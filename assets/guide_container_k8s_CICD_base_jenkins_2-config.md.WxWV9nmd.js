import{_ as s,o as a,c as n,R as e}from"./chunks/framework.zUbWieqp.js";const g=JSON.parse('{"title":"1. æ’ä»¶å®‰è£…","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/CICD/base_jenkins/2-config.md","filePath":"guide/container/k8s/CICD/base_jenkins/2-config.md","lastUpdated":1723447064000}'),l={name:"guide/container/k8s/CICD/base_jenkins/2-config.md"},p=e(`<h1 id="_1-æ’ä»¶å®‰è£…" tabindex="-1">1. æ’ä»¶å®‰è£… <a class="header-anchor" href="#_1-æ’ä»¶å®‰è£…" aria-label="Permalink to &quot;1. æ’ä»¶å®‰è£…&quot;">â€‹</a></h1><h2 id="_1-1-æ‰‹åŠ¨å®‰è£…" tabindex="-1">1.1 æ‰‹åŠ¨å®‰è£… <a class="header-anchor" href="#_1-1-æ‰‹åŠ¨å®‰è£…" aria-label="Permalink to &quot;1.1 æ‰‹åŠ¨å®‰è£…&quot;">â€‹</a></h2><p><a href="https://updates.jenkins-ci.org/download/plugins/" target="_blank" rel="noreferrer">https://updates.jenkins-ci.org/download/plugins/</a></p><h2 id="_1-2-åœ¨çº¿å®‰è£…" tabindex="-1">1.2 åœ¨çº¿å®‰è£… <a class="header-anchor" href="#_1-2-åœ¨çº¿å®‰è£…" aria-label="Permalink to &quot;1.2 åœ¨çº¿å®‰è£…&quot;">â€‹</a></h2><p>â€œç³»ç»Ÿç®¡ç†â€ â€“&gt; â€œæ’ä»¶ç®¡ç†â€ â€“&gt; â€œå¯é€‰æ’ä»¶â€</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"># æ¨èæ’ä»¶</span></span>
<span class="line"><span style="color:#e1e4e8;">Chinese  ä¸­æ–‡</span></span>
<span class="line"><span style="color:#e1e4e8;">Gitlab</span></span>
<span class="line"><span style="color:#e1e4e8;">Git Parameter</span></span>
<span class="line"><span style="color:#e1e4e8;">Extended Choice Parameter  æ„å»ºjobæ—¶å®ç”¨æ’ä»¶</span></span>
<span class="line"><span style="color:#e1e4e8;">Docker</span></span>
<span class="line"><span style="color:#e1e4e8;">Groovy</span></span>
<span class="line"><span style="color:#e1e4e8;">Kubernetes</span></span>
<span class="line"><span style="color:#e1e4e8;">Pipeline</span></span>
<span class="line"><span style="color:#e1e4e8;">Config File Provider</span></span>
<span class="line"><span style="color:#e1e4e8;">active choices</span></span>
<span class="line"><span style="color:#e1e4e8;">kubernetes Continuous Deploy</span></span>
<span class="line"><span style="color:#e1e4e8;">http request</span></span>
<span class="line"><span style="color:#e1e4e8;">build user vars</span></span>
<span class="line"><span style="color:#e1e4e8;">description setter</span></span>
<span class="line"><span style="color:#e1e4e8;">Describe With Params</span></span>
<span class="line"><span style="color:#e1e4e8;">Build Name and Description Setter</span></span>
<span class="line"><span style="color:#e1e4e8;">Pipeline Stage View</span></span>
<span class="line"><span style="color:#e1e4e8;">Post build task</span></span>
<span class="line"><span style="color:#e1e4e8;">Blue Ocean</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"># æ¨èæ’ä»¶</span></span>
<span class="line"><span style="color:#24292e;">Chinese  ä¸­æ–‡</span></span>
<span class="line"><span style="color:#24292e;">Gitlab</span></span>
<span class="line"><span style="color:#24292e;">Git Parameter</span></span>
<span class="line"><span style="color:#24292e;">Extended Choice Parameter  æ„å»ºjobæ—¶å®ç”¨æ’ä»¶</span></span>
<span class="line"><span style="color:#24292e;">Docker</span></span>
<span class="line"><span style="color:#24292e;">Groovy</span></span>
<span class="line"><span style="color:#24292e;">Kubernetes</span></span>
<span class="line"><span style="color:#24292e;">Pipeline</span></span>
<span class="line"><span style="color:#24292e;">Config File Provider</span></span>
<span class="line"><span style="color:#24292e;">active choices</span></span>
<span class="line"><span style="color:#24292e;">kubernetes Continuous Deploy</span></span>
<span class="line"><span style="color:#24292e;">http request</span></span>
<span class="line"><span style="color:#24292e;">build user vars</span></span>
<span class="line"><span style="color:#24292e;">description setter</span></span>
<span class="line"><span style="color:#24292e;">Describe With Params</span></span>
<span class="line"><span style="color:#24292e;">Build Name and Description Setter</span></span>
<span class="line"><span style="color:#24292e;">Pipeline Stage View</span></span>
<span class="line"><span style="color:#24292e;">Post build task</span></span>
<span class="line"><span style="color:#24292e;">Blue Ocean</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>æ–°ç‰ˆæœ¬jenkinsä¸­å·²å¼ƒç”¨kubernetes Continuous Deploy</p><p>ä¸‹è½½åœ°å€<a href="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/kubernetes_Continuous_Deploy.hpi" target="_blank" rel="noreferrer">https://nnaigos.oss-cn-hangzhou.aliyuncs.com/kubernetes_Continuous_Deploy.hpi</a></p><ul><li>æ”¯æŒä»¥ä¸‹èµ„æºç±»å‹: <ul><li>Deployment</li><li>Replica Set</li><li>Daemon Set</li><li>Pod</li><li>Job</li><li>Service</li><li>Ingress</li><li>Secret</li></ul></li></ul></div><h1 id="_2-å…¨å±€å‡­æ®-unrestricted" tabindex="-1">2. å…¨å±€å‡­æ®(unrestricted) <a class="header-anchor" href="#_2-å…¨å±€å‡­æ®-unrestricted" aria-label="Permalink to &quot;2. å…¨å±€å‡­æ®(unrestricted)&quot;">â€‹</a></h1><p>1ã€gitlab-auth-passwdï¼Œç±»å‹:Username with password</p><p>2ã€Harborï¼Œç±»å‹:Username with password</p><p>3ã€kubeconfigï¼Œç±»å‹: Secret file</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407311544654.png" alt="image-20240731154422825"></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407311545399.png" alt="image-20240731154515032"></p><p>ç‚¹å‡»å…¨å±€</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407311546144.png" alt="image-20240731154644199"></p><h2 id="_2-1-æ·»åŠ k8så‡­æ®" tabindex="-1">2.1 æ·»åŠ k8så‡­æ® <a class="header-anchor" href="#_2-1-æ·»åŠ k8så‡­æ®" aria-label="Permalink to &quot;2.1 æ·»åŠ k8så‡­æ®&quot;">â€‹</a></h2><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407311559432.png" alt="image-20240731155930124"></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407311559285.png" alt="image-20240731155948980"></p><p>æˆ–è€…é€šè¿‡</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202408061224995.png" alt="image"></p><h2 id="_2-2-æ·»åŠ k8s" tabindex="-1">2.2 æ·»åŠ k8s <a class="header-anchor" href="#_2-2-æ·»åŠ k8s" aria-label="Permalink to &quot;2.2 æ·»åŠ k8s&quot;">â€‹</a></h2><p>Kubeconfigï¼šå¦‚æœæ˜¯kubeadméƒ¨ç½²çš„ï¼Œé…ç½®æ–‡ä»¶ï¼š</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">1.æ–¹å¼è·å–k8så¯†é’¥</span></span>
<span class="line"><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">.kube/config</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">2.å¯¼å‡ºæ–¹å¼æˆ–è€…å¯†é’¥</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">view</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--raw</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-config-admin</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">1.æ–¹å¼è·å–k8så¯†é’¥</span></span>
<span class="line"><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">.kube/config</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">2.å¯¼å‡ºæ–¹å¼æˆ–è€…å¯†é’¥</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">view</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--raw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-config-admin</span></span></code></pre></div><p>ç³»ç»Ÿç®¡ç† â€“&gt; èŠ‚ç‚¹ç®¡ç† â€“&gt; Configure Cloud</p><blockquote><p>ç”±äºjenkinsæ˜¯ç›´æ¥éƒ¨ç½²åœ¨k8sä¹‹å†…çš„ï¼Œå°±æ¯”è¾ƒç®€å•ï¼Œä¸éœ€è¦å¡«å†™è¯ä¹¦ï¼Œç›´æ¥è¿™æ ·</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#kubernetes åœ°å€é‡‡ç”¨äº†kubeçš„æœåŠ¡å™¨å‘ç°ï¼š</span></span>
<span class="line"><span style="color:#B392F0;">https://kubernetes.default.svc.cluster.local</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ç‚¹å‡»Test Connectionï¼Œå¦‚æœå‡ºç° Connection test successful çš„æç¤ºä¿¡æ¯è¯æ˜ Jenkins å·²ç»å¯ä»¥å’Œ Kubernetes ç³»ç»Ÿæ­£å¸¸é€šä¿¡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#Jenkins URLåœ°å€ï¼š</span></span>
<span class="line"><span style="color:#B392F0;">http://jenkins.devops.svc.cluster.local:8080ï¼ˆportå¤„å¡«å†™å½“å‰é›†ç¾¤å†…jenkins</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">podçš„ç«¯å£ï¼‰</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#kubernetes åœ°å€é‡‡ç”¨äº†kubeçš„æœåŠ¡å™¨å‘ç°ï¼š</span></span>
<span class="line"><span style="color:#6F42C1;">https://kubernetes.default.svc.cluster.local</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ç‚¹å‡»Test Connectionï¼Œå¦‚æœå‡ºç° Connection test successful çš„æç¤ºä¿¡æ¯è¯æ˜ Jenkins å·²ç»å¯ä»¥å’Œ Kubernetes ç³»ç»Ÿæ­£å¸¸é€šä¿¡</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#Jenkins URLåœ°å€ï¼š</span></span>
<span class="line"><span style="color:#6F42C1;">http://jenkins.devops.svc.cluster.local:8080ï¼ˆportå¤„å¡«å†™å½“å‰é›†ç¾¤å†…jenkins</span><span style="color:#24292E;"> </span><span style="color:#032F62;">podçš„ç«¯å£ï¼‰</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407311606956.png" alt="image-20240731160649646"></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407311612520.png" alt="image-20240731161158286"></p><h2 id="_2-3-æ·»åŠ gitlabå‡­è¯" tabindex="-1">2.3 æ·»åŠ gitlabå‡­è¯ <a class="header-anchor" href="#_2-3-æ·»åŠ gitlabå‡­è¯" aria-label="Permalink to &quot;2.3 æ·»åŠ gitlabå‡­è¯&quot;">â€‹</a></h2><h3 id="username-passwordç±»å‹" tabindex="-1">username passwordç±»å‹ <a class="header-anchor" href="#username-passwordç±»å‹" aria-label="Permalink to &quot;username passwordç±»å‹&quot;">â€‹</a></h3><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202408051134871.png" alt="image-20240805113222144"></p><h3 id="æ·»åŠ sshç±»å‹" tabindex="-1">æ·»åŠ sshç±»å‹ <a class="header-anchor" href="#æ·»åŠ sshç±»å‹" aria-label="Permalink to &quot;æ·»åŠ sshç±»å‹&quot;">â€‹</a></h3><p>å°†id_rsa.pubå†…å®¹æ‹·è´å‡ºæ¥ï¼Œç„¶åæ‰“å¼€githubï¼Œè¿›å…¥setting-&gt; SSH and GPG keys ç‚¹å‡»<code>New SSH key</code></p><p>å°†id_rsaå†…å®¹æ‹·è´å‡ºæ¥,è¿›å…¥jenkins manager---&gt;æ·»åŠ å‡­è¯---&gt;é€‰æ‹©<code>SSH Username with private key</code>è®¤è¯æ–¹å¼</p><h2 id="_2-4-æ·»åŠ haborå‡­è¯" tabindex="-1">2.4 æ·»åŠ Haborå‡­è¯ <a class="header-anchor" href="#_2-4-æ·»åŠ haborå‡­è¯" aria-label="Permalink to &quot;2.4 æ·»åŠ Haborå‡­è¯&quot;">â€‹</a></h2><p>å’Œgitlabæ·»åŠ æ–¹å¼ä¸€æ ·</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">secret</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker-registry</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">registry-pull-secret</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--docker-server=10.100.24.85</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--docker-username=admin</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--docker-password=Aa123456</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--docker-email=admin@admin.com</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">secret</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker-registry</span><span style="color:#24292E;"> </span><span style="color:#032F62;">registry-pull-secret</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--docker-server=10.100.24.85</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--docker-username=admin</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--docker-password=Aa123456</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--docker-email=admin@admin.com</span></span></code></pre></div>`,37),o=[p];function t(c,i,r,d,y,u){return a(),n("div",null,o)}const k=s(l,[["render",t]]);export{g as __pageData,k as default};
