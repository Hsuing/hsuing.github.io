import{_ as s,o as n,c as a,R as p}from"./chunks/framework.zUbWieqp.js";const d=JSON.parse('{"title":"1. kubectl describe","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/TroubleshootingMaintenanceManual/9-查看pod资源.md","filePath":"guide/container/k8s/TroubleshootingMaintenanceManual/9-查看pod资源.md","lastUpdated":1729591632000}'),l={name:"guide/container/k8s/TroubleshootingMaintenanceManual/9-查看pod资源.md"},o=p(`<h1 id="_1-kubectl-describe" tabindex="-1">1. kubectl describe <a class="header-anchor" href="#_1-kubectl-describe" aria-label="Permalink to &quot;1. kubectl describe&quot;">​</a></h1><p>可通过该命令查看 Pod 在节点上的资源分配情况（Request、Limits），如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"># product 表示生产环境</span></span>
<span class="line"><span style="color:#e1e4e8;">kubectl describe node -l env=product</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"># 执行结果</span></span>
<span class="line"><span style="color:#e1e4e8;">Namespace                   Name                                                      CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE</span></span>
<span class="line"><span style="color:#e1e4e8;">---------                   ----                                                      ------------  ----------  ---------------  -------------  ---</span></span>
<span class="line"><span style="color:#e1e4e8;">product                     annoroad-clinicallims3-754dddb5cb-k5xkn                   0 (0%)        0 (0%)      0 (0%)           0 (0%)         85d</span></span>
<span class="line"><span style="color:#e1e4e8;">product                     annoroad-crm-796884585d-ts2xn                             0 (0%)        0 (0%)      0 (0%)           0 (0%)         85d</span></span>
<span class="line"><span style="color:#e1e4e8;">product                     annoroad-dms-6d658d564f-m6j7r                             0 (0%)        0 (0%)      0 (0%)           0 (0%)         16d</span></span>
<span class="line"><span style="color:#e1e4e8;">product                     annoroad-dms-server-6557c5bc85-45sw2                      0 (0%)        0 (0%)      0 (0%)           0 (0%)         15d</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"># product 表示生产环境</span></span>
<span class="line"><span style="color:#24292e;">kubectl describe node -l env=product</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"># 执行结果</span></span>
<span class="line"><span style="color:#24292e;">Namespace                   Name                                                      CPU Requests  CPU Limits  Memory Requests  Memory Limits  AGE</span></span>
<span class="line"><span style="color:#24292e;">---------                   ----                                                      ------------  ----------  ---------------  -------------  ---</span></span>
<span class="line"><span style="color:#24292e;">product                     annoroad-clinicallims3-754dddb5cb-k5xkn                   0 (0%)        0 (0%)      0 (0%)           0 (0%)         85d</span></span>
<span class="line"><span style="color:#24292e;">product                     annoroad-crm-796884585d-ts2xn                             0 (0%)        0 (0%)      0 (0%)           0 (0%)         85d</span></span>
<span class="line"><span style="color:#24292e;">product                     annoroad-dms-6d658d564f-m6j7r                             0 (0%)        0 (0%)      0 (0%)           0 (0%)         16d</span></span>
<span class="line"><span style="color:#24292e;">product                     annoroad-dms-server-6557c5bc85-45sw2                      0 (0%)        0 (0%)      0 (0%)           0 (0%)         15d</span></span></code></pre></div><h1 id="_2-kubectl-top-node" tabindex="-1">2. kubectl top node <a class="header-anchor" href="#_2-kubectl-top-node" aria-label="Permalink to &quot;2. kubectl top node&quot;">​</a></h1><p>可通过该命令查看节点的资源使用情况，如下：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># product 表示生产环境</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">top</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">node</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-l</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">env=product</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 执行结果</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                       </span><span style="color:#9ECBFF;">CPU</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">cores</span><span style="color:#E1E4E8;">)   </span><span style="color:#9ECBFF;">CPU%</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">MEMORY</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">bytes</span><span style="color:#E1E4E8;">)   </span><span style="color:#9ECBFF;">MEMORY%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.102</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">904</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">11</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">10340</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">69</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.103</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1393</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">17</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">12810</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">86</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.104</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1994</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">24</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">13281</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">89</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.105</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">987</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">12</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">9399</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">63</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.115</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">638</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">15</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">12017</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">80</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.118</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">806</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">20</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">9372</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">62</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.135</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">258</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">6</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">9696</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">65</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.136</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">871</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">21</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">10957</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">73</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.137</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">310</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">7</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">9322</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">62</span><span style="color:#9ECBFF;">%</span></span>
<span class="line"><span style="color:#B392F0;">cn-beijing.192.16.168.138</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">943</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">23</span><span style="color:#9ECBFF;">%</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">11908</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">80</span><span style="color:#9ECBFF;">%</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># product 表示生产环境</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">top</span><span style="color:#24292E;"> </span><span style="color:#032F62;">node</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-l</span><span style="color:#24292E;"> </span><span style="color:#032F62;">env=product</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 执行结果</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                       </span><span style="color:#032F62;">CPU</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">cores</span><span style="color:#24292E;">)   </span><span style="color:#032F62;">CPU%</span><span style="color:#24292E;">   </span><span style="color:#032F62;">MEMORY</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">bytes</span><span style="color:#24292E;">)   </span><span style="color:#032F62;">MEMORY%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.102</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">904</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">11</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">10340</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">69</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.103</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1393</span><span style="color:#032F62;">m</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">17</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">12810</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">86</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.104</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1994</span><span style="color:#032F62;">m</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">24</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">13281</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">89</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.105</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">987</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">12</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">9399</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">63</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.115</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">638</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">15</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">12017</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">80</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.118</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">806</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">20</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">9372</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">62</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.135</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">258</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">6</span><span style="color:#032F62;">%</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">9696</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">65</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.136</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">871</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">21</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">10957</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">73</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.137</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">310</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">7</span><span style="color:#032F62;">%</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">9322</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">62</span><span style="color:#032F62;">%</span></span>
<span class="line"><span style="color:#6F42C1;">cn-beijing.192.16.168.138</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">943</span><span style="color:#032F62;">m</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">23</span><span style="color:#032F62;">%</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">11908</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">80</span><span style="color:#032F62;">%</span></span></code></pre></div><ul><li>top pod</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"># product 表示生产环境</span></span>
<span class="line"><span style="color:#e1e4e8;">kubectl top pod -n product</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"># product 表示生产环境</span></span>
<span class="line"><span style="color:#24292e;">kubectl top pod -n product</span></span></code></pre></div><h1 id="_3-查询每个pod" tabindex="-1">3. 查询每个Pod <a class="header-anchor" href="#_3-查询每个pod" aria-label="Permalink to &quot;3. 查询每个Pod&quot;">​</a></h1><p>kubectl查询每个pod占用磁盘空间</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl get node</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ROLES</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">VERSION</span></span>
<span class="line"><span style="color:#B392F0;">k8s-master01</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Ready</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">control-plane,master</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">121</span><span style="color:#9ECBFF;">d</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">v1.22.17</span></span>
<span class="line"><span style="color:#B392F0;">kube-node01</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Ready</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">                 </span><span style="color:#79B8FF;">119</span><span style="color:#9ECBFF;">d</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">v1.22.17</span></span>
<span class="line"><span style="color:#B392F0;">kube-node02</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Ready</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">                 </span><span style="color:#79B8FF;">120</span><span style="color:#9ECBFF;">d</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">v1.22.17</span></span>
<span class="line"><span style="color:#B392F0;">kube-node03</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Ready</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">                 </span><span style="color:#79B8FF;">120</span><span style="color:#9ECBFF;">d</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">v1.22.17</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--raw</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/api/v1/nodes/kube-node01/proxy/stats/summary</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">jq</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;.pods[] | &quot;PodName:  \\(.podRef.name)&quot;, &quot;usedBytes:   \\(.containers[].rootfs.usedBytes)&quot;, &quot;======================================================&quot;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">&quot;PodName:  openelb-keepalive-vip-fmqp8&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;usedBytes:   94208&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;PodName:  consul-0&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;usedBytes:   983040&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;PodName:  process-exporter-cwwr9&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;usedBytes:   0&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;PodName:  calico-typha-67c6dc57d6-jkxfh&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;usedBytes:   0&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;PodName:  minio-1-ss-0-0&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;usedBytes:   0&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;usedBytes:   0&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl get node</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">           </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ROLES</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">    </span><span style="color:#032F62;">VERSION</span></span>
<span class="line"><span style="color:#6F42C1;">k8s-master01</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Ready</span><span style="color:#24292E;">    </span><span style="color:#032F62;">control-plane,master</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">121</span><span style="color:#032F62;">d</span><span style="color:#24292E;">   </span><span style="color:#032F62;">v1.22.17</span></span>
<span class="line"><span style="color:#6F42C1;">kube-node01</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Ready</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">                 </span><span style="color:#005CC5;">119</span><span style="color:#032F62;">d</span><span style="color:#24292E;">   </span><span style="color:#032F62;">v1.22.17</span></span>
<span class="line"><span style="color:#6F42C1;">kube-node02</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Ready</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">                 </span><span style="color:#005CC5;">120</span><span style="color:#032F62;">d</span><span style="color:#24292E;">   </span><span style="color:#032F62;">v1.22.17</span></span>
<span class="line"><span style="color:#6F42C1;">kube-node03</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Ready</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">                 </span><span style="color:#005CC5;">120</span><span style="color:#032F62;">d</span><span style="color:#24292E;">   </span><span style="color:#032F62;">v1.22.17</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--raw</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/api/v1/nodes/kube-node01/proxy/stats/summary</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">jq</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;.pods[] | &quot;PodName:  \\(.podRef.name)&quot;, &quot;usedBytes:   \\(.containers[].rootfs.usedBytes)&quot;, &quot;======================================================&quot;&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">&quot;PodName:  openelb-keepalive-vip-fmqp8&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;usedBytes:   94208&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;PodName:  consul-0&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;usedBytes:   983040&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;PodName:  process-exporter-cwwr9&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;usedBytes:   0&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;PodName:  calico-typha-67c6dc57d6-jkxfh&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;usedBytes:   0&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;======================================================&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;PodName:  minio-1-ss-0-0&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;usedBytes:   0&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;usedBytes:   0&quot;</span></span></code></pre></div><h2 id="_3-1-节点上容器" tabindex="-1">3.1 节点上容器 <a class="header-anchor" href="#_3-1-节点上容器" aria-label="Permalink to &quot;3.1 节点上容器&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 节点上查看磁盘使用情况,并安装从大到小排序,可以看到各个容器的占用磁盘空间。</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ps</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-a</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--format</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;table {{.Size}}\\t{{.Names}}&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sort</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-hr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看磁盘总体使用情况</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">system</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">df</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-v</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#清理所有未使用的资源（镜像、容器、卷和网络）</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">system</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">prune</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-a</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#解决方式，配置日志轮询</span></span>
<span class="line"><span style="color:#6A737D;">#docker</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#B392F0;">&quot;log-driver&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;json-file&quot;</span></span>
<span class="line"><span style="color:#B392F0;">&quot;log-opts&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">&quot;max-size&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;100m&quot;,</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">&quot;max-file&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">  }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 节点上查看磁盘使用情况,并安装从大到小排序,可以看到各个容器的占用磁盘空间。</span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ps</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-a</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--format</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;table {{.Size}}\\t{{.Names}}&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sort</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-hr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看磁盘总体使用情况</span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">system</span><span style="color:#24292E;"> </span><span style="color:#032F62;">df</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-v</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#清理所有未使用的资源（镜像、容器、卷和网络）</span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">system</span><span style="color:#24292E;"> </span><span style="color:#032F62;">prune</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-a</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#解决方式，配置日志轮询</span></span>
<span class="line"><span style="color:#6A737D;">#docker</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;log-driver&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;json-file&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">&quot;log-opts&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">&quot;max-size&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;100m&quot;,</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">&quot;max-file&quot;</span><span style="color:#005CC5;">:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;3&quot;</span></span>
<span class="line"><span style="color:#24292E;">  }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre></div>`,13),e=[o];function t(c,r,y,E,F,i){return n(),a("div",null,e)}const u=s(l,[["render",t]]);export{d as __pageData,u as default};
