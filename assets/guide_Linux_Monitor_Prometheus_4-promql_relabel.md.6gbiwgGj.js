import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const g=JSON.parse('{"title":"1. relabeling","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Monitor/Prometheus/4-promql_relabel.md","filePath":"guide/Linux/Monitor/Prometheus/4-promql_relabel.md","lastUpdated":1739528109000}'),p={name:"guide/Linux/Monitor/Prometheus/4-promql_relabel.md"},e=l(`<h1 id="_1-relabeling" tabindex="-1">1. relabeling <a class="header-anchor" href="#_1-relabeling" aria-label="Permalink to &quot;1. relabeling&quot;">â€‹</a></h1><h2 id="_1-1-relabelç®€ä»‹" tabindex="-1">1.1 relabelç®€ä»‹ <a class="header-anchor" href="#_1-1-relabelç®€ä»‹" aria-label="Permalink to &quot;1.1 relabelç®€ä»‹&quot;">â€‹</a></h2><p>Relabeling æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå®ƒå…è®¸ä½ é€šè¿‡é‡å†™æ ‡ç­¾é›†æ¥åˆ†ç±»å’Œè¿‡æ»¤Prometheus<code>Target/ç›®æ ‡</code>å’Œ<code>Metric/æŒ‡æ ‡</code>ã€‚</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202412261430118.png" alt="image-20241226143000386"></p><h2 id="_1-2-relabelç›®çš„" tabindex="-1">1.2 relabelç›®çš„ <a class="header-anchor" href="#_1-2-relabelç›®çš„" aria-label="Permalink to &quot;1.2 relabelç›®çš„&quot;">â€‹</a></h2><p>å¦‚ä½•å°†æŒ‡æ ‡é‡çº§é™ç»´å’Œé‡ç»„</p><ul><li><strong>è¦ä¿ç•™çš„æ•°æ®</strong>ï¼šè¿™æ¶‰åŠä¿ç•™ä¸€ç»„æ˜ç¡®å®šä¹‰çš„é‡è¦æŒ‡æ ‡å’Œæ ‡ç­¾ï¼Œå¹¶åˆ é™¤å…¶ä»–æ‰€æœ‰å†…å®¹ã€‚è¦å°†æŒ‡æ ‡å’Œæ ‡ç­¾åˆ—å…¥ç™½åå•ï¼Œé¦–å…ˆåº”è¯¥æ˜ç¡®å“ªäº›æ ¸å¿ƒæŒ‡æ ‡å’Œæ ‡ç­¾æ˜¯å¸Œæœ›ä¿ç•™çš„ã€‚è¦åœ¨Prometheusä¸­å¯ç”¨ç™½åå•ï¼Œéœ€è¦é…åˆrelabeling actionçš„<code>keep</code>å’Œ<code>labelkeep</code>æ¥æ“ä½œã€‚</li><li><strong>å¯ä¸¢å¼ƒçš„æ•°æ®</strong>ï¼šè¿™æ¶‰åŠåˆ é™¤ä½ éœ€è¦æ˜ç¡®å®šä¹‰çš„ä¸€ç»„ä¸é‡è¦æŒ‡æ ‡ï¼Œå¹¶ä¿ç•™å…¶ä»–æ‰€æœ‰æŒ‡æ ‡ã€‚ä¸€æ—¦ç¡®å®šäº†è¦åˆ é™¤çš„é«˜åŸºæ•°æŒ‡æ ‡å’Œæ ‡ç­¾åˆ—è¡¨ï¼Œæ‹’ç»åå•å°±å¯èƒ½éœ€è¦è¢«ä½¿ç”¨ã€‚è¦åœ¨ Prometheus ä¸­å¯ç”¨é»‘åå•ï¼Œéœ€è¦é…åˆrelabeling actionçš„<code>drop</code>å’Œ<code>labeldrop</code>æ¥æ“ä½œã€‚</li></ul><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>è®°ä½ä¸€ç‚¹ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªé˜¶æ®µå¯ä»¥é‡æ–°æ ‡è®°ã€‚</p><p>ç¬¬ä¸€é˜¶æ®µæ˜¯å¯¹æ¥è‡ªæœåŠ¡å‘ç°çš„ç›®æ ‡è¿›è¡Œé‡æ–°æ ‡è®°ï¼Œè¿™æ˜¯å¯¹äºæ¥è‡ªæœåŠ¡å‘ç°çš„å…ƒæ•°æ®æ ‡ç­¾ä¸­çš„ä¿¡æ¯åº”ç”¨äºæŒ‡æ ‡ä¸Šçš„æ ‡ç­¾æ¥è¯´éå¸¸æœ‰ç”¨ã€‚</p><p>ç¬¬äºŒé˜¶æ®µæ˜¯æŠ“å–æŒ‡æ ‡ä¹‹åä½†æ˜¯åœ¨å­˜å‚¨ç³»ç»Ÿä¹‹å‰ã€‚è¿™æ ·å°±å¯ä»¥ç¡®å®šå“ªäº›æŒ‡æ ‡éœ€è¦ä¿å­˜ï¼Œå“ªäº›éœ€è¦ä¸¢å¼ƒä»¥åŠè¿™äº›æŒ‡æ ‡çš„æ ·å¼ã€‚</p><p>æŠ“å–ä¹‹å‰ä½¿ç”¨relabel_configsï¼ŒæŠ“å–ä¹‹åä½¿ç”¨metrics_relabel_configs</p></div><h2 id="_1-3-ç”Ÿå‘½å‘¨æœŸ" tabindex="-1">1.3 ç”Ÿå‘½å‘¨æœŸ <a class="header-anchor" href="#_1-3-ç”Ÿå‘½å‘¨æœŸ" aria-label="Permalink to &quot;1.3 ç”Ÿå‘½å‘¨æœŸ&quot;">â€‹</a></h2><h2 id="_1-4-åŸç†" tabindex="-1">1.4 åŸç† <a class="header-anchor" href="#_1-4-åŸç†" aria-label="Permalink to &quot;1.4 åŸç†&quot;">â€‹</a></h2><p>é‡æ–°æ ‡è®°æ ‡ç­¾ä½œç”¨:</p><p>1ã€åŠ¨æ€ç”Ÿæˆæ–°æ ‡ç­¾ æ ¹æ®å·²æœ‰çš„æ ‡ç­¾ç”Ÿæˆæ–°æ ‡ç­¾</p><p>2ã€è¿‡æ»¤é‡‡é›†çš„Target</p><p>3ã€åˆ é™¤ä¸éœ€è¦æˆ–è€…æ•æ„Ÿæ ‡ç­¾</p><p>4ã€æ·»åŠ æ–°æ ‡ç­¾</p><h2 id="_1-5-relabelå››ç§æ–¹å¼" tabindex="-1">1.5 relabelå››ç§æ–¹å¼ <a class="header-anchor" href="#_1-5-relabelå››ç§æ–¹å¼" aria-label="Permalink to &quot;1.5 relabelå››ç§æ–¹å¼&quot;">â€‹</a></h2><h3 id="_1-relabel-config" tabindex="-1">1.relabel_config <a class="header-anchor" href="#_1-relabel-config" aria-label="Permalink to &quot;1.relabel_config&quot;">â€‹</a></h3><p>é‡æ–°æ ‡è®°ï¼ˆRelabelingï¼‰æ˜¯ä¸€ä¸ªå¯ä»¥åœ¨æŠ“å–ç›®æ ‡ï¼ˆtargetï¼‰æ•°æ®ä¹‹å‰ï¼ŒåŠ¨æ€ä¿®æ”¹ç›®æ ‡çš„æ ‡ç­¾é›†çš„å¼ºå¤§å·¥å…·ã€‚æ¯ä¸ªæŠ“å–ï¼ˆscrapeï¼‰é…ç½®å¯ä»¥å®šä¹‰å¤šä¸ªé‡æ–°æ ‡è®°æ­¥éª¤ã€‚å®ƒä»¬æŒ‰ç…§åœ¨é…ç½®æ–‡ä»¶ä¸­çš„å‡ºç°é¡ºåºåº”ç”¨äºæ¯ä¸ªç›®æ ‡çš„æ ‡ç­¾é›†ã€‚</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">relabel_config</span></span>
<span class="line"><span style="color:#B392F0;">åœ¨è¢«prometheusæŠ“å–ä¹‹å‰ä¿®æ”¹ï¼Œé’ˆå¯¹çš„æ˜¯target</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">relabel_config</span></span>
<span class="line"><span style="color:#6F42C1;">åœ¨è¢«prometheusæŠ“å–ä¹‹å‰ä¿®æ”¹ï¼Œé’ˆå¯¹çš„æ˜¯target</span></span></code></pre></div><h3 id="_2-metric-relabel-configs" tabindex="-1">2.metric_relabel_configs <a class="header-anchor" href="#_2-metric-relabel-configs" aria-label="Permalink to &quot;2.metric_relabel_configs&quot;">â€‹</a></h3><p>æŒ‡æ ‡é‡æ–°æ ‡è®°ï¼ˆMetric relabelingï¼‰æ˜¯åœ¨æ‘„å–ï¼ˆingestionï¼‰ä¹‹å‰æœ€åä¸€æ­¥å¯¹æ ·æœ¬ï¼ˆsamplesï¼‰åº”ç”¨çš„ã€‚å®ƒå…·æœ‰ä¸ç›®æ ‡é‡æ ‡è®°ï¼ˆrelabel_configsï¼‰ç›¸åŒçš„é…ç½®æ ¼å¼å’Œæ“ä½œã€‚æŒ‡æ ‡é‡æ ‡è®°ä¸é€‚ç”¨äºè‡ªåŠ¨ç”Ÿæˆçš„æ—¶é—´åºåˆ—ï¼Œä¾‹å¦‚ upã€‚</p><p>è¿™æ ·åšçš„ä¸€ä¸ªç”¨é€”æ˜¯æ’é™¤é‚£äº›æ‘„å–æˆæœ¬è¿‡é«˜çš„æ—¶é—´åºåˆ—ã€‚</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">metric_relabel_configs</span></span>
<span class="line"><span style="color:#e1e4e8;">åœ¨è¢«prometheuså­˜å‚¨ä¹‹å‰ä¿®æ”¹ï¼Œé’ˆå¯¹çš„æ˜¯metric</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">metric_relabel_configs</span></span>
<span class="line"><span style="color:#24292e;">åœ¨è¢«prometheuså­˜å‚¨ä¹‹å‰ä¿®æ”¹ï¼Œé’ˆå¯¹çš„æ˜¯metric</span></span></code></pre></div><h3 id="_3-alert-relabel-configs" tabindex="-1">3.alert_relabel_configs <a class="header-anchor" href="#_3-alert-relabel-configs" aria-label="Permalink to &quot;3.alert_relabel_configs&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">alert_relabel_configs</span></span>
<span class="line"><span style="color:#e1e4e8;">åœ¨è¢«å‘é€åˆ°alertmanagerä¹‹å‰ï¼Œé’ˆå¯¹çš„æ˜¯alert</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">alert_relabel_configs</span></span>
<span class="line"><span style="color:#24292e;">åœ¨è¢«å‘é€åˆ°alertmanagerä¹‹å‰ï¼Œé’ˆå¯¹çš„æ˜¯alert</span></span></code></pre></div><h3 id="_4-write-relabel-configs" tabindex="-1">4.write_relabel_configs <a class="header-anchor" href="#_4-write-relabel-configs" aria-label="Permalink to &quot;4.write_relabel_configs&quot;">â€‹</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">write_relabel_configs</span></span>
<span class="line"><span style="color:#e1e4e8;">å†™åˆ°è¿œç¨‹å­˜å‚¨çš„æ ·æœ¬</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">write_relabel_configs</span></span>
<span class="line"><span style="color:#24292e;">å†™åˆ°è¿œç¨‹å­˜å‚¨çš„æ ·æœ¬</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202412261416188.png" alt="Relabeling"></p><h3 id="_5-relabel-configs-å’Œ-metric-relabel-configs-åŒºåˆ«" tabindex="-1">5.relabel_configs å’Œ metric_relabel_configs åŒºåˆ« <a class="header-anchor" href="#_5-relabel-configs-å’Œ-metric-relabel-configs-åŒºåˆ«" aria-label="Permalink to &quot;5.relabel_configs å’Œ metric_relabel_configs åŒºåˆ«&quot;">â€‹</a></h3><ol><li>åº”ç”¨æ—¶é—´ç‚¹ä¸åŒï¼šrelabel_configs ç”¨äºåœ¨æŠ“å–ç›®æ ‡ä¹‹å‰å¯¹ç›®æ ‡è¿›è¡Œæ ‡ç­¾é‡å†™æˆ–ç­›é€‰ï¼Œè€Œ metric_relabel_configs åœ¨æŒ‡æ ‡æ”¶é›†å®Œæˆåè¿›è¡Œæ“ä½œã€‚</li><li>æ“ä½œçš„å¯¹è±¡ä¸åŒï¼šrelabel_configs ç”¨äºç›®æ ‡çº§åˆ«çš„æ“ä½œï¼Œå¯ä»¥å¯¹ç›®æ ‡è¿›è¡Œæ ‡ç­¾çš„ä¿®æ”¹ã€ç”Ÿæˆå’Œè¿‡æ»¤ï¼›metric_relabel_configs ç”¨äºæŒ‡æ ‡çº§åˆ«çš„æ“ä½œï¼Œå¯ä»¥å¯¹æŒ‡æ ‡çš„æ ‡ç­¾è¿›è¡Œä¿®æ”¹ã€ç”Ÿæˆå’Œè¿‡æ»¤ã€‚</li><li>ä½¿ç”¨åœºæ™¯ä¸åŒï¼šrelabel_configs é€‚ç”¨äºéœ€è¦åœ¨æŠ“å–ç›®æ ‡å‰è¿›è¡Œæ ‡ç­¾çš„æ“ä½œï¼Œä¾‹å¦‚ä¿®æ”¹æŠ“å–æ•°æ®æ—¶é»˜è®¤ä½¿ç”¨çš„ç«¯å£æˆ–è·¯å¾„ï¼›metric_relabel_configs é€‚ç”¨äºéœ€è¦åœ¨æŒ‡æ ‡æ”¶é›†å®Œæˆåå¯¹æŒ‡æ ‡è¿›è¡Œè¿›ä¸€æ­¥å¤„ç†ï¼Œä¾‹å¦‚è¿‡æ»¤æ‰ä¸éœ€è¦çš„æ ‡ç­¾æˆ–è€…åŸºäºç°æœ‰æ ‡ç­¾åˆ›å»ºæ–°çš„æ ‡ç­¾ã€‚</li></ol><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>å¦‚æœä½¿ç”¨ metric_relabel_configs åŸºäºç°æœ‰æ ‡ç­¾åˆ›å»ºæ–°çš„æ ‡ç­¾ï¼Œé‚£ä¹ˆåªæœ‰å·²ç»å­˜åœ¨è€æ ‡ç­¾çš„æŒ‡æ ‡æ‰ä¼šæœ‰æ–°çš„æ ‡ç­¾ï¼Œè€Œä¸æ˜¯æ‰€æœ‰æŒ‡æ ‡ä¸­éƒ½ä¼šæœ‰ã€‚è¿™æ˜¯å› ä¸º metric_relabel_configs ä¸­å®šä¹‰çš„æ“ä½œæ˜¯åŸºäºå·²å­˜åœ¨çš„æ ‡ç­¾è¿›è¡Œçš„ã€‚å¦‚æœä¸€ä¸ªæŒ‡æ ‡ä¸åŒ…å«è¿™ä¸ªç‰¹å®šçš„æ ‡ç­¾ï¼Œé‚£ä¹ˆç›¸å…³çš„ metric_relabel_configs é…ç½®å°±ä¸ä¼šå¯¹å®ƒäº§ç”Ÿä»»ä½•å½±å“ã€‚</p></div><ul><li>Prometheusé…ç½®</li></ul><p><a href="https://prometheus.io/docs/prometheus/2.55/configuration/configuration/#relabel_config" target="_blank" rel="noreferrer">https://prometheus.io/docs/prometheus/2.55/configuration/configuration/#relabel_config</a></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">global</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#B392F0;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">rule_files</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#B392F0;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">scrape_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">sample_job_1</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">kubernetes_sd_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">relabel_configs</span><span style="color:#E1E4E8;">:           </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">       </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">metric_relabel_configs</span><span style="color:#E1E4E8;">:    </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">sample_job_2</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">static_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">targets</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">metric_relabel_configs</span><span style="color:#E1E4E8;">:    </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">alerting</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">alert_relabel_configs</span><span style="color:#E1E4E8;">:       </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#E1E4E8;">    [ - </span><span style="color:#9ECBFF;">&lt;relabel_config&gt; ...</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">alertmanagers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    [ - </span><span style="color:#9ECBFF;">&lt;alertmanager_config&gt; ...</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">remote_write</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">- </span><span style="color:#85E89D;">url</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">write_relabel_configs</span><span style="color:#E1E4E8;">:       </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">...</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">global</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#6F42C1;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">rule_files</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#6F42C1;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">scrape_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">sample_job_1</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">kubernetes_sd_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">relabel_configs</span><span style="color:#24292E;">:           </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">       </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">metric_relabel_configs</span><span style="color:#24292E;">:    </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">sample_job_2</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">static_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">targets</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">metric_relabel_configs</span><span style="color:#24292E;">:    </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#005CC5;">...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">alerting</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">alert_relabel_configs</span><span style="color:#24292E;">:       </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#24292E;">    [ - </span><span style="color:#032F62;">&lt;relabel_config&gt; ...</span><span style="color:#24292E;"> ]</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">alertmanagers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    [ - </span><span style="color:#032F62;">&lt;alertmanager_config&gt; ...</span><span style="color:#24292E;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">remote_write</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">- </span><span style="color:#22863A;">url</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">write_relabel_configs</span><span style="color:#24292E;">:       </span><span style="color:#6A737D;"># &lt;-</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#005CC5;">...</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">...</span></span></code></pre></div><h2 id="_1-6-relabelingè§„åˆ™" tabindex="-1">1.6 relabelingè§„åˆ™ <a class="header-anchor" href="#_1-6-relabelingè§„åˆ™" aria-label="Permalink to &quot;1.6 relabelingè§„åˆ™&quot;">â€‹</a></h2><p>å¸¸ç”¨çš„åœ¨ä»¥ä¸‹ä¸¤ä¸ªé˜¶æ®µå¯ä»¥é‡æ–°æ ‡è®°ï¼š</p><p><code>relabel_configs</code>ï¼šåœ¨é‡‡é›†ä¹‹å‰ï¼ˆæ¯”å¦‚åœ¨é‡‡é›†æ•°æ®ä¹‹å‰é‡æ–°å®šä¹‰å…ƒæ ‡ç­¾ï¼‰ï¼Œå¯ä»¥ä½¿ç”¨relabel_configsæ·»åŠ ä¸€äº›æ ‡ç­¾ã€ä¹Ÿå¯ä»¥åªé‡‡é›†ç‰¹å®šç›®æ ‡æˆ–è¿‡æ»¤ç›®æ ‡</p><p><code>metric_relabel_configs</code>ï¼šå¦‚æœæ˜¯å·²ç»æŠ“å–åˆ°æŒ‡æ ‡æ•°æ®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨metric_relabel_configsåšæœ€åçš„é‡æ–°æ ‡è®°å’Œè¿‡æ»¤</p><h3 id="_1-åœ¨çº¿åˆ†æ" tabindex="-1">1.åœ¨çº¿åˆ†æ <a class="header-anchor" href="#_1-åœ¨çº¿åˆ†æ" aria-label="Permalink to &quot;1.åœ¨çº¿åˆ†æ&quot;">â€‹</a></h3><p>Prom Labs çš„<a href="https://relabeler.promlabs.com/" target="_blank" rel="noreferrer">Relabeler</a>å·¥å…·åœ¨è°ƒè¯•relabelingé…ç½®æ—¶å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©,å®ƒå¯ä»¥è®©ä½ ç›´è§‚åœ°ç¡®è®¤relabelé…ç½®å®æ–½çš„è§„åˆ™</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202412261410017.png" alt="image-20241226141032849"></p><h3 id="_2-è¯­æ³•" tabindex="-1">2.è¯­æ³• <a class="header-anchor" href="#_2-è¯­æ³•" aria-label="Permalink to &quot;2.è¯­æ³•&quot;">â€‹</a></h3><p>é™¤äº†é…ç½®çš„æ¯ä¸ªç›®æ ‡æ ‡ç­¾ä¹‹å¤–ï¼Œprometheusè¿˜ä¼šè‡ªåŠ¨æ·»åŠ å‡ ä¸ªæ ‡ç­¾ï¼š</p><ul><li>é»˜è®¤matedata</li></ul><p><strong>jobæ ‡ç­¾ï¼šè®¾ç½®ä¸ºjob_nameç›¸åº”çš„æŠ“å–é…ç½®çš„å€¼ã€‚</strong></p><p><strong>instanceæ ‡ç­¾ï¼š__address__è®¾ç½®ä¸ºç›®æ ‡çš„åœ°å€<code>&lt;host&gt;:&lt;port&gt;</code>ã€‚é‡æ–°æ ‡è®°åï¼Œå¦‚æœåœ¨é‡æ–°æ ‡è®°æœŸé—´æœªè®¾ç½®æ ‡ç­¾ï¼Œåˆ™é»˜è®¤å°†__address__æ ‡ç­¾å€¼èµ‹å€¼ç»™instanceã€‚</strong></p><p><strong><strong>schema</strong>ï¼šåè®®ç±»å‹</strong></p><p><strong>__metrics_pathï¼šæŠ“å–æŒ‡æ ‡æ•°çš„url</strong></p><p><strong><strong>scrape_interval</strong>ï¼šscrapeæŠ“å–æ•°æ®æ—¶é—´é—´éš”ï¼ˆç§’ï¼‰</strong></p><p><strong><strong>scrape_timeout</strong>ï¼šscrapeè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰</strong></p><ul><li>consulçš„metedata</li></ul><p>å¦‚æœä»€ä¹ˆä¹Ÿä¸æ·»åŠ ï¼Œé»˜è®¤åªæ˜¾ç¤º job åŠ instance ä¸¤ä¸ªæ ‡ç­¾ï¼Œå…¶ä»–æ ‡ç­¾éƒ½é»˜è®¤å±äº <code>before relabeling</code> ä¸‹</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#æºæ ‡ç­¾ï¼Œéœ€è¦åœ¨ç°æœ‰æ ‡ç­¾ä¸­å·²å­˜åœ¨</span></span>
<span class="line"><span style="color:#E1E4E8;">[ </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;[&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;labelname&gt;</span><span style="color:#E1E4E8;"> [, </span><span style="color:#79B8FF;">...</span><span style="color:#E1E4E8;">] </span><span style="color:#9ECBFF;">&#39;]&#39;</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># å¤šä¸ªæºæ ‡ç­¾çš„åˆ†éš”ç¬¦;</span></span>
<span class="line"><span style="color:#E1E4E8;">[ </span><span style="color:#85E89D;">separator</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&lt;string&gt; | default = ;</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># è¦æ›¿æ¢çš„ç›®æ ‡æ ‡ç­¾;</span></span>
<span class="line"><span style="color:#E1E4E8;">[ </span><span style="color:#85E89D;">target_label</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&lt;labelname&gt;</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…æºæ ‡ç­¾çš„å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">[ </span><span style="color:#85E89D;">regex</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&lt;regex&gt; | default = (.*)</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æºæ ‡ç­¾å€¼å–hashçš„æ¨¡å—;</span></span>
<span class="line"><span style="color:#E1E4E8;">[ </span><span style="color:#85E89D;">modulus</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&lt;uint64&gt;</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># å½“æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ—¶ï¼Œç”¨äºæ›¿æ¢çš„å€¼ï¼Œ$1ä»£æ›¿æ­£åˆ™åŒ¹é…åˆ°çš„å€¼ï¼›</span></span>
<span class="line"><span style="color:#E1E4E8;">[ </span><span style="color:#85E89D;">replacement</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&lt;string&gt; | default = $1</span><span style="color:#E1E4E8;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># åŸºäºæ­£åˆ™åŒ¹é…çš„åŠ¨ä½œ</span></span>
<span class="line"><span style="color:#E1E4E8;">[ </span><span style="color:#85E89D;">action</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&lt;relabel_action&gt; | default = replace</span><span style="color:#E1E4E8;"> ]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#æºæ ‡ç­¾ï¼Œéœ€è¦åœ¨ç°æœ‰æ ‡ç­¾ä¸­å·²å­˜åœ¨</span></span>
<span class="line"><span style="color:#24292E;">[ </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;[&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;labelname&gt;</span><span style="color:#24292E;"> [, </span><span style="color:#005CC5;">...</span><span style="color:#24292E;">] </span><span style="color:#032F62;">&#39;]&#39;</span><span style="color:#24292E;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># å¤šä¸ªæºæ ‡ç­¾çš„åˆ†éš”ç¬¦;</span></span>
<span class="line"><span style="color:#24292E;">[ </span><span style="color:#22863A;">separator</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&lt;string&gt; | default = ;</span><span style="color:#24292E;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># è¦æ›¿æ¢çš„ç›®æ ‡æ ‡ç­¾;</span></span>
<span class="line"><span style="color:#24292E;">[ </span><span style="color:#22863A;">target_label</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&lt;labelname&gt;</span><span style="color:#24292E;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…æºæ ‡ç­¾çš„å€¼</span></span>
<span class="line"><span style="color:#24292E;">[ </span><span style="color:#22863A;">regex</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&lt;regex&gt; | default = (.*)</span><span style="color:#24292E;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æºæ ‡ç­¾å€¼å–hashçš„æ¨¡å—;</span></span>
<span class="line"><span style="color:#24292E;">[ </span><span style="color:#22863A;">modulus</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&lt;uint64&gt;</span><span style="color:#24292E;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># å½“æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ—¶ï¼Œç”¨äºæ›¿æ¢çš„å€¼ï¼Œ$1ä»£æ›¿æ­£åˆ™åŒ¹é…åˆ°çš„å€¼ï¼›</span></span>
<span class="line"><span style="color:#24292E;">[ </span><span style="color:#22863A;">replacement</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&lt;string&gt; | default = $1</span><span style="color:#24292E;"> ]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># åŸºäºæ­£åˆ™åŒ¹é…çš„åŠ¨ä½œ</span></span>
<span class="line"><span style="color:#24292E;">[ </span><span style="color:#22863A;">action</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&lt;relabel_action&gt; | default = replace</span><span style="color:#24292E;"> ]</span></span></code></pre></div><p>Relabeling è§„åˆ™ä¸»è¦ç”±ä»¥ä¸‹çš„ä¸€äº›é…ç½®å±æ€§ç»„æˆ:</p><table><thead><tr><th style="text-align:left;">å‚æ•°</th><th style="text-align:left;">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left;">action</td><td style="text-align:left;">æ‰§è¡Œçš„relabelingåŠ¨ä½œï¼Œå¯é€‰å€¼åŒ…æ‹¬ <code>replace</code>ã€<code>keep</code>ã€<code>drop</code>ã€<code>hashmod</code>ã€<code>labelmap</code>ã€<code>labeldrop</code> ã€<code>labelkeep</code>ï¼Œé»˜è®¤å€¼ä¸º<code>replace</code></td></tr><tr><td style="text-align:left;">separator</td><td style="text-align:left;">åˆ†éš”ç¬¦ï¼Œä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œåˆå¹¶å¤šä¸ª source_labels çš„å€¼æ—¶ä½¿ç”¨çš„åˆ†éš”ç¬¦ï¼Œé»˜è®¤ä¸º<code>;</code></td></tr><tr><td style="text-align:left;">source_labels</td><td style="text-align:left;">æºæ ‡ç­¾ï¼Œä½¿ç”¨é…ç½®çš„åˆ†éš”ç¬¦ä¸²è”çš„æ ‡ç­¾åç§°åˆ—è¡¨ï¼Œå¹¶ä¸æä¾›çš„æ­£åˆ™è¡¨è¾¾å¼è¿›è¡ŒåŒ¹é…</td></tr><tr><td style="text-align:left;">target_label</td><td style="text-align:left;">æŒ‡å®šè¦ä¿®æ”¹æˆ–æ–°åˆ›å»ºçš„ç›®æ ‡æ ‡ç­¾çš„åç§°ï¼Œå½“ä½¿ç”¨<code>replace</code>æˆ–è€…<code>hashmod</code>åŠ¨ä½œæ—¶ï¼Œåº”è¯¥è¢«è¦†ç›–çš„æ ‡ç­¾å</td></tr><tr><td style="text-align:left;"><a href="https://regexr.com/" target="_blank" rel="noreferrer">regex</a></td><td style="text-align:left;">å®šä¹‰ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œç”¨äºåŒ¹é…å’Œç­›é€‰ source_labels çš„å€¼ï¼Œé»˜è®¤ä¸º<code>(.*)</code></td></tr><tr><td style="text-align:left;">modulus</td><td style="text-align:left;">æ¨¡æ•°ï¼Œä¸²è”çš„æºæ ‡ç­¾å“ˆå¸Œå€¼çš„æ¨¡ï¼Œä¸»è¦ç”¨äºPrometheusæ°´å¹³åˆ†ç‰‡</td></tr><tr><td style="text-align:left;">replacement</td><td style="text-align:left;">å†™åœ¨ç›®æ ‡æ ‡ç­¾ä¸Šï¼Œå®ƒå¯ä»¥å‚è€ƒç”± regex æ•è·çš„æ­£åˆ™è¡¨è¾¾å¼æ•è·ç»„ï¼Œé»˜è®¤å€¼ä¸º<code>$1</code></td></tr></tbody></table><p>å…³äºrelabel_configçš„actionç±»å‹è¯´æ˜ï¼š</p><table><thead><tr><th style="text-align:left;">å‚æ•°</th><th style="text-align:left;">è§£é‡Š</th></tr></thead><tbody><tr><td style="text-align:left;">replace</td><td style="text-align:left;">è®¾ç½®æˆ–æ›¿æ¢/è¦†ç›–æ ‡ç­¾å€¼ï¼Œæ˜¯é»˜è®¤çš„action</td></tr><tr><td style="text-align:left;">keep</td><td style="text-align:left;">æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„targetè¿›è¡Œé‡‡é›†ï¼Œå…¶ä»–çš„ä¸é‡‡é›†</td></tr><tr><td style="text-align:left;">drop</td><td style="text-align:left;">æ»¡è¶³ç‰¹å®šæ¡ä»¶çš„targetä¸é‡‡é›†ï¼Œå…¶ä»–çš„é‡‡é›†</td></tr><tr><td style="text-align:left;">labeldrop</td><td style="text-align:left;">åŒ¹é…regexæ‰€æœ‰æ ‡ç­¾åç§°ï¼Œå¯¹åŒ¹é…åˆ°çš„å®ä¾‹æ ‡ç­¾è¿›è¡Œåˆ é™¤</td></tr><tr><td style="text-align:left;">labelkeep</td><td style="text-align:left;">åŒ¹é…regexæ‰€æœ‰æ ‡ç­¾åç§°ï¼Œå¯¹åŒ¹é…åˆ°çš„å®ä¾‹æ ‡ç­¾è¿›è¡Œä¿ç•™</td></tr><tr><td style="text-align:left;">labelmap</td><td style="text-align:left;">æ­£åˆ™åŒ¹é…æ‰€æœ‰æ ‡ç­¾åï¼Œå°†åŒ¹é…çš„æ ‡ç­¾å€¼éƒ¨åˆ†åšä¸ºæ–°æ ‡ç­¾åï¼ŒåŸæ ‡ç­¾å€¼ åšä¸ºæ–°æ ‡ç­¾çš„å€¼</td></tr><tr><td style="text-align:left;">hashmod</td><td style="text-align:left;"><strong>ä½¿ç”¨hashmodè®¡ç®—source_labelsçš„hashå€¼å¹¶è¿›è¡Œå¯¹æ¯”ï¼ŒåŸºäºè‡ªå®šä¹‰çš„æ¨¡æ•°å–æ¨¡ï¼Œä»¥å®ç°å¯¹ç›®æ ‡è¿›è¡Œåˆ†ç±»ã€é‡æ–°èµ‹å€¼ç­‰åŠŸèƒ½</strong></td></tr><tr><td style="text-align:left;">lowercase</td><td style="text-align:left;">å°†è¿æ¥çš„ source_labels æ˜ å°„åˆ°å®ƒä»¬çš„å°å†™å½¢å¼</td></tr><tr><td style="text-align:left;">uppercase</td><td style="text-align:left;">å°†è¿æ¥çš„ source_labels æ˜ å°„åˆ°å®ƒä»¬çš„å¤§å†™å½¢å¼</td></tr></tbody></table><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>é‡å®šä¹‰æ ‡ç­¾å¹¶åº”ç”¨åï¼Œ__å¼€å¤´çš„æ ‡ç­¾ä¼šè¢«åˆ é™¤; è¦ä¸´æ—¶å­˜å‚¨å€¼ç”¨äºä¸‹ä¸€é˜¶æ®µçš„å¤„ç†,ä½¿ç”¨__tmpå¼€å¤´çš„æ ‡ç­¾å,è¿™ç§æ ‡ç­¾ä¸ä¼šè¢«Prometheusä½¿ç”¨;</p></div><h4 id="relabel-configs-ä½¿ç”¨ç¤ºä¾‹" tabindex="-1">relabel_configs ä½¿ç”¨ç¤ºä¾‹ <a class="header-anchor" href="#relabel-configs-ä½¿ç”¨ç¤ºä¾‹" aria-label="Permalink to &quot;relabel_configs ä½¿ç”¨ç¤ºä¾‹&quot;">â€‹</a></h4><p>1.æ·»åŠ æœºå™¨</p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">myjob</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">honor_timestamps</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">static_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">targets</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;10.103.236.199:9100&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_hostname__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_idc__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;idc-01&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">myjob</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">honor_timestamps</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">static_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">targets</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;10.103.236.199:9100&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_hostname__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_idc__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;idc-01&#39;</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502141529410.png" alt="image-20250214152823836"></p><h4 id="replaceæ›¿æ¢" tabindex="-1">replaceæ›¿æ¢ <a class="header-anchor" href="#replaceæ›¿æ¢" aria-label="Permalink to &quot;replaceæ›¿æ¢&quot;">â€‹</a></h4><p>å°†__machine_hostname__çš„å€¼æ›¿æ¢åˆ°æ–°æ ‡ç­¾hostname</p><p>æµç¨‹å›¾</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502141722358.png" alt="image-20250214172237438"></p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">myjob</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">honor_timestamps</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">static_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">targets</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;10.103.236.199:9100&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_hostname__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_idc__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;idc-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">relabel_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">__machine_hostname__</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">regex</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;(.*)&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">action</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">replace</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">replacement</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;$1&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">target_label</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;hostname&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">myjob</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">honor_timestamps</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">static_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">targets</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;10.103.236.199:9100&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_hostname__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_idc__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;idc-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">relabel_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">__machine_hostname__</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">regex</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;(.*)&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">action</span><span style="color:#24292E;">: </span><span style="color:#032F62;">replace</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">replacement</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;$1&#39;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">target_label</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;hostname&quot;</span></span></code></pre></div><blockquote><p>source_labels é€‰æ‹©äº†éœ€è¦çš„æå–å†…å®¹çš„æºæ ‡ç­¾ï¼Œç„¶åä¼šç”¨ separator å°†å…¶æ ‡ç­¾å€¼ä¸²è¡Œæ‹¼æ¥èµ·æ¥ï¼Œå› ä¸ºæ²¡æœ‰å®šä¹‰ separatorï¼Œè¿™é‡Œæ˜¯é»˜è®¤çš„ ; ç¬¦å·</p><p>ç»è¿‡æ­£åˆ™åŒ¹é…åï¼Œreplacement è§„å®šäº† $1çš„ç»“æœï¼Œå…¶ä¸­ $1 æ­£åˆ™åŒ¹é…ç»“æœçš„ç¬¬ä¸€ç»„ï¼Œå¹¶æŠŠè¿™ä¸ªç»“æœèµ‹å€¼ç»™ hostnameè¿™ä¸ªæ ‡ç­¾</p></blockquote><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502141551721.png" alt="image-20250214155132145"></p><h4 id="keepç¤ºä¾‹" tabindex="-1">keepç¤ºä¾‹ <a class="header-anchor" href="#keepç¤ºä¾‹" aria-label="Permalink to &quot;keepç¤ºä¾‹&quot;">â€‹</a></h4><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">relabel_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">__machine_hostname__</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">regex</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;(.*)-01&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">target_label</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;hostname&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">action</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">keep</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">replacement</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;$1&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">relabel_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">__machine_hostname__</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">regex</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;(.*)-01&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">target_label</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;hostname&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">action</span><span style="color:#24292E;">: </span><span style="color:#032F62;">keep</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">replacement</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;$1&#39;</span></span></code></pre></div><h4 id="labelmapä½¿ç”¨ç¤ºä¾‹" tabindex="-1">labelmapä½¿ç”¨ç¤ºä¾‹ <a class="header-anchor" href="#labelmapä½¿ç”¨ç¤ºä¾‹" aria-label="Permalink to &quot;labelmapä½¿ç”¨ç¤ºä¾‹&quot;">â€‹</a></h4><p>é‡å†™æ–°çš„æ ‡ç­¾hostnameå’Œidcï¼Œä½¿ç”¨åŸæœ‰__machine_hostname__å’Œ__machine_idc__æ ‡ç­¾çš„å€¼,æ¢å¥è¯è¯´ï¼Œå°† __<em>machine_hostname</em> ä¸ºå‰ç¼€çš„æ ‡ç­¾ï¼Œå»é™¤å‰ç¼€åï¼Œå°†é”®å€¼å¯¹ä½œä¸ºæœ€ç»ˆæ ‡ç­¾</p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">myjob</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">honor_timestamps</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">static_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">targets</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;10.103.236.199:9100&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_hostname__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_idc__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;idc-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">relabel_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">action</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">labelmap</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">regex</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">__machine_(.*)_</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">myjob</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">honor_timestamps</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">static_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">targets</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;10.103.236.199:9100&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_hostname__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_idc__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;idc-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">relabel_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">action</span><span style="color:#24292E;">: </span><span style="color:#032F62;">labelmap</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">regex</span><span style="color:#24292E;">: </span><span style="color:#032F62;">__machine_(.*)_</span></span></code></pre></div><blockquote><p>è¿™é‡Œä¸å†ä¾èµ– source_labelsï¼Œå› ä¸ºåœ¨ labelmap é‡Œï¼Œregex æ˜¯å¯¹æ‰€æœ‰__machine_å¼€å¤´çš„æ ‡ç­¾åŒ¹é…çš„</p></blockquote><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502141602935.png" alt="image-20250214160207203"></p><h4 id="uppercaseç¤ºä¾‹" tabindex="-1">uppercaseç¤ºä¾‹ <a class="header-anchor" href="#uppercaseç¤ºä¾‹" aria-label="Permalink to &quot;uppercaseç¤ºä¾‹&quot;">â€‹</a></h4><p>uppercase çš„æ“ä½œæ›´åŠ çš„ç®€å•ï¼Œä¸éœ€è¦æ­£åˆ™å¤„ç†ï¼Œç›´æ¥å°†æºæ ‡ç­¾å€¼è½¬å˜ä¸ºå¤§å†™</p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">myjob</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">honor_timestamps</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">static_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">targets</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;10.103.236.199:9100&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_hostname__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_idc__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;idc-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">relabel_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">action</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">uppercase</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">__machine_idc__</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">target_label</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">idc</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">myjob</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">honor_timestamps</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">static_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">targets</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;10.103.236.199:9100&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_hostname__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_idc__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;idc-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">relabel_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">action</span><span style="color:#24292E;">: </span><span style="color:#032F62;">uppercase</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">__machine_idc__</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">target_label</span><span style="color:#24292E;">: </span><span style="color:#032F62;">idc</span></span></code></pre></div><blockquote><p>è¿™ä¸ª action ä¸ä½¿ç”¨æ­£åˆ™ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥ regex å’Œ replacementï¼Œæ“ä½œè¿‡ç¨‹ä¹Ÿæ›´åŠ ç®€å• å°±æ˜¯æŠŠ source_labels æŒ‡å®šçš„æ ‡ç­¾éƒ½è½¬åŒ–ä¸ºå¤§å†™å­—æ¯ï¼Œèµ‹å€¼ç»™ env_dc æ ‡ç­¾</p></blockquote><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502141704739.png" alt="image-20250214170414313"></p><h4 id="lowercaseç¤ºä¾‹" tabindex="-1">lowercaseç¤ºä¾‹ <a class="header-anchor" href="#lowercaseç¤ºä¾‹" aria-label="Permalink to &quot;lowercaseç¤ºä¾‹&quot;">â€‹</a></h4><p>æ°å¥½ä¸uppercaseæ“ä½œç›¸åï¼ŒåŒæ—¶ä¹Ÿä¸éœ€è¦æ­£åˆ™å¤„ç†ï¼Œç›´æ¥å°†æºæ ‡ç­¾å€¼è½¬å˜ä¸ºå°å†™</p><div class="language-yml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">myjob</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">honor_timestamps</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">static_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">targets</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;10.103.236.199:9100&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_hostname__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">__machine_idc__</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;IDC-01&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">relabel_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">action</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">uppercase</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">source_labels</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">__machine_idc__</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">target_label</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">idc</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">myjob</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">honor_timestamps</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">static_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">targets</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;10.103.236.199:9100&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_hostname__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;node-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">__machine_idc__</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;IDC-01&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">relabel_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">action</span><span style="color:#24292E;">: </span><span style="color:#032F62;">uppercase</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">source_labels</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">__machine_idc__</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">target_label</span><span style="color:#24292E;">: </span><span style="color:#032F62;">idc</span></span></code></pre></div><blockquote><p>è¿™ä¸ª action ä¸ä½¿ç”¨æ­£åˆ™ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥ regex å’Œ replacementï¼Œæ“ä½œè¿‡ç¨‹ä¹Ÿæ›´åŠ ç®€å• å°±æ˜¯æŠŠ source_labels æŒ‡å®šçš„æ ‡ç­¾çš„å€¼éƒ½è½¬åŒ–ä¸ºå°å†™å­—æ¯ï¼Œèµ‹å€¼ç»™ env_dc æ ‡ç­¾</p></blockquote>`,85),o=[e];function t(c,r,E,y,i,_){return a(),n("div",null,o)}const b=s(p,[["render",t]]);export{g as __pageData,b as default};
