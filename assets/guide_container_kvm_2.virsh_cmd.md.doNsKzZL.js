import{_ as s,o as a,c as e,R as n}from"./chunks/framework.zUbWieqp.js";const h=JSON.parse('{"title":"1.磁盘扩容","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/kvm/2.virsh_cmd.md","filePath":"guide/container/kvm/2.virsh_cmd.md","lastUpdated":1714030813000}'),l={name:"guide/container/kvm/2.virsh_cmd.md"},p=n(`<h1 id="_1-磁盘扩容" tabindex="-1">1.磁盘扩容 <a class="header-anchor" href="#_1-磁盘扩容" aria-label="Permalink to &quot;1.磁盘扩容&quot;">​</a></h1><h2 id="_1-1镜像扩容" tabindex="-1">1.1镜像扩容 <a class="header-anchor" href="#_1-1镜像扩容" aria-label="Permalink to &quot;1.1镜像扩容&quot;">​</a></h2><p>注意：需要先关闭虚拟机才能操作，<code>+</code>号前面有空格，后面没有空格</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">qemu-img resize k8s1.qcow2 +40G</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">qemu-img resize k8s1.qcow2 +40G</span></span></code></pre></div><ul><li>查看磁盘信息</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">root@shenghuang:/data/kvmimgs# qemu-img  info k8s1.qcow2 </span></span>
<span class="line"><span style="color:#e1e4e8;">image: k8s1.qcow2</span></span>
<span class="line"><span style="color:#e1e4e8;">file format: qcow2</span></span>
<span class="line"><span style="color:#e1e4e8;">virtual size: 40 GiB (42949672960 bytes)</span></span>
<span class="line"><span style="color:#e1e4e8;">disk size: 6.08 GiB</span></span>
<span class="line"><span style="color:#e1e4e8;">cluster_size: 65536</span></span>
<span class="line"><span style="color:#e1e4e8;">Format specific information:</span></span>
<span class="line"><span style="color:#e1e4e8;">    compat: 1.1</span></span>
<span class="line"><span style="color:#e1e4e8;">    lazy refcounts: false</span></span>
<span class="line"><span style="color:#e1e4e8;">    refcount bits: 16</span></span>
<span class="line"><span style="color:#e1e4e8;">    corrupt: false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">root@shenghuang:/data/kvmimgs# qemu-img  info k8s1.qcow2 </span></span>
<span class="line"><span style="color:#24292e;">image: k8s1.qcow2</span></span>
<span class="line"><span style="color:#24292e;">file format: qcow2</span></span>
<span class="line"><span style="color:#24292e;">virtual size: 40 GiB (42949672960 bytes)</span></span>
<span class="line"><span style="color:#24292e;">disk size: 6.08 GiB</span></span>
<span class="line"><span style="color:#24292e;">cluster_size: 65536</span></span>
<span class="line"><span style="color:#24292e;">Format specific information:</span></span>
<span class="line"><span style="color:#24292e;">    compat: 1.1</span></span>
<span class="line"><span style="color:#24292e;">    lazy refcounts: false</span></span>
<span class="line"><span style="color:#24292e;">    refcount bits: 16</span></span>
<span class="line"><span style="color:#24292e;">    corrupt: false</span></span></code></pre></div><h3 id="linux磁盘扩容" tabindex="-1">Linux磁盘扩容 <a class="header-anchor" href="#linux磁盘扩容" aria-label="Permalink to &quot;Linux磁盘扩容&quot;">​</a></h3><p>启动虚拟机后，进入虚拟机控制台，使用<code>fdisk -l</code>命令查看磁盘信息</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/image-20220309093747710.png" alt=""></p><p>可以看到这台虚拟机的磁盘大小已经有40GB了，但分区大小还是没有变化，只有初始大小20GB</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#重新读取分区表</span></span>
<span class="line"><span style="color:#e1e4e8;">[root@k8s-master02 ~]# partprobe </span></span>
<span class="line"><span style="color:#e1e4e8;">[root@k8s-master02 ~]# ls /dev/vda*</span></span>
<span class="line"><span style="color:#e1e4e8;">/dev/vda  /dev/vda1  /dev/vda2  /dev/vda3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#重新读取分区表</span></span>
<span class="line"><span style="color:#24292e;">[root@k8s-master02 ~]# partprobe </span></span>
<span class="line"><span style="color:#24292e;">[root@k8s-master02 ~]# ls /dev/vda*</span></span>
<span class="line"><span style="color:#24292e;">/dev/vda  /dev/vda1  /dev/vda2  /dev/vda3</span></span></code></pre></div><ul><li>创建pv</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@k8s-master02 ~]# pvcreate /dev/vda3</span></span>
<span class="line"><span style="color:#e1e4e8;">  Physical volume &quot;/dev/vda3&quot; successfully created.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@k8s-master02 ~]# pvcreate /dev/vda3</span></span>
<span class="line"><span style="color:#24292e;">  Physical volume &quot;/dev/vda3&quot; successfully created.</span></span></code></pre></div><ul><li>创建vg</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#查看vg名字</span></span>
<span class="line"><span style="color:#e1e4e8;">[root@k8s-master02 ~]# vgdisplay</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#查看vg名字</span></span>
<span class="line"><span style="color:#24292e;">[root@k8s-master02 ~]# vgdisplay</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/image-20220309094901828.png" alt=""></p><ul><li>扩容vg</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@k8s-master02 ~]# vgextend  cl /dev/vda3</span></span>
<span class="line"><span style="color:#e1e4e8;">  Volume group &quot;cl&quot; successfully extended</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@k8s-master02 ~]# vgextend  cl /dev/vda3</span></span>
<span class="line"><span style="color:#24292e;">  Volume group &quot;cl&quot; successfully extended</span></span></code></pre></div><ul><li>扩容</li></ul><p>可以看出<code>/dev/mapper/cl-root</code> 挂载到了根目录，正是我们需要扩容的磁盘。使用以下命令进行扩容</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">df -h</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">df -h</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/image-20220309100147330.png" alt=""></p><p>根据文件信息可以看出<code>/dev/mapper/cl-root</code> 的类型是 <code>xfs</code>，<code>xfs</code>类型的磁盘使用命令</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">xfs_growfs /dev/mapper/cl-root</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">xfs_growfs /dev/mapper/cl-root</span></span></code></pre></div><p>其他类型使用</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">resize2fs /dev/mapper/cl-root</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">resize2fs /dev/mapper/cl-root</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/image-20220309100340098.png" alt=""></p><h3 id="windows磁盘扩容" tabindex="-1">Windows磁盘扩容 <a class="header-anchor" href="#windows磁盘扩容" aria-label="Permalink to &quot;Windows磁盘扩容&quot;">​</a></h3><p>Windows磁盘扩容比较方便，进入 <strong>计算机管理&gt;磁盘管理</strong> 找到新增的分区把它添加到需要的分区即可</p>`,29),o=[p];function c(t,i,r,d,u,g){return a(),e("div",null,o)}const m=s(l,[["render",c]]);export{h as __pageData,m as default};
