import{_ as s,o as n,c as a,R as p}from"./chunks/framework.zUbWieqp.js";const u=JSON.parse('{"title":"1. Anyconnect介绍","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/vpn/24_ocserv.md","filePath":"guide/Linux/vpn/24_ocserv.md","lastUpdated":1743777336000}'),l={name:"guide/Linux/vpn/24_ocserv.md"},o=p(`<h1 id="_1-anyconnect介绍" tabindex="-1">1. Anyconnect介绍 <a class="header-anchor" href="#_1-anyconnect介绍" aria-label="Permalink to &quot;1. Anyconnect介绍&quot;">​</a></h1><p>ocserv(OpenConnect Server) 是一个用于虚拟私人网络（VPN）连接的开源客户端软件。它最初是为了连接到 Cisco AnyConnect VPN 服务器而开发的，但现在已经发展成为一个支持多种 VPN 协议的通用客户端，包括 Windows、macOS、Linux 和 Android。</p><p>OpenConnect 的优点之一是它的灵活性。它可以通过命令行或图形用户界面进行配置，并且可以与各种 VPN 服务器兼容，包括 Cisco AnyConnect、Juniper SSL VPN 和 Palo Alto Networks GlobalProtect 等。</p><h2 id="_1-安装" tabindex="-1">1.安装 <a class="header-anchor" href="#_1-安装" aria-label="Permalink to &quot;1.安装&quot;">​</a></h2><p>官方文档，<a href="http://ocserv.gitlab.io/www/manual.html" target="_blank" rel="noreferrer">http://ocserv.gitlab.io/www/manual.html</a></p><p><a href="http://ocserv.gitlab.io/www/index.html" target="_blank" rel="noreferrer">http://ocserv.gitlab.io/www/index.html</a></p><p><a href="http://ocserv.gitlab.io/www/download.html" target="_blank" rel="noreferrer">http://ocserv.gitlab.io/www/download.html</a></p><p><a href="https://gitlab.com/openconnect/ocserv" target="_blank" rel="noreferrer">https://gitlab.com/openconnect/ocserv</a></p><p>客户端下载地址：</p><p><a href="https://software.cisco.com/download/home/286281283/type/282364313/release/4.10.08029" target="_blank" rel="noreferrer">https://software.cisco.com/download/home/286281283/type/282364313/release/4.10.08029</a></p><h3 id="anyconnect特点" tabindex="-1">Anyconnect特点 <a class="header-anchor" href="#anyconnect特点" aria-label="Permalink to &quot;Anyconnect特点&quot;">​</a></h3><ul><li>AnyConnect的VPN协议默认使用UDP作为数据传输，但如果有什么网络问题导致UDP传输出现问题，它会利用最初建立的TCP TLS通道作为备份通道，降低VPN断开的概率。</li><li>AnyConnect作为Cisco新一代的VPN解决方案，被用于许多大型企业</li></ul><h3 id="检查ppp-tun环境" tabindex="-1">检查PPP/TUN环境 <a class="header-anchor" href="#检查ppp-tun环境" aria-label="Permalink to &quot;检查PPP/TUN环境&quot;">​</a></h3><p>首先要检查VPS的TUN是否开启(OpenVZ虚拟化的服务器很可能默认关闭)。</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">cat /dev/net/tun</span></span>
<span class="line"><span style="color:#e1e4e8;"># 返回的必须是：</span></span>
<span class="line"><span style="color:#e1e4e8;">cat: /dev/net/tun: File descriptor in bad state</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">cat /dev/net/tun</span></span>
<span class="line"><span style="color:#24292e;"># 返回的必须是：</span></span>
<span class="line"><span style="color:#24292e;">cat: /dev/net/tun: File descriptor in bad state</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#iptables</span></span>
<span class="line"><span style="color:#e1e4e8;">#自动调整MTU</span></span>
<span class="line"><span style="color:#e1e4e8;">iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#开启 NAT</span></span>
<span class="line"><span style="color:#e1e4e8;">iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">iptables -I INPUT -p tcp --dport 10028 -j ACCEPT # 端口应与ocserv配置中配置的端口对应</span></span>
<span class="line"><span style="color:#e1e4e8;">iptables -I INPUT -p udp --dport 10028 -j ACCEPT</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">---- test</span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --permanent --add-port=10028/tcp</span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --permanent --add-port=10028/udp</span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --permanent --add-masquerade</span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --reload</span></span>
<span class="line"><span style="color:#e1e4e8;">----</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#开启 IPv4 转发</span></span>
<span class="line"><span style="color:#e1e4e8;">sysctl -w net.ipv4.ip_forward=1</span></span>
<span class="line"><span style="color:#e1e4e8;"># 或修改配置文件</span></span>
<span class="line"><span style="color:#e1e4e8;">vi /etc/sysctl.conf</span></span>
<span class="line"><span style="color:#e1e4e8;">net.ipv4.ip_forward = 1</span></span>
<span class="line"><span style="color:#e1e4e8;">net.ipv4.conf.all.proxy_arp = 1</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">iptables-save &gt; /etc/iptables.rules</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --permanent --zone=public --add-port=2233/tcp</span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --permanent --zone=public --add-port=2233/udp</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --permanent --add-masquerade</span></span>
<span class="line"><span style="color:#e1e4e8;">firewall-cmd --permanent --direct --passthrough ipv4 -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#iptables</span></span>
<span class="line"><span style="color:#24292e;">#自动调整MTU</span></span>
<span class="line"><span style="color:#24292e;">iptables -I FORWARD -p tcp --tcp-flags SYN,RST SYN -j TCPMSS --clamp-mss-to-pmtu</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#开启 NAT</span></span>
<span class="line"><span style="color:#24292e;">iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">iptables -I INPUT -p tcp --dport 10028 -j ACCEPT # 端口应与ocserv配置中配置的端口对应</span></span>
<span class="line"><span style="color:#24292e;">iptables -I INPUT -p udp --dport 10028 -j ACCEPT</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">---- test</span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --permanent --add-port=10028/tcp</span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --permanent --add-port=10028/udp</span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --permanent --add-masquerade</span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --reload</span></span>
<span class="line"><span style="color:#24292e;">----</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#开启 IPv4 转发</span></span>
<span class="line"><span style="color:#24292e;">sysctl -w net.ipv4.ip_forward=1</span></span>
<span class="line"><span style="color:#24292e;"># 或修改配置文件</span></span>
<span class="line"><span style="color:#24292e;">vi /etc/sysctl.conf</span></span>
<span class="line"><span style="color:#24292e;">net.ipv4.ip_forward = 1</span></span>
<span class="line"><span style="color:#24292e;">net.ipv4.conf.all.proxy_arp = 1</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">iptables-save &gt; /etc/iptables.rules</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --permanent --zone=public --add-port=2233/tcp</span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --permanent --zone=public --add-port=2233/udp</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --permanent --add-masquerade</span></span>
<span class="line"><span style="color:#24292e;">firewall-cmd --permanent --direct --passthrough ipv4 -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span></span></code></pre></div><p>安装结束，访问<a href="https://xxx.com" target="_blank" rel="noreferrer">https://xxx.com</a></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202310201047832.jpg" alt=""></p><h3 id="连接" tabindex="-1">连接 <a class="header-anchor" href="#连接" aria-label="Permalink to &quot;连接&quot;">​</a></h3><h4 id="win" tabindex="-1">win： <a class="header-anchor" href="#win" aria-label="Permalink to &quot;win：&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#链接正常之后，服务端显示结果</span></span>
<span class="line"><span style="color:#e1e4e8;">11: vpns0: &lt;POINTOPOINT,UP,LOWER_UP&gt; mtu 1326 qdisc pfifo_fast state UNKNOWN group default qlen 500</span></span>
<span class="line"><span style="color:#e1e4e8;">    link/none </span></span>
<span class="line"><span style="color:#e1e4e8;">    inet 192.168.8.1 peer 192.168.8.242/32 scope global vpns0</span></span>
<span class="line"><span style="color:#e1e4e8;">       valid_lft forever preferred_lft forever</span></span>
<span class="line"><span style="color:#e1e4e8;">    inet6 fe80::b0ad:1e0f:6b17:e07d/64 scope link flags 800 </span></span>
<span class="line"><span style="color:#e1e4e8;">       valid_lft forever preferred_lft forever</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#链接正常之后，服务端显示结果</span></span>
<span class="line"><span style="color:#24292e;">11: vpns0: &lt;POINTOPOINT,UP,LOWER_UP&gt; mtu 1326 qdisc pfifo_fast state UNKNOWN group default qlen 500</span></span>
<span class="line"><span style="color:#24292e;">    link/none </span></span>
<span class="line"><span style="color:#24292e;">    inet 192.168.8.1 peer 192.168.8.242/32 scope global vpns0</span></span>
<span class="line"><span style="color:#24292e;">       valid_lft forever preferred_lft forever</span></span>
<span class="line"><span style="color:#24292e;">    inet6 fe80::b0ad:1e0f:6b17:e07d/64 scope link flags 800 </span></span>
<span class="line"><span style="color:#24292e;">       valid_lft forever preferred_lft forever</span></span></code></pre></div><h3 id="配置ocserv" tabindex="-1">配置ocserv <a class="header-anchor" href="#配置ocserv" aria-label="Permalink to &quot;配置ocserv&quot;">​</a></h3><p>Ocserv提供了多种认证登录方式.主要有:</p><ul><li>pam本地系统账户</li><li>ocsrev创建的明文账户(需要指定passwd密码文件.下面我指定的是/etc/ocserv/ocpasswd)</li><li>certificate证书认证</li><li>redius认证</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$grep -A 5 &quot;#auth&quot; /etc/ocserv/ocserv.conf</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;pam&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;pam[gid-min=1000]&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$grep -A 5 &quot;#auth&quot; /etc/ocserv/ocserv.conf</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;pam&quot;</span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;pam[gid-min=1000]&quot;</span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#24292e;">auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span></code></pre></div><h3 id="配置文件解析" tabindex="-1">配置文件解析 <a class="header-anchor" href="#配置文件解析" aria-label="Permalink to &quot;配置文件解析&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#认证方式,这里使用了certificate证书认证  </span></span>
<span class="line"><span style="color:#e1e4e8;">auth = &quot;certificate&quot;  </span></span>
<span class="line"><span style="color:#e1e4e8;">#最大客户端连接数    </span></span>
<span class="line"><span style="color:#e1e4e8;">max-clients = 50   </span></span>
<span class="line"><span style="color:#e1e4e8;">#同一客户端最大同时连接数    </span></span>
<span class="line"><span style="color:#e1e4e8;">max-same-clients = 10    </span></span>
<span class="line"><span style="color:#e1e4e8;">#优化VPN速度和稳定性 </span></span>
<span class="line"><span style="color:#e1e4e8;">try-mtu-discovery = true  </span></span>
<span class="line"><span style="color:#e1e4e8;">#服务端证书路径  </span></span>
<span class="line"><span style="color:#e1e4e8;">server-cert = /etc/ocserv/server-cert.pem  </span></span>
<span class="line"><span style="color:#e1e4e8;">#服务端key路径 </span></span>
<span class="line"><span style="color:#e1e4e8;">server-key = /etc/ocserv/server-key.pem  </span></span>
<span class="line"><span style="color:#e1e4e8;">#ca证书路径,如果是证书验证则需要开启这个参数,如果是密码认证,则注释掉  </span></span>
<span class="line"><span style="color:#e1e4e8;">ca-cert = /etc/ocserv/ca-cert.pem  </span></span>
<span class="line"><span style="color:#e1e4e8;"># 确保服务器正确读取用户证书（后面会用到用户证书） </span></span>
<span class="line"><span style="color:#e1e4e8;">cert-user-oid = 2.5.4.3  </span></span>
<span class="line"><span style="color:#e1e4e8;">#分发给VPN客户端的IP地址范围,DNS地址  </span></span>
<span class="line"><span style="color:#e1e4e8;">ipv4-network = 10.0.81.0  </span></span>
<span class="line"><span style="color:#e1e4e8;">ipv4-netmask = 255.255.255.0  </span></span>
<span class="line"><span style="color:#e1e4e8;">dns = 114.114.114.114  </span></span>
<span class="line"><span style="color:#e1e4e8;">#如果仅仅是访问以下内网地址则指定route参数,如果注释所有route参数则表示所有流量走VPN  </span></span>
<span class="line"><span style="color:#e1e4e8;">route = 10.0.0.0/255.255.255.0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#认证方式,这里使用了certificate证书认证  </span></span>
<span class="line"><span style="color:#24292e;">auth = &quot;certificate&quot;  </span></span>
<span class="line"><span style="color:#24292e;">#最大客户端连接数    </span></span>
<span class="line"><span style="color:#24292e;">max-clients = 50   </span></span>
<span class="line"><span style="color:#24292e;">#同一客户端最大同时连接数    </span></span>
<span class="line"><span style="color:#24292e;">max-same-clients = 10    </span></span>
<span class="line"><span style="color:#24292e;">#优化VPN速度和稳定性 </span></span>
<span class="line"><span style="color:#24292e;">try-mtu-discovery = true  </span></span>
<span class="line"><span style="color:#24292e;">#服务端证书路径  </span></span>
<span class="line"><span style="color:#24292e;">server-cert = /etc/ocserv/server-cert.pem  </span></span>
<span class="line"><span style="color:#24292e;">#服务端key路径 </span></span>
<span class="line"><span style="color:#24292e;">server-key = /etc/ocserv/server-key.pem  </span></span>
<span class="line"><span style="color:#24292e;">#ca证书路径,如果是证书验证则需要开启这个参数,如果是密码认证,则注释掉  </span></span>
<span class="line"><span style="color:#24292e;">ca-cert = /etc/ocserv/ca-cert.pem  </span></span>
<span class="line"><span style="color:#24292e;"># 确保服务器正确读取用户证书（后面会用到用户证书） </span></span>
<span class="line"><span style="color:#24292e;">cert-user-oid = 2.5.4.3  </span></span>
<span class="line"><span style="color:#24292e;">#分发给VPN客户端的IP地址范围,DNS地址  </span></span>
<span class="line"><span style="color:#24292e;">ipv4-network = 10.0.81.0  </span></span>
<span class="line"><span style="color:#24292e;">ipv4-netmask = 255.255.255.0  </span></span>
<span class="line"><span style="color:#24292e;">dns = 114.114.114.114  </span></span>
<span class="line"><span style="color:#24292e;">#如果仅仅是访问以下内网地址则指定route参数,如果注释所有route参数则表示所有流量走VPN  </span></span>
<span class="line"><span style="color:#24292e;">route = 10.0.0.0/255.255.255.0</span></span></code></pre></div><h3 id="优化" tabindex="-1">优化 <a class="header-anchor" href="#优化" aria-label="Permalink to &quot;优化&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">dpd = 900</span></span>
<span class="line"><span style="color:#e1e4e8;">mobile-dpd = 1800</span></span>
<span class="line"><span style="color:#e1e4e8;">output-buffer = 23000</span></span>
<span class="line"><span style="color:#e1e4e8;">idle-timeout = 3600</span></span>
<span class="line"><span style="color:#e1e4e8;">try-mtu-discovery = true</span></span>
<span class="line"><span style="color:#e1e4e8;">compression = true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">dpd = 900</span></span>
<span class="line"><span style="color:#24292e;">mobile-dpd = 1800</span></span>
<span class="line"><span style="color:#24292e;">output-buffer = 23000</span></span>
<span class="line"><span style="color:#24292e;">idle-timeout = 3600</span></span>
<span class="line"><span style="color:#24292e;">try-mtu-discovery = true</span></span>
<span class="line"><span style="color:#24292e;">compression = true</span></span></code></pre></div><h2 id="_1-命令操作" tabindex="-1">1.命令操作 <a class="header-anchor" href="#_1-命令操作" aria-label="Permalink to &quot;1.命令操作&quot;">​</a></h2><ul><li>查看版本</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#ocserv -v ocserv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">ocserv</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.1</span><span style="color:#9ECBFF;">.6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">Compiled</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">with:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">seccomp,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tcp-wrappers,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">PKCS#11,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">AnyConnect</span></span>
<span class="line"><span style="color:#B392F0;">GnuTLS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3.5</span><span style="color:#9ECBFF;">.18</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#ocserv -v ocserv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">ocserv</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.1</span><span style="color:#032F62;">.6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Compiled</span><span style="color:#24292E;"> </span><span style="color:#032F62;">with:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">seccomp,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tcp-wrappers,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">PKCS#11,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">AnyConnect</span></span>
<span class="line"><span style="color:#6F42C1;">GnuTLS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3.5</span><span style="color:#032F62;">.18</span></span></code></pre></div><h3 id="_1-1管理命令" tabindex="-1">1.1<strong>管理命令</strong> <a class="header-anchor" href="#_1-1管理命令" aria-label="Permalink to &quot;1.1**管理命令**&quot;">​</a></h3><p>查看服务状态</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">occtl -n show status</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">occtl -n show status</span></span></code></pre></div><p>查看在线用户</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">occtl -n show users</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">occtl -n show users</span></span></code></pre></div><p>剔除当前用户</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">occtl disconnect user username</span></span>
<span class="line"><span style="color:#e1e4e8;">occtl disconnect id userid</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">occtl disconnect user username</span></span>
<span class="line"><span style="color:#24292e;">occtl disconnect id userid</span></span></code></pre></div><h3 id="_1-2用户管理" tabindex="-1">1.2<strong>用户管理</strong> <a class="header-anchor" href="#_1-2用户管理" aria-label="Permalink to &quot;1.2**用户管理**&quot;">​</a></h3><p>创建用户</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ocpasswd -c /etc/ocserv/ocpasswd username</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ocpasswd -c /etc/ocserv/ocpasswd username</span></span></code></pre></div><p>添加用户到组：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ocpasswd -c /etc/ocserv/ocpasswd -g groupname username</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ocpasswd -c /etc/ocserv/ocpasswd -g groupname username</span></span></code></pre></div><p>锁定用户</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ocpasswd -c /etc/ocserv/ocpasswd -l username</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ocpasswd -c /etc/ocserv/ocpasswd -l username</span></span></code></pre></div><p>解锁用户</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ocpasswd -c /etc/ocserv/ocpasswd -u username</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ocpasswd -c /etc/ocserv/ocpasswd -u username</span></span></code></pre></div><p>删除用户：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ocpasswd -c /etc/ocserv/ocpasswd -d username</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ocpasswd -c /etc/ocserv/ocpasswd -d username</span></span></code></pre></div><p><strong>更多命令：</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">occtl --help</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">occtl --help</span></span></code></pre></div><h2 id="_2-ubuntu18-04" tabindex="-1">2.ubuntu18.04 <a class="header-anchor" href="#_2-ubuntu18-04" aria-label="Permalink to &quot;2.ubuntu18.04&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">/etc/init.d/ocserv start</span></span>
<span class="line"><span style="color:#e1e4e8;"># 启动 ocserv</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">/etc/init.d/ocserv stop</span></span>
<span class="line"><span style="color:#e1e4e8;"># 停止 ocserv</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">/etc/init.d/ocserv restart</span></span>
<span class="line"><span style="color:#e1e4e8;"># 重启 ocserv</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">/etc/init.d/ocserv status</span></span>
<span class="line"><span style="color:#e1e4e8;"># 查看 ocserv 运行状态</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">/etc/init.d/ocserv log</span></span>
<span class="line"><span style="color:#e1e4e8;"># 查看 ocserv 运行日志</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">/etc/init.d/ocserv test</span></span>
<span class="line"><span style="color:#e1e4e8;"># 测试 ocserv 配置文件是否正确</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">配置文件：/etc/ocserv/ocserv.conf</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">账号配置文件：/etc/ocserv/ocpasswd</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">日志文件：/tmp/ocserv.log</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">/etc/init.d/ocserv start</span></span>
<span class="line"><span style="color:#24292e;"># 启动 ocserv</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">/etc/init.d/ocserv stop</span></span>
<span class="line"><span style="color:#24292e;"># 停止 ocserv</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">/etc/init.d/ocserv restart</span></span>
<span class="line"><span style="color:#24292e;"># 重启 ocserv</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">/etc/init.d/ocserv status</span></span>
<span class="line"><span style="color:#24292e;"># 查看 ocserv 运行状态</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">/etc/init.d/ocserv log</span></span>
<span class="line"><span style="color:#24292e;"># 查看 ocserv 运行日志</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">/etc/init.d/ocserv test</span></span>
<span class="line"><span style="color:#24292e;"># 测试 ocserv 配置文件是否正确</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">配置文件：/etc/ocserv/ocserv.conf</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">账号配置文件：/etc/ocserv/ocpasswd</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">日志文件：/tmp/ocserv.log</span></span></code></pre></div><h2 id="_3-线上配置文件" tabindex="-1">3.线上配置文件 <a class="header-anchor" href="#_3-线上配置文件" aria-label="Permalink to &quot;3.线上配置文件&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">auth</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#listen-host = 127.0.0.1</span></span>
<span class="line"><span style="color:#B392F0;">tcp-port</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">443</span></span>
<span class="line"><span style="color:#B392F0;">udp-port</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">443</span></span>
<span class="line"><span style="color:#B392F0;">run-as-user</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span></span>
<span class="line"><span style="color:#B392F0;">run-as-group</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">daemon</span></span>
<span class="line"><span style="color:#B392F0;">socket-file</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/run/ocserv-socket</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">server-cert</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/ocserv/ssl/9495244_sike.freehan.ink.pem</span></span>
<span class="line"><span style="color:#B392F0;">server-key</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/ocserv/ssl/9495244_sike.freehan.ink.key.pem</span></span>
<span class="line"><span style="color:#6A737D;">#server-cert = /etc/ocserv/ssl/server-cert.pem</span></span>
<span class="line"><span style="color:#6A737D;">#server-key = /etc/ocserv/ssl/server-key.pem</span></span>
<span class="line"><span style="color:#6A737D;">#ca-cert = /etc/ocserv/ssl/ca-cert.pem</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">isolate-workers</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#6A737D;">#设置允许的最大客户端数。默认值为 16。设置为 0 表示无限制。</span></span>
<span class="line"><span style="color:#B392F0;">max-clients</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#设置用户可以同时使用的设备数量。默认值为 2。设置为 0 表示无限制。</span></span>
<span class="line"><span style="color:#B392F0;">max-same-clients</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">rate-limit-ms</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">server-stats-reset-time</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">604800</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#默认情况下，OpenConnect 每 9 小时（32400 秒）发送一次 keepalive 数据包。这个值太高了。将其设置为 60 秒，以减少 VPN 连接丢失的几率。</span></span>
<span class="line"><span style="color:#B392F0;">keepalive</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">60</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">dpd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">900</span></span>
<span class="line"><span style="color:#B392F0;">mobile-dpd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1900</span></span>
<span class="line"><span style="color:#B392F0;">switch-to-tcp-timeout</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">25</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#将try-mtu-discovery 的值更改为 true 以启用 MTU 发现。它可以优化 VPN 性能。</span></span>
<span class="line"><span style="color:#B392F0;">try-mtu-discovery</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#B392F0;">compression</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">tls-priorities</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;NORMAL:%SERVER_PRECEDENCE:%COMPAT:-RSA:-VERS-SSL3.0:-ARCFOUR-128:-VERS-TLS1.0:-VERS-TLS1.1&quot;</span></span>
<span class="line"><span style="color:#B392F0;">auth-timeout</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">240</span></span>
<span class="line"><span style="color:#B392F0;">idle-timeout</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">86400</span></span>
<span class="line"><span style="color:#B392F0;">mobile-idle-timeout</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">86400</span></span>
<span class="line"><span style="color:#B392F0;">min-reauth-time</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">300</span></span>
<span class="line"><span style="color:#B392F0;">max-ban-score</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">80</span></span>
<span class="line"><span style="color:#B392F0;">ban-reset-time</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1200</span></span>
<span class="line"><span style="color:#B392F0;">cookie-timeout</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">300</span></span>
<span class="line"><span style="color:#B392F0;">deny-roaming</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">rekey-time</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">172800</span></span>
<span class="line"><span style="color:#B392F0;">rekey-method</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ssl</span></span>
<span class="line"><span style="color:#B392F0;">use-occtl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#B392F0;">pid-file</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/run/ocserv.pid</span></span>
<span class="line"><span style="color:#B392F0;">net-priority</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">6</span></span>
<span class="line"><span style="color:#B392F0;">device</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">vpns</span></span>
<span class="line"><span style="color:#B392F0;">predictable-ips</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">default-domain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sike.freehan.ink</span></span>
<span class="line"><span style="color:#6A737D;">#listen-proxy-proto = true</span></span>
<span class="line"><span style="color:#6A737D;">#proxy-url = https://sike.freehan.ink:443</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#不要跟服务器及本地网段有冲突</span></span>
<span class="line"><span style="color:#B392F0;">ipv4-network</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.8.0</span></span>
<span class="line"><span style="color:#B392F0;">ipv4-netmask</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">255.255</span><span style="color:#9ECBFF;">.255.0</span></span>
<span class="line"><span style="color:#6A737D;"># An alternative way of specifying the network:</span></span>
<span class="line"><span style="color:#6A737D;">#ipv4-network = 192.168.1.0/24</span></span>
<span class="line"><span style="color:#6A737D;"># The IPv6 subnet that leases will be given from.</span></span>
<span class="line"><span style="color:#6A737D;">#ipv6-network = fda9:4efe:7e3b:03ea::/48 </span></span>
<span class="line"><span style="color:#6A737D;"># Specify the size of the network to provide to clients. It is</span></span>
<span class="line"><span style="color:#6A737D;"># generally recommended to provide clients with a /64 network in</span></span>
<span class="line"><span style="color:#6A737D;"># IPv6, but any subnet may be specified. To provide clients only</span></span>
<span class="line"><span style="color:#6A737D;"># with a single IP use the prefix 128.</span></span>
<span class="line"><span style="color:#6A737D;">#ipv6-subnet-prefix = 128</span></span>
<span class="line"><span style="color:#6A737D;">#ipv6-subnet-prefix = 64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># tunnel-all-dns = true</span></span>
<span class="line"><span style="color:#B392F0;">dns</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">8.8</span><span style="color:#9ECBFF;">.8.8</span></span>
<span class="line"><span style="color:#B392F0;">dns</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">8.8</span><span style="color:#9ECBFF;">.4.4</span></span>
<span class="line"><span style="color:#B392F0;">ping-leases</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.112</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.176</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.192</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">14.0</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">14.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">14.128</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">14.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">27.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">27.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">27.128</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">27.176</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">27.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">27.224</span><span style="color:#9ECBFF;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">36.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">36.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">36.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">36.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">36.240</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">39.0</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">39.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">39.96</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">39.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">40.72</span><span style="color:#9ECBFF;">.0.0/255.254.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">40.124</span><span style="color:#9ECBFF;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">42.0</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">42.48</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">42.80</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">42.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">42.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">43.224</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">45.65</span><span style="color:#9ECBFF;">.16.0/255.255.240.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">45.112</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">45.248</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">47.92</span><span style="color:#9ECBFF;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">47.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">49.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">49.128</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">49.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">52.80</span><span style="color:#9ECBFF;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">54.222</span><span style="color:#9ECBFF;">.0.0/255.254.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">58.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">58.128</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">58.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">58.240</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">59.32</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">59.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">59.96</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">59.144</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">59.160</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">59.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">60.0</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">60.48</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">60.160</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">60.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">61.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">61.80</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">61.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">61.224</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">91.234</span><span style="color:#9ECBFF;">.36.0/255.255.255.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">101.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">101.128</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">101.192</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">101.224</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">103.0</span><span style="color:#9ECBFF;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">106.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">106.224</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">110.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">110.144</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">110.160</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">110.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">111.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">111.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">111.112</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">111.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">111.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">111.224</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">112.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">112.128</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">112.192</span><span style="color:#9ECBFF;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">112.224</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">113.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">113.128</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">113.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">114.16</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">114.48</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">114.64</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">114.128</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">114.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">115.0</span><span style="color:#9ECBFF;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">116.0</span><span style="color:#9ECBFF;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">117.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">117.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">118.16</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">118.64</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">118.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">119.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">119.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">119.224</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">120.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">120.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">120.128</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">120.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">121.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">121.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">122.0</span><span style="color:#9ECBFF;">.0.0/254.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">124.0</span><span style="color:#9ECBFF;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">125.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">125.160</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">125.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">137.59</span><span style="color:#9ECBFF;">.59.0/255.255.255.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">137.59</span><span style="color:#9ECBFF;">.88.0/255.255.252.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">139.0</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">139.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">140.64</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">140.128</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">140.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">144.0</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">144.12</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">144.48</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">144.123</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">144.255</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">146.196</span><span style="color:#9ECBFF;">.0.0/255.255.128.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">150.0</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">150.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">150.128</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">150.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">152.104</span><span style="color:#9ECBFF;">.128.0/255.255.128.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">153.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">153.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">157.0</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">157.18</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">157.61</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">157.112</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">157.144</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">157.255</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">159.226</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">160.19</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">160.20</span><span style="color:#9ECBFF;">.48.0/255.255.252.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">160.202</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">160.238</span><span style="color:#9ECBFF;">.64.0/255.255.252.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">161.207</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">162.105</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">163.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">163.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">163.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">163.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">164.52</span><span style="color:#9ECBFF;">.0.0/255.255.128.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">166.111</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">167.139</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">167.189</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">167.220</span><span style="color:#9ECBFF;">.244.0/255.255.252.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">168.160</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">170.179</span><span style="color:#9ECBFF;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">171.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">171.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">175.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">175.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">180.64</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">180.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">182.0</span><span style="color:#9ECBFF;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">183.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">183.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">183.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">192.124</span><span style="color:#9ECBFF;">.154.0/255.255.255.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">192.140</span><span style="color:#9ECBFF;">.128.0/255.255.128.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">195.78</span><span style="color:#9ECBFF;">.82.0/255.255.254.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">202.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">202.128</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">202.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">203.0</span><span style="color:#9ECBFF;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">210.0</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">210.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">210.160</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">210.192</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">211.64</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">211.80</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">211.96</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">211.136</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">211.144</span><span style="color:#9ECBFF;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">211.160</span><span style="color:#9ECBFF;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">216.250</span><span style="color:#9ECBFF;">.108.0/255.255.252.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">218.0</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">218.160</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">218.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">219.64</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">219.128</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">219.192</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">220.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">220.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">221.0</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">221.96</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">221.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">222.0</span><span style="color:#9ECBFF;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">223.0</span><span style="color:#9ECBFF;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">223.64</span><span style="color:#9ECBFF;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#B392F0;">no-route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">223.128</span><span style="color:#9ECBFF;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#B392F0;">cisco-client-compat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#B392F0;">dtls-legacy</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">auth</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#listen-host = 127.0.0.1</span></span>
<span class="line"><span style="color:#6F42C1;">tcp-port</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">443</span></span>
<span class="line"><span style="color:#6F42C1;">udp-port</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">443</span></span>
<span class="line"><span style="color:#6F42C1;">run-as-user</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span></span>
<span class="line"><span style="color:#6F42C1;">run-as-group</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">daemon</span></span>
<span class="line"><span style="color:#6F42C1;">socket-file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/run/ocserv-socket</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">server-cert</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ocserv/ssl/9495244_sike.freehan.ink.pem</span></span>
<span class="line"><span style="color:#6F42C1;">server-key</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ocserv/ssl/9495244_sike.freehan.ink.key.pem</span></span>
<span class="line"><span style="color:#6A737D;">#server-cert = /etc/ocserv/ssl/server-cert.pem</span></span>
<span class="line"><span style="color:#6A737D;">#server-key = /etc/ocserv/ssl/server-key.pem</span></span>
<span class="line"><span style="color:#6A737D;">#ca-cert = /etc/ocserv/ssl/ca-cert.pem</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">isolate-workers</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#6A737D;">#设置允许的最大客户端数。默认值为 16。设置为 0 表示无限制。</span></span>
<span class="line"><span style="color:#6F42C1;">max-clients</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#设置用户可以同时使用的设备数量。默认值为 2。设置为 0 表示无限制。</span></span>
<span class="line"><span style="color:#6F42C1;">max-same-clients</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">rate-limit-ms</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">server-stats-reset-time</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">604800</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#默认情况下，OpenConnect 每 9 小时（32400 秒）发送一次 keepalive 数据包。这个值太高了。将其设置为 60 秒，以减少 VPN 连接丢失的几率。</span></span>
<span class="line"><span style="color:#6F42C1;">keepalive</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">60</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">dpd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">900</span></span>
<span class="line"><span style="color:#6F42C1;">mobile-dpd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1900</span></span>
<span class="line"><span style="color:#6F42C1;">switch-to-tcp-timeout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">25</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#将try-mtu-discovery 的值更改为 true 以启用 MTU 发现。它可以优化 VPN 性能。</span></span>
<span class="line"><span style="color:#6F42C1;">try-mtu-discovery</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#6F42C1;">compression</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">tls-priorities</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;NORMAL:%SERVER_PRECEDENCE:%COMPAT:-RSA:-VERS-SSL3.0:-ARCFOUR-128:-VERS-TLS1.0:-VERS-TLS1.1&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">auth-timeout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">240</span></span>
<span class="line"><span style="color:#6F42C1;">idle-timeout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">86400</span></span>
<span class="line"><span style="color:#6F42C1;">mobile-idle-timeout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">86400</span></span>
<span class="line"><span style="color:#6F42C1;">min-reauth-time</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">300</span></span>
<span class="line"><span style="color:#6F42C1;">max-ban-score</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">80</span></span>
<span class="line"><span style="color:#6F42C1;">ban-reset-time</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1200</span></span>
<span class="line"><span style="color:#6F42C1;">cookie-timeout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">300</span></span>
<span class="line"><span style="color:#6F42C1;">deny-roaming</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">rekey-time</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">172800</span></span>
<span class="line"><span style="color:#6F42C1;">rekey-method</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ssl</span></span>
<span class="line"><span style="color:#6F42C1;">use-occtl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#6F42C1;">pid-file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/run/ocserv.pid</span></span>
<span class="line"><span style="color:#6F42C1;">net-priority</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span></span>
<span class="line"><span style="color:#6F42C1;">device</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">vpns</span></span>
<span class="line"><span style="color:#6F42C1;">predictable-ips</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">default-domain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sike.freehan.ink</span></span>
<span class="line"><span style="color:#6A737D;">#listen-proxy-proto = true</span></span>
<span class="line"><span style="color:#6A737D;">#proxy-url = https://sike.freehan.ink:443</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#不要跟服务器及本地网段有冲突</span></span>
<span class="line"><span style="color:#6F42C1;">ipv4-network</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.8.0</span></span>
<span class="line"><span style="color:#6F42C1;">ipv4-netmask</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">255.255</span><span style="color:#032F62;">.255.0</span></span>
<span class="line"><span style="color:#6A737D;"># An alternative way of specifying the network:</span></span>
<span class="line"><span style="color:#6A737D;">#ipv4-network = 192.168.1.0/24</span></span>
<span class="line"><span style="color:#6A737D;"># The IPv6 subnet that leases will be given from.</span></span>
<span class="line"><span style="color:#6A737D;">#ipv6-network = fda9:4efe:7e3b:03ea::/48 </span></span>
<span class="line"><span style="color:#6A737D;"># Specify the size of the network to provide to clients. It is</span></span>
<span class="line"><span style="color:#6A737D;"># generally recommended to provide clients with a /64 network in</span></span>
<span class="line"><span style="color:#6A737D;"># IPv6, but any subnet may be specified. To provide clients only</span></span>
<span class="line"><span style="color:#6A737D;"># with a single IP use the prefix 128.</span></span>
<span class="line"><span style="color:#6A737D;">#ipv6-subnet-prefix = 128</span></span>
<span class="line"><span style="color:#6A737D;">#ipv6-subnet-prefix = 64</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># tunnel-all-dns = true</span></span>
<span class="line"><span style="color:#6F42C1;">dns</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">8.8</span><span style="color:#032F62;">.8.8</span></span>
<span class="line"><span style="color:#6F42C1;">dns</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">8.8</span><span style="color:#032F62;">.4.4</span></span>
<span class="line"><span style="color:#6F42C1;">ping-leases</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.112</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.176</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.192</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">14.0</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">14.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">14.128</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">14.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">27.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">27.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">27.128</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">27.176</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">27.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">27.224</span><span style="color:#032F62;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">36.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">36.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">36.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">36.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">36.240</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">39.0</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">39.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">39.96</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">39.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">40.72</span><span style="color:#032F62;">.0.0/255.254.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">40.124</span><span style="color:#032F62;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">42.0</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">42.48</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">42.80</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">42.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">42.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">43.224</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">45.65</span><span style="color:#032F62;">.16.0/255.255.240.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">45.112</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">45.248</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">47.92</span><span style="color:#032F62;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">47.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">49.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">49.128</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">49.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">52.80</span><span style="color:#032F62;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">54.222</span><span style="color:#032F62;">.0.0/255.254.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">58.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">58.128</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">58.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">58.240</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">59.32</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">59.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">59.96</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">59.144</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">59.160</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">59.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">60.0</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">60.48</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">60.160</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">60.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">61.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">61.80</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">61.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">61.224</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">91.234</span><span style="color:#032F62;">.36.0/255.255.255.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">101.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">101.128</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">101.192</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">101.224</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">103.0</span><span style="color:#032F62;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">106.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">106.224</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">110.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">110.144</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">110.160</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">110.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">111.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">111.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">111.112</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">111.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">111.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">111.224</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">112.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">112.128</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">112.192</span><span style="color:#032F62;">.0.0/255.252.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">112.224</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">113.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">113.128</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">113.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">114.16</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">114.48</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">114.64</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">114.128</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">114.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">115.0</span><span style="color:#032F62;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">116.0</span><span style="color:#032F62;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">117.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">117.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">118.16</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">118.64</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">118.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">119.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">119.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">119.224</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">120.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">120.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">120.128</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">120.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">121.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">121.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">122.0</span><span style="color:#032F62;">.0.0/254.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">124.0</span><span style="color:#032F62;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">125.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">125.160</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">125.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">137.59</span><span style="color:#032F62;">.59.0/255.255.255.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">137.59</span><span style="color:#032F62;">.88.0/255.255.252.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">139.0</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">139.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">140.64</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">140.128</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">140.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">144.0</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">144.12</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">144.48</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">144.123</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">144.255</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">146.196</span><span style="color:#032F62;">.0.0/255.255.128.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">150.0</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">150.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">150.128</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">150.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">152.104</span><span style="color:#032F62;">.128.0/255.255.128.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">153.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">153.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">157.0</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">157.18</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">157.61</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">157.112</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">157.144</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">157.255</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">159.226</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">160.19</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">160.20</span><span style="color:#032F62;">.48.0/255.255.252.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">160.202</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">160.238</span><span style="color:#032F62;">.64.0/255.255.252.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">161.207</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">162.105</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">163.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">163.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">163.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">163.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">164.52</span><span style="color:#032F62;">.0.0/255.255.128.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">166.111</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">167.139</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">167.189</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">167.220</span><span style="color:#032F62;">.244.0/255.255.252.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">168.160</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">170.179</span><span style="color:#032F62;">.0.0/255.255.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">171.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">171.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">175.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">175.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">180.64</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">180.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">182.0</span><span style="color:#032F62;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">183.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">183.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">183.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">192.124</span><span style="color:#032F62;">.154.0/255.255.255.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">192.140</span><span style="color:#032F62;">.128.0/255.255.128.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">195.78</span><span style="color:#032F62;">.82.0/255.255.254.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">202.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">202.128</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">202.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">203.0</span><span style="color:#032F62;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">210.0</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">210.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">210.160</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">210.192</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">211.64</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">211.80</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">211.96</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">211.136</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">211.144</span><span style="color:#032F62;">.0.0/255.240.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">211.160</span><span style="color:#032F62;">.0.0/255.248.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">216.250</span><span style="color:#032F62;">.108.0/255.255.252.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">218.0</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">218.160</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">218.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">219.64</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">219.128</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">219.192</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">220.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">220.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">221.0</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">221.96</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">221.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">222.0</span><span style="color:#032F62;">.0.0/255.0.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">223.0</span><span style="color:#032F62;">.0.0/255.224.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">223.64</span><span style="color:#032F62;">.0.0/255.192.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">no-route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">223.128</span><span style="color:#032F62;">.0.0/255.128.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">cisco-client-compat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#6F42C1;">dtls-legacy</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span></code></pre></div><p><a href="https://zzongbh.github.io/c99fb8e8/" target="_blank" rel="noreferrer">https://zzongbh.github.io/c99fb8e8/</a></p><p><a href="https://www.linuxbabe.com/redhat/openconnect-vpn-server-ocserv-centos-8" target="_blank" rel="noreferrer">https://www.linuxbabe.com/redhat/openconnect-vpn-server-ocserv-centos-8</a></p><p><a href="https://www.cnblogs.com/yueping/p/15842948.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/yueping/p/15842948.html</a></p><p><a href="https://holmesian.org/linode-vps-centos-anyconnect" target="_blank" rel="noreferrer">https://holmesian.org/linode-vps-centos-anyconnect</a></p><h3 id="流量分流" tabindex="-1">流量分流 <a class="header-anchor" href="#流量分流" aria-label="Permalink to &quot;流量分流&quot;">​</a></h3><p><code>no-route</code>配置可能需要根据自己的局域网配置调整。此外，对于国内网段，设置no-route可以避免国内流量通过vpn降低访问效率</p><h2 id="_4-证书方式" tabindex="-1">4.证书方式 <a class="header-anchor" href="#_4-证书方式" aria-label="Permalink to &quot;4.证书方式&quot;">​</a></h2><ul><li>配置文件</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$sed -e &#39;/^#/d&#39; /etc/ocserv/ocserv.conf | sed &#39;/^$/d&#39;</span></span>
<span class="line"><span style="color:#e1e4e8;">auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">tcp-port = 4333</span></span>
<span class="line"><span style="color:#e1e4e8;">udp-port = 4333</span></span>
<span class="line"><span style="color:#e1e4e8;">run-as-user = ocserv</span></span>
<span class="line"><span style="color:#e1e4e8;">run-as-group = ocserv</span></span>
<span class="line"><span style="color:#e1e4e8;">socket-file = ocserv.sock</span></span>
<span class="line"><span style="color:#e1e4e8;">chroot-dir = /var/lib/ocserv</span></span>
<span class="line"><span style="color:#e1e4e8;">isolate-workers = true</span></span>
<span class="line"><span style="color:#e1e4e8;">max-clients = 50</span></span>
<span class="line"><span style="color:#e1e4e8;">max-same-clients = 10</span></span>
<span class="line"><span style="color:#e1e4e8;">keepalive = 32400</span></span>
<span class="line"><span style="color:#e1e4e8;">dpd = 90</span></span>
<span class="line"><span style="color:#e1e4e8;">mobile-dpd = 1800</span></span>
<span class="line"><span style="color:#e1e4e8;">switch-to-tcp-timeout = 25</span></span>
<span class="line"><span style="color:#e1e4e8;">try-mtu-discovery = true</span></span>
<span class="line"><span style="color:#e1e4e8;">server-cert = /etc/ocserv/server-cert.pem</span></span>
<span class="line"><span style="color:#e1e4e8;">server-key = /etc/ocserv/server-key.pem</span></span>
<span class="line"><span style="color:#e1e4e8;">ca-cert = /etc/ocserv/ca-cert.pem</span></span>
<span class="line"><span style="color:#e1e4e8;">cert-user-oid = 2.5.4.3</span></span>
<span class="line"><span style="color:#e1e4e8;">tls-priorities = &quot;NORMAL:%SERVER_PRECEDENCE:%COMPAT:-VERS-SSL3.0&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">auth-timeout = 240</span></span>
<span class="line"><span style="color:#e1e4e8;">min-reauth-time = 300</span></span>
<span class="line"><span style="color:#e1e4e8;">max-ban-score = 50</span></span>
<span class="line"><span style="color:#e1e4e8;">ban-reset-time = 300</span></span>
<span class="line"><span style="color:#e1e4e8;">cookie-timeout = 300</span></span>
<span class="line"><span style="color:#e1e4e8;">deny-roaming = false</span></span>
<span class="line"><span style="color:#e1e4e8;">rekey-time = 172800</span></span>
<span class="line"><span style="color:#e1e4e8;">rekey-method = ssl</span></span>
<span class="line"><span style="color:#e1e4e8;">use-occtl = true</span></span>
<span class="line"><span style="color:#e1e4e8;">pid-file = /var/run/ocserv.pid</span></span>
<span class="line"><span style="color:#e1e4e8;">device = vpns</span></span>
<span class="line"><span style="color:#e1e4e8;">predictable-ips = true</span></span>
<span class="line"><span style="color:#e1e4e8;">default-domain = example.com</span></span>
<span class="line"><span style="color:#e1e4e8;">ipv4-network = 10.0.81.0</span></span>
<span class="line"><span style="color:#e1e4e8;">ipv4-netmask = 255.255.255.0</span></span>
<span class="line"><span style="color:#e1e4e8;">dns = 114.114.114.114</span></span>
<span class="line"><span style="color:#e1e4e8;">ping-leases = false</span></span>
<span class="line"><span style="color:#e1e4e8;">route = 10.0.0.0/255.255.255.0</span></span>
<span class="line"><span style="color:#e1e4e8;">cisco-client-compat = true</span></span>
<span class="line"><span style="color:#e1e4e8;">dtls-legacy = true</span></span>
<span class="line"><span style="color:#e1e4e8;">user-profile = profile.xml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$sed -e &#39;/^#/d&#39; /etc/ocserv/ocserv.conf | sed &#39;/^$/d&#39;</span></span>
<span class="line"><span style="color:#24292e;">auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#24292e;">tcp-port = 4333</span></span>
<span class="line"><span style="color:#24292e;">udp-port = 4333</span></span>
<span class="line"><span style="color:#24292e;">run-as-user = ocserv</span></span>
<span class="line"><span style="color:#24292e;">run-as-group = ocserv</span></span>
<span class="line"><span style="color:#24292e;">socket-file = ocserv.sock</span></span>
<span class="line"><span style="color:#24292e;">chroot-dir = /var/lib/ocserv</span></span>
<span class="line"><span style="color:#24292e;">isolate-workers = true</span></span>
<span class="line"><span style="color:#24292e;">max-clients = 50</span></span>
<span class="line"><span style="color:#24292e;">max-same-clients = 10</span></span>
<span class="line"><span style="color:#24292e;">keepalive = 32400</span></span>
<span class="line"><span style="color:#24292e;">dpd = 90</span></span>
<span class="line"><span style="color:#24292e;">mobile-dpd = 1800</span></span>
<span class="line"><span style="color:#24292e;">switch-to-tcp-timeout = 25</span></span>
<span class="line"><span style="color:#24292e;">try-mtu-discovery = true</span></span>
<span class="line"><span style="color:#24292e;">server-cert = /etc/ocserv/server-cert.pem</span></span>
<span class="line"><span style="color:#24292e;">server-key = /etc/ocserv/server-key.pem</span></span>
<span class="line"><span style="color:#24292e;">ca-cert = /etc/ocserv/ca-cert.pem</span></span>
<span class="line"><span style="color:#24292e;">cert-user-oid = 2.5.4.3</span></span>
<span class="line"><span style="color:#24292e;">tls-priorities = &quot;NORMAL:%SERVER_PRECEDENCE:%COMPAT:-VERS-SSL3.0&quot;</span></span>
<span class="line"><span style="color:#24292e;">auth-timeout = 240</span></span>
<span class="line"><span style="color:#24292e;">min-reauth-time = 300</span></span>
<span class="line"><span style="color:#24292e;">max-ban-score = 50</span></span>
<span class="line"><span style="color:#24292e;">ban-reset-time = 300</span></span>
<span class="line"><span style="color:#24292e;">cookie-timeout = 300</span></span>
<span class="line"><span style="color:#24292e;">deny-roaming = false</span></span>
<span class="line"><span style="color:#24292e;">rekey-time = 172800</span></span>
<span class="line"><span style="color:#24292e;">rekey-method = ssl</span></span>
<span class="line"><span style="color:#24292e;">use-occtl = true</span></span>
<span class="line"><span style="color:#24292e;">pid-file = /var/run/ocserv.pid</span></span>
<span class="line"><span style="color:#24292e;">device = vpns</span></span>
<span class="line"><span style="color:#24292e;">predictable-ips = true</span></span>
<span class="line"><span style="color:#24292e;">default-domain = example.com</span></span>
<span class="line"><span style="color:#24292e;">ipv4-network = 10.0.81.0</span></span>
<span class="line"><span style="color:#24292e;">ipv4-netmask = 255.255.255.0</span></span>
<span class="line"><span style="color:#24292e;">dns = 114.114.114.114</span></span>
<span class="line"><span style="color:#24292e;">ping-leases = false</span></span>
<span class="line"><span style="color:#24292e;">route = 10.0.0.0/255.255.255.0</span></span>
<span class="line"><span style="color:#24292e;">cisco-client-compat = true</span></span>
<span class="line"><span style="color:#24292e;">dtls-legacy = true</span></span>
<span class="line"><span style="color:#24292e;">user-profile = profile.xml</span></span></code></pre></div><h3 id="_4-1创建客户端证书" tabindex="-1">4.1创建客户端证书 <a class="header-anchor" href="#_4-1创建客户端证书" aria-label="Permalink to &quot;4.1创建客户端证书&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$vim gen-client.sh</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#!/bin/bash</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">USER=$1</span></span>
<span class="line"><span style="color:#e1e4e8;">CA_DIR=$2</span></span>
<span class="line"><span style="color:#e1e4e8;">SERIAL=\`date +%s\`</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#生成客户端key</span></span>
<span class="line"><span style="color:#e1e4e8;">certtool --generate-privkey --outfile $USER-key.pem</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#生成证书模板文件</span></span>
<span class="line"><span style="color:#e1e4e8;">cat &lt;&lt; _EOF_ &gt;user.tmpl</span></span>
<span class="line"><span style="color:#e1e4e8;">cn = &quot;$USER&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">unit = &quot;users&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">serial = &quot;$SERIAL&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">expiration_days = 9999</span></span>
<span class="line"><span style="color:#e1e4e8;">signing_key</span></span>
<span class="line"><span style="color:#e1e4e8;">tls_www_client</span></span>
<span class="line"><span style="color:#e1e4e8;">_EOF_</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#生成用户证书</span></span>
<span class="line"><span style="color:#e1e4e8;">certtool --generate-certificate --load-privkey $USER-key.pem --load-ca-certificate $CA_DIR/ca-cert.pem --load-ca-privkey $CA_DIR/ca-key.pem --template user.tmpl --outfile $USER-cert.pem</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#将证书转换成p12格式,以便客户端导入证书</span></span>
<span class="line"><span style="color:#e1e4e8;">openssl pkcs12 -export -inkey $USER-key.pem -in $USER-cert.pem -name &quot;$USER VPN Client Cert&quot; -certfile $CA_DIR/ca-cert.pem -out $USER.p12</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$vim gen-client.sh</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#!/bin/bash</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">USER=$1</span></span>
<span class="line"><span style="color:#24292e;">CA_DIR=$2</span></span>
<span class="line"><span style="color:#24292e;">SERIAL=\`date +%s\`</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#生成客户端key</span></span>
<span class="line"><span style="color:#24292e;">certtool --generate-privkey --outfile $USER-key.pem</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#生成证书模板文件</span></span>
<span class="line"><span style="color:#24292e;">cat &lt;&lt; _EOF_ &gt;user.tmpl</span></span>
<span class="line"><span style="color:#24292e;">cn = &quot;$USER&quot;</span></span>
<span class="line"><span style="color:#24292e;">unit = &quot;users&quot;</span></span>
<span class="line"><span style="color:#24292e;">serial = &quot;$SERIAL&quot;</span></span>
<span class="line"><span style="color:#24292e;">expiration_days = 9999</span></span>
<span class="line"><span style="color:#24292e;">signing_key</span></span>
<span class="line"><span style="color:#24292e;">tls_www_client</span></span>
<span class="line"><span style="color:#24292e;">_EOF_</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#生成用户证书</span></span>
<span class="line"><span style="color:#24292e;">certtool --generate-certificate --load-privkey $USER-key.pem --load-ca-certificate $CA_DIR/ca-cert.pem --load-ca-privkey $CA_DIR/ca-key.pem --template user.tmpl --outfile $USER-cert.pem</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#将证书转换成p12格式,以便客户端导入证书</span></span>
<span class="line"><span style="color:#24292e;">openssl pkcs12 -export -inkey $USER-key.pem -in $USER-cert.pem -name &quot;$USER VPN Client Cert&quot; -certfile $CA_DIR/ca-cert.pem -out $USER.p12</span></span></code></pre></div><blockquote><p>官网使用的是certtool命令将证书转换成p12格式:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">certtool --to-p12 --load-privkey user-key.pem --pkcs-cipher 3des-pkcs12 --load-certificate user-cert.pem --outfile user.p12 --outder</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">certtool --to-p12 --load-privkey user-key.pem --pkcs-cipher 3des-pkcs12 --load-certificate user-cert.pem --outfile user.p12 --outder</span></span></code></pre></div></blockquote><p>创建用户文件.例如给我创建一个客户端证书</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$ mkdir han</span></span>
<span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$cd han</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#脚本的$1参数表示创建的用户名,$2参数表示ca证书位置.</span></span>
<span class="line"><span style="color:#e1e4e8;">#按提示给证书设置一个密码(建议).也可以空密码(MAC电脑不支持导入空密码证书).</span></span>
<span class="line"><span style="color:#e1e4e8;">[root@openvpn han]$../gen-client-cert.sh han ..</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#脚本执行完成后,在用户文件夹可以看到证书文件:</span></span>
<span class="line"><span style="color:#e1e4e8;">[root@openvpn han]$ll</span></span>
<span class="line"><span style="color:#e1e4e8;">total 20</span></span>
<span class="line"><span style="color:#e1e4e8;">-rw-r--r--. 1 root root 1176 Jul 10 22:47 han-cert.pem</span></span>
<span class="line"><span style="color:#e1e4e8;">-rw-------. 1 root root 5826 Jul 10 22:47 han-key.pem</span></span>
<span class="line"><span style="color:#e1e4e8;">-rw-r--r--. 1 root root 3376 Jul 10 22:47 han.p12</span></span>
<span class="line"><span style="color:#e1e4e8;">-rw-r--r--. 1 root root  104 Jul 10 22:47 user.tmpl</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$ mkdir han</span></span>
<span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$cd han</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#脚本的$1参数表示创建的用户名,$2参数表示ca证书位置.</span></span>
<span class="line"><span style="color:#24292e;">#按提示给证书设置一个密码(建议).也可以空密码(MAC电脑不支持导入空密码证书).</span></span>
<span class="line"><span style="color:#24292e;">[root@openvpn han]$../gen-client-cert.sh han ..</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#脚本执行完成后,在用户文件夹可以看到证书文件:</span></span>
<span class="line"><span style="color:#24292e;">[root@openvpn han]$ll</span></span>
<span class="line"><span style="color:#24292e;">total 20</span></span>
<span class="line"><span style="color:#24292e;">-rw-r--r--. 1 root root 1176 Jul 10 22:47 han-cert.pem</span></span>
<span class="line"><span style="color:#24292e;">-rw-------. 1 root root 5826 Jul 10 22:47 han-key.pem</span></span>
<span class="line"><span style="color:#24292e;">-rw-r--r--. 1 root root 3376 Jul 10 22:47 han.p12</span></span>
<span class="line"><span style="color:#24292e;">-rw-r--r--. 1 root root  104 Jul 10 22:47 user.tmpl</span></span></code></pre></div><blockquote><p>由于你的证书是自己签发，所以请在anyconnect软件关闭阻止不受信任的服务器选项</p></blockquote><h2 id="_5-密码方式" tabindex="-1">5.密码方式 <a class="header-anchor" href="#_5-密码方式" aria-label="Permalink to &quot;5.密码方式&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn ocserv]$vim ocserv.conf</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#注释证书认证方面的配置</span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">#ca-cert = /etc/ocserv/ca-cert.pem</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#开启密码认证.passwd指定ocpasswd文件路径</span></span>
<span class="line"><span style="color:#e1e4e8;">auth = &quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn ocserv]$vim ocserv.conf</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#注释证书认证方面的配置</span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#24292e;">#ca-cert = /etc/ocserv/ca-cert.pem</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#开启密码认证.passwd指定ocpasswd文件路径</span></span>
<span class="line"><span style="color:#24292e;">auth = &quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span></code></pre></div><p>其他方面配置和证书验证差不多.重启ocserv服务后,客户端就可以通过用户密码登录VPN</p><h2 id="_6-证书和密码认证" tabindex="-1">6.证书和密码认证 <a class="header-anchor" href="#_6-证书和密码认证" aria-label="Permalink to &quot;6.证书和密码认证&quot;">​</a></h2><p>ocserv在登录认证方面功能非常强大也很人性化.可以同时支持多种认证方式.</p><p>比如我们想要同时使用密码或者证书登录</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#开启首选验证机制为密码认证</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;pam&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;pam[gid-min=1000]&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">auth = &quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"># 开启证书备用认证&quot;enable-auth&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"># Specify alternative authentication methods that are sufficient</span></span>
<span class="line"><span style="color:#e1e4e8;"># for authentication. That is, if set, any of the methods enabled</span></span>
<span class="line"><span style="color:#e1e4e8;"># will be sufficient to login, irrespective of the main &#39;auth&#39; entries.</span></span>
<span class="line"><span style="color:#e1e4e8;"># When multiple options are present, they are OR composed (any of them</span></span>
<span class="line"><span style="color:#e1e4e8;"># succeeding allows login).</span></span>
<span class="line"><span style="color:#e1e4e8;">enable-auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#配置文件其他参数无需修改</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#开启首选验证机制为密码认证</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;pam&quot;</span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;pam[gid-min=1000]&quot;</span></span>
<span class="line"><span style="color:#24292e;">auth = &quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#24292e;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"># 开启证书备用认证&quot;enable-auth&quot;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"># Specify alternative authentication methods that are sufficient</span></span>
<span class="line"><span style="color:#24292e;"># for authentication. That is, if set, any of the methods enabled</span></span>
<span class="line"><span style="color:#24292e;"># will be sufficient to login, irrespective of the main &#39;auth&#39; entries.</span></span>
<span class="line"><span style="color:#24292e;"># When multiple options are present, they are OR composed (any of them</span></span>
<span class="line"><span style="color:#24292e;"># succeeding allows login).</span></span>
<span class="line"><span style="color:#24292e;">enable-auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#配置文件其他参数无需修改</span></span></code></pre></div><p>重启ocserv服务后,客户端在没有证书的情况下会要求输入用户密码登录VPN.如果有导入证书的情况下,不会要求输入用户密码.</p><h2 id="_7-客户端证书注销-账户" tabindex="-1">7.客户端证书注销/账户 <a class="header-anchor" href="#_7-客户端证书注销-账户" aria-label="Permalink to &quot;7.客户端证书注销/账户&quot;">​</a></h2><h3 id="删除一个账户-密码" tabindex="-1">删除一个账户.密码 <a class="header-anchor" href="#删除一个账户-密码" aria-label="Permalink to &quot;删除一个账户.密码&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#ocpasswd命令提供了delete选项删除用户</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$ocpasswd --help</span></span>
<span class="line"><span style="color:#e1e4e8;">ocpasswd - OpenConnect server password utility</span></span>
<span class="line"><span style="color:#e1e4e8;">Usage:  ocpasswd [ -&lt;flag&gt; [&lt;val&gt;] | --&lt;name&gt;[{=| }&lt;val&gt;] ]... [username]</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">   -c, --passwd=file          Password file</span></span>
<span class="line"><span style="color:#e1e4e8;">   -g, --groupname=str        User&#39;s group name</span></span>
<span class="line"><span style="color:#e1e4e8;">   -d, --delete               Delete user</span></span>
<span class="line"><span style="color:#e1e4e8;">   -l, --lock                 Lock user</span></span>
<span class="line"><span style="color:#e1e4e8;">   -u, --unlock               Unlock user</span></span>
<span class="line"><span style="color:#e1e4e8;">   -v, --version              output version information and exit</span></span>
<span class="line"><span style="color:#e1e4e8;">   -h, --help                 display extended usage information and exit</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"># 删除我的账户</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$ocpasswd -c /etc/ocserv/ocpasswd -d han</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#ocpasswd命令提供了delete选项删除用户</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$ocpasswd --help</span></span>
<span class="line"><span style="color:#24292e;">ocpasswd - OpenConnect server password utility</span></span>
<span class="line"><span style="color:#24292e;">Usage:  ocpasswd [ -&lt;flag&gt; [&lt;val&gt;] | --&lt;name&gt;[{=| }&lt;val&gt;] ]... [username]</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">   -c, --passwd=file          Password file</span></span>
<span class="line"><span style="color:#24292e;">   -g, --groupname=str        User&#39;s group name</span></span>
<span class="line"><span style="color:#24292e;">   -d, --delete               Delete user</span></span>
<span class="line"><span style="color:#24292e;">   -l, --lock                 Lock user</span></span>
<span class="line"><span style="color:#24292e;">   -u, --unlock               Unlock user</span></span>
<span class="line"><span style="color:#24292e;">   -v, --version              output version information and exit</span></span>
<span class="line"><span style="color:#24292e;">   -h, --help                 display extended usage information and exit</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"># 删除我的账户</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$ocpasswd -c /etc/ocserv/ocpasswd -d han</span></span></code></pre></div><h3 id="注销客户端证书" tabindex="-1">注销客户端证书 <a class="header-anchor" href="#注销客户端证书" aria-label="Permalink to &quot;注销客户端证书&quot;">​</a></h3><h4 id="_1-生成crl-tmpl模板文件" tabindex="-1">1.生成crl.tmpl模板文件 <a class="header-anchor" href="#_1-生成crl-tmpl模板文件" aria-label="Permalink to &quot;1.生成crl.tmpl模板文件&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$cat &lt;&lt; _EOF_ &gt;crl.tmpl</span></span>
<span class="line"><span style="color:#e1e4e8;">crl_next_update = 365</span></span>
<span class="line"><span style="color:#e1e4e8;">crl_number = 1</span></span>
<span class="line"><span style="color:#e1e4e8;">_EOF_</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$cat crl.tmpl</span></span>
<span class="line"><span style="color:#e1e4e8;">crl_next_update = 365</span></span>
<span class="line"><span style="color:#e1e4e8;">crl_number = 1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$cat &lt;&lt; _EOF_ &gt;crl.tmpl</span></span>
<span class="line"><span style="color:#24292e;">crl_next_update = 365</span></span>
<span class="line"><span style="color:#24292e;">crl_number = 1</span></span>
<span class="line"><span style="color:#24292e;">_EOF_</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$cat crl.tmpl</span></span>
<span class="line"><span style="color:#24292e;">crl_next_update = 365</span></span>
<span class="line"><span style="color:#24292e;">crl_number = 1</span></span></code></pre></div><p>2.将要注销的证书文件拷贝一份到revoked.pem文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$cat huangyong/huangyong-cert.pem &gt;&gt; revoked.pem</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$cat huangyong/huangyong-cert.pem &gt;&gt; revoked.pem</span></span></code></pre></div><p>3.生成crl.pem文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">certtool --generate-crl --load-ca-privkey ca-key.pem \\</span></span>
<span class="line"><span style="color:#e1e4e8;">           --load-ca-certificate ca-cert.pem --load-certificate revoked.pem \\</span></span>
<span class="line"><span style="color:#e1e4e8;">           --template crl.tmpl --outfile crl.pem</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">certtool --generate-crl --load-ca-privkey ca-key.pem \\</span></span>
<span class="line"><span style="color:#24292e;">           --load-ca-certificate ca-cert.pem --load-certificate revoked.pem \\</span></span>
<span class="line"><span style="color:#24292e;">           --template crl.tmpl --outfile crl.pem</span></span></code></pre></div><p>4.修改配置文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@openvpn anyconnect]$vim /etc/ocserv/ocserv.conf</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#开启crl参数,并且制定crl.pem文件的路径</span></span>
<span class="line"><span style="color:#e1e4e8;">crl = /etc/anyconnect/crl.pem</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@openvpn anyconnect]$vim /etc/ocserv/ocserv.conf</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#开启crl参数,并且制定crl.pem文件的路径</span></span>
<span class="line"><span style="color:#24292e;">crl = /etc/anyconnect/crl.pem</span></span></code></pre></div><p>5.重启ocserv服务</p><h2 id="_8-配合dnsmasq" tabindex="-1">8.配合DNSmasq <a class="header-anchor" href="#_8-配合dnsmasq" aria-label="Permalink to &quot;8.配合DNSmasq&quot;">​</a></h2><p><code>dnsmasq: DNS request timed out for machines in local network</code> ，原来必须显式地设置 listen-address 监听接口，DNSmasq才会对外部客户端请求响应，否则只有本机（估计DNSmasq代码中检查客户端IP来判断是否是本机IP进行过滤）才提供服务，虽然端口已经监听</p><p>修改VPN服务器上 /etc/dnsmasq.conf 配置，添加</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">listen-address</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.101.1</span></span>
<span class="line"><span style="color:#E1E4E8;">listen-address</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">VPN_SERVER_IP</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">listen-address</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.101.1</span></span>
<span class="line"><span style="color:#24292E;">listen-address</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">VPN_SERVER_IP</span></span></code></pre></div><p>然后重启dnsmasq就可以正常解析。</p><blockquote><p>为了安全起见，实际我是只监听tun接口提供服务，这样只有VPN客户端可以访问DNS</p></blockquote><h2 id="_9-密码文件-二次认证" tabindex="-1">9.密码文件+二次认证 <a class="header-anchor" href="#_9-密码文件-二次认证" aria-label="Permalink to &quot;9.密码文件+二次认证&quot;">​</a></h2><p>文档，<a href="https://ocserv.gitlab.io/www/recipes-ocserv-2fa.html" target="_blank" rel="noreferrer">https://ocserv.gitlab.io/www/recipes-ocserv-2fa.html</a></p><p><a href="https://github.com/archiecobbs/mod-authn-otp/wiki/UsersFile" target="_blank" rel="noreferrer">https://github.com/archiecobbs/mod-authn-otp/wiki/UsersFile</a></p><p>Since version 0.10.9 it is possible to use ocserv’s password file for 2FA. It requires ocserv to be compiled with liboath</p><h3 id="_9-1创建otp文件" tabindex="-1">9.1创建otp文件 <a class="header-anchor" href="#_9-1创建otp文件" aria-label="Permalink to &quot;9.1创建otp文件&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;HOTP/T30 han - $(</span><span style="color:#B392F0;">head</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">16</span><span style="color:#9ECBFF;"> /dev/urandom </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">xxd</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">256</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-ps</span><span style="color:#9ECBFF;">)&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/ocserv/users.oath</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看users.oath文件</span></span>
<span class="line"><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users.oath</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#B392F0;">HOTP/T30</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">han</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">d3856253575278b553d7e2217263e6ae</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#install </span></span>
<span class="line"><span style="color:#B392F0;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">oathtool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">oathtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--totp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-w</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">d3856253575278b553d7e2217263e6ae</span></span>
<span class="line"><span style="color:#B392F0;">625845</span></span>
<span class="line"><span style="color:#B392F0;">466831</span></span>
<span class="line"><span style="color:#B392F0;">507674</span></span>
<span class="line"><span style="color:#B392F0;">845042</span></span>
<span class="line"><span style="color:#B392F0;">611568</span></span>
<span class="line"><span style="color:#B392F0;">079778</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#生成密钥，生成二维码 一般的otp工具可以进行扫描添加或者手动输入秘钥添加，这里进行二维码生成后便于直接扫描添加 使用以下命令将KEY转换为base32(在0x后面一样记得替换自己的KEY)</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0xd3856253575278b553d7e2217263e6ae</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">xxd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">256</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">base32</span></span>
<span class="line"><span style="color:#E1E4E8;">2OCWEU2XKJ4LKU6X4IQXEY7GVY</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">=====</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#qrencode创建一个二维码</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apt-get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">qrencode</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;otpauth://totp/kay@example.com?secret=2OCWEU2XKJ4LKU6X4IQXEY7GVY&amp;issuer=OpenConnect&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">qrencode</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-o</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-t</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">UTF8</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;HOTP/T30 han - $(</span><span style="color:#6F42C1;">head</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-c</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">16</span><span style="color:#032F62;"> /dev/urandom </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">xxd</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-c</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">256</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-ps</span><span style="color:#032F62;">)&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ocserv/users.oath</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看users.oath文件</span></span>
<span class="line"><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users.oath</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">HOTP/T30</span><span style="color:#24292E;"> </span><span style="color:#032F62;">han</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span><span style="color:#24292E;"> </span><span style="color:#032F62;">d3856253575278b553d7e2217263e6ae</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#install </span></span>
<span class="line"><span style="color:#6F42C1;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">oathtool</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">oathtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--totp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-w</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span><span style="color:#24292E;"> </span><span style="color:#032F62;">d3856253575278b553d7e2217263e6ae</span></span>
<span class="line"><span style="color:#6F42C1;">625845</span></span>
<span class="line"><span style="color:#6F42C1;">466831</span></span>
<span class="line"><span style="color:#6F42C1;">507674</span></span>
<span class="line"><span style="color:#6F42C1;">845042</span></span>
<span class="line"><span style="color:#6F42C1;">611568</span></span>
<span class="line"><span style="color:#6F42C1;">079778</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#生成密钥，生成二维码 一般的otp工具可以进行扫描添加或者手动输入秘钥添加，这里进行二维码生成后便于直接扫描添加 使用以下命令将KEY转换为base32(在0x后面一样记得替换自己的KEY)</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0xd3856253575278b553d7e2217263e6ae</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">xxd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-r</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-c</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">256</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">base32</span></span>
<span class="line"><span style="color:#24292E;">2OCWEU2XKJ4LKU6X4IQXEY7GVY</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">=====</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#qrencode创建一个二维码</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apt-get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">qrencode</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;otpauth://totp/kay@example.com?secret=2OCWEU2XKJ4LKU6X4IQXEY7GVY&amp;issuer=OpenConnect&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">qrencode</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-o</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-t</span><span style="color:#24292E;"> </span><span style="color:#032F62;">UTF8</span></span></code></pre></div><h3 id="_9-2ocserv配置" tabindex="-1">9.2ocserv配置 <a class="header-anchor" href="#_9-2ocserv配置" aria-label="Permalink to &quot;9.2ocserv配置&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">auth</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;plain[passwd=/etc/ocserv/passwd,otp=/etc/ocserv/users.oath]&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">auth</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;plain[passwd=/etc/ocserv/passwd,otp=/etc/ocserv/users.oath]&quot;</span></span></code></pre></div><h2 id="_10-限速" tabindex="-1">10.限速 <a class="header-anchor" href="#_10-限速" aria-label="Permalink to &quot;10.限速&quot;">​</a></h2><p>1）为userA新建配置文件</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">        # vi /usr/local/ocserv/etc/config-per-user/userA</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">        # vi /usr/local/ocserv/etc/config-per-user/userA</span></span></code></pre></div><p>在上述文件添加下述信息：</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">        route = 192.168.11.0/24 #局部路由，userA需要路由的IP或者IP段</span></span>
<span class="line"><span style="color:#e1e4e8;">        rx-data-per-sec = 2000000 #实现接收限速配置</span></span>
<span class="line"><span style="color:#e1e4e8;">        tx-data-per-sec = 2000000  #实现发送限速配置</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">        route = 192.168.11.0/24 #局部路由，userA需要路由的IP或者IP段</span></span>
<span class="line"><span style="color:#24292e;">        rx-data-per-sec = 2000000 #实现接收限速配置</span></span>
<span class="line"><span style="color:#24292e;">        tx-data-per-sec = 2000000  #实现发送限速配置</span></span></code></pre></div><p>（2）修改ocserv的配置文件sample.conf</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">        # vi /usr/local/ocserv/etc/sample.conf</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">        # vi /usr/local/ocserv/etc/sample.conf</span></span></code></pre></div><p>在sample.conf配置文件中添加以下配置：</p><div class="language-text vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">text</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">        config-per-user = /usr/local/ocserv/etc/config-per-user/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">        config-per-user = /usr/local/ocserv/etc/config-per-user/</span></span></code></pre></div><h2 id="_11-记录用户登录注销日志" tabindex="-1">11.记录用户登录注销日志 <a class="header-anchor" href="#_11-记录用户登录注销日志" aria-label="Permalink to &quot;11.记录用户登录注销日志&quot;">​</a></h2><p>配置文件修改：</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">connect-script</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/ocserv/connect-script</span></span>
<span class="line"><span style="color:#B392F0;">disconnect-script</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/ocserv/connect-script</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">connect-script</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ocserv/connect-script</span></span>
<span class="line"><span style="color:#6F42C1;">disconnect-script</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ocserv/connect-script</span></span></code></pre></div><p>connect-script 文件内容</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">export</span><span style="color:#E1E4E8;"> LOGFILE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/etc/ocserv/login.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#echo $USERNAME : $REASON : $DEVICE</span></span>
<span class="line"><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">$REASON</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span></span>
<span class="line"><span style="color:#E1E4E8;">  connect)</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`</span><span style="color:#B392F0;">date</span><span style="color:#9ECBFF;">\`</span><span style="color:#E1E4E8;"> $USERNAME </span><span style="color:#9ECBFF;">&quot;connected&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> $LOGFILE</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`</span><span style="color:#B392F0;">date</span><span style="color:#9ECBFF;">\`</span><span style="color:#E1E4E8;"> $REASON $USERNAME $DEVICE $IP_LOCAL $IP_REMOTE $IP_REAL </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> $LOGFILE</span></span>
<span class="line"><span style="color:#E1E4E8;">    ;;</span></span>
<span class="line"><span style="color:#E1E4E8;">  disconnect)</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`</span><span style="color:#B392F0;">date</span><span style="color:#9ECBFF;">\`</span><span style="color:#E1E4E8;"> $USERNAME </span><span style="color:#9ECBFF;">&quot;disconnected&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> $LOGFILE</span></span>
<span class="line"><span style="color:#E1E4E8;">    ;;</span></span>
<span class="line"><span style="color:#F97583;">esac</span></span>
<span class="line"><span style="color:#79B8FF;">exit</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">export</span><span style="color:#24292E;"> LOGFILE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/etc/ocserv/login.log</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#echo $USERNAME : $REASON : $DEVICE</span></span>
<span class="line"><span style="color:#D73A49;">case</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">$REASON</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span></span>
<span class="line"><span style="color:#24292E;">  connect)</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`</span><span style="color:#6F42C1;">date</span><span style="color:#032F62;">\`</span><span style="color:#24292E;"> $USERNAME </span><span style="color:#032F62;">&quot;connected&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> $LOGFILE</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`</span><span style="color:#6F42C1;">date</span><span style="color:#032F62;">\`</span><span style="color:#24292E;"> $REASON $USERNAME $DEVICE $IP_LOCAL $IP_REMOTE $IP_REAL </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> $LOGFILE</span></span>
<span class="line"><span style="color:#24292E;">    ;;</span></span>
<span class="line"><span style="color:#24292E;">  disconnect)</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`</span><span style="color:#6F42C1;">date</span><span style="color:#032F62;">\`</span><span style="color:#24292E;"> $USERNAME </span><span style="color:#032F62;">&quot;disconnected&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> $LOGFILE</span></span>
<span class="line"><span style="color:#24292E;">    ;;</span></span>
<span class="line"><span style="color:#D73A49;">esac</span></span>
<span class="line"><span style="color:#005CC5;">exit</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span></span></code></pre></div><p>⚠️ 一定要通过<code>chmod +x connect-script</code>给这个配置文件可执行权限，否则脚本无法执行同时用户登录会报错</p><p>用户登录、注销日志记录在 <code>/etc/ocserv/login.log</code></p><h2 id="_12-密码登录的用户按组别划分权限" tabindex="-1">12. 密码登录的用户按组别划分权限 <a class="header-anchor" href="#_12-密码登录的用户按组别划分权限" aria-label="Permalink to &quot;12. 密码登录的用户按组别划分权限&quot;">​</a></h2><p>修改配置文件</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">auth</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi[keytab=/etc/key.tab,require-local-user-map=true,tgt-freshness-time=900]&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">config-per-group</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/ocserv/group/</span></span>
<span class="line"><span style="color:#6A737D;">#default-group-config = /etc/ocserv/group/users</span></span>
<span class="line"><span style="color:#6A737D;">#default-select-group = users</span></span>
<span class="line"><span style="color:#B392F0;">auto-select-group</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">auth</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;certificate&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi[keytab=/etc/key.tab,require-local-user-map=true,tgt-freshness-time=900]&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">config-per-group</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ocserv/group/</span></span>
<span class="line"><span style="color:#6A737D;">#default-group-config = /etc/ocserv/group/users</span></span>
<span class="line"><span style="color:#6A737D;">#default-select-group = users</span></span>
<span class="line"><span style="color:#6F42C1;">auto-select-group</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">false</span></span></code></pre></div><p>在用户密码保存文件<code>/etc/ocserv/ocpasswd</code>中配置用户组,用户组配置在用户名和密码之间，中间用:分隔.组名可以自定义，和/etc/ocserv/group/里面的文件对应即可</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">user1:group1:$5$124fVO/ctAyf.azb$ZR4GUQNtScnL3lPdSJqVUaAKNGb7</span></span>
<span class="line"><span style="color:#e1e4e8;">user2:group2:$5$bINdojFGGgzv0G84$YkPB5P.fZIZnH1uWr7IjapI4A</span></span>
<span class="line"><span style="color:#e1e4e8;">user3:group3:$5$WHVrqmSibrwtIayE$6tM9DNm9fIfzrVYqi4.nPBBO7</span></span>
<span class="line"><span style="color:#e1e4e8;">user4:$5$WHVrqmSibrwtIayE$6tM9DNm9fIfzrVYqi4.nPBBO7</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">user1:group1:$5$124fVO/ctAyf.azb$ZR4GUQNtScnL3lPdSJqVUaAKNGb7</span></span>
<span class="line"><span style="color:#24292e;">user2:group2:$5$bINdojFGGgzv0G84$YkPB5P.fZIZnH1uWr7IjapI4A</span></span>
<span class="line"><span style="color:#24292e;">user3:group3:$5$WHVrqmSibrwtIayE$6tM9DNm9fIfzrVYqi4.nPBBO7</span></span>
<span class="line"><span style="color:#24292e;">user4:$5$WHVrqmSibrwtIayE$6tM9DNm9fIfzrVYqi4.nPBBO7</span></span></code></pre></div><p>user4没有分配至用户组，则默认按ocserv.conf配置文件里的路由</p><p>另外划分了三个组，分别为</p><ul><li>group1</li><li>group2</li><li>group3</li></ul><p>需要分别为这三个组赋予用户可访问的网络资源 分别新建三个文件</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">/etc/ocserv/group/group1</span></span>
<span class="line"><span style="color:#e1e4e8;">/etc/ocserv/group/group2</span></span>
<span class="line"><span style="color:#e1e4e8;">/etc/ocserv/group/group3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">/etc/ocserv/group/group1</span></span>
<span class="line"><span style="color:#24292e;">/etc/ocserv/group/group2</span></span>
<span class="line"><span style="color:#24292e;">/etc/ocserv/group/group3</span></span></code></pre></div><p>group1 文件内容为:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">route = 10.0.1.0/255.255.255.0</span></span>
<span class="line"><span style="color:#e1e4e8;">route = 10.0.0.0/255.255.255.0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">route = 10.0.1.0/255.255.255.0</span></span>
<span class="line"><span style="color:#24292e;">route = 10.0.0.0/255.255.255.0</span></span></code></pre></div><p>则属于group1的用户可以访问10.0.0.0/24 和10.0.1.0/24的内容</p><p>group2 文件内空如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">dns=223.5.5.5</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">dns=223.5.5.5</span></span></code></pre></div><p>则属于group2的用户，所有流量都会转发至ocserv服务器</p><p>group3的文件内容如下</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">route = 10.0.0.2/255.255.255.255</span></span>
<span class="line"><span style="color:#e1e4e8;">route = 10.0.0.1/255.255.255.255</span></span>
<span class="line"><span style="color:#e1e4e8;">restrict-user-to-ports = &quot;tcp(8080), tcp(80), udp(53), icmp()&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">route = 10.0.0.2/255.255.255.255</span></span>
<span class="line"><span style="color:#24292e;">route = 10.0.0.1/255.255.255.255</span></span>
<span class="line"><span style="color:#24292e;">restrict-user-to-ports = &quot;tcp(8080), tcp(80), udp(53), icmp()&quot;</span></span></code></pre></div><p>则属于group3组的用户只能访问10.0.0.1、10.0.0.2两个IP的tcp8080、tcp80、udp53端口和icmp</p><h2 id="_13-证书认证" tabindex="-1">13.证书认证 <a class="header-anchor" href="#_13-证书认证" aria-label="Permalink to &quot;13.证书认证&quot;">​</a></h2><p>修改ocserv.conf</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#只启用证书认证</span></span>
<span class="line"><span style="color:#B392F0;">auth</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#服务器ssl证书</span></span>
<span class="line"><span style="color:#B392F0;">server-cert</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/certs/server_cert/ssl-cert.pem</span></span>
<span class="line"><span style="color:#B392F0;">server-key</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/certs/server_cert/ssl-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#CA根证书</span></span>
<span class="line"><span style="color:#B392F0;">ca-cert</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/certs/ca_cert/ca-cert.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户识别</span></span>
<span class="line"><span style="color:#B392F0;">cert-user-oid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span><span style="color:#9ECBFF;">.4.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户组识别，这个需要注释掉，否则思科客户端证书认证不成功。openconnect客户端正常</span></span>
<span class="line"><span style="color:#6A737D;">#cert-group-oid = 2.5.4.11</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#兼容思科anyconnect 客户端</span></span>
<span class="line"><span style="color:#B392F0;">cisco-client-compat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#只启用证书认证</span></span>
<span class="line"><span style="color:#6F42C1;">auth</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#服务器ssl证书</span></span>
<span class="line"><span style="color:#6F42C1;">server-cert</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/certs/server_cert/ssl-cert.pem</span></span>
<span class="line"><span style="color:#6F42C1;">server-key</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/certs/server_cert/ssl-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#CA根证书</span></span>
<span class="line"><span style="color:#6F42C1;">ca-cert</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/certs/ca_cert/ca-cert.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户识别</span></span>
<span class="line"><span style="color:#6F42C1;">cert-user-oid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span><span style="color:#032F62;">.4.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户组识别，这个需要注释掉，否则思科客户端证书认证不成功。openconnect客户端正常</span></span>
<span class="line"><span style="color:#6A737D;">#cert-group-oid = 2.5.4.11</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#兼容思科anyconnect 客户端</span></span>
<span class="line"><span style="color:#6F42C1;">cisco-client-compat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span></code></pre></div><p>以上为只启用证书认证的配置，若优先用户为密码认证，备用证书认证，则</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">auth</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#B392F0;">enable-auth</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;"># Specify alternative authentication methods that are sufficient</span></span>
<span class="line"><span style="color:#6A737D;"># for authentication. That is, if set, any of the methods enabled</span></span>
<span class="line"><span style="color:#6A737D;"># will be sufficient to login.</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi[keytab=/etc/key.tab,require-local-user-map=true,tgt-freshness-time=900]&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">auth</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;plain[passwd=/etc/ocserv/ocpasswd]&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">enable-auth</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius[config=/etc/radiusclient/radiusclient.conf,groupconfig=true]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#auth = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/radcli/radiusclient.conf,groupconfig=false]&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#acct = &quot;radius [config=/etc/ocserv/radiusclient.conf]&quot;</span></span>
<span class="line"><span style="color:#6A737D;"># Specify alternative authentication methods that are sufficient</span></span>
<span class="line"><span style="color:#6A737D;"># for authentication. That is, if set, any of the methods enabled</span></span>
<span class="line"><span style="color:#6A737D;"># will be sufficient to login.</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#enable-auth = &quot;gssapi[keytab=/etc/key.tab,require-local-user-map=true,tgt-freshness-time=900]&quot;</span></span></code></pre></div><h3 id="_1-证书生成" tabindex="-1">1.证书生成 <a class="header-anchor" href="#_1-证书生成" aria-label="Permalink to &quot;1.证书生成&quot;">​</a></h3><p>vim gen_cert.sh</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">generate_ca</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Generate a CA Private Key</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">certtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--generate-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rsa</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--bits</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4096</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--outfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Generate a CA Certificate</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ca-temp.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#9ECBFF;">cn = &quot;Root CA&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">organization = &quot;vpn.test.cn&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">serial = 001</span></span>
<span class="line"><span style="color:#9ECBFF;">expiration_days = -1</span></span>
<span class="line"><span style="color:#9ECBFF;">ca</span></span>
<span class="line"><span style="color:#9ECBFF;">signing_key  </span></span>
<span class="line"><span style="color:#9ECBFF;">cert_signing_key  </span></span>
<span class="line"><span style="color:#9ECBFF;">crl_signing_key  </span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">certtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--generate-self-signed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-key.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--template</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ca-temp.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--outfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-cert.pem</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">rm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ca-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">exit</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">generate_server_cert</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">read</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Enter Domain Name: &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">domain_name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Server Private Key</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">certtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--generate-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rsa</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--bits</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4096</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--outfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./server_cert/</span><span style="color:#E1E4E8;">$domain_name</span><span style="color:#9ECBFF;">-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Server Certificate</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;organization = </span><span style="color:#E1E4E8;">$domain_name</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server-temp.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">EOF</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">server-temp.txt</span></span>
<span class="line"><span style="color:#9ECBFF;">cn = </span><span style="color:#E1E4E8;">$domain_name</span></span>
<span class="line"><span style="color:#9ECBFF;">organization = </span><span style="color:#E1E4E8;">$domain_name</span></span>
<span class="line"><span style="color:#9ECBFF;">serial = 2</span></span>
<span class="line"><span style="color:#9ECBFF;">expiration_days = 360</span></span>
<span class="line"><span style="color:#9ECBFF;">signing_key</span></span>
<span class="line"><span style="color:#9ECBFF;">encryption_key </span></span>
<span class="line"><span style="color:#9ECBFF;">tls_www_server</span></span>
<span class="line"><span style="color:#9ECBFF;">dns_name = </span><span style="color:#E1E4E8;">$domain_name</span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">certtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--generate-certificate</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--hash</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SHA256</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./server_cert/</span><span style="color:#E1E4E8;">$domain_name</span><span style="color:#9ECBFF;">-key.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-ca-certificate</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-cert.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-ca-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-key.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--template</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server-temp.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--outfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./server_cert/</span><span style="color:#E1E4E8;">$domain_name</span><span style="color:#9ECBFF;">-cert.pem</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">rm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">exit</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">generate_user_cert</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">read</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Enter Username: &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">username</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">read</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Enter Group: &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">group</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># User Private Key</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">certtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--generate-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--rsa</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--bits</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4096</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--outfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./user_cert/</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># User Certificate</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;cn = </span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">#echo &quot;uid = $username&quot; &gt;&gt; user-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;organization = vpn.test.cn&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;unit = </span><span style="color:#E1E4E8;">$group</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;signing_key&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;tls_www_client&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">certtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--generate-certificate</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--hash</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SHA256</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./user_cert/</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">-key.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-ca-certificate</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-cert.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-ca-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-key.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--template</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user-temp.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--outfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./user_cert/</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">-cert.pem</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">rm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user-temp.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># User Certificate in PKCS#12 Format</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">openssl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pkcs12</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-export</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./user_cert/</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">-cert.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-inkey</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./user_cert/</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">-key.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-certfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-cert.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-out</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./user_cert/</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">.p12</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;"> User Certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">#certtool --to-p12 --load-privkey ./user_cert/$username-key.pem --load-certificate ./user_cert/$username-cert.pem --pkcs-cipher 3des-pkcs12 --outfile ./user_cert/$username-ios.p12 --outder</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">exit</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">function</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">revoke_user_cert</span><span style="color:#E1E4E8;">() {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">read</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Enter Username to Revoke: &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">username</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># Revoke Certificate</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;crl_next_update = 365&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">revoke-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;crl_number = 1&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">revoke-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">certtool</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--generate-crl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--hash</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SHA256</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-ca-privkey</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-key.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-ca-certificate</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./ca_cert/ca-cert.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--load-certificate</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./user_cert/</span><span style="color:#E1E4E8;">$username</span><span style="color:#9ECBFF;">-cert.pem</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--template</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">revoke-temp.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--outfile</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">crl.pem</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">rm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">revoke-temp.txt</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">exit</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">dirs</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;ca_cert&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;server_cert&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;user_cert&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 遍历目录名</span></span>
<span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> dir </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;\${</span><span style="color:#E1E4E8;">dirs</span><span style="color:#9ECBFF;">[@]}&quot;</span></span>
<span class="line"><span style="color:#F97583;">do</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># 如果目录不存在，则创建它</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> [[ </span><span style="color:#F97583;">!</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">-d</span><span style="color:#E1E4E8;"> $dir ]]; </span><span style="color:#F97583;">then</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Directory </span><span style="color:#E1E4E8;">$dir</span><span style="color:#9ECBFF;"> does not exist. Creating now...&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> $dir</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Directory </span><span style="color:#E1E4E8;">$dir</span><span style="color:#9ECBFF;"> created.&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">else</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Directory </span><span style="color:#E1E4E8;">$dir</span><span style="color:#9ECBFF;"> exists.&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">fi</span></span>
<span class="line"><span style="color:#F97583;">done</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">PS3</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;Please enter your choice: &#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">options</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Generate CA Certificate&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Generate Server Certificate&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Generate User Certificate&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Revoke User Certificate&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Quit&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> opt </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;\${</span><span style="color:#E1E4E8;">options</span><span style="color:#9ECBFF;">[@]}&quot;</span></span>
<span class="line"><span style="color:#F97583;">do</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">case</span><span style="color:#E1E4E8;"> $opt </span><span style="color:#F97583;">in</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;Generate CA Certificate&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">generate_ca</span></span>
<span class="line"><span style="color:#E1E4E8;">            ;;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;Generate Server Certificate&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">generate_server_cert</span></span>
<span class="line"><span style="color:#E1E4E8;">            ;;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;Generate User Certificate&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">generate_user_cert</span></span>
<span class="line"><span style="color:#E1E4E8;">            ;;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;Revoke User Certificate&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">revoke_user_cert</span></span>
<span class="line"><span style="color:#E1E4E8;">            ;;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">&quot;Quit&quot;</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">break</span></span>
<span class="line"><span style="color:#E1E4E8;">            ;;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">) echo </span><span style="color:#9ECBFF;">&quot;invalid option </span><span style="color:#E1E4E8;">$REPLY</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#E1E4E8;">;;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">esac</span></span>
<span class="line"><span style="color:#F97583;">done</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#!/bin/bash</span></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">generate_ca</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Generate a CA Private Key</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">certtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--generate-privkey</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rsa</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--bits</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4096</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--outfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Generate a CA Certificate</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ca-temp.txt</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#032F62;">cn = &quot;Root CA&quot;</span></span>
<span class="line"><span style="color:#032F62;">organization = &quot;vpn.test.cn&quot;</span></span>
<span class="line"><span style="color:#032F62;">serial = 001</span></span>
<span class="line"><span style="color:#032F62;">expiration_days = -1</span></span>
<span class="line"><span style="color:#032F62;">ca</span></span>
<span class="line"><span style="color:#032F62;">signing_key  </span></span>
<span class="line"><span style="color:#032F62;">cert_signing_key  </span></span>
<span class="line"><span style="color:#032F62;">crl_signing_key  </span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">certtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--generate-self-signed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-privkey</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-key.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--template</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ca-temp.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--outfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-cert.pem</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">rm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ca-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">exit</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">generate_server_cert</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">read</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Enter Domain Name: &quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">domain_name</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Server Private Key</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">certtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--generate-privkey</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rsa</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--bits</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4096</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">--outfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./server_cert/</span><span style="color:#24292E;">$domain_name</span><span style="color:#032F62;">-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Server Certificate</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;organization = </span><span style="color:#24292E;">$domain_name</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server-temp.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">EOF</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">server-temp.txt</span></span>
<span class="line"><span style="color:#032F62;">cn = </span><span style="color:#24292E;">$domain_name</span></span>
<span class="line"><span style="color:#032F62;">organization = </span><span style="color:#24292E;">$domain_name</span></span>
<span class="line"><span style="color:#032F62;">serial = 2</span></span>
<span class="line"><span style="color:#032F62;">expiration_days = 360</span></span>
<span class="line"><span style="color:#032F62;">signing_key</span></span>
<span class="line"><span style="color:#032F62;">encryption_key </span></span>
<span class="line"><span style="color:#032F62;">tls_www_server</span></span>
<span class="line"><span style="color:#032F62;">dns_name = </span><span style="color:#24292E;">$domain_name</span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">certtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--generate-certificate</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--hash</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SHA256</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-privkey</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./server_cert/</span><span style="color:#24292E;">$domain_name</span><span style="color:#032F62;">-key.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-ca-certificate</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-cert.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-ca-privkey</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-key.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--template</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server-temp.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--outfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./server_cert/</span><span style="color:#24292E;">$domain_name</span><span style="color:#032F62;">-cert.pem</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">rm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">exit</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">generate_user_cert</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">read</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Enter Username: &quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">username</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">read</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Enter Group: &quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">group</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># User Private Key</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">certtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--generate-privkey</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--rsa</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--bits</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4096</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--outfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./user_cert/</span><span style="color:#24292E;">$username</span><span style="color:#032F62;">-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># User Certificate</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;cn = </span><span style="color:#24292E;">$username</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">#echo &quot;uid = $username&quot; &gt;&gt; user-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;organization = vpn.test.cn&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;unit = </span><span style="color:#24292E;">$group</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;signing_key&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;tls_www_client&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">certtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--generate-certificate</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--hash</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SHA256</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-privkey</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./user_cert/</span><span style="color:#24292E;">$username</span><span style="color:#032F62;">-key.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-ca-certificate</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-cert.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-ca-privkey</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-key.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--template</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user-temp.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--outfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./user_cert/</span><span style="color:#24292E;">$username</span><span style="color:#032F62;">-cert.pem</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">rm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user-temp.txt</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># User Certificate in PKCS#12 Format</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">openssl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pkcs12</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-export</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./user_cert/</span><span style="color:#24292E;">$username</span><span style="color:#032F62;">-cert.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-inkey</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./user_cert/</span><span style="color:#24292E;">$username</span><span style="color:#032F62;">-key.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-certfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-cert.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-out</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./user_cert/</span><span style="color:#24292E;">$username</span><span style="color:#032F62;">.p12</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">$username</span><span style="color:#032F62;"> User Certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;">#certtool --to-p12 --load-privkey ./user_cert/$username-key.pem --load-certificate ./user_cert/$username-cert.pem --pkcs-cipher 3des-pkcs12 --outfile ./user_cert/$username-ios.p12 --outder</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">exit</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">function</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">revoke_user_cert</span><span style="color:#24292E;">() {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">read</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Enter Username to Revoke: &quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">username</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># Revoke Certificate</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;crl_next_update = 365&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">revoke-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;crl_number = 1&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">revoke-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">certtool</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--generate-crl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--hash</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SHA256</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-ca-privkey</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-key.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-ca-certificate</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./ca_cert/ca-cert.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--load-certificate</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./user_cert/</span><span style="color:#24292E;">$username</span><span style="color:#032F62;">-cert.pem</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--template</span><span style="color:#24292E;"> </span><span style="color:#032F62;">revoke-temp.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--outfile</span><span style="color:#24292E;"> </span><span style="color:#032F62;">crl.pem</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">rm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">revoke-temp.txt</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#005CC5;">exit</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">dirs</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;ca_cert&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;server_cert&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;user_cert&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 遍历目录名</span></span>
<span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> dir </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;\${</span><span style="color:#24292E;">dirs</span><span style="color:#032F62;">[@]}&quot;</span></span>
<span class="line"><span style="color:#D73A49;">do</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># 如果目录不存在，则创建它</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> [[ </span><span style="color:#D73A49;">!</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">-d</span><span style="color:#24292E;"> $dir ]]; </span><span style="color:#D73A49;">then</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Directory </span><span style="color:#24292E;">$dir</span><span style="color:#032F62;"> does not exist. Creating now...&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> $dir</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Directory </span><span style="color:#24292E;">$dir</span><span style="color:#032F62;"> created.&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">else</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Directory </span><span style="color:#24292E;">$dir</span><span style="color:#032F62;"> exists.&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">fi</span></span>
<span class="line"><span style="color:#D73A49;">done</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">PS3</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;Please enter your choice: &#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">options</span><span style="color:#D73A49;">=</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Generate CA Certificate&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Generate Server Certificate&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Generate User Certificate&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Revoke User Certificate&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Quit&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#D73A49;">select</span><span style="color:#24292E;"> opt </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;\${</span><span style="color:#24292E;">options</span><span style="color:#032F62;">[@]}&quot;</span></span>
<span class="line"><span style="color:#D73A49;">do</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">case</span><span style="color:#24292E;"> $opt </span><span style="color:#D73A49;">in</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;Generate CA Certificate&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">generate_ca</span></span>
<span class="line"><span style="color:#24292E;">            ;;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;Generate Server Certificate&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">generate_server_cert</span></span>
<span class="line"><span style="color:#24292E;">            ;;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;Generate User Certificate&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">generate_user_cert</span></span>
<span class="line"><span style="color:#24292E;">            ;;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;Revoke User Certificate&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#6F42C1;">revoke_user_cert</span></span>
<span class="line"><span style="color:#24292E;">            ;;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#032F62;">&quot;Quit&quot;</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">break</span></span>
<span class="line"><span style="color:#24292E;">            ;;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">) echo </span><span style="color:#032F62;">&quot;invalid option </span><span style="color:#24292E;">$REPLY</span><span style="color:#032F62;">&quot;</span><span style="color:#24292E;">;;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">esac</span></span>
<span class="line"><span style="color:#D73A49;">done</span></span></code></pre></div><h3 id="_2-证书认证分组配置" tabindex="-1">2.证书认证分组配置 <a class="header-anchor" href="#_2-证书认证分组配置" aria-label="Permalink to &quot;2.证书认证分组配置&quot;">​</a></h3><p>⚠️ 测试发现使用openconnect 客户端正常，但使用思科anyconnect客户端无法正常登录</p><p>若需要证书认证的同时用户能够根据不同的用户组分配权限.</p><p>生成的用户证书需要配置OU属性，服务器根据OU判断用户组</p><p>同时修改ocserv.conf</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#只启用证书认证</span></span>
<span class="line"><span style="color:#B392F0;">auth</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#服务器ssl证书</span></span>
<span class="line"><span style="color:#B392F0;">server-cert</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/certs/server_cert/ssl-cert.pem</span></span>
<span class="line"><span style="color:#B392F0;">server-key</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/certs/server_cert/ssl-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#CA根证书</span></span>
<span class="line"><span style="color:#B392F0;">ca-cert</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/opt/certs/ca_cert/ca-cert.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户识别</span></span>
<span class="line"><span style="color:#B392F0;">cert-user-oid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span><span style="color:#9ECBFF;">.4.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户组识别，这个需要注释掉，否则思科客户端证书认证不成功</span></span>
<span class="line"><span style="color:#B392F0;">cert-group-oid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2.5</span><span style="color:#9ECBFF;">.4.11</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#兼容思科anyconnect 客户端</span></span>
<span class="line"><span style="color:#B392F0;">cisco-client-compat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">config-per-group</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/ocserv/group/</span></span>
<span class="line"><span style="color:#6A737D;">#default-group-config = /etc/ocserv/group/users</span></span>
<span class="line"><span style="color:#6A737D;">#default-select-group = users</span></span>
<span class="line"><span style="color:#B392F0;">auto-select-group</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#只启用证书认证</span></span>
<span class="line"><span style="color:#6F42C1;">auth</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;certificate&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#服务器ssl证书</span></span>
<span class="line"><span style="color:#6F42C1;">server-cert</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/certs/server_cert/ssl-cert.pem</span></span>
<span class="line"><span style="color:#6F42C1;">server-key</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/certs/server_cert/ssl-key.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#CA根证书</span></span>
<span class="line"><span style="color:#6F42C1;">ca-cert</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/opt/certs/ca_cert/ca-cert.pem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户识别</span></span>
<span class="line"><span style="color:#6F42C1;">cert-user-oid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span><span style="color:#032F62;">.4.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#证书用户组识别，这个需要注释掉，否则思科客户端证书认证不成功</span></span>
<span class="line"><span style="color:#6F42C1;">cert-group-oid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2.5</span><span style="color:#032F62;">.4.11</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#兼容思科anyconnect 客户端</span></span>
<span class="line"><span style="color:#6F42C1;">cisco-client-compat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">config-per-group</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/ocserv/group/</span></span>
<span class="line"><span style="color:#6A737D;">#default-group-config = /etc/ocserv/group/users</span></span>
<span class="line"><span style="color:#6A737D;">#default-select-group = users</span></span>
<span class="line"><span style="color:#6F42C1;">auto-select-group</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">true</span></span></code></pre></div><h3 id="_3-用户组权限" tabindex="-1">3.用户组权限 <a class="header-anchor" href="#_3-用户组权限" aria-label="Permalink to &quot;3.用户组权限&quot;">​</a></h3><p>配置三个用户组 user1 、 user2 、admin</p><p>在/etc/ocserv/group分别建立三个文件 user1 、user2 、 admin</p><p>user1: (DNS隧道分离)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">dns</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#79B8FF;">223.5</span><span style="color:#9ECBFF;">.5.5</span></span>
<span class="line"><span style="color:#B392F0;">dns</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#79B8FF;">114.114</span><span style="color:#9ECBFF;">.114.114</span></span>
<span class="line"><span style="color:#B392F0;">split-dns</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">wiki.test.cn</span></span>
<span class="line"><span style="color:#B392F0;">route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10.0</span><span style="color:#9ECBFF;">.1.0/255.255.255.0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">dns</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#005CC5;">223.5</span><span style="color:#032F62;">.5.5</span></span>
<span class="line"><span style="color:#6F42C1;">dns</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#005CC5;">114.114</span><span style="color:#032F62;">.114.114</span></span>
<span class="line"><span style="color:#6F42C1;">split-dns</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">wiki.test.cn</span></span>
<span class="line"><span style="color:#6F42C1;">route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10.0</span><span style="color:#032F62;">.1.0/255.255.255.0</span></span></code></pre></div><p>user2: (限制指定端口)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">dns</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#79B8FF;">223.5</span><span style="color:#9ECBFF;">.5.5</span></span>
<span class="line"><span style="color:#B392F0;">route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10.0</span><span style="color:#9ECBFF;">.0.2/255.255.255.255</span></span>
<span class="line"><span style="color:#B392F0;">route</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10.0</span><span style="color:#9ECBFF;">.0.1/255.255.255.255</span></span>
<span class="line"><span style="color:#B392F0;">restrict-user-to-ports</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;tcp(8080), tcp(445), tcp(80), udp(443), sctp(99), tcp(583), icmp(), icmpv6()&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">dns</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#005CC5;">223.5</span><span style="color:#032F62;">.5.5</span></span>
<span class="line"><span style="color:#6F42C1;">route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10.0</span><span style="color:#032F62;">.0.2/255.255.255.255</span></span>
<span class="line"><span style="color:#6F42C1;">route</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10.0</span><span style="color:#032F62;">.0.1/255.255.255.255</span></span>
<span class="line"><span style="color:#6F42C1;">restrict-user-to-ports</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;tcp(8080), tcp(445), tcp(80), udp(443), sctp(99), tcp(583), icmp(), icmpv6()&quot;</span></span></code></pre></div><p>admin: (所有流量都走VPN)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">dns</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">223.5</span><span style="color:#9ECBFF;">.5.5</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">dns</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">223.5</span><span style="color:#032F62;">.5.5</span></span></code></pre></div><h1 id="_2-ocserv结合dnsmasq" tabindex="-1">2. ocserv结合dnsmasq <a class="header-anchor" href="#_2-ocserv结合dnsmasq" aria-label="Permalink to &quot;2. ocserv结合dnsmasq&quot;">​</a></h1><h2 id="_2-1-安装dnsmasq" tabindex="-1">2.1 安装dnsmasq <a class="header-anchor" href="#_2-1-安装dnsmasq" aria-label="Permalink to &quot;2.1 安装dnsmasq&quot;">​</a></h2><p>Ubuntu 22.04 默认使用 <code>systemd-resolved</code>，它可能会绕过 <code>dnsmasq</code>。关闭 <code>systemd-resolved</code>：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">systemctl stop systemd-resolved</span></span>
<span class="line"><span style="color:#e1e4e8;">systemctl disable systemd-resolved</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">systemctl stop systemd-resolved</span></span>
<span class="line"><span style="color:#24292e;">systemctl disable systemd-resolved</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">update</span></span>
<span class="line"><span style="color:#B392F0;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dnsmasq</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">update</span></span>
<span class="line"><span style="color:#6F42C1;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dnsmasq</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span></code></pre></div><ul><li>配置resolv.conf</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;nameserver 172.31.21.98&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tee</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/resolv.conf</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;nameserver 172.31.21.98&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tee</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/resolv.conf</span></span></code></pre></div><p>本地走dnsmasq</p><h2 id="_2-2-配置dnsmasq" tabindex="-1">2.2 配置dnsmasq <a class="header-anchor" href="#_2-2-配置dnsmasq" aria-label="Permalink to &quot;2.2 配置dnsmasq&quot;">​</a></h2><ul><li><p>创建</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/log/dnsmasq/</span></span>
<span class="line"><span style="color:#B392F0;">touch</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/log/dnsmasq/dnsmasq.log</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/log/dnsmasq/</span></span>
<span class="line"><span style="color:#6F42C1;">touch</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/log/dnsmasq/dnsmasq.log</span></span></code></pre></div></li><li><p>配置dnsmasq，屏蔽特定网站</p></li></ul><p>cat /etc/dnsmasq.conf</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">server</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">8.8</span><span style="color:#9ECBFF;">.8.8</span></span>
<span class="line"><span style="color:#E1E4E8;">server</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">8.8</span><span style="color:#9ECBFF;">.4.4</span></span>
<span class="line"><span style="color:#B392F0;">no-poll</span></span>
<span class="line"><span style="color:#B392F0;">clear-on-reload</span></span>
<span class="line"><span style="color:#B392F0;">no-negcache</span></span>
<span class="line"><span style="color:#E1E4E8;">resolv-file</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/etc/resolv.dnsmasq.conf</span></span>
<span class="line"><span style="color:#B392F0;">strict-order</span></span>
<span class="line"><span style="color:#E1E4E8;">interface</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">eth0</span></span>
<span class="line"><span style="color:#E1E4E8;">listen-address</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">172.31</span><span style="color:#9ECBFF;">.21.98,127.0.0.1,192.168.8.1</span></span>
<span class="line"><span style="color:#E1E4E8;">addn-hosts</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/etc/dnsmasq.hosts</span></span>
<span class="line"><span style="color:#E1E4E8;">cache-size</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># 缓存条数</span></span>
<span class="line"><span style="color:#B392F0;">log-queries</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># 记录查询日志</span></span>
<span class="line"><span style="color:#E1E4E8;">log-facility</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/var/log/dnsmasq/dnsmasq.log</span></span>
<span class="line"><span style="color:#E1E4E8;">conf-dir</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/etc/dnsmasq.d</span></span>
<span class="line"><span style="color:#E1E4E8;">conf-dir</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/etc/dnsmasq.d,.bak</span></span>
<span class="line"><span style="color:#E1E4E8;">conf-dir</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/etc/dnsmasq.d/,</span><span style="color:#79B8FF;">*</span><span style="color:#9ECBFF;">.conf</span></span>
<span class="line"><span style="color:#E1E4E8;">conf-dir</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/etc/dnsmasq.d,.rpmnew,.rpmsave,.rpmorig</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">address</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/youtube.com/0.0.0.0</span></span>
<span class="line"><span style="color:#E1E4E8;">address</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/googlevideo.com/0.0.0.0</span></span>
<span class="line"><span style="color:#E1E4E8;">address</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/youtube.com/::</span></span>
<span class="line"><span style="color:#E1E4E8;">address</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/googlevideo.com/::</span></span>
<span class="line"><span style="color:#B392F0;">no-resolv</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">server</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">8.8</span><span style="color:#032F62;">.8.8</span></span>
<span class="line"><span style="color:#24292E;">server</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">8.8</span><span style="color:#032F62;">.4.4</span></span>
<span class="line"><span style="color:#6F42C1;">no-poll</span></span>
<span class="line"><span style="color:#6F42C1;">clear-on-reload</span></span>
<span class="line"><span style="color:#6F42C1;">no-negcache</span></span>
<span class="line"><span style="color:#24292E;">resolv-file</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/etc/resolv.dnsmasq.conf</span></span>
<span class="line"><span style="color:#6F42C1;">strict-order</span></span>
<span class="line"><span style="color:#24292E;">interface</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">eth0</span></span>
<span class="line"><span style="color:#24292E;">listen-address</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">172.31</span><span style="color:#032F62;">.21.98,127.0.0.1,192.168.8.1</span></span>
<span class="line"><span style="color:#24292E;">addn-hosts</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/etc/dnsmasq.hosts</span></span>
<span class="line"><span style="color:#24292E;">cache-size</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 缓存条数</span></span>
<span class="line"><span style="color:#6F42C1;">log-queries</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 记录查询日志</span></span>
<span class="line"><span style="color:#24292E;">log-facility</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/var/log/dnsmasq/dnsmasq.log</span></span>
<span class="line"><span style="color:#24292E;">conf-dir</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/etc/dnsmasq.d</span></span>
<span class="line"><span style="color:#24292E;">conf-dir</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/etc/dnsmasq.d,.bak</span></span>
<span class="line"><span style="color:#24292E;">conf-dir</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/etc/dnsmasq.d/,</span><span style="color:#005CC5;">*</span><span style="color:#032F62;">.conf</span></span>
<span class="line"><span style="color:#24292E;">conf-dir</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/etc/dnsmasq.d,.rpmnew,.rpmsave,.rpmorig</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">address</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/youtube.com/0.0.0.0</span></span>
<span class="line"><span style="color:#24292E;">address</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/googlevideo.com/0.0.0.0</span></span>
<span class="line"><span style="color:#24292E;">address</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/youtube.com/::</span></span>
<span class="line"><span style="color:#24292E;">address</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/googlevideo.com/::</span></span>
<span class="line"><span style="color:#6F42C1;">no-resolv</span></span></code></pre></div><blockquote><p>192.168.8.1---&gt;ocserv分配的ip</p></blockquote><h2 id="_2-3-重启服务" tabindex="-1">2.3 重启服务 <a class="header-anchor" href="#_2-3-重启服务" aria-label="Permalink to &quot;2.3 重启服务&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">systemctl restart dnsmasq</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">systemctl restart dnsmasq</span></span></code></pre></div><h2 id="_2-4-配置ocserv" tabindex="-1">2.4 配置ocserv <a class="header-anchor" href="#_2-4-配置ocserv" aria-label="Permalink to &quot;2.4 配置ocserv&quot;">​</a></h2><p>修改dns走dnsmasq</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">dns</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">172.31</span><span style="color:#9ECBFF;">.21.98</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">dns</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">172.31</span><span style="color:#032F62;">.21.98</span></span></code></pre></div><ul><li>重启服务</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ocserv</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ocserv</span></span></code></pre></div><h2 id="_2-5-测试-dns-解析" tabindex="-1">2.5 测试 DNS 解析 <a class="header-anchor" href="#_2-5-测试-dns-解析" aria-label="Permalink to &quot;2.5 测试 DNS 解析&quot;">​</a></h2><ul><li>服务端测试</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nslookup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">www.youtube.com</span></span>
<span class="line"><span style="color:#B392F0;">Server:</span><span style="color:#E1E4E8;">		</span><span style="color:#79B8FF;">127.0</span><span style="color:#9ECBFF;">.0.1</span></span>
<span class="line"><span style="color:#B392F0;">Address:</span><span style="color:#E1E4E8;">	</span><span style="color:#79B8FF;">127.0</span><span style="color:#9ECBFF;">.0.1#53</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">www.youtube.com</span></span>
<span class="line"><span style="color:#B392F0;">Address:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0.0</span><span style="color:#9ECBFF;">.0.0</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">www.youtube.com</span></span>
<span class="line"><span style="color:#B392F0;">Address:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">::</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#说明屏蔽成功</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#如果你要检查 dnsmasq 是否缓存了查询结果</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dig</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">@172.31.21.98</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">youtube.com</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nslookup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">www.youtube.com</span></span>
<span class="line"><span style="color:#6F42C1;">Server:</span><span style="color:#24292E;">		</span><span style="color:#005CC5;">127.0</span><span style="color:#032F62;">.0.1</span></span>
<span class="line"><span style="color:#6F42C1;">Address:</span><span style="color:#24292E;">	</span><span style="color:#005CC5;">127.0</span><span style="color:#032F62;">.0.1#53</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">	</span><span style="color:#032F62;">www.youtube.com</span></span>
<span class="line"><span style="color:#6F42C1;">Address:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0.0</span><span style="color:#032F62;">.0.0</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">	</span><span style="color:#032F62;">www.youtube.com</span></span>
<span class="line"><span style="color:#6F42C1;">Address:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">::</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#说明屏蔽成功</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#如果你要检查 dnsmasq 是否缓存了查询结果</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dig</span><span style="color:#24292E;"> </span><span style="color:#032F62;">@172.31.21.98</span><span style="color:#24292E;"> </span><span style="color:#032F62;">youtube.com</span></span></code></pre></div><ul><li>ocserv 客户端测试</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202503310005113.png" alt="image-20250331000517741"></p><blockquote><p>提示0.0.0.0，说明成功</p></blockquote>`,190),e=[o];function c(t,r,y,E,i,F){return n(),a("div",null,e)}const d=s(l,[["render",c]]);export{u as __pageData,d as default};
