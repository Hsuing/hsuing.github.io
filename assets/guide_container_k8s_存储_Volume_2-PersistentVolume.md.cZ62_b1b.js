import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const C=JSON.parse('{"title":"1. PV与PVC基本概念","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/存储/Volume/2-PersistentVolume.md","filePath":"guide/container/k8s/存储/Volume/2-PersistentVolume.md","lastUpdated":1760705628000}'),p={name:"guide/container/k8s/存储/Volume/2-PersistentVolume.md"},o=l(`<h1 id="_1-pv与pvc基本概念" tabindex="-1">1. PV与PVC基本概念 <a class="header-anchor" href="#_1-pv与pvc基本概念" aria-label="Permalink to &quot;1. PV与PVC基本概念&quot;">​</a></h1><p>官方文档地址: <a href="https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/" target="_blank" rel="noreferrer">https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/</a></p><h2 id="_1-1-为何需要pv与pvc" tabindex="-1">1.1 为何需要PV与PVC <a class="header-anchor" href="#_1-1-为何需要pv与pvc" aria-label="Permalink to &quot;1.1 为何需要PV与PVC&quot;">​</a></h2><p>我们使用过网络存储卷来实现Pod的数据持久化以及pod间共享，也不是很复杂。如果我们使用更为复杂的网络存储来完成数据共享和持久化，在使用上会带来一些问题。首先开发人员必须清楚的了解使用的网络存储技术、同时还必须清楚不同的网络存储卷的配置方式、访问细节等。才能完成网络存储卷相关的配置任务，这就要求开发人员对该类存储有着一定的了解才能顺利使用。</p><p>但这与Kubernetes向用户和开发隐藏底层架构的目标有所背离，Kubernetes希望我们的存储资源的使用也能像计算资源一样，让我们的用户和开发无需关心存储系统是什么设备、位于何处、如何访问等。</p><h2 id="_1-2-什么是pv与pvc" tabindex="-1">1.2 什么是PV与PVC <a class="header-anchor" href="#_1-2-什么是pv与pvc" aria-label="Permalink to &quot;1.2 什么是PV与PVC&quot;">​</a></h2><p><strong>持久卷（PersistentVolume，PV）：PersistentVolume简称PV，是 <strong>对底层共享存储的一种抽象</strong>，将共享存储定义为一种资源， <strong>属于集群级别的资源，不属于任何namespace</strong>。用户使用PV需要通过PVC来申请。PV是由管理员进行创建和配置，它和具体的底层的共享存储技术实现方式有关，比如说Ceph、GlusterFS、NFS等，都是通过插件机制完成与共享存储的对接，且根据不同的存储PV配置的参数也不同。</strong></p><p><strong>持久化卷声明（PersistentVolumeClaim，PVC）：PersistentVolumeClaim 简称 PVC，<strong>表达的是用户对存储的请求，它属于一个 Namespace中的资源</strong>。PVC和Pod比较类似，Pod消耗的是Node节点资源，而PVC消耗的是PV存储资源，Pod可以请求CPU和Memory，而PVC可以请求特定的存储空间和访问模式。</strong></p><p>有了PV和PVC，开发人员无需关系底层使用的是什么网络存储卷，通过PVC描述所需要的存储类型、大小，即可完成存储资源的申领，而后通过配置清单描述Pod所需要使用的PVC即可完成存储卷的绑定和使用。这样大大的简化了用户使用存储的方式。</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406031448827.png" alt="image-20240603144642392"></p><div class="warning custom-block"><p class="custom-block-title">💡 说明</p><p>PresistentVolume(PV)是指集群管理员配置提供的某存储系统上的一段存储空间，它是对底层共享存储的抽象，将共享存储作为一种可由用户申请使用的资源，实现&quot;存储消费&quot;机制，通过存储插件，PV支持使用多种网络存储等多种后端存储系统，例如，NFS、CephFS、RBD。PV是集群级别的资源，不属于任何名称空间，用户对PV资源的使用需要通过PersistentVolumeClaim(PVC)提供的使用申请来完成绑定，PVC是PV资源的消费者，它向PV申请特定大小的空间及访问模式(rw或ro)从而创建出PVC存储卷。然后再由Pod资源通过PersistentVolumeClaim存储卷关联使用。</p><p>PersistentVolumeClaim，PVC是存储卷类型的资源，它通过申请占用某个PersistentVolume而创建，它与PV是一对一的关系，用户无须关心其底层实现细节，申请时，用户只需要指定目标空间的大小，访问模式，PV标签选择器和StorageClass等相关信息即可。</p></div><h2 id="_1-3-什么是storageclass" tabindex="-1">1.3 什么是StorageClass <a class="header-anchor" href="#_1-3-什么是storageclass" aria-label="Permalink to &quot;1.3 什么是StorageClass&quot;">​</a></h2><p><strong>一般来说，PV有多种类型：Static PV (静态)、Dynamic PV (动态)、Local PV (本地)。</strong></p><p><strong>在一个大规模的kubernetes集群里，可能会有成千上万个PVC，这就意味着，运维人员需要事先创建成千上万个PV，如果单纯靠人工来管理，会存在一定的困难。</strong></p><p><strong>Dynamic Volume Provisioning（动态PV） <strong>创建机制的核心</strong>， <strong>在于一个名为StorageClass的API对象</strong>，它是一个 <strong>用于创建PV的模板</strong>。</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">storage.k8s.io/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">StorageClass</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">managed-nfs-storage</span></span>
<span class="line"><span style="color:#85E89D;">reclaimPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Delete</span></span>
<span class="line"><span style="color:#85E89D;">provisioner</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">fuseim.pri/ifs</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># or choose another name, must match deployment&#39;s env PROVISIONER_NAME&#39;</span></span>
<span class="line"><span style="color:#85E89D;">parameters</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">archiveOnDelete</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;false&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">storage.k8s.io/v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">StorageClass</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">managed-nfs-storage</span></span>
<span class="line"><span style="color:#22863A;">reclaimPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Delete</span></span>
<span class="line"><span style="color:#22863A;">provisioner</span><span style="color:#24292E;">: </span><span style="color:#032F62;">fuseim.pri/ifs</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># or choose another name, must match deployment&#39;s env PROVISIONER_NAME&#39;</span></span>
<span class="line"><span style="color:#22863A;">parameters</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">archiveOnDelete</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;false&quot;</span></span></code></pre></div><blockquote><p>Retain - 当PVC被删除时，PV会保留，但被标识为released状态 Delete - 当PVC被删除时，PV也同时被删除 Recycle - 目前仅NFS和HostPath支持回收（Recycle）。 AWS EBS和GCE PD卷支持删除（Delete）</p></blockquote><p><strong>在YAML文件中定义PVC时，需要指定一个StorageClass名称，然后等到用户要创建这个PVC时，系统会根据PVC定义的需求，并参考StorageClass的存储细节，最后通过调用StorageClass声明的存储插件（Provisioner），动态创建出需要的PV。</strong></p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">test-claim</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volume.beta.kubernetes.io/storage-class</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;managed-nfs-storage&quot;</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">test-claim</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volume.beta.kubernetes.io/storage-class</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;managed-nfs-storage&quot;</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span></span></code></pre></div><blockquote><p><strong>所以，在声明一个PVC时，如果在PVC中添加了StorageClassName字段，那就意味着，当PVC在集群中找不到匹配的PV时，它会根据StorageClassName的定义，触发相应的Provisioner插件创建出合适的PV进行绑定。</strong></p></blockquote><h2 id="_1-4-什么是provisioner" tabindex="-1">1.4 什么是Provisioner <a class="header-anchor" href="#_1-4-什么是provisioner" aria-label="Permalink to &quot;1.4 什么是Provisioner&quot;">​</a></h2><p><strong>一般来说，PV有多种类型：Static PV (静态)、Dynamic PV (动态)、Local PV (本地)。</strong></p><p><strong>StorageClass 资源对象的定义主要包括：名称、Provisioner、存储的相关参数配置、回收策略。 <strong>StorageClass一旦被创建，则无法修改，只能删除重新创建</strong>。</strong></p><h2 id="_1-5-pv-pvc-storageclass关系" tabindex="-1">1.5 PV/PVC/StorageClass关系 <a class="header-anchor" href="#_1-5-pv-pvc-storageclass关系" aria-label="Permalink to &quot;1.5 PV/PVC/StorageClass关系&quot;">​</a></h2><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/20251015205343249.png" alt="image-20251015205341234"></p><h2 id="_1-6-pv与pvc生命周期" tabindex="-1">1.6 PV与PVC⽣命周期 <a class="header-anchor" href="#_1-6-pv与pvc生命周期" aria-label="Permalink to &quot;1.6 PV与PVC⽣命周期&quot;">​</a></h2><p><strong>PV和PVC之间的相互作用遵循这个生命周期：Provisioning（配置）----Binding（绑定）----Using（使用）----Releasing（释放）----Recycling（回收）</strong></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">1、Provisioning：即PV的创建，可以直接创建PV（静态方式），也可以使用StorageClass动态创建</span></span>
<span class="line"><span style="color:#e1e4e8;">2、Provisioning：Binding：将PV分配给PVC</span></span>
<span class="line"><span style="color:#e1e4e8;">3、Pod通过PVC使用该Volume，并可以通过准入控制StorageProtection（1.9及以前版本为PVCProtection），阻止删除正在使用的PVC</span></span>
<span class="line"><span style="color:#e1e4e8;">4、Pod释放Volume并删除PVC</span></span>
<span class="line"><span style="color:#e1e4e8;">5、回收PV，可以保留PV以便下次使用，也可以直接从云存储中删除</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">1、Provisioning：即PV的创建，可以直接创建PV（静态方式），也可以使用StorageClass动态创建</span></span>
<span class="line"><span style="color:#24292e;">2、Provisioning：Binding：将PV分配给PVC</span></span>
<span class="line"><span style="color:#24292e;">3、Pod通过PVC使用该Volume，并可以通过准入控制StorageProtection（1.9及以前版本为PVCProtection），阻止删除正在使用的PVC</span></span>
<span class="line"><span style="color:#24292e;">4、Pod释放Volume并删除PVC</span></span>
<span class="line"><span style="color:#24292e;">5、回收PV，可以保留PV以便下次使用，也可以直接从云存储中删除</span></span></code></pre></div><p><strong>根据上述五个阶段，PV的状态有以下4种</strong></p><blockquote><p><strong>Available（可用）：表示可用状态，还未被任何PVC绑定</strong></p><p><strong>Bound（已绑定）：表示PV已经绑定到PVC</strong></p><p><strong>Released（已释放）：表示PVC被删掉，但是资源尚未被集群回收</strong></p><p><strong>Failed（失败）：表示该PV的自动回收失败</strong></p></blockquote><p><strong>一个PV从创建到销毁的具体流程</strong></p><blockquote><p>1、一个PV创建完后状态会变成Available，等待被PVC绑定</p><p><strong>2、一旦被PVC绑定，PV的状态就会变成Bound，就可用被定义了相应PVC的Pod使用。</strong></p><p><strong>3、Pod使用完后会释放PV，PV的状态变成Released。</strong></p><p><strong>4、变成Released的PV会根据定义的回收策略做相应的回收工作。</strong></p></blockquote><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406031518018.png" alt="image-20240603151840822"></p><p>1、资源供应：运维⼿动创建底层存储设备，提供存储功能；</p><p>2、资源可⽤(<strong>Available</strong>)：创建PV，此时PV卷是⼀个空闲资源，尚未绑定任何PVC资源；</p><p>3、资源绑定(<strong>Bound</strong>)：⽤户创建PVC资源，根据描述绑定到符合条件的PV资源；</p><ul><li>匹配到合适的PV，就与该PV进⾏绑定，Pod应⽤也就可以使⽤该PVC作为后端存储；</li><li>如果匹配不到合适的PV，PVC则会处于Pengding状态，直到出现符合要求的PV，才会完成绑定；</li><li><code>PV⼀旦绑定上某个PVC，就会被这个PVC独占，不能在与其他PVC进⾏绑定</code></li></ul><p>4、资源使⽤：⽤户可以在Pod中定义Volumes，类型为PVC，⽽后在容器中定义VolumeMounts挂载该PVC资源；</p><p>5、资源释放(<strong>Released</strong>)：当存储资源使用完毕后，管理员可以删除PVC，与该PVC绑定的PV将会被标记为（ReLeased）状态，但不能立刻与其他PVC进行绑定，因为之前PVC写入的数据还被保留在存储设备上，只有在回收之后，该PV才能被再次使用</p><p>6、资源回收：当PV进入Released状态后，其后续的处理机制依赖于回收策略，(Rtain、Recycle、Delete)</p><blockquote><p>在 Kubernetes (k8S) 中，PersistentVolume (PV) 的生命周期内包含以下几个关键阶段：</p><ol><li><strong>Available（可用）</strong>： PV 在这个阶段被创建并添加到集群中，它具有特定的存储容量、访问模式和持久化策略。在这个状态下，PV 是未被任何 PersistentVolumeClaim (PVC) 绑定的，等待被 PVC 请求和使用。</li><li><strong>Bound（已绑定）</strong>： 当一个或多个 PVC 根据它们的需求请求存储时，如果某个 PV 的规格与 PVC 完全匹配且 PV 处于 Available 状态，Kubernetes 会将 PV 与 PVC 进行绑定。绑定后，PV 的状态变为 Bound，并将其存储资源分配给对应的 PVC 所关联的 Pod 使用。</li><li><strong>Released（已释放）</strong>： 如果一个已绑定的 PV 关联的 PVC 被删除，并且其回收策略设置为 <code>Retain</code> 或某些情况下自动触发，PV 将进入 Released 状态。此时，虽然 PV 不再被任何 PVC 使用，但它仍保留着之前的数据，并等待管理员手动清理数据或决定是否重新使用。</li><li><strong>Pending Release（待释放）</strong>： 在某些特定场景下，例如动态 Provisioned PVs 使用了 StorageClass 的 reclaimPolicy 为 <code>Delete</code> 或 <code>Recycle</code>，当关联的 PVC 删除时，PV 可能会处于 Pending Release 状态，等待执行相应的数据清理或资源回收操作。</li><li><strong>Failed（失败）</strong> PV 在尝试进行某种操作（如挂载、卸载或清理等）时，如果遇到错误，可能进入 Failed 状态。</li><li><strong>Lost（丢失）</strong> 在某些罕见的情况下，比如底层存储出现问题导致 Kubernetes 无法管理该 PV，那么 PV 可能会被标记为 Lost 状态。</li><li><strong>Terminating（终止）/Deleted（已删除）</strong> 当 PV 需要被永久移除时，管理员可以手动删除 PV，或者根据 PVC 的回收策略自动删除 PV。PV 进入 Terminating 阶段后，系统会依据配置进行必要的清理工作，然后最终从集群中删除 PV。</li></ol></blockquote><h1 id="_2-pv回收和访问策略" tabindex="-1">2. PV回收和访问策略 <a class="header-anchor" href="#_2-pv回收和访问策略" aria-label="Permalink to &quot;2. PV回收和访问策略&quot;">​</a></h1><h2 id="_2-0-accessmode" tabindex="-1">2.0 accessMode <a class="header-anchor" href="#_2-0-accessmode" aria-label="Permalink to &quot;2.0 accessMode&quot;">​</a></h2><p>PV的访问模式<a href="https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/#volume-mode" target="_blank" rel="noreferrer">参考官方</a></p><p>1.ReadWriteOnce: 仅可被单个节点读写挂载；命令行中简写RWO。</p><p>2.ReadOnlyMany: 仅可被多个节点同时只读挂在；命令行简写ROX。</p><p>3.ReadyWriteMany: 可被多个节点同时读写挂载；命令行中简写RWX</p><h2 id="_2-1-retain" tabindex="-1">2.1 Retain <a class="header-anchor" href="#_2-1-retain" aria-label="Permalink to &quot;2.1 Retain&quot;">​</a></h2><p>Retain（保留）：需要⼿动回收</p><p>删除PVC后将保留其绑定的PV及存储的数据，但会把该PV置为<code>ReLeased</code>状态，它不可再被其他PVC所绑定，且需要由管理员手动进行后续的回收操作：首先删除PV，接着手动清理其关联的外部存储组件上的数据，最后基于该组件重新创建PV；</p><h2 id="_2-2-recycle" tabindex="-1">2.2 Recycle <a class="header-anchor" href="#_2-2-recycle" aria-label="Permalink to &quot;2.2 Recycle&quot;">​</a></h2><p>Recycle（回收）：基本擦除 (<code>rm -rf /thevolume/*&quot;</code>)</p><p>对于支持该回收策略的存储卷插件，删除PVC时，其绑定的PV所关联的外部存储组件上的数据会被清空，随后该PV将转为<code>Available</code>状态，可再次接收其他PVC的绑定请求。不过目前<code>仅 NFS 和HostPath</code> 支持该回收策略；</p><h2 id="_2-3-delete" tabindex="-1">2.3 Delete <a class="header-anchor" href="#_2-3-delete" aria-label="Permalink to &quot;2.3 Delete&quot;">​</a></h2><p>Delete（删除）：对于⽀持该回收策略的卷插件，删除⼀个PVC将同时删除其绑定的PV资源以及该PV关联的外部存储组件。</p><h1 id="_3-pv资源实践" tabindex="-1">3. PV资源实践 <a class="header-anchor" href="#_3-pv资源实践" aria-label="Permalink to &quot;3. PV资源实践&quot;">​</a></h1><p>PV是⾪属于Kubernetes核⼼API群组中的标准资源类型，它主要实现将外部存储系统定义为可被，PVC申明绑定使⽤的资源对象。PV资源Spec字段主要嵌套以下⼏个通⽤字段，它们⽤于定义PV的容量，访问模式和回收策略等属性。</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span><span style="color:#E1E4E8;">  </span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolume</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pv2</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">nfs</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;"># 存储类型，与底层真正存储对应</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">capacity</span><span style="color:#E1E4E8;">:  </span><span style="color:#6A737D;"># 存储能力，目前只支持存储空间的设置</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:  </span><span style="color:#6A737D;"># 访问模式</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">storageClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;"># 存储类别</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">persistentVolumeReclaimPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;"># 回收策略</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span><span style="color:#24292E;">  </span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolume</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pv2</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">nfs</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># 存储类型，与底层真正存储对应</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">capacity</span><span style="color:#24292E;">:  </span><span style="color:#6A737D;"># 存储能力，目前只支持存储空间的设置</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:  </span><span style="color:#6A737D;"># 访问模式</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">storageClassName</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># 存储类别</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">persistentVolumeReclaimPolicy</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># 回收策略</span></span></code></pre></div><h2 id="_3-1-pv配置字段详解" tabindex="-1">3.1 PV配置字段详解 <a class="header-anchor" href="#_3-1-pv配置字段详解" aria-label="Permalink to &quot;3.1 PV配置字段详解&quot;">​</a></h2><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>capacity</td><td>指定PV容量</td></tr><tr><td>volumeMode</td><td>指定PV类型，⽤于指定此存储卷被格式为⽂件系统<br>使⽤，还是直接使⽤裸格式的块设备，默认Filesystem</td></tr><tr><td>accessModes</td><td>指定当前PV⽀持的访问模式，<a href="https://kubernetes.io/zh-cn/docs/concepts/storage/persistent-volumes/#volume-mode" target="_blank" rel="noreferrer">官⽹参考地址</a></td></tr><tr><td>persistentVolumeReclaimPolicy</td><td>指定PV空间被释放时的处<br>理机制；Retain（默认）、Recycle、delete</td></tr><tr><td>storageClassName</td><td>当前PV所属的StorageClass资源的名称，<br>⽤来实现存储资源分类；</td></tr><tr><td>mountOptions</td><td>挂载选项，例如：ro、nfsvers、等</td></tr></tbody></table><p>PV 的关键配置参数说明：</p><ul><li><p><strong>存储类型</strong></p><p>底层实际存储的类型，kubernetes支持多种存储类型，每种存储类型的配置都有所差异</p></li><li><p><strong>访问模式（accessModes）</strong></p><p>用于描述用户应用对存储资源的访问权限，访问权限包括下面几种方式：</p><ul><li>ReadWriteOnce（RWO）：读写权限，但是只能被单个节点挂载</li><li>ReadOnlyMany（ROX）： 只读权限，可以被多个节点挂载</li><li>ReadWriteMany（RWX）：读写权限，可以被多个节点挂载</li></ul><p><code>需要注意的是，底层不同的存储类型可能支持的访问模式不同</code></p></li><li><p><strong>回收策略（persistentVolumeReclaimPolicy）</strong></p><p>当PV不再被使用了之后，对其的处理方式。目前支持三种策略：</p><ul><li>Retain （保留） 保留数据，需要管理员手工清理数据</li><li>Recycle（回收） 清除 PV 中的数据，效果相当于执行 rm -rf /thevolume/*</li><li>Delete （删除） 与 PV 相连的后端存储完成 volume 的删除操作，当然这常见于云服务商的存储服务</li></ul><p><code>需要注意的是，底层不同的存储类型可能支持的回收策略不同</code></p></li><li><p><strong>存储类别</strong></p><p>PV可以通过storageClassName参数指定一个存储类别</p><ul><li>具有特定类别的PV只能与请求了该类别的PVC进行绑定</li><li>未设定类别的PV则只能与不请求任何类别的PVC进行绑定</li></ul></li><li><p><strong>状态（status）</strong></p><p>一个 PV 的生命周期中，可能会处于4中不同的阶段：</p><ul><li>Available（可用）： 表示可用状态，还未被任何 PVC 绑定</li><li>Bound（已绑定）： 表示 PV 已经被 PVC 绑定</li><li>Released（已释放）： 表示 PVC 被删除，但是资源还未被集群重新声明</li><li>Failed（失败）： 表示该 PV 的自动回收失败</li></ul></li></ul><h1 id="_4-pvc资源实践" tabindex="-1">4. PVC资源实践 <a class="header-anchor" href="#_4-pvc资源实践" aria-label="Permalink to &quot;4. PVC资源实践&quot;">​</a></h1><h2 id="_4-1-pvc配置字段详解" tabindex="-1">4.1 PVC配置字段详解 <a class="header-anchor" href="#_4-1-pvc配置字段详解" aria-label="Permalink to &quot;4.1 PVC配置字段详解&quot;">​</a></h2><p>PersistentVolumeClaim，PVC是存储卷类型的资源，它通过申请占用某个PersistentVolume而创建，它与PV是一对一的关系，用户无须关心其底层实现细节， 申请时，用户只需要指定目标空间的大小，访问模式，PV标签选择器和StorageClass等相关信息即可</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pvc</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dev</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;"># 访问模式</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">selector</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;"># 采用标签对PV选择</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">storageClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;"># 存储类别</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;"># 请求空间</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">5Gi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pvc</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dev</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># 访问模式</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">selector</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># 采用标签对PV选择</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">storageClassName</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># 存储类别</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">: </span><span style="color:#6A737D;"># 请求空间</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">5Gi</span></span></code></pre></div><table><thead><tr><th>参数</th><th>描述</th></tr></thead><tbody><tr><td>accessModes</td><td>PVC的访问模式；它同样⽀持RWO、RWX、ROX三种<br>⽅式；</td></tr><tr><td>resources</td><td>申明使⽤的存储空间的最⼩值和最⼤值；</td></tr><tr><td>selector</td><td>筛选PV时额外使⽤的标签选择器；</td></tr><tr><td>volumeName</td><td>直接指定要绑定的PV资源名称；</td></tr><tr><td>strogeClassName</td><td>指定从哪类存储资源下筛选PV，如果指定的名<br>称不存在，则⽆法绑定成功。如果指定的资源下没有符合的空间也⽆<br>法绑定成功。⽐如申请20G空间，但pv都只有10G空间，则⽆法满<br>⾜</td></tr></tbody></table><h1 id="_5-静态案例" tabindex="-1">5. 静态案例 <a class="header-anchor" href="#_5-静态案例" aria-label="Permalink to &quot;5. 静态案例&quot;">​</a></h1><p>在节点执⾏如下操作，建议所有节点操作，因为不确定Pod会调度⾄哪个节点；<code>（⽣产不建议使⽤HostPath⽅式）</code></p><p><code>静态存储</code></p><h2 id="_5-1-hostpath-pv" tabindex="-1">5.1 hostpath pv <a class="header-anchor" href="#_5-1-hostpath-pv" aria-label="Permalink to &quot;5.1 hostpath pv&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/mnt/data</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;hello hostpath pv,pvc&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/mnt/data/index.html</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/mnt/data</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;hello hostpath pv,pvc&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/mnt/data/index.html</span></span></code></pre></div><p>1.创建pv yaml文件</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master pv</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 1.hostpath-pv.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolume</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pv-volume-001</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">storageClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;host-manager&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#资源类型的标识</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">persistentVolumeReclaimPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#保留策略</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:      </span><span style="color:#6A737D;">#访问模式</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#9ECBFF;">ReadWriteOnce</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#访问模式为仅被单个节点读写挂载，单路读写</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">capacity</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#容量</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#存储空间大小</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">hostPath</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#临时存储位置</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;/mnt/data&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master pv</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 1.hostpath-pv.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolume</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pv-volume-001</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">storageClassName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;host-manager&quot;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#资源类型的标识</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">persistentVolumeReclaimPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#保留策略</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:      </span><span style="color:#6A737D;">#访问模式</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#032F62;">ReadWriteOnce</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#访问模式为仅被单个节点读写挂载，单路读写</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">capacity</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#容量</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#存储空间大小</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">hostPath</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#临时存储位置</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;/mnt/data&quot;</span></span></code></pre></div><p>2.执行apply</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# kubectl apply -f 1.hostpath-pv.yaml</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolume/pv-volume-001</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# kubectl apply -f 1.hostpath-pv.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolume/pv-volume-001</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span></code></pre></div><p>3.查看</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# kubectl get pv</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">RECLAIM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POLICY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">CLAIM</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STORAGECLASS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">REASON</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">pv-volume-001</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWO</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">Available</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">host-manager</span><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">77</span><span style="color:#9ECBFF;">s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">PV是有状态的对象，状态类型如下：</span></span>
<span class="line"><span style="color:#6A737D;"># 1Gi:  存储空间大小</span></span>
<span class="line"><span style="color:#6A737D;"># RWO:  访问模式(ReadWriteOnce缩写)</span></span>
<span class="line"><span style="color:#6A737D;"># Recycle:     回收策略</span></span>
<span class="line"><span style="color:#6A737D;"># Available:   PV状态</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># persistentVolumeReclaimPolicy回收策略</span></span>
<span class="line"><span style="color:#6A737D;"># Retain (保留) 保留数据，需要管理员手动清理</span></span>
<span class="line"><span style="color:#6A737D;"># Recycle (回收) 清除PV中的数据，效果相当于执行删除命令</span></span>
<span class="line"><span style="color:#6A737D;"># Delete (删除) 与PV相连的后端存储完成volume的删除操作，常见于云服务商的存储服务</span></span>
<span class="line"><span style="color:#6A737D;"># 不过需要注意的是，目前只有NFS和HostPath两类支持回收策略，一般设置Retain比较保险</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 状态有以下几种</span></span>
<span class="line"><span style="color:#6A737D;"># Available:   PV状态,表示可用状态,还未被任何PVC绑定</span></span>
<span class="line"><span style="color:#6A737D;"># Bound:			已绑定,已经绑定到某个PVC</span></span>
<span class="line"><span style="color:#6A737D;"># Released:    已释放,对应的pvc已经删除,但资源还没有被集群收回</span></span>
<span class="line"><span style="color:#6A737D;"># Failed:      PV自动回收失败</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# kubectl get pv</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">            </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">RECLAIM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POLICY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">      </span><span style="color:#032F62;">CLAIM</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STORAGECLASS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">REASON</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">pv-volume-001</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWO</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">           </span><span style="color:#032F62;">Available</span><span style="color:#24292E;">           </span><span style="color:#032F62;">host-manager</span><span style="color:#24292E;">            </span><span style="color:#005CC5;">77</span><span style="color:#032F62;">s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">PV是有状态的对象，状态类型如下：</span></span>
<span class="line"><span style="color:#6A737D;"># 1Gi:  存储空间大小</span></span>
<span class="line"><span style="color:#6A737D;"># RWO:  访问模式(ReadWriteOnce缩写)</span></span>
<span class="line"><span style="color:#6A737D;"># Recycle:     回收策略</span></span>
<span class="line"><span style="color:#6A737D;"># Available:   PV状态</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># persistentVolumeReclaimPolicy回收策略</span></span>
<span class="line"><span style="color:#6A737D;"># Retain (保留) 保留数据，需要管理员手动清理</span></span>
<span class="line"><span style="color:#6A737D;"># Recycle (回收) 清除PV中的数据，效果相当于执行删除命令</span></span>
<span class="line"><span style="color:#6A737D;"># Delete (删除) 与PV相连的后端存储完成volume的删除操作，常见于云服务商的存储服务</span></span>
<span class="line"><span style="color:#6A737D;"># 不过需要注意的是，目前只有NFS和HostPath两类支持回收策略，一般设置Retain比较保险</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 状态有以下几种</span></span>
<span class="line"><span style="color:#6A737D;"># Available:   PV状态,表示可用状态,还未被任何PVC绑定</span></span>
<span class="line"><span style="color:#6A737D;"># Bound:			已绑定,已经绑定到某个PVC</span></span>
<span class="line"><span style="color:#6A737D;"># Released:    已释放,对应的pvc已经删除,但资源还没有被集群收回</span></span>
<span class="line"><span style="color:#6A737D;"># Failed:      PV自动回收失败</span></span></code></pre></div><h2 id="_5-2-hostpath-pvc" tabindex="-1">5.2 hostpath pvc <a class="header-anchor" href="#_5-2-hostpath-pvc" aria-label="Permalink to &quot;5.2 hostpath pvc&quot;">​</a></h2><p>1.创建yaml文件</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master pv</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 2.hostpath-pvc.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># 声明该资源类型为PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">001-pvc</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># 声明该PersistentVolumeClaim的名称为001-pvc</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">storageClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;host-manager&quot;</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#和PV的storageclassname须一致，否则无法识别</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#9ECBFF;">ReadWriteOnce</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># 声明该PersistentVolumeClaim的访问模式为ReadWriteOnce</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0.5Gi</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># 声明该PersistentVolumeClaim的请求存储空间为0.5Gi,这里的大小不能超过PV的大小</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master pv</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 2.hostpath-pvc.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 声明该资源类型为PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">001-pvc</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 声明该PersistentVolumeClaim的名称为001-pvc</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">storageClassName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;host-manager&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#和PV的storageclassname须一致，否则无法识别</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#032F62;">ReadWriteOnce</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 声明该PersistentVolumeClaim的访问模式为ReadWriteOnce</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0.5Gi</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 声明该PersistentVolumeClaim的请求存储空间为0.5Gi,这里的大小不能超过PV的大小</span></span></code></pre></div><p>2.执行apply</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# kubectl apply -f 2.hostpath-pvc.yaml</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolumeclaim/001-pvc</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# kubectl apply -f 2.hostpath-pvc.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolumeclaim/001-pvc</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span></code></pre></div><p>3.查看状态</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# kubectl get pvc</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">VOLUME</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STORAGECLASS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">001-pvc</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">pv-volume-001</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWO</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">host-manager</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">m55s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# kubectl get pvc</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">      </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">VOLUME</span><span style="color:#24292E;">          </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STORAGECLASS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">001-pvc</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">pv-volume-001</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWO</span><span style="color:#24292E;">            </span><span style="color:#032F62;">host-manager</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">m55s</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# kubectl describe pv pv-volume-001</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">pv-volume-001</span></span>
<span class="line"><span style="color:#B392F0;">Labels:</span><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Annotations:</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">pv.kubernetes.io/bound-by-controller:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yes</span></span>
<span class="line"><span style="color:#B392F0;">Finalizers:</span><span style="color:#E1E4E8;">      [kubernetes.io/pv-protection]</span></span>
<span class="line"><span style="color:#B392F0;">StorageClass:</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">host-manager</span></span>
<span class="line"><span style="color:#B392F0;">Status:</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">Bound</span></span>
<span class="line"><span style="color:#B392F0;">Claim:</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">default/001-pvc</span></span>
<span class="line"><span style="color:#B392F0;">Reclaim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Policy:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Retain</span></span>
<span class="line"><span style="color:#B392F0;">Access</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Modes:</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RWO</span></span>
<span class="line"><span style="color:#B392F0;">VolumeMode:</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">Capacity:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span></span>
<span class="line"><span style="color:#B392F0;">Node</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Affinity:</span><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Message:</span></span>
<span class="line"><span style="color:#B392F0;">Source:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Type:</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">HostPath</span><span style="color:#E1E4E8;"> (bare </span><span style="color:#9ECBFF;">host</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">directory</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">volume</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Path:</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">/mnt/data</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">HostPathType:</span></span>
<span class="line"><span style="color:#B392F0;">Events:</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# kubectl describe pv pv-volume-001</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">            </span><span style="color:#032F62;">pv-volume-001</span></span>
<span class="line"><span style="color:#6F42C1;">Labels:</span><span style="color:#24292E;">          </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Annotations:</span><span style="color:#24292E;">     </span><span style="color:#032F62;">pv.kubernetes.io/bound-by-controller:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yes</span></span>
<span class="line"><span style="color:#6F42C1;">Finalizers:</span><span style="color:#24292E;">      [kubernetes.io/pv-protection]</span></span>
<span class="line"><span style="color:#6F42C1;">StorageClass:</span><span style="color:#24292E;">    </span><span style="color:#032F62;">host-manager</span></span>
<span class="line"><span style="color:#6F42C1;">Status:</span><span style="color:#24292E;">          </span><span style="color:#032F62;">Bound</span></span>
<span class="line"><span style="color:#6F42C1;">Claim:</span><span style="color:#24292E;">           </span><span style="color:#032F62;">default/001-pvc</span></span>
<span class="line"><span style="color:#6F42C1;">Reclaim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Policy:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Retain</span></span>
<span class="line"><span style="color:#6F42C1;">Access</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Modes:</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RWO</span></span>
<span class="line"><span style="color:#6F42C1;">VolumeMode:</span><span style="color:#24292E;">      </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">Capacity:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span></span>
<span class="line"><span style="color:#6F42C1;">Node</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Affinity:</span><span style="color:#24292E;">   </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Message:</span></span>
<span class="line"><span style="color:#6F42C1;">Source:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Type:</span><span style="color:#24292E;">          </span><span style="color:#032F62;">HostPath</span><span style="color:#24292E;"> (bare </span><span style="color:#032F62;">host</span><span style="color:#24292E;"> </span><span style="color:#032F62;">directory</span><span style="color:#24292E;"> </span><span style="color:#032F62;">volume</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Path:</span><span style="color:#24292E;">          </span><span style="color:#032F62;">/mnt/data</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">HostPathType:</span></span>
<span class="line"><span style="color:#6F42C1;">Events:</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]#  kubectl describe pvc 001-pvc</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">001</span><span style="color:#9ECBFF;">-pvc</span></span>
<span class="line"><span style="color:#B392F0;">Namespace:</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#B392F0;">StorageClass:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">host-manager</span></span>
<span class="line"><span style="color:#B392F0;">Status:</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Bound</span></span>
<span class="line"><span style="color:#B392F0;">Volume:</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">pv-volume-001</span></span>
<span class="line"><span style="color:#B392F0;">Labels:</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Annotations:</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">pv.kubernetes.io/bind-completed:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yes</span></span>
<span class="line"><span style="color:#E1E4E8;">               </span><span style="color:#B392F0;">pv.kubernetes.io/bound-by-controller:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yes</span></span>
<span class="line"><span style="color:#B392F0;">Finalizers:</span><span style="color:#E1E4E8;">    [kubernetes.io/pvc-protection]</span></span>
<span class="line"><span style="color:#B392F0;">Capacity:</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span></span>
<span class="line"><span style="color:#B392F0;">Access</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Modes:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">RWO</span></span>
<span class="line"><span style="color:#B392F0;">VolumeMode:</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">Used</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">By:</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Events:</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]#  kubectl describe pvc 001-pvc</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">001</span><span style="color:#032F62;">-pvc</span></span>
<span class="line"><span style="color:#6F42C1;">Namespace:</span><span style="color:#24292E;">     </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#6F42C1;">StorageClass:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">host-manager</span></span>
<span class="line"><span style="color:#6F42C1;">Status:</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Bound</span></span>
<span class="line"><span style="color:#6F42C1;">Volume:</span><span style="color:#24292E;">        </span><span style="color:#032F62;">pv-volume-001</span></span>
<span class="line"><span style="color:#6F42C1;">Labels:</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Annotations:</span><span style="color:#24292E;">   </span><span style="color:#032F62;">pv.kubernetes.io/bind-completed:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yes</span></span>
<span class="line"><span style="color:#24292E;">               </span><span style="color:#6F42C1;">pv.kubernetes.io/bound-by-controller:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yes</span></span>
<span class="line"><span style="color:#6F42C1;">Finalizers:</span><span style="color:#24292E;">    [kubernetes.io/pvc-protection]</span></span>
<span class="line"><span style="color:#6F42C1;">Capacity:</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span></span>
<span class="line"><span style="color:#6F42C1;">Access</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Modes:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">RWO</span></span>
<span class="line"><span style="color:#6F42C1;">VolumeMode:</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">Used</span><span style="color:#24292E;"> </span><span style="color:#032F62;">By:</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Events:</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h2 id="_5-3-hostpath-pod" tabindex="-1">5.3 hostpath pod <a class="header-anchor" href="#_5-3-hostpath-pod" aria-label="Permalink to &quot;5.3 hostpath pod&quot;">​</a></h2><p>1.创建pod</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master pv</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 3.pod_hostpath_pvc.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-hostpath-pvc</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">web-storage</span><span style="color:#E1E4E8;">     </span><span style="color:#6A737D;"># 定义挂载名字</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">persistentVolumeClaim</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">claimName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">001-pvc</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;"># 先前定义的pvc名字</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">web-storage</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/usr/share/nginx/html</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master pv</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 3.pod_hostpath_pvc.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-hostpath-pvc</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">web-storage</span><span style="color:#24292E;">     </span><span style="color:#6A737D;"># 定义挂载名字</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">persistentVolumeClaim</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">claimName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">001-pvc</span><span style="color:#24292E;">  </span><span style="color:#6A737D;"># 先前定义的pvc名字</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">web-storage</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/usr/share/nginx/html</span></span></code></pre></div><p>2.执行apply</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# kubectl apply -f 3.pod_hostpath_pvc.yaml</span></span>
<span class="line"><span style="color:#B392F0;">pod/pod-hostpath-pvc</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# kubectl apply -f 3.pod_hostpath_pvc.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">pod/pod-hostpath-pvc</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span></code></pre></div><p>3.查看Pod</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# kubectl get pod</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                                   </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">pod-hostpath-pvc</span><span style="color:#E1E4E8;">                       </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">m16s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# kubectl get pod</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                                   </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">         </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">pod-hostpath-pvc</span><span style="color:#24292E;">                       </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">                </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">m16s</span></span></code></pre></div><p>4.访问</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master pv]# curl 172.30.0.156</span></span>
<span class="line"><span style="color:#B392F0;">hello</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">hostpath</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pv,pvc</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master pv]# curl 172.30.0.156</span></span>
<span class="line"><span style="color:#6F42C1;">hello</span><span style="color:#24292E;"> </span><span style="color:#032F62;">hostpath</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pv,pvc</span></span></code></pre></div><h1 id="_6-pv实践" tabindex="-1">6. pv实践 <a class="header-anchor" href="#_6-pv实践" aria-label="Permalink to &quot;6. pv实践&quot;">​</a></h1><p>使用NFS作为存储，来演示PV的使用，创建3个PV，对应NFS中的3个暴露的路径</p><ol><li>准备NFS环境</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 创建目录</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@nfs </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# mkdir /root/data/{</span><span style="color:#B392F0;">pv1,pv2,pv3}</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-pv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 暴露服务</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@nfs </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# more /etc/exports</span></span>
<span class="line"><span style="color:#B392F0;">/root/data/pv1</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.5.0/24</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">rw,no_root_squash</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">/root/data/pv2</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.5.0/24</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">rw,no_root_squash</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#B392F0;">/root/data/pv3</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.5.0/24</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">rw,no_root_squash</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 重启服务</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@nfs </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]#  systemctl restart nfs</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 创建目录</span></span>
<span class="line"><span style="color:#24292E;">[root@nfs </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# mkdir /root/data/{</span><span style="color:#6F42C1;">pv1,pv2,pv3}</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-pv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 暴露服务</span></span>
<span class="line"><span style="color:#24292E;">[root@nfs </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# more /etc/exports</span></span>
<span class="line"><span style="color:#6F42C1;">/root/data/pv1</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.5.0/24</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">rw,no_root_squash</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6F42C1;">/root/data/pv2</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.5.0/24</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">rw,no_root_squash</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#6F42C1;">/root/data/pv3</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.5.0/24</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">rw,no_root_squash</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 重启服务</span></span>
<span class="line"><span style="color:#24292E;">[root@nfs </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]#  systemctl restart nfs</span></span></code></pre></div><p>2.创建pv.yaml</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolume</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">:  </span><span style="color:#9ECBFF;">pv1</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">capacity</span><span style="color:#E1E4E8;">: </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">persistentVolumeReclaimPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Retain</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">nfs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/root/data/pv1</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">server</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">192.168.5.6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolume</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">:  </span><span style="color:#9ECBFF;">pv2</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">capacity</span><span style="color:#E1E4E8;">: </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">persistentVolumeReclaimPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Retain</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">nfs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/root/data/pv2</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">server</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">192.168.5.6</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolume</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">:  </span><span style="color:#9ECBFF;">pv3</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">capacity</span><span style="color:#E1E4E8;">: </span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">3Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">persistentVolumeReclaimPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Retain</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">nfs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/root/data/pv3</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">server</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">192.168.5.6</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolume</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">:  </span><span style="color:#032F62;">pv1</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">capacity</span><span style="color:#24292E;">: </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">persistentVolumeReclaimPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Retain</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">nfs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/root/data/pv1</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">server</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">192.168.5.6</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolume</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">:  </span><span style="color:#032F62;">pv2</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">capacity</span><span style="color:#24292E;">: </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">persistentVolumeReclaimPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Retain</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">nfs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/root/data/pv2</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">server</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">192.168.5.6</span></span>
<span class="line"><span style="color:#24292E;">    </span></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolume</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">:  </span><span style="color:#032F62;">pv3</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">capacity</span><span style="color:#24292E;">: </span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">3Gi</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">persistentVolumeReclaimPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Retain</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">nfs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/root/data/pv3</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">server</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">192.168.5.6</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 创建 pv</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl create -f pv.yaml</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolume/pv1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolume/pv2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolume/pv3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pv</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl get pv -o wide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">RECLAIM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POLICY</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#B392F0;">pv1</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Available</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pv2</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Available</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pv3</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Available</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">9</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Filesystem</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 创建 pv</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl create -f pv.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolume/pv1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolume/pv2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolume/pv3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pv</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl get pv -o wide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">  </span><span style="color:#032F62;">RECLAIM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POLICY</span><span style="color:#24292E;">  </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">      </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#6F42C1;">pv1</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Available</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">s</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pv2</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Available</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">s</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pv3</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Available</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">9</span><span style="color:#032F62;">s</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Filesystem</span></span></code></pre></div><h1 id="_7-pvc实践" tabindex="-1">7. pvc实践 <a class="header-anchor" href="#_7-pvc实践" aria-label="Permalink to &quot;7. pvc实践&quot;">​</a></h1><ol><li>创建pvc.yaml，申请pv</li></ol><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pvc1</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dev</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">: </span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pvc2</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dev</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">: </span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pvc3</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dev</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">: </span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pvc1</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dev</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">: </span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pvc2</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dev</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">: </span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pvc3</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dev</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">: </span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 创建pvc</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl create -f pvc.yaml</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolumeclaim/pvc1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolumeclaim/pvc2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolumeclaim/pvc3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pvc</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl get pvc  -n dev -o wide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">VOLUME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STORAGECLASS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#B392F0;">pvc1</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">pv1</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">                           </span><span style="color:#79B8FF;">15</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pvc2</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">pv2</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">                           </span><span style="color:#79B8FF;">15</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pvc3</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">pv3</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">                           </span><span style="color:#79B8FF;">15</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pv</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl get pv -o wide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">RECLAIM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POLICY</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">CLAIM</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#B392F0;">pv1</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWx</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">dev/pvc1</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">h37m</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pv2</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">dev/pvc2</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">h37m</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pv3</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">dev/pvc3</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">h37m</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Filesystem</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 创建pvc</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl create -f pvc.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolumeclaim/pvc1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolumeclaim/pvc2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolumeclaim/pvc3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pvc</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl get pvc  -n dev -o wide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">VOLUME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STORAGECLASS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#6F42C1;">pvc1</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">pv1</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">                           </span><span style="color:#005CC5;">15</span><span style="color:#032F62;">s</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pvc2</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">pv2</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">                           </span><span style="color:#005CC5;">15</span><span style="color:#032F62;">s</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pvc3</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">pv3</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">                           </span><span style="color:#005CC5;">15</span><span style="color:#032F62;">s</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pv</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl get pv -o wide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">  </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">  </span><span style="color:#032F62;">RECLAIM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POLICY</span><span style="color:#24292E;">  </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">CLAIM</span><span style="color:#24292E;">       </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">     </span><span style="color:#032F62;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#6F42C1;">pv1</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWx</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">          </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">dev/pvc1</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">h37m</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pv2</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">          </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">dev/pvc2</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">h37m</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pv3</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">          </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">dev/pvc3</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">h37m</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Filesystem</span></span></code></pre></div><p>2.创建pods.yaml, 使用pv</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod1</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dev</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox:1.30</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;/bin/sh&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;-c&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;while true;do echo pod1 &gt;&gt; /root/out.txt; sleep 10; done;&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/root/</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">persistentVolumeClaim</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">claimName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pvc1</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">readOnly</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod2</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dev</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox:1.30</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;/bin/sh&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;-c&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;while true;do echo pod2 &gt;&gt; /root/out.txt; sleep 10; done;&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/root/</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">persistentVolumeClaim</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">claimName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pvc2</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">readOnly</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">false</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod1</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dev</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox:1.30</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;/bin/sh&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;-c&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;while true;do echo pod1 &gt;&gt; /root/out.txt; sleep 10; done;&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/root/</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">persistentVolumeClaim</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">claimName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pvc1</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">readOnly</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod2</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dev</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox:1.30</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;/bin/sh&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;-c&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;while true;do echo pod2 &gt;&gt; /root/out.txt; sleep 10; done;&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/root/</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">persistentVolumeClaim</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">claimName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pvc2</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">readOnly</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 创建pod</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl create -f pods.yaml</span></span>
<span class="line"><span style="color:#B392F0;">pod/pod1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"><span style="color:#B392F0;">pod/pod2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pod</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl get pods -n dev -o wide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">IP</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">NODE</span><span style="color:#E1E4E8;">   </span></span>
<span class="line"><span style="color:#B392F0;">pod1</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">14</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">10.244</span><span style="color:#9ECBFF;">.1.69</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">node1</span><span style="color:#E1E4E8;">   </span></span>
<span class="line"><span style="color:#B392F0;">pod2</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">14</span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">10.244</span><span style="color:#9ECBFF;">.1.70</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">node1</span><span style="color:#E1E4E8;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pvc</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl get pvc -n dev -o wide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">VOLUME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#B392F0;">pvc1</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">pv1</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">               </span><span style="color:#79B8FF;">94</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pvc2</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">pv2</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">               </span><span style="color:#79B8FF;">94</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pvc3</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">pv3</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">               </span><span style="color:#79B8FF;">94</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pv</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-master01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl get pv -n dev -o wide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">RECLAIM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POLICY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CLAIM</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#B392F0;">pv1</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">dev/pvc1</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">h11m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pv2</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">dev/pvc2</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">h11m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">pv3</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Retain</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">dev/pvc3</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">h11m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看nfs中的文件存储</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@nfs </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# more /root/data/pv1/out.txt</span></span>
<span class="line"><span style="color:#B392F0;">node1</span></span>
<span class="line"><span style="color:#B392F0;">node1</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@nfs </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# more /root/data/pv2/out.txt</span></span>
<span class="line"><span style="color:#B392F0;">node2</span></span>
<span class="line"><span style="color:#B392F0;">node2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 创建pod</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl create -f pods.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">pod/pod1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"><span style="color:#6F42C1;">pod/pod2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pod</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl get pods -n dev -o wide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">IP</span><span style="color:#24292E;">            </span><span style="color:#032F62;">NODE</span><span style="color:#24292E;">   </span></span>
<span class="line"><span style="color:#6F42C1;">pod1</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">14</span><span style="color:#032F62;">s</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">10.244</span><span style="color:#032F62;">.1.69</span><span style="color:#24292E;">   </span><span style="color:#032F62;">node1</span><span style="color:#24292E;">   </span></span>
<span class="line"><span style="color:#6F42C1;">pod2</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">14</span><span style="color:#032F62;">s</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">10.244</span><span style="color:#032F62;">.1.70</span><span style="color:#24292E;">   </span><span style="color:#032F62;">node1</span><span style="color:#24292E;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pvc</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl get pvc -n dev -o wide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">VOLUME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">      </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#6F42C1;">pvc1</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">pv1</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">               </span><span style="color:#005CC5;">94</span><span style="color:#032F62;">m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pvc2</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">pv2</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">               </span><span style="color:#005CC5;">94</span><span style="color:#032F62;">m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pvc3</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">pv3</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">               </span><span style="color:#005CC5;">94</span><span style="color:#032F62;">m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看pv</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-master01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl get pv -n dev -o wide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">RECLAIM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POLICY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CLAIM</span><span style="color:#24292E;">       </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">     </span><span style="color:#032F62;">VOLUMEMODE</span></span>
<span class="line"><span style="color:#6F42C1;">pv1</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">           </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">dev/pvc1</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">h11m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pv2</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">           </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">dev/pvc2</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">h11m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">pv3</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Retain</span><span style="color:#24292E;">           </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">dev/pvc3</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">h11m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看nfs中的文件存储</span></span>
<span class="line"><span style="color:#24292E;">[root@nfs </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# more /root/data/pv1/out.txt</span></span>
<span class="line"><span style="color:#6F42C1;">node1</span></span>
<span class="line"><span style="color:#6F42C1;">node1</span></span>
<span class="line"><span style="color:#24292E;">[root@nfs </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# more /root/data/pv2/out.txt</span></span>
<span class="line"><span style="color:#6F42C1;">node2</span></span>
<span class="line"><span style="color:#6F42C1;">node2</span></span></code></pre></div>`,110),e=[o];function t(c,r,E,y,i,F){return a(),n("div",null,e)}const m=s(p,[["render",t]]);export{C as __pageData,m as default};
