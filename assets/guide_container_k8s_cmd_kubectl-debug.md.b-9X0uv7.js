import{_ as s,o as a,c as n,R as p}from"./chunks/framework.zUbWieqp.js";const F=JSON.parse('{"title":"kubectl debug工具","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/cmd/kubectl-debug.md","filePath":"guide/container/k8s/cmd/kubectl-debug.md","lastUpdated":1729765555000}'),o={name:"guide/container/k8s/cmd/kubectl-debug.md"},e=p(`<h1 id="kubectl-debug工具" tabindex="-1">kubectl debug工具 <a class="header-anchor" href="#kubectl-debug工具" aria-label="Permalink to &quot;kubectl debug工具&quot;">​</a></h1><p>通常情况下，业务容器所使用的镜像是非常精简的，而一旦业务容器出现问题，通过<code>kubectl exec</code>进入到容器时，我们会发现自己需要使用的工具都没有，也无法通过<code>apt, apt-get, yum</code>等包管理工具,下载需要的工具</p><h2 id="_1-使用" tabindex="-1">1.使用 <a class="header-anchor" href="#_1-使用" aria-label="Permalink to &quot;1.使用&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">debug</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--help</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">debug</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--help</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@kube-master-01 ~]# kubectl get pods</span></span>
<span class="line"><span style="color:#e1e4e8;">NAME                                      READY   STATUS    RESTARTS         AGE</span></span>
<span class="line"><span style="color:#e1e4e8;">busybox                                   1/1     Running   110 (46m ago)    32d</span></span>
<span class="line"><span style="color:#e1e4e8;">demoapp-7cc687d895-8xltm                  1/1     Running   4 (5h47m ago)    6d5h</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@kube-master-01 ~]# kubectl get pods</span></span>
<span class="line"><span style="color:#24292e;">NAME                                      READY   STATUS    RESTARTS         AGE</span></span>
<span class="line"><span style="color:#24292e;">busybox                                   1/1     Running   110 (46m ago)    32d</span></span>
<span class="line"><span style="color:#24292e;">demoapp-7cc687d895-8xltm                  1/1     Running   4 (5h47m ago)    6d5h</span></span></code></pre></div><p>主要是利用<code>--target</code>参数，这个参数主要用于指定<code>debug Pod</code>中的哪个容器;<code>--image</code>参数就是用于指定使用哪个镜像来<code>debug</code>，这个镜像包含我们需要使用的工具即可</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">debug</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">demoapp-7cc687d895-8xltm</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--image=ubuntu:20.04</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-it</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--target=demoapp</span></span>
<span class="line"><span style="color:#B392F0;">Targeting</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">container</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;demoapp&quot;.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">If</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">you</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">don&#39;t see processes from this container it may be because the container runtimedoesn&#39;t</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">support</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">this</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">feature.</span></span>
<span class="line"><span style="color:#B392F0;">Defaulting</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">debug</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">container</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">debugger-vrpd6.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">If</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">you</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">don&#39;t see a command prompt, try pressing enter.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">root@demoapp-7cc687d895-8xltm:/#</span></span>
<span class="line"><span style="color:#9ECBFF;">#此处多回车几次就可以进去</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">root@demoapp-7cc687d895-8xltm:/# ps uax|grep python</span></span>
<span class="line"><span style="color:#9ECBFF;">root           1  0.0  0.5  27288 23192 ?        Ss   02:47   0:13 python3 /app/demo.py</span></span>
<span class="line"><span style="color:#9ECBFF;">root@demoapp-7cc687d895-8xltm:/# vmstat</span></span>
<span class="line"><span style="color:#9ECBFF;">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span></span>
<span class="line"><span style="color:#9ECBFF;"> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span></span>
<span class="line"><span style="color:#9ECBFF;"> 0  0      0 1115792   1664 1753772    0    0    36    48  477  920  1 10 89  1  0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">debug</span><span style="color:#24292E;"> </span><span style="color:#032F62;">demoapp-7cc687d895-8xltm</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--image=ubuntu:20.04</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-it</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--target=demoapp</span></span>
<span class="line"><span style="color:#6F42C1;">Targeting</span><span style="color:#24292E;"> </span><span style="color:#032F62;">container</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;demoapp&quot;.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">If</span><span style="color:#24292E;"> </span><span style="color:#032F62;">you</span><span style="color:#24292E;"> </span><span style="color:#032F62;">don&#39;t see processes from this container it may be because the container runtimedoesn&#39;t</span><span style="color:#24292E;"> </span><span style="color:#032F62;">support</span><span style="color:#24292E;"> </span><span style="color:#032F62;">this</span><span style="color:#24292E;"> </span><span style="color:#032F62;">feature.</span></span>
<span class="line"><span style="color:#6F42C1;">Defaulting</span><span style="color:#24292E;"> </span><span style="color:#032F62;">debug</span><span style="color:#24292E;"> </span><span style="color:#032F62;">container</span><span style="color:#24292E;"> </span><span style="color:#032F62;">name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">debugger-vrpd6.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">If</span><span style="color:#24292E;"> </span><span style="color:#032F62;">you</span><span style="color:#24292E;"> </span><span style="color:#032F62;">don&#39;t see a command prompt, try pressing enter.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">root@demoapp-7cc687d895-8xltm:/#</span></span>
<span class="line"><span style="color:#032F62;">#此处多回车几次就可以进去</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">root@demoapp-7cc687d895-8xltm:/# ps uax|grep python</span></span>
<span class="line"><span style="color:#032F62;">root           1  0.0  0.5  27288 23192 ?        Ss   02:47   0:13 python3 /app/demo.py</span></span>
<span class="line"><span style="color:#032F62;">root@demoapp-7cc687d895-8xltm:/# vmstat</span></span>
<span class="line"><span style="color:#032F62;">procs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----</span></span>
<span class="line"><span style="color:#032F62;"> r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st</span></span>
<span class="line"><span style="color:#032F62;"> 0  0      0 1115792   1664 1753772    0    0    36    48  477  920  1 10 89  1  0</span></span></code></pre></div>`,7),l=[e];function t(c,r,y,i,d,E){return a(),n("div",null,l)}const b=s(o,[["render",t]]);export{F as __pageData,b as default};
