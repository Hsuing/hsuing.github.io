import{_ as s,o as n,c as a,R as l}from"./chunks/framework.zUbWieqp.js";const u=JSON.parse('{"title":"1.redis_rules","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Monitor/Prometheus/8-rules_redis.md","filePath":"guide/Linux/Monitor/Prometheus/8-rules_redis.md","lastUpdated":1731060191000}'),p={name:"guide/Linux/Monitor/Prometheus/8-rules_redis.md"},o=l(`<h1 id="_1-redis-rules" tabindex="-1">1.redis_rules <a class="header-anchor" href="#_1-redis-rules" aria-label="Permalink to &quot;1.redis_rules&quot;">â€‹</a></h1><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">groups</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis.rules</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">rules</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisDown</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis_up == 0</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis down (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis instance is down</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisMissingMaster</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">(count(redis_instance_info{role=&quot;master&quot;}) or vector(0)) &lt; 1</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis missing master (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis cluster has no node marked as master.</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisTooManyMasters</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">count(redis_instance_info{role=&quot;master&quot;}) &gt; 1</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis too many masters (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis cluster has too many nodes marked as master.</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisDisconnectedSlaves</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">count without (instance, job) (redis_connected_slaves) - sum without (instance, job) (redis_connected_slaves) - 1 &gt; 1</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis disconnected slaves (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis not replicating for all slaves. Consider reviewing the redis replication status.</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisReplicationBroken</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">delta(redis_connected_slaves[1m]) &lt; 0</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis replication broken (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis instance lost a slave</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisClusterFlapping</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">changes(redis_connected_slaves[1m]) &gt; 1</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis cluster flapping (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Changes have been detected in Redis replica connection. This can occur when replica nodes lose connection to the master and reconnect (a.k.a flapping).</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisMissingBackup</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">time() - redis_rdb_last_save_timestamp_seconds &gt; 60 * 60 * 24</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis missing backup (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis has not been backuped for 24 hours</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># The exporter must be started with --include-system-metrics flag or REDIS_EXPORTER_INCL_SYSTEM_METRICS=true environment variable.</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisOutOfSystemMemory</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis_memory_used_bytes / redis_total_system_memory_bytes * 100 &gt; 90</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">warning</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis out of system memory (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis is running out of system memory (&gt; 90%)</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisOutOfConfiguredMaxmemory</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis_memory_used_bytes / redis_memory_max_bytes * 100 &gt; 90</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">warning</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis out of configured maxmemory (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis is running out of configured maxmemory (&gt; 90%)</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisTooManyConnections</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis_connected_clients &gt; 500</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">warning</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis too many connections (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Redis instance has too many connections</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#        - alert: RedisNotEnoughConnections</span></span>
<span class="line"><span style="color:#6A737D;">#          expr: redis_connected_clients &lt; 5</span></span>
<span class="line"><span style="color:#6A737D;">#          for: 2m</span></span>
<span class="line"><span style="color:#6A737D;">#          labels:</span></span>
<span class="line"><span style="color:#6A737D;">#            severity: warning</span></span>
<span class="line"><span style="color:#6A737D;">#          annotations:</span></span>
<span class="line"><span style="color:#6A737D;">#            summary: Redis not enough connections (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#6A737D;">#            description: &quot;Redis instance should have more connections (&gt; 5)\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">alert</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">RedisRejectedConnections</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">expr</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">increase(redis_rejected_connections_total[1m]) &gt; 0</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">for</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0m</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">summary</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Redis rejected connections (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">description</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Some connections to Redis has been rejected</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  VALUE = {{ $value }}</span><span style="color:#79B8FF;">\\n</span><span style="color:#9ECBFF;">  LABELS = {{ $labels }}&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">groups</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis.rules</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">rules</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisDown</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis_up == 0</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis down (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis instance is down</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisMissingMaster</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">(count(redis_instance_info{role=&quot;master&quot;}) or vector(0)) &lt; 1</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis missing master (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis cluster has no node marked as master.</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisTooManyMasters</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">count(redis_instance_info{role=&quot;master&quot;}) &gt; 1</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis too many masters (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis cluster has too many nodes marked as master.</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisDisconnectedSlaves</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">count without (instance, job) (redis_connected_slaves) - sum without (instance, job) (redis_connected_slaves) - 1 &gt; 1</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis disconnected slaves (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis not replicating for all slaves. Consider reviewing the redis replication status.</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisReplicationBroken</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">delta(redis_connected_slaves[1m]) &lt; 0</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis replication broken (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis instance lost a slave</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisClusterFlapping</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">changes(redis_connected_slaves[1m]) &gt; 1</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis cluster flapping (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Changes have been detected in Redis replica connection. This can occur when replica nodes lose connection to the master and reconnect (a.k.a flapping).</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisMissingBackup</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">time() - redis_rdb_last_save_timestamp_seconds &gt; 60 * 60 * 24</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis missing backup (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis has not been backuped for 24 hours</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;"># The exporter must be started with --include-system-metrics flag or REDIS_EXPORTER_INCL_SYSTEM_METRICS=true environment variable.</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisOutOfSystemMemory</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis_memory_used_bytes / redis_total_system_memory_bytes * 100 &gt; 90</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">warning</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis out of system memory (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis is running out of system memory (&gt; 90%)</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisOutOfConfiguredMaxmemory</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis_memory_used_bytes / redis_memory_max_bytes * 100 &gt; 90</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">warning</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis out of configured maxmemory (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis is running out of configured maxmemory (&gt; 90%)</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisTooManyConnections</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis_connected_clients &gt; 500</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">warning</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis too many connections (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Redis instance has too many connections</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#6A737D;">#        - alert: RedisNotEnoughConnections</span></span>
<span class="line"><span style="color:#6A737D;">#          expr: redis_connected_clients &lt; 5</span></span>
<span class="line"><span style="color:#6A737D;">#          for: 2m</span></span>
<span class="line"><span style="color:#6A737D;">#          labels:</span></span>
<span class="line"><span style="color:#6A737D;">#            severity: warning</span></span>
<span class="line"><span style="color:#6A737D;">#          annotations:</span></span>
<span class="line"><span style="color:#6A737D;">#            summary: Redis not enough connections (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#6A737D;">#            description: &quot;Redis instance should have more connections (&gt; 5)\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">alert</span><span style="color:#24292E;">: </span><span style="color:#032F62;">RedisRejectedConnections</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">expr</span><span style="color:#24292E;">: </span><span style="color:#032F62;">increase(redis_rejected_connections_total[1m]) &gt; 0</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">for</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0m</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">summary</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Redis rejected connections (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">description</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Some connections to Redis has been rejected</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  VALUE = {{ $value }}</span><span style="color:#005CC5;">\\n</span><span style="color:#032F62;">  LABELS = {{ $labels }}&quot;</span></span></code></pre></div>`,2),e=[o];function t(c,r,E,y,i,F){return n(),a("div",null,e)}const m=s(p,[["render",t]]);export{u as __pageData,m as default};
