import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const h=JSON.parse('{"title":"一、安装ZFS","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Storage/zfs/1-zfs.md","filePath":"guide/Linux/Storage/zfs/1-zfs.md","lastUpdated":1712138678000}'),p={name:"guide/Linux/Storage/zfs/1-zfs.md"},o=l(`<p>文档，<a href="https://openzfs.github.io/openzfs-docs/man/index.html" target="_blank" rel="noreferrer">https://openzfs.github.io/openzfs-docs/man/index.html</a></p><h1 id="一、安装zfs" tabindex="-1">一、安装ZFS <a class="header-anchor" href="#一、安装zfs" aria-label="Permalink to &quot;一、安装ZFS&quot;">​</a></h1><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">http://download.zfsonlinux.org/epel/zfs-release.el7_4.noarch.rpm</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">gdisk</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dosfstools</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://download.zfsonlinux.org/epel/zfs-release.el7_4.noarch.rpm</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span><span style="color:#24292E;"> </span><span style="color:#032F62;">gdisk</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dosfstools</span></span></code></pre></div><ul><li>安装最新版本</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://zfsonlinux.org/epel/zfs-release-2-3$(</span><span style="color:#B392F0;">rpm</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">--eval</span><span style="color:#9ECBFF;"> &quot;%{dist}&quot;).noarch.rpm</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kernel-devel</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://zfsonlinux.org/epel/zfs-release-2-3$(</span><span style="color:#6F42C1;">rpm</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">--eval</span><span style="color:#032F62;"> &quot;%{dist}&quot;).noarch.rpm</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kernel-devel</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span></code></pre></div><ul><li>启动</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 开机自启zfs服务</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enable</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--now</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs-import-scan.service</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs-mount</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs-import.target</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs-zed</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看zfs-import-scan服务状态</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">status</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs-import-scan</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 开机自启zfs服务</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enable</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--now</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs-import-scan.service</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs-mount</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs-import.target</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs-zed</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看zfs-import-scan服务状态</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">status</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs-import-scan</span></span></code></pre></div><h1 id="二、加载模块" tabindex="-1">二、加载模块 <a class="header-anchor" href="#二、加载模块" aria-label="Permalink to &quot;二、加载模块&quot;">​</a></h1><h2 id="_2-1手动加载zfs模块" tabindex="-1">2.1手动加载zfs模块 <a class="header-anchor" href="#_2-1手动加载zfs模块" aria-label="Permalink to &quot;2.1手动加载zfs模块&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">/usr/sbin/modprobe</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">/usr/sbin/modprobe</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span></span></code></pre></div><h2 id="_2-2自启加载" tabindex="-1">2.2自启加载 <a class="header-anchor" href="#_2-2自启加载" aria-label="Permalink to &quot;2.2自启加载&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/modules-load.d/zfs.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;options zfs zfs_arc_max=2147483648&quot;</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">&gt;&gt;</span><span style="color:#9ECBFF;">/etc/modprobe.d/zfs.conf</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/modules-load.d/zfs.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;options zfs zfs_arc_max=2147483648&quot;</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">&gt;&gt;</span><span style="color:#032F62;">/etc/modprobe.d/zfs.conf</span></span></code></pre></div><h2 id="_2-3查看模块" tabindex="-1">2.3查看模块 <a class="header-anchor" href="#_2-3查看模块" aria-label="Permalink to &quot;2.3查看模块&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@other </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# lsmod </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span></span>
<span class="line"><span style="color:#B392F0;">zfs</span><span style="color:#E1E4E8;">                  </span><span style="color:#79B8FF;">3457024</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">2</span></span>
<span class="line"><span style="color:#B392F0;">zunicode</span><span style="color:#E1E4E8;">              </span><span style="color:#79B8FF;">331776</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span></span>
<span class="line"><span style="color:#B392F0;">zavl</span><span style="color:#E1E4E8;">                   </span><span style="color:#79B8FF;">16384</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span></span>
<span class="line"><span style="color:#B392F0;">icp</span><span style="color:#E1E4E8;">                   </span><span style="color:#79B8FF;">262144</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span></span>
<span class="line"><span style="color:#B392F0;">zcommon</span><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">69632</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs</span></span>
<span class="line"><span style="color:#B392F0;">znvpair</span><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">77824</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs,zcommon</span></span>
<span class="line"><span style="color:#B392F0;">spl</span><span style="color:#E1E4E8;">                   </span><span style="color:#79B8FF;">102400</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">4</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zfs,icp,znvpair,zcommon</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@other </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# lsmod </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span></span>
<span class="line"><span style="color:#6F42C1;">zfs</span><span style="color:#24292E;">                  </span><span style="color:#005CC5;">3457024</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#6F42C1;">zunicode</span><span style="color:#24292E;">              </span><span style="color:#005CC5;">331776</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span></span>
<span class="line"><span style="color:#6F42C1;">zavl</span><span style="color:#24292E;">                   </span><span style="color:#005CC5;">16384</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span></span>
<span class="line"><span style="color:#6F42C1;">icp</span><span style="color:#24292E;">                   </span><span style="color:#005CC5;">262144</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span></span>
<span class="line"><span style="color:#6F42C1;">zcommon</span><span style="color:#24292E;">                </span><span style="color:#005CC5;">69632</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs</span></span>
<span class="line"><span style="color:#6F42C1;">znvpair</span><span style="color:#24292E;">                </span><span style="color:#005CC5;">77824</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs,zcommon</span></span>
<span class="line"><span style="color:#6F42C1;">spl</span><span style="color:#24292E;">                   </span><span style="color:#005CC5;">102400</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">4</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zfs,icp,znvpair,zcommon</span></span></code></pre></div><p><code>至此结束</code></p>`,15),e=[o];function t(c,r,y,E,i,F){return a(),n("div",null,e)}const C=s(p,[["render",t]]);export{h as __pageData,C as default};
