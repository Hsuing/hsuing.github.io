import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const F=JSON.parse('{"title":"1. windows_exporter","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Monitor/Prometheus/monitor_project/1-windows_exporter.md","filePath":"guide/Linux/Monitor/Prometheus/monitor_project/1-windows_exporter.md","lastUpdated":1733622369000}'),p={name:"guide/Linux/Monitor/Prometheus/monitor_project/1-windows_exporter.md"},o=l(`<h1 id="_1-windows-exporter" tabindex="-1">1. windows_exporter <a class="header-anchor" href="#_1-windows-exporter" aria-label="Permalink to &quot;1. windows_exporter&quot;">​</a></h1><h2 id="_1-1-介绍" tabindex="-1">1.1 介绍 <a class="header-anchor" href="#_1-1-介绍" aria-label="Permalink to &quot;1.1 介绍&quot;">​</a></h2><p>收集win机器指标，该服务默认收集cpu、cpu_info、memory、process、tcp、cs、logical_disk、net、os、system、textfile、time</p><ul><li>默认安装到C:\\Program Files \\windows_exporter目录。</li><li>默认监听端口是9182</li></ul><h2 id="_1-2-部署" tabindex="-1">1.2 部署 <a class="header-anchor" href="#_1-2-部署" aria-label="Permalink to &quot;1.2 部署&quot;">​</a></h2><h3 id="_1-下载" tabindex="-1">1.下载 <a class="header-anchor" href="#_1-下载" aria-label="Permalink to &quot;1.下载&quot;">​</a></h3><p><a href="https://github.com/prometheus-community/windows_exporter" target="_blank" rel="noreferrer">官当</a></p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">wget https://github.com/prometheus-community/windows_exporter/releases/download/v0.29.2/windows_exporter-0.29.2-amd64.msi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">wget https://github.com/prometheus-community/windows_exporter/releases/download/v0.29.2/windows_exporter-0.29.2-amd64.msi</span></span></code></pre></div><h3 id="_2-安装" tabindex="-1">2.安装 <a class="header-anchor" href="#_2-安装" aria-label="Permalink to &quot;2.安装&quot;">​</a></h3><p>直接双击运行安装，这个默认安装会自动注册到系统服务中。</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131025429.png" alt="image-20241113102506127"></p><ul><li>安装路径</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131028146.png" alt="image-20241113102835206"></p><ul><li>端口和配置文件</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131029889.png" alt="image-20241113102906685"></p><ul><li>安装</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131030159.png" alt="image-20241113102944740"></p><h3 id="_3-启动" tabindex="-1">3.启动 <a class="header-anchor" href="#_3-启动" aria-label="Permalink to &quot;3.启动&quot;">​</a></h3><p>win+R,输入services.msc</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131042283.png" alt="image-20241113104230171"></p><p>如果没有上述图片的服务，需要注入到系统服务中去，实现开机自起。</p><p>语法：</p><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">C:\\Users\\Administrator</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">sc create</span></span>
<span class="line"><span style="color:#E1E4E8;">描述:</span></span>
<span class="line"><span style="color:#E1E4E8;">        在注册表和服务数据库中创建服务项。</span></span>
<span class="line"><span style="color:#E1E4E8;">用法:</span></span>
<span class="line"><span style="color:#E1E4E8;">        sc </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">server</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> create [</span><span style="color:#F97583;">service</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">name</span><span style="color:#E1E4E8;">] [</span><span style="color:#F97583;">binPath=</span><span style="color:#E1E4E8;"> ] </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">option</span><span style="color:#F97583;">1&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">option</span><span style="color:#F97583;">2&gt;</span><span style="color:#E1E4E8;">...</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">选项:</span></span>
<span class="line"><span style="color:#E1E4E8;">注意: 选项名称包括等号。</span></span>
<span class="line"><span style="color:#E1E4E8;">      等号和值之间需要一个空格。</span></span>
<span class="line"><span style="color:#E1E4E8;"> type</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">own</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">share</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">interact</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">kernel</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">filesys</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">rec</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">       (默认 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> own)</span></span>
<span class="line"><span style="color:#E1E4E8;"> start</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">boot</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">system</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">auto</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">demand</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">disabled</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">delayed</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">auto</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">       (默认 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> demand)</span></span>
<span class="line"><span style="color:#E1E4E8;"> error</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">normal</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">severe</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">critical</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">ignore</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">       (默认 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> normal)</span></span>
<span class="line"><span style="color:#E1E4E8;"> binPath</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">BinaryPathName</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> group</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">LoadOrderGroup</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> tag</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">yes</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">no</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> depend</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">依存关系(以 </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;"> (斜杠) 分隔)</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> obj</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">AccountName</span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">ObjectName</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">       (默认 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> LocalSystem)</span></span>
<span class="line"><span style="color:#E1E4E8;"> DisplayName</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">显示名称</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;"> password</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">密码</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">C:\\Users\\Administrator</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">sc create</span></span>
<span class="line"><span style="color:#24292E;">描述:</span></span>
<span class="line"><span style="color:#24292E;">        在注册表和服务数据库中创建服务项。</span></span>
<span class="line"><span style="color:#24292E;">用法:</span></span>
<span class="line"><span style="color:#24292E;">        sc </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">server</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> create [</span><span style="color:#D73A49;">service</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">name</span><span style="color:#24292E;">] [</span><span style="color:#D73A49;">binPath=</span><span style="color:#24292E;"> ] </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">option</span><span style="color:#D73A49;">1&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">option</span><span style="color:#D73A49;">2&gt;</span><span style="color:#24292E;">...</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">选项:</span></span>
<span class="line"><span style="color:#24292E;">注意: 选项名称包括等号。</span></span>
<span class="line"><span style="color:#24292E;">      等号和值之间需要一个空格。</span></span>
<span class="line"><span style="color:#24292E;"> type</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">own</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">share</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">interact</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">kernel</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">filesys</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">rec</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">       (默认 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> own)</span></span>
<span class="line"><span style="color:#24292E;"> start</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">boot</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">system</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">auto</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">demand</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">disabled</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">delayed</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">auto</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">       (默认 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> demand)</span></span>
<span class="line"><span style="color:#24292E;"> error</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">normal</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">severe</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">critical</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">ignore</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">       (默认 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> normal)</span></span>
<span class="line"><span style="color:#24292E;"> binPath</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">BinaryPathName</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;"> group</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">LoadOrderGroup</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;"> tag</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">yes</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">no</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;"> depend</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">依存关系(以 </span><span style="color:#D73A49;">/</span><span style="color:#24292E;"> (斜杠) 分隔)</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;"> obj</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">AccountName</span><span style="color:#D73A49;">|</span><span style="color:#24292E;">ObjectName</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">       (默认 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> LocalSystem)</span></span>
<span class="line"><span style="color:#24292E;"> DisplayName</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">显示名称</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;"> password</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">密码</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><ul><li>创建服务</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">C:\\Users\\Administrator&gt;sc create windows_exporter binpath= C:\\windows_exporter.exe type= own start= auto displayname= windows_exporter</span></span>
<span class="line"><span style="color:#e1e4e8;">[SC] CreateService 成功</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">C:\\Users\\Administrator&gt;sc create windows_exporter binpath= C:\\windows_exporter.exe type= own start= auto displayname= windows_exporter</span></span>
<span class="line"><span style="color:#24292e;">[SC] CreateService 成功</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">❌ 注意</p><p>等号“=”与值之间有一个空格，必需要保留，如果不保留，运行会出错。</p></div><ul><li>删除服务</li></ul><div class="language-powershell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">C:\\Users\\Administrator</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">sc delete windows_exporter</span></span>
<span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#F97583;">SC</span><span style="color:#E1E4E8;">] DeleteService 成功</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">C:\\Users\\Administrator</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">sc delete windows_exporter</span></span>
<span class="line"><span style="color:#24292E;">[</span><span style="color:#D73A49;">SC</span><span style="color:#24292E;">] DeleteService 成功</span></span></code></pre></div><h3 id="_4-访问" tabindex="-1">4.访问 <a class="header-anchor" href="#_4-访问" aria-label="Permalink to &quot;4.访问&quot;">​</a></h3><p>ip:9182/metrics</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131046627.png" alt="image-20241113104646833"></p><h2 id="_1-3-prometheus采集" tabindex="-1">1.3 prometheus采集 <a class="header-anchor" href="#_1-3-prometheus采集" aria-label="Permalink to &quot;1.3 prometheus采集&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">job_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Windows</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">static_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">targets</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">10.103.236.129:9182</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">scrape_interval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1m</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">scrape_timeout</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">30s</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">scheme</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">http</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">metrics_path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;/metrics&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">honor_labels</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">job_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Windows</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">static_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">targets</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">10.103.236.129:9182</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">scrape_interval</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1m</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">scrape_timeout</span><span style="color:#24292E;">: </span><span style="color:#032F62;">30s</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">scheme</span><span style="color:#24292E;">: </span><span style="color:#032F62;">http</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">metrics_path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;/metrics&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">honor_labels</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span></code></pre></div><ul><li>重新加载服务</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-XPOST</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">http://prometheus.ikubernetes.net/-/reload</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">curl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-XPOST</span><span style="color:#24292E;">  </span><span style="color:#032F62;">http://prometheus.ikubernetes.net/-/reload</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131158025.png" alt="image-20241113115828526"></p><h3 id="_1-告警规则" tabindex="-1">1.告警规则 <a class="header-anchor" href="#_1-告警规则" aria-label="Permalink to &quot;1.告警规则&quot;">​</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">windos.rules</span><span style="color:#E1E4E8;">: </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#9ECBFF;">    groups:</span></span>
<span class="line"><span style="color:#9ECBFF;">    - name: windos.rules</span></span>
<span class="line"><span style="color:#9ECBFF;">      rules:</span></span>
<span class="line"><span style="color:#9ECBFF;">      - alert: Windows_采集器状态</span></span>
<span class="line"><span style="color:#9ECBFF;">        expr: windows_exporter_collector_success == 0</span></span>
<span class="line"><span style="color:#9ECBFF;">        for: 0m</span></span>
<span class="line"><span style="color:#9ECBFF;">        labels:</span></span>
<span class="line"><span style="color:#9ECBFF;">          severity: critical</span></span>
<span class="line"><span style="color:#9ECBFF;">        annotations:</span></span>
<span class="line"><span style="color:#9ECBFF;">          summary: Windows Server collector Error (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#9ECBFF;">          description: &quot;Collector {{ $labels.collector }} was not successful\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">      - alert: Windows_ServerServiceStatus</span></span>
<span class="line"><span style="color:#9ECBFF;">        expr: windows_service_state{ name=&quot;MSSQLSERVER&quot;, state=&quot;running&quot;} != 1</span></span>
<span class="line"><span style="color:#9ECBFF;">        for: 1m</span></span>
<span class="line"><span style="color:#9ECBFF;">        labels:</span></span>
<span class="line"><span style="color:#9ECBFF;">          severity: critical</span></span>
<span class="line"><span style="color:#9ECBFF;">        annotations:</span></span>
<span class="line"><span style="color:#9ECBFF;">          summary: Windows Server service Status (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#9ECBFF;">          description: &quot;Windows Service state is not OK\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">      - alert: Windows_cpu</span></span>
<span class="line"><span style="color:#9ECBFF;">        expr: 100 - (avg by (instance) (rate(windows_cpu_time_total{mode=&quot;idle&quot;}[2m])) * 100) &gt; 80</span></span>
<span class="line"><span style="color:#9ECBFF;">        for: 0m</span></span>
<span class="line"><span style="color:#9ECBFF;">        labels:</span></span>
<span class="line"><span style="color:#9ECBFF;">          severity: critical</span></span>
<span class="line"><span style="color:#9ECBFF;">        annotations:</span></span>
<span class="line"><span style="color:#9ECBFF;">          summary: Windows Server CPU Usage (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#9ECBFF;">          description: &quot;CPU Usage is more than 80%\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">      - alert: Windows_mem</span></span>
<span class="line"><span style="color:#9ECBFF;">        expr: 100 - ((windows_os_physical_memory_free_bytes / windows_cs_physical_memory_bytes) * 100) &gt; 80</span></span>
<span class="line"><span style="color:#9ECBFF;">        for: 2m</span></span>
<span class="line"><span style="color:#9ECBFF;">        labels:</span></span>
<span class="line"><span style="color:#9ECBFF;">          severity: critical</span></span>
<span class="line"><span style="color:#9ECBFF;">        annotations:</span></span>
<span class="line"><span style="color:#9ECBFF;">          summary: Windows Server memory Usage (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#9ECBFF;">          description: &quot;Memory usage is more than 80%\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">      - alert: Windows_disk</span></span>
<span class="line"><span style="color:#9ECBFF;">        expr: 100.0 - 100 * ((windows_logical_disk_free_bytes / 1024 / 1024 ) / (windows_logical_disk_size_bytes / 1024 / 1024)) &gt; 80</span></span>
<span class="line"><span style="color:#9ECBFF;">        for: 2m</span></span>
<span class="line"><span style="color:#9ECBFF;">        labels:</span></span>
<span class="line"><span style="color:#9ECBFF;">          severity: critical</span></span>
<span class="line"><span style="color:#9ECBFF;">        annotations:</span></span>
<span class="line"><span style="color:#9ECBFF;">          summary: Windows Server disk Space Usage (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#9ECBFF;">          description: &quot;Disk usage is more than 80%\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">windos.rules</span><span style="color:#24292E;">: </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#032F62;">    groups:</span></span>
<span class="line"><span style="color:#032F62;">    - name: windos.rules</span></span>
<span class="line"><span style="color:#032F62;">      rules:</span></span>
<span class="line"><span style="color:#032F62;">      - alert: Windows_采集器状态</span></span>
<span class="line"><span style="color:#032F62;">        expr: windows_exporter_collector_success == 0</span></span>
<span class="line"><span style="color:#032F62;">        for: 0m</span></span>
<span class="line"><span style="color:#032F62;">        labels:</span></span>
<span class="line"><span style="color:#032F62;">          severity: critical</span></span>
<span class="line"><span style="color:#032F62;">        annotations:</span></span>
<span class="line"><span style="color:#032F62;">          summary: Windows Server collector Error (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#032F62;">          description: &quot;Collector {{ $labels.collector }} was not successful\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#032F62;">      - alert: Windows_ServerServiceStatus</span></span>
<span class="line"><span style="color:#032F62;">        expr: windows_service_state{ name=&quot;MSSQLSERVER&quot;, state=&quot;running&quot;} != 1</span></span>
<span class="line"><span style="color:#032F62;">        for: 1m</span></span>
<span class="line"><span style="color:#032F62;">        labels:</span></span>
<span class="line"><span style="color:#032F62;">          severity: critical</span></span>
<span class="line"><span style="color:#032F62;">        annotations:</span></span>
<span class="line"><span style="color:#032F62;">          summary: Windows Server service Status (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#032F62;">          description: &quot;Windows Service state is not OK\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#032F62;">      - alert: Windows_cpu</span></span>
<span class="line"><span style="color:#032F62;">        expr: 100 - (avg by (instance) (rate(windows_cpu_time_total{mode=&quot;idle&quot;}[2m])) * 100) &gt; 80</span></span>
<span class="line"><span style="color:#032F62;">        for: 0m</span></span>
<span class="line"><span style="color:#032F62;">        labels:</span></span>
<span class="line"><span style="color:#032F62;">          severity: critical</span></span>
<span class="line"><span style="color:#032F62;">        annotations:</span></span>
<span class="line"><span style="color:#032F62;">          summary: Windows Server CPU Usage (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#032F62;">          description: &quot;CPU Usage is more than 80%\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#032F62;">      - alert: Windows_mem</span></span>
<span class="line"><span style="color:#032F62;">        expr: 100 - ((windows_os_physical_memory_free_bytes / windows_cs_physical_memory_bytes) * 100) &gt; 80</span></span>
<span class="line"><span style="color:#032F62;">        for: 2m</span></span>
<span class="line"><span style="color:#032F62;">        labels:</span></span>
<span class="line"><span style="color:#032F62;">          severity: critical</span></span>
<span class="line"><span style="color:#032F62;">        annotations:</span></span>
<span class="line"><span style="color:#032F62;">          summary: Windows Server memory Usage (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#032F62;">          description: &quot;Memory usage is more than 80%\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span>
<span class="line"><span style="color:#032F62;">      - alert: Windows_disk</span></span>
<span class="line"><span style="color:#032F62;">        expr: 100.0 - 100 * ((windows_logical_disk_free_bytes / 1024 / 1024 ) / (windows_logical_disk_size_bytes / 1024 / 1024)) &gt; 80</span></span>
<span class="line"><span style="color:#032F62;">        for: 2m</span></span>
<span class="line"><span style="color:#032F62;">        labels:</span></span>
<span class="line"><span style="color:#032F62;">          severity: critical</span></span>
<span class="line"><span style="color:#032F62;">        annotations:</span></span>
<span class="line"><span style="color:#032F62;">          summary: Windows Server disk Space Usage (instance {{ $labels.instance }})</span></span>
<span class="line"><span style="color:#032F62;">          description: &quot;Disk usage is more than 80%\\n  VALUE = {{ $value }}\\n  LABELS = {{ $labels }}&quot;</span></span></code></pre></div><h2 id="_1-4-grafana" tabindex="-1">1.4 grafana <a class="header-anchor" href="#_1-4-grafana" aria-label="Permalink to &quot;1.4 grafana&quot;">​</a></h2><p>默认搜索，<a href="https://grafana.com/grafana/dashboards/" target="_blank" rel="noreferrer">https://grafana.com/grafana/dashboards/</a></p><p>模板使用10467</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411131205227.png" alt="image-20241113120529306"></p>`,42),e=[o];function t(c,r,i,y,E,d){return a(),n("div",null,e)}const m=s(p,[["render",t]]);export{F as __pageData,m as default};
