import{_ as s,o as a,c as n,R as p}from"./chunks/framework.zUbWieqp.js";const h=JSON.parse('{"title":"Jenkins安装插件提速","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Jenkins/plus/1-plugins_speed.md","filePath":"guide/Linux/Jenkins/plus/1-plugins_speed.md","lastUpdated":1720533756000}'),e={name:"guide/Linux/Jenkins/plus/1-plugins_speed.md"},o=p(`<h1 id="jenkins安装插件提速" tabindex="-1">Jenkins安装插件提速 <a class="header-anchor" href="#jenkins安装插件提速" aria-label="Permalink to &quot;Jenkins安装插件提速&quot;">​</a></h1><p><a href="https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json" target="_blank" rel="noreferrer">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</a></p><p>替换原来的官方的json，看看清华源拉下来的是什么</p><ul><li>1-操作步骤</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">$ cd {你的Jenkins工作目录}/updates  #进入更新配置位置</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">$ cd {你的Jenkins工作目录}/updates  #进入更新配置位置</span></span></code></pre></div><ul><li>2-sed 替换</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">$ sed -i &#39;s/http:\\/\\/updates.jenkins-ci.org\\/download/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/jenkins/g&#39; default.json &amp;&amp; sed -i &#39;s/http:\\/\\/www.google.com/https:\\/\\/www.baidu.com/g&#39; default.json</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">$ sed -i &#39;s/http:\\/\\/updates.jenkins-ci.org\\/download/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/jenkins/g&#39; default.json &amp;&amp; sed -i &#39;s/http:\\/\\/www.google.com/https:\\/\\/www.baidu.com/g&#39; default.json</span></span></code></pre></div><blockquote><p>替换完之后，速度杠杠的</p></blockquote><h2 id="操作步骤" tabindex="-1">操作步骤 <a class="header-anchor" href="#操作步骤" aria-label="Permalink to &quot;操作步骤&quot;">​</a></h2><p>以上的配置Json其实在Jenkins的工作目录中，提供三种方式加速插件安装，第1、2种本质是一样的，第3种适合当前所有版本！</p><h3 id="第一种方式-使用vim" tabindex="-1">第一种方式：使用vim <a class="header-anchor" href="#第一种方式-使用vim" aria-label="Permalink to &quot;第一种方式：使用vim&quot;">​</a></h3><p>方式：通过Vim对Jenkins启动后从官方地址下载的default.json修改，需要先等default.json下载完成才能进行</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cd</span><span style="color:#E1E4E8;"> \${JENKINS_HOME}</span><span style="color:#9ECBFF;">/updates</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#进入更新配置位置</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">vim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">default.json</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">#这个Json文件与上边的配置文件是相同的</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cd</span><span style="color:#24292E;"> \${JENKINS_HOME}</span><span style="color:#032F62;">/updates</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#进入更新配置位置</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">default.json</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">#这个Json文件与上边的配置文件是相同的</span></span></code></pre></div><p>这里wiki和github的文档不用改，我们就可以成功修改这个配置</p><p>使用vim的命令，如下，替换所有插件下载的url</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">:1,$s/http:\\/\\/updates.jenkins-ci.org\\/download/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/jenkins/g</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">:1,$s/http:\\/\\/updates.jenkins-ci.org\\/download/https:\\/\\/mirrors.tuna.tsinghua.edu.cn\\/jenkins/g</span></span></code></pre></div><p>替换连接测试url</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">:1,$s/http:\\/\\/www.google.com/https:\\/\\/www.baidu.com/g</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">:1,$s/http:\\/\\/www.google.com/https:\\/\\/www.baidu.com/g</span></span></code></pre></div><blockquote><p>进入vim先输入<code>：</code>然后再粘贴上边的<code>：</code>后边的命令，注意不要写两个冒号！</p></blockquote><p>修改完成保存退出<code>:wq</code></p><h3 id="第二种方式-使用sed" tabindex="-1">第二种方式：使用sed <a class="header-anchor" href="#第二种方式-使用sed" aria-label="Permalink to &quot;第二种方式：使用sed&quot;">​</a></h3><p>方式：通过 <code>sed</code> 命令对 Jenkins 启动后从官方地址下载的 <code>default.json</code> 修改，需要先等 <code>default.json</code> 下载完成才能进行</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cd</span><span style="color:#E1E4E8;"> \${JENKINS_HOME}</span><span style="color:#9ECBFF;">/updates</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#进入更新配置位置</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;s#http://updates.jenkins-ci.org/download#https://mirrors.tuna.tsinghua.edu.cn/jenkins#g&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">default.json</span><span style="color:#E1E4E8;"> &amp;&amp; </span><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;s#http://www.google.com#https://www.baidu.com#g&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">default.json</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cd</span><span style="color:#24292E;"> \${JENKINS_HOME}</span><span style="color:#032F62;">/updates</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#进入更新配置位置</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;s#http://updates.jenkins-ci.org/download#https://mirrors.tuna.tsinghua.edu.cn/jenkins#g&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">default.json</span><span style="color:#24292E;"> &amp;&amp; </span><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;s#http://www.google.com#https://www.baidu.com#g&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">default.json</span></span></code></pre></div><blockquote><p>这是直接修改的配置文件，如果前边 Jenkins 用 <code>sudo</code> 启动的话，那么这里的两个 <code>sed</code> 前均需要加上 <code>sudo</code></p></blockquote><h3 id="第三种方式-下载一份update-center-json-手动修改后放到本地web服务器中" tabindex="-1">第三种方式：下载一份update-center.json，手动修改后放到本地web服务器中 <a class="header-anchor" href="#第三种方式-下载一份update-center-json-手动修改后放到本地web服务器中" aria-label="Permalink to &quot;第三种方式：下载一份update-center.json，手动修改后放到本地web服务器中&quot;">​</a></h3><p>方式：提前准备好修改后的update-center.json，代替 default.json 发挥作用，无需等官方 <code>default.json</code> 下载</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> $JENKINS_HOME</span></span>
<span class="line"><span style="color:#B392F0;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-Lo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">update-center.json</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</span></span>
<span class="line"><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;s#http://updates.jenkins-ci.org/download#https://mirrors.tuna.tsinghua.edu.cn/jenkins#g&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">update-center.json</span><span style="color:#E1E4E8;"> &amp;&amp; </span><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;s#http://www.google.com#https://www.baidu.com#g&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">update-center.json</span></span>
<span class="line"><span style="color:#6A737D;">#安装Nginx</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apt</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span>
<span class="line"><span style="color:#6A737D;">#移动配置到nginx默认web目录</span></span>
<span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mv</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">update-center.json</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/var/www/html/</span></span>
<span class="line"><span style="color:#6A737D;">#修改Jenkins配置文件</span></span>
<span class="line"><span style="color:#B392F0;">sed</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-i</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;s#http://本地Nginx-IP/update-center.json#https://updates.jenkins.io/update-center.json#g&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">hudson.model.UpdateCenter.xml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> $JENKINS_HOME</span></span>
<span class="line"><span style="color:#6F42C1;">curl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-Lo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">update-center.json</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json</span></span>
<span class="line"><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;s#http://updates.jenkins-ci.org/download#https://mirrors.tuna.tsinghua.edu.cn/jenkins#g&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">update-center.json</span><span style="color:#24292E;"> &amp;&amp; </span><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;s#http://www.google.com#https://www.baidu.com#g&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">update-center.json</span></span>
<span class="line"><span style="color:#6A737D;">#安装Nginx</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apt</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span>
<span class="line"><span style="color:#6A737D;">#移动配置到nginx默认web目录</span></span>
<span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mv</span><span style="color:#24292E;"> </span><span style="color:#032F62;">update-center.json</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/var/www/html/</span></span>
<span class="line"><span style="color:#6A737D;">#修改Jenkins配置文件</span></span>
<span class="line"><span style="color:#6F42C1;">sed</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-i</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;s#http://本地Nginx-IP/update-center.json#https://updates.jenkins.io/update-center.json#g&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">hudson.model.UpdateCenter.xml</span></span></code></pre></div><p>重启Jenkins，安装插件试试，简直超速！！</p><h2 id="原理" tabindex="-1">原理 <a class="header-anchor" href="#原理" aria-label="Permalink to &quot;原理&quot;">​</a></h2><p>之前刚写本文时流程是 Jenkins 启动后，会通过 <code>hudson.model.UpdateCenter.xml</code> 中的 url 下载 <code>update-center.json</code> 将 <code>id</code> 设置成 <code>json</code> 的名称放入 <code>updates</code> 目录中，当 <code>updates/default.json</code> 生成后，就不再更新它。</p><p>修改方式1与2就是通过修改其下载后的 <code>updates/default.json</code> 解决问题。然而现在情况变了，新版本Jenkins（2.272实测，其它版本请自测）不再将update-center.json放入updates目录中了，所以后续版本推荐第三种方式</p>`,31),l=[o];function t(c,r,d,i,u,y){return a(),n("div",null,l)}const g=s(e,[["render",t]]);export{h as __pageData,g as default};
