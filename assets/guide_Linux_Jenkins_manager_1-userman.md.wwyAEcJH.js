import{_ as n,o as s,c as a,R as o}from"./chunks/framework.zUbWieqp.js";const d=JSON.parse('{"title":"二、 项目矩阵授权策略","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Jenkins/manager/1-userman.md","filePath":"guide/Linux/Jenkins/manager/1-userman.md","lastUpdated":1720533756000}'),t={name:"guide/Linux/Jenkins/manager/1-userman.md"},p=o('<p><strong>第一步：安装角色策略插件</strong></p><ol><li>安装插件<code>Role-base Authorization Strategy</code></li><li>Jenkins &gt; Manage Jenkin &gt; Configure Global Security &gt; Authorization &gt; 选中<code>Role-Based Strategy</code></li><li>Jenkins &gt; Manage Jenkin &gt; Manage and Assign Roles</li><li>Manage Role</li></ol><p>为jenkins安装角色策略插件，通过配置角色策略可以解决上面问题。插件名称：<a href="https://www.jianshu.com/download/attachments/66591/role-strategy.hpi?version=1&amp;modificationDate=1573453953000&amp;api=v2" target="_blank" rel="noreferrer">role-strategy.hpi</a></p><p>每个项目分配两个账号：</p><p>一个账号可以查看并修改job配置，修改配置，可新建job –（对应开发）</p><p>另外一个账号只有构建权限，无法修改 job配置 –（对应测试）</p><p>不同项目组账号登录之后，jenkins视图只显示自己项目组的job</p><p><strong>第二步：准备项目测试账号</strong></p><p>规划两个项目组，如内部工单系统、账户管理系统，分别以BPS、AMS简称。</p><p>每个项目组设置两个账号，如：BPS_DEV 代表BPS开发人员账号、BPS_SIT 代表BPS测试人员账号</p><p>账户管理系统也按如下设置：AMS_DEV 代表AMS开发人员账号、AMS_SIT 代表AMS测试人员账号</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242153985.png" alt=""></p><h4 id="第三步-启用角色控制权限" tabindex="-1">第三步：启用角色控制权限 <a class="header-anchor" href="#第三步-启用角色控制权限" aria-label="Permalink to &quot;第三步：启用角色控制权限&quot;">​</a></h4><p>管理Jenkins——Configure Global Security，勾选以下两项：</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242153604.png" alt=""></p><h4 id="第四步-创建角色" tabindex="-1">第四步：创建角色 <a class="header-anchor" href="#第四步-创建角色" aria-label="Permalink to &quot;第四步：创建角色&quot;">​</a></h4><p>管理Jenkins——Manage and Assign Roles——Manage Roles，</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242153322.png" alt=""></p><p><strong>创建一个全局角色</strong></p><p>这里简单说明以下，全局角色和项目角色的区别</p><p>全局角色即拥有Jenkins全部访问权限</p><p>项目角色即拥有指定项目的访问权限。</p><p>这里先创建一个全局角色：zhouyou ,这里勾选Overall的read权限</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242154408.png" alt=""></p><p><strong>创建项目角色</strong></p><p>分别创建两个项目的角色，按照规划的分配权限，Pattern用于给项目匹配 job，使用正则表达式</p><p><strong>正则表达式</strong></p><p>这里的正则表达式和脚本里的正则表达式有点不太一样，简单介绍一下规则</p><blockquote><p>AMS.* 表示所有以AMS开头的项目</p><p>（？！）AMS. * 表示所有以AMS-开头的项目，并且不区分大小写</p><p>AMS|BPS.* 表示所有以AMS或BPS开头的项目</p></blockquote><p>创建项目的角色及权限划分如下</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242154045.png" alt=""></p><h4 id="第五步-给用户分配角色" tabindex="-1"><strong>第五步：给用户分配角色</strong> <a class="header-anchor" href="#第五步-给用户分配角色" aria-label="Permalink to &quot;**第五步：给用户分配角色**&quot;">​</a></h4><p>系统管理——Manage and Assign Roles——Assign Roles</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242154884.png" alt=""></p><h4 id="第六步-创建视图" tabindex="-1"><strong>第六步：创建视图</strong> <a class="header-anchor" href="#第六步-创建视图" aria-label="Permalink to &quot;**第六步：创建视图**&quot;">​</a></h4><p>以账户管理系统AMS为例</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242154454.png" alt=""></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242154547.png" alt=""></p><h4 id="第七步-创建构建任务" tabindex="-1"><strong>第七步：创建构建任务</strong> <a class="header-anchor" href="#第七步-创建构建任务" aria-label="Permalink to &quot;**第七步：创建构建任务**&quot;">​</a></h4><h4 id="案例" tabindex="-1">案例： <a class="header-anchor" href="#案例" aria-label="Permalink to &quot;案例：&quot;">​</a></h4><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242155830.png" alt=""></p><p>Assign Roles</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242155559.png" alt=""></p><h1 id="二、-项目矩阵授权策略" tabindex="-1">二、 <strong>项目矩阵授权策略</strong> <a class="header-anchor" href="#二、-项目矩阵授权策略" aria-label="Permalink to &quot;二、 **项目矩阵授权策略**&quot;">​</a></h1><h2 id="_1、新增用户" tabindex="-1">1、新增用户 <a class="header-anchor" href="#_1、新增用户" aria-label="Permalink to &quot;1、新增用户&quot;">​</a></h2><p>**方式一：开发人员自行注册用户，操作步骤如下： **</p><p>**1）系统管理 --&gt;&gt; 全局安全配置 --&gt;&gt; 勾选允许用户注册 **</p><p><strong>注：如果此处选择了&quot;允许用户注册&quot;，那么任何人都可以注册，只是注册后没有任何的操作权限，登陆后会提示&quot;Access Denied，没有Overall/Read权限&quot;，还是需要在管理员账号下授权后才能操作）</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242155318.png" alt=""></p><p><strong>2）配置完毕后，返回登录页，如下图</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242155239.png" alt=""></p><p><strong>方式二：管理员创建用户，操作步骤如下</strong></p><p><strong>1）系统管理 --&gt;&gt; 管理用户 --&gt;&gt; 新建用户</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242155263.png" alt=""></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242155016.png" alt=""></p><p>**2）输入注册信息 **</p><p><strong>注：这里新增test用户为例</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242155087.png" alt=""></p><p>**注：请结合自身项目情况选择方式分配。 **</p><h2 id="_2、添加用户权限" tabindex="-1">2、添加用户权限 <a class="header-anchor" href="#_2、添加用户权限" aria-label="Permalink to &quot;2、添加用户权限&quot;">​</a></h2><p><strong>1）系统管理 --&gt;&gt; 全局安全配置 --&gt;&gt; 项目矩阵授权策略</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242156786.png" alt=""></p><p><strong>2）勾选项目矩阵授权策略，配置只读权限</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242156942.png" alt=""></p><p><strong>注：如果不分配read权限，登陆后会提示&quot;Access Denied，没有Overall/Read权限&quot;，这里是全局的哦，开启后所有验证用户都具备read权限，点击保存后管理员用户自动添加</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242156104.png" alt=""></p><p>**3）配置项目权限 **</p><p>**注：一般而言，除了运维人员（管理员）具有所有项目操作的权限外，一般只给开发人员（通常是项目组的负责人）Beta环境下的项目操作权限。如下，只给test这个用户设置构建项目的权限。 **</p><p><strong>1）进入相应的项目构建配置里，&quot;启用项目安全&quot;，将相应的用户添加进去，赋予操作权限，说明他们对该项目由构建的权限。如下：</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242156664.png" alt=""></p><p><strong>2）添加指定用户或组</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242156487.png" alt=""></p><p>**3）分配权限：Build和read **</p><p><strong>注：只能构建操作，不能做其他操作</strong></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202406242156849.png" alt=""></p><p>**4）登录test用户验证 **</p><p><strong># 登录成功后台，当前视图会显示所有有权限的项目</strong></p>',77),g=[p];function i(e,r,c,l,h,u){return s(),a("div",null,g)}const _=n(t,[["render",i]]);export{d as __pageData,_ as default};
