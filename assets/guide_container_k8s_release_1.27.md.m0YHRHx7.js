import{_ as e,o,c as a,R as d}from"./chunks/framework.zUbWieqp.js";const P=JSON.parse('{"title":"1.v1.27 有什么新内容？","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/release/1.27.md","filePath":"guide/container/k8s/release/1.27.md","lastUpdated":1736763438000}'),t={name:"guide/container/k8s/release/1.27.md"},c=d('<p>在 Kubernetes v1.27 中，添加了一个新的 alpha 功能，允许用户在不重启容器的情况下调整分配给 Pod 的 CPU 或 memory 资源的大小。为了实现这一点，pod container 中的 <code>resources</code> 字段现在允许对 <code>cpu</code> 和 <code>memory</code> 资源进行更改。可以通过 patch 修改正在运行的 pod spec 来实现。</p><p>这也意味着 pod.spec 中 <code>resources</code> 字段不能再作为 pod 实际资源的指标。监控工具和其他此类应用程序现在必须查看 pod status 中的新字段。Kubernetes 通过 CRI（容器运行时接口）API 调用运行时（例如负责运行容器的 containerd）来查询实际的 request CPU 和 memory 和 limit。来自容器运行时的响应反映在 pod 的 status 中。</p><p>此外，还添加了一个 <code>restartPolicy</code> 字段，它使用户可以控制：在调整资源大小时如何处理容器。</p><h1 id="_1-v1-27-有什么新内容" tabindex="-1">1.v1.27 有什么新内容？ <a class="header-anchor" href="#_1-v1-27-有什么新内容" aria-label="Permalink to &quot;1.v1.27 有什么新内容？&quot;">​</a></h1><p>除了在 Pod 的 spec 中添加调整大小策略外，还在 Pod 的 status 中添加了一个名为 <code>allocatedResources</code> 的新字段。<code>containerStatuses</code>该字段反映了分配给 Pod 容器的节点资源。</p><p>此外，一个名为<code>resources</code>的新字段已添加到容器的 status 中。该字段反映容器运行时报告的在运行容器上配置的实际资源 request 和 limit。</p><p>最后，一个名为<code>resize</code>的新字段已添加到 pod 的 status，以显示上次请求调整大小的状态。</p><ul><li><code>Proposed</code>值是对请求的调整大小的确认，并指示该请求已被验证和记录。</li><li><code>InProgress</code>值表示节点已接受调整大小请求，并且正在将调整大小请求应用于 pod 的容器。</li><li><code>Deferred</code>值为表示此时无法授予请求的调整大小，节点将不断重试。当其他 pod 离开并释放节点资源时，可以授予调整大小。</li><li><code>Infeasible</code>的值是一个信号，表明该节点无法适应请求的调整大小。如果请求的调整大小超过节点可以为 pod 分配的最大资源，就会发生这种情况。</li></ul><h2 id="_1-2-何时使用此功能" tabindex="-1">1.2 何时使用此功能 <a class="header-anchor" href="#_1-2-何时使用此功能" aria-label="Permalink to &quot;1.2 何时使用此功能&quot;">​</a></h2><p>以下是此功能可能有用的几个示例：</p><ul><li>Pod 在节点上运行，但资源过多或过少。</li><li>Pod 没有被调度是因为集群中没有足够的 CPU 或内存，而集群中运行的 Pod 被过度配置而未得到充分利用。</li><li>驱逐那些需要更多资源以将它们调度到更大节点上的有状态 pod，是一项昂贵或破坏性的操作，可以缩小或移动节点中优先级较低的 pod</li></ul><h2 id="_1-3-如何使用此功能" tabindex="-1">1.3 如何使用此功能 <a class="header-anchor" href="#_1-3-如何使用此功能" aria-label="Permalink to &quot;1.3 如何使用此功能&quot;">​</a></h2><p>为了在 v1.27 中使用此功能，必须启用 <code>InPlacePodVerticalScaling</code> 功能门。可以启动一个启用了此功能的本地集群</p>',13),s=[c];function r(i,l,p,n,_,u){return o(),a("div",null,s)}const m=e(t,[["render",r]]);export{P as __pageData,m as default};
