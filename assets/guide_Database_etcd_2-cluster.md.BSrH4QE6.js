import{_ as s,o as a,c as n,R as p}from"./chunks/framework.zUbWieqp.js";const l="/assets/1.AMsbKMUO.png",C=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Database/etcd/2-cluster.md","filePath":"guide/Database/etcd/2-cluster.md","lastUpdated":1703141608000}'),o={name:"guide/Database/etcd/2-cluster.md"},t=p(`<h2 id="_1-配置文件集群" tabindex="-1">1.配置文件集群 <a class="header-anchor" href="#_1-配置文件集群" aria-label="Permalink to &quot;1.配置文件集群&quot;">​</a></h2><h3 id="_1-1下载" tabindex="-1">1.1下载 <a class="header-anchor" href="#_1-1下载" aria-label="Permalink to &quot;1.1下载&quot;">​</a></h3><p><a href="https://github.com/etcd-io/etcd/releases/download/v3.4.24/etcd-v3.4.24-linux-amd64.tar.gz" target="_blank" rel="noreferrer">https://github.com/etcd-io/etcd/releases/download/v3.4.24/etcd-v3.4.24-linux-amd64.tar.gz</a></p><h3 id="_1-2配置" tabindex="-1">1.2配置 <a class="header-anchor" href="#_1-2配置" aria-label="Permalink to &quot;1.2配置&quot;">​</a></h3><ul><li>三节点信息</li></ul><table><thead><tr><th>主机名</th><th>IP地址</th></tr></thead><tbody><tr><td>sht-sgmhadoopdn-01</td><td>172.16.101.58</td></tr><tr><td>sht-sgmhadoopdn-02</td><td>172.16.101.59</td></tr><tr><td>sht-sgmhadoopdn-03</td><td>172.16.101.60</td></tr></tbody></table><ul><li>各节点添加hosts文件解析</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cat /etc/hosts</span></span>
<span class="line"><span style="color:#B392F0;">127.0.0.1</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">localhost</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost.localdomain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost4</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost4.localdomain4</span></span>
<span class="line"><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;">:1         </span><span style="color:#9ECBFF;">localhost</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost.localdomain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost6</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost6.localdomain6</span></span>
<span class="line"><span style="color:#B392F0;">172.16.101.58</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">sht-sgmhadoopdn-01</span></span>
<span class="line"><span style="color:#B392F0;">172.16.101.59</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">sht-sgmhadoopdn-02</span></span>
<span class="line"><span style="color:#B392F0;">172.16.101.60</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">sht-sgmhadoopdn-03</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cat /etc/hosts</span></span>
<span class="line"><span style="color:#6F42C1;">127.0.0.1</span><span style="color:#24292E;">   </span><span style="color:#032F62;">localhost</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost.localdomain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost4</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost4.localdomain4</span></span>
<span class="line"><span style="color:#005CC5;">:</span><span style="color:#24292E;">:1         </span><span style="color:#032F62;">localhost</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost.localdomain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost6</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost6.localdomain6</span></span>
<span class="line"><span style="color:#6F42C1;">172.16.101.58</span><span style="color:#24292E;">    </span><span style="color:#032F62;">sht-sgmhadoopdn-01</span></span>
<span class="line"><span style="color:#6F42C1;">172.16.101.59</span><span style="color:#24292E;">    </span><span style="color:#032F62;">sht-sgmhadoopdn-02</span></span>
<span class="line"><span style="color:#6F42C1;">172.16.101.60</span><span style="color:#24292E;">    </span><span style="color:#032F62;">sht-sgmhadoopdn-03</span></span></code></pre></div><ul><li>创建运行etcd的用户和组</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># groupadd -r dba</span></span>
<span class="line"><span style="color:#6A737D;"># useradd -r -g dba -G root tnuser</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># groupadd -r dba</span></span>
<span class="line"><span style="color:#6A737D;"># useradd -r -g dba -G root tnuser</span></span></code></pre></div><ul><li>下载解压etcd</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">wget</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/etcd-io/etcd/releases/download/v3.4.24/etcd-v3.4.24-linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#mkdir data dir</span></span>
<span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/etcd/data</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">wget</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/etcd-io/etcd/releases/download/v3.4.24/etcd-v3.4.24-linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#mkdir data dir</span></span>
<span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/etcd/data</span></span></code></pre></div><ul><li>新建etcd配置文件etcd.conf，各节点配置文件内容如下</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#sht-sgmhadoopdn-01</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf </span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-01&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_DATA_DIR</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/data/etcd/data&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-01:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-01:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ENABLE_V2</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;true&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#sht-sgmhadoopdn-01</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf </span></span>
<span class="line"><span style="color:#24292E;">ETCD_NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-01&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_DATA_DIR</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/data/etcd/data&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-01:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-01:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ENABLE_V2</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;true&quot;</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#sht-sgmhadoopdn-02</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf </span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-02&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_DATA_DIR</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/data/etcd/data&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-02:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-02:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#sht-sgmhadoopdn-02</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf </span></span>
<span class="line"><span style="color:#24292E;">ETCD_NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-02&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_DATA_DIR</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/data/etcd/data&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-02:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-02:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380&quot;</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#sht-sgmhadoopdn-03</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf </span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-03&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_DATA_DIR</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/data/etcd/data&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-02:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-03:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#sht-sgmhadoopdn-03</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf </span></span>
<span class="line"><span style="color:#24292E;">ETCD_NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-03&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_DATA_DIR</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/data/etcd/data&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-02:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-03:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380&quot;</span></span></code></pre></div><ul><li>etcd配置系统服务，各节点的etcd.service文件内容如下</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cat /usr/lib/systemd/system/etcd.service </span></span>
<span class="line"><span style="color:#E1E4E8;">[Unit]</span></span>
<span class="line"><span style="color:#E1E4E8;">Description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">etcd</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">service</span></span>
<span class="line"><span style="color:#E1E4E8;">Documentation</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">https://github.com/etcd-io/etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network.target</span></span>
<span class="line"><span style="color:#E1E4E8;">After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"><span style="color:#E1E4E8;">Wants</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[Service]</span></span>
<span class="line"><span style="color:#E1E4E8;">User</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">tnuser</span></span>
<span class="line"><span style="color:#E1E4E8;">Type</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">notify</span></span>
<span class="line"><span style="color:#E1E4E8;">EnvironmentFile</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/usr/local/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#E1E4E8;">WorkingDirectory</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/usr/local/etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">ExecStart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/usr/local/etcd/etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">Restart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">always</span></span>
<span class="line"><span style="color:#E1E4E8;">RestartSec</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">s</span></span>
<span class="line"><span style="color:#E1E4E8;">LimitNOFILE</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">65536</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[Install]</span></span>
<span class="line"><span style="color:#E1E4E8;">WantedBy</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">multi-user.target</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cat /usr/lib/systemd/system/etcd.service </span></span>
<span class="line"><span style="color:#24292E;">[Unit]</span></span>
<span class="line"><span style="color:#24292E;">Description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">etcd</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">service</span></span>
<span class="line"><span style="color:#24292E;">Documentation</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">https://github.com/etcd-io/etcd</span></span>
<span class="line"><span style="color:#24292E;">After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network.target</span></span>
<span class="line"><span style="color:#24292E;">After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"><span style="color:#24292E;">Wants</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[Service]</span></span>
<span class="line"><span style="color:#24292E;">User</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">tnuser</span></span>
<span class="line"><span style="color:#24292E;">Type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">notify</span></span>
<span class="line"><span style="color:#24292E;">EnvironmentFile</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/usr/local/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#24292E;">WorkingDirectory</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/usr/local/etcd</span></span>
<span class="line"><span style="color:#24292E;">ExecStart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/usr/local/etcd/etcd</span></span>
<span class="line"><span style="color:#24292E;">Restart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">always</span></span>
<span class="line"><span style="color:#24292E;">RestartSec</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">10</span><span style="color:#032F62;">s</span></span>
<span class="line"><span style="color:#24292E;">LimitNOFILE</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">65536</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[Install]</span></span>
<span class="line"><span style="color:#24292E;">WantedBy</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">multi-user.target</span></span></code></pre></div><ul><li>各节点启动etcd服务</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"># systemctl daemon-reload</span></span>
<span class="line"><span style="color:#e1e4e8;"># systemctl start etcd</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"># systemctl daemon-reload</span></span>
<span class="line"><span style="color:#24292e;"># systemctl start etcd</span></span></code></pre></div><ul><li>查看集群信息</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># etcdctl endpoint status --endpoints http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379 --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">ENDPOINT</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">VERSION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">DB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SIZE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEADER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">TERM</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">APPLIED</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ERRORS</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">3.4.1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">16</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">8</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">11</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                 </span><span style="color:#B392F0;">11</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">3.4.1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">16</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">8</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">11</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                 </span><span style="color:#B392F0;">11</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">3.4.1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">16</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">8</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">11</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                 </span><span style="color:#B392F0;">11</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl endpoint health --endpoints http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379 --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">ENDPOINT</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HEALTH</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">TOOK</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ERROR</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">5.23352ms</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">5.832925ms</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">6.431018ms</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">STATUS</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">           </span><span style="color:#B392F0;">PEER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                    </span><span style="color:#B392F0;">CLIENT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">                     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-01</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-03</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-02</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># etcdctl endpoint status --endpoints http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379 --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">            </span><span style="color:#6F42C1;">ENDPOINT</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">VERSION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SIZE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEADER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">TERM</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">APPLIED</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ERRORS</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">3.4.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">16</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">8</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">11</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                 </span><span style="color:#6F42C1;">11</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">3.4.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">16</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">8</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">11</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                 </span><span style="color:#6F42C1;">11</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">3.4.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">16</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">8</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">11</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                 </span><span style="color:#6F42C1;">11</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl endpoint health --endpoints http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379 --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">            </span><span style="color:#6F42C1;">ENDPOINT</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HEALTH</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">    </span><span style="color:#6F42C1;">TOOK</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ERROR</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">5.23352ms</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">5.832925ms</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">6.431018ms</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">STATUS</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">           </span><span style="color:#6F42C1;">PEER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">CLIENT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">                     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-01</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-03</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-02</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre></div><p>修改各节点etcd.conf配置文件如下参数</p><p>原</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCD_INITIAL_CLUSTER_STATE=&quot;new&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCD_INITIAL_CLUSTER_STATE=&quot;new&quot;</span></span></code></pre></div><p>修改为</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCD_INITIAL_CLUSTER_STATE=&quot;existing&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCD_INITIAL_CLUSTER_STATE=&quot;existing&quot;</span></span></code></pre></div><p>重启各节点</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"># systemctl stop etcd</span></span>
<span class="line"><span style="color:#e1e4e8;"># systemctl start etcd</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"># systemctl stop etcd</span></span>
<span class="line"><span style="color:#24292e;"># systemctl start etcd</span></span></code></pre></div><blockquote><p>注：</p><p>该修改步骤不是必须的，只是为了使后续进行节点增加时候保持各配置文件一致性，该参数只是在添加新节点进入集群中才会起作用，重启现有集群会忽略该参数</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#把下载好的二进制文件直接cp 到/usr/bin目录下</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@hkbcwbeta data]# tree etcd_data</span></span>
<span class="line"><span style="color:#B392F0;">etcd_data</span></span>
<span class="line"><span style="color:#B392F0;">├──</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcd.conf</span></span>
<span class="line"><span style="color:#B392F0;">├──</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcds</span></span>
<span class="line"><span style="color:#B392F0;">│  </span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">└──</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">member</span></span>
<span class="line"><span style="color:#B392F0;">│  </span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">└──</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">snap</span></span>
<span class="line"><span style="color:#B392F0;">│  </span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">└──</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">db</span></span>
<span class="line"><span style="color:#B392F0;">└──</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">wal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@hkbcwbeta etcd_data]# cat etcd.conf</span></span>
<span class="line"><span style="color:#6A737D;">#[Member]</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">k8s3</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_DATA_DIR</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/data/etcd_data&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_WAL_DIR</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/data/etcd_data/wal&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_AUTO_COMPACTION_RETENTION</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_AUTO_COMPACTION_MODE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;periodic&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_MAX_SNAPSHOTS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;5&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_MAX_WALS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;5&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_SNAPSHOT_COUNT</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;50000&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_HEARTBEAT_INTERVAL</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;100&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ELECTION_TIMEOUT</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;1000&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_MAX_REQUEST_BYTES</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;10485760&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://192.168.17.134:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://192.168.17.134:2379,http://127.0.0.1:2379&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#[Clustering]</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://192.168.17.134:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://192.168.17.134:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;k8s1=http://192.168.17.132:2380,k8s2=http://192.168.17.133:2380,k8s3=http://192.168.17.134:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;etcd-cluster&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ENABLE_V2</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;true&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#把下载好的二进制文件直接cp 到/usr/bin目录下</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@hkbcwbeta data]# tree etcd_data</span></span>
<span class="line"><span style="color:#6F42C1;">etcd_data</span></span>
<span class="line"><span style="color:#6F42C1;">├──</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcd.conf</span></span>
<span class="line"><span style="color:#6F42C1;">├──</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcds</span></span>
<span class="line"><span style="color:#6F42C1;">│  </span><span style="color:#24292E;"> </span><span style="color:#032F62;">└──</span><span style="color:#24292E;"> </span><span style="color:#032F62;">member</span></span>
<span class="line"><span style="color:#6F42C1;">│  </span><span style="color:#24292E;">     </span><span style="color:#032F62;">└──</span><span style="color:#24292E;"> </span><span style="color:#032F62;">snap</span></span>
<span class="line"><span style="color:#6F42C1;">│  </span><span style="color:#24292E;">         </span><span style="color:#032F62;">└──</span><span style="color:#24292E;"> </span><span style="color:#032F62;">db</span></span>
<span class="line"><span style="color:#6F42C1;">└──</span><span style="color:#24292E;"> </span><span style="color:#032F62;">wal</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@hkbcwbeta etcd_data]# cat etcd.conf</span></span>
<span class="line"><span style="color:#6A737D;">#[Member]</span></span>
<span class="line"><span style="color:#24292E;">ETCD_NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">k8s3</span></span>
<span class="line"><span style="color:#24292E;">ETCD_DATA_DIR</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/data/etcd_data&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_WAL_DIR</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/data/etcd_data/wal&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_AUTO_COMPACTION_RETENTION</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_AUTO_COMPACTION_MODE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;periodic&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_MAX_SNAPSHOTS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;5&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_MAX_WALS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;5&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_SNAPSHOT_COUNT</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;50000&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_HEARTBEAT_INTERVAL</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;100&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ELECTION_TIMEOUT</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;1000&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_MAX_REQUEST_BYTES</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;10485760&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://192.168.17.134:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://192.168.17.134:2379,http://127.0.0.1:2379&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#[Clustering]</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://192.168.17.134:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://192.168.17.134:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;k8s1=http://192.168.17.132:2380,k8s2=http://192.168.17.133:2380,k8s3=http://192.168.17.134:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;etcd-cluster&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;new&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ENABLE_V2</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;true&quot;</span></span></code></pre></div><h3 id="启动" tabindex="-1">启动 <a class="header-anchor" href="#启动" aria-label="Permalink to &quot;启动&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@hkbcwbeta etcd_data]# cat /etc/systemd/system/etcd.service </span></span>
<span class="line"><span style="color:#E1E4E8;">[Unit]</span></span>
<span class="line"><span style="color:#E1E4E8;">Description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">Etcd</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Server</span></span>
<span class="line"><span style="color:#E1E4E8;">After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network.target</span></span>
<span class="line"><span style="color:#E1E4E8;">After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"><span style="color:#E1E4E8;">Wants</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[Service]</span></span>
<span class="line"><span style="color:#E1E4E8;">User</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">Type</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">simple</span></span>
<span class="line"><span style="color:#E1E4E8;">WorkingDirectory</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/data/etcd_data/etcds/</span></span>
<span class="line"><span style="color:#E1E4E8;">EnvironmentFile</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">-/data/etcd_data/etcd.conf</span></span>
<span class="line"><span style="color:#E1E4E8;">ExecStart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/usr/bin/etcd</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">--auto-compaction-retention</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;1&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--max-request-bytes</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;33554432&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--quota-backend-bytes</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;8589934592&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">Restart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">on-failure</span></span>
<span class="line"><span style="color:#E1E4E8;">RestartSec</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">s</span></span>
<span class="line"><span style="color:#E1E4E8;">LimitNOFILE</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">40000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[Install]</span></span>
<span class="line"><span style="color:#E1E4E8;">WantedBy</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">multi-user.target</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@hkbcwbeta etcd_data]# cat /etc/systemd/system/etcd.service </span></span>
<span class="line"><span style="color:#24292E;">[Unit]</span></span>
<span class="line"><span style="color:#24292E;">Description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">Etcd</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Server</span></span>
<span class="line"><span style="color:#24292E;">After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network.target</span></span>
<span class="line"><span style="color:#24292E;">After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"><span style="color:#24292E;">Wants</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[Service]</span></span>
<span class="line"><span style="color:#24292E;">User</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">etcd</span></span>
<span class="line"><span style="color:#24292E;">Type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">simple</span></span>
<span class="line"><span style="color:#24292E;">WorkingDirectory</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/data/etcd_data/etcds/</span></span>
<span class="line"><span style="color:#24292E;">EnvironmentFile</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">-/data/etcd_data/etcd.conf</span></span>
<span class="line"><span style="color:#24292E;">ExecStart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/usr/bin/etcd</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">--auto-compaction-retention</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;1&#39;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--max-request-bytes</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;33554432&#39;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--quota-backend-bytes</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;8589934592&#39;</span></span>
<span class="line"><span style="color:#24292E;">Restart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">on-failure</span></span>
<span class="line"><span style="color:#24292E;">RestartSec</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">10</span><span style="color:#032F62;">s</span></span>
<span class="line"><span style="color:#24292E;">LimitNOFILE</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">40000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[Install]</span></span>
<span class="line"><span style="color:#24292E;">WantedBy</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">multi-user.target</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#集群方式启动</span></span>
<span class="line"><span style="color:#E1E4E8;"> [Unit]</span></span>
<span class="line"><span style="color:#E1E4E8;">    Description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">Etcd</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Server</span></span>
<span class="line"><span style="color:#E1E4E8;">    After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network.target</span></span>
<span class="line"><span style="color:#E1E4E8;">    After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"><span style="color:#E1E4E8;">    Wants</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"><span style="color:#E1E4E8;">    [Service]</span></span>
<span class="line"><span style="color:#E1E4E8;">    Type</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">notify</span></span>
<span class="line"><span style="color:#E1E4E8;">    WorkingDirectory</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/var/lib/etcd/</span></span>
<span class="line"><span style="color:#E1E4E8;">    EnvironmentFile</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">-/etc/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#E1E4E8;">    User</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># set GOMAXPROCS to number of processors</span></span>
<span class="line"><span style="color:#E1E4E8;">    ExecStart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/bin/bash</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;GOMAXPROCS=$(</span><span style="color:#B392F0;">nproc</span><span style="color:#9ECBFF;">) /usr/bin/etcd </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --name=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_NAME</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --data-dir=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_DATA_DIR</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --listen-peer-urls=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_LISTEN_PEER_URLS</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --advertise-client-urls=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --initial-cluster-token=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --initial-cluster=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">  </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --initial-cluster-state=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#9ECBFF;">    --listen-client-urls=</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">\${</span><span style="color:#E1E4E8;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#9ECBFF;">}</span><span style="color:#79B8FF;">\\&quot;</span><span style="color:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    Restart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">on-failure</span></span>
<span class="line"><span style="color:#E1E4E8;">    LimitNOFILE</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">65536</span></span>
<span class="line"><span style="color:#E1E4E8;">    [Install]</span></span>
<span class="line"><span style="color:#E1E4E8;">    WantedBy</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">multi-user.target</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#6A737D;">#集群方式启动</span></span>
<span class="line"><span style="color:#24292E;"> [Unit]</span></span>
<span class="line"><span style="color:#24292E;">    Description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">Etcd</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Server</span></span>
<span class="line"><span style="color:#24292E;">    After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network.target</span></span>
<span class="line"><span style="color:#24292E;">    After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"><span style="color:#24292E;">    Wants</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"><span style="color:#24292E;">    [Service]</span></span>
<span class="line"><span style="color:#24292E;">    Type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">notify</span></span>
<span class="line"><span style="color:#24292E;">    WorkingDirectory</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/var/lib/etcd/</span></span>
<span class="line"><span style="color:#24292E;">    EnvironmentFile</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">-/etc/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#24292E;">    User</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">etcd</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6A737D;"># set GOMAXPROCS to number of processors</span></span>
<span class="line"><span style="color:#24292E;">    ExecStart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/bin/bash</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">-c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;GOMAXPROCS=$(</span><span style="color:#6F42C1;">nproc</span><span style="color:#032F62;">) /usr/bin/etcd </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --name=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_NAME</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --data-dir=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_DATA_DIR</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --listen-peer-urls=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_LISTEN_PEER_URLS</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --advertise-client-urls=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --initial-cluster-token=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --initial-cluster=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_INITIAL_CLUSTER</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">  </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --initial-cluster-state=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#032F62;">    --listen-client-urls=</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">\${</span><span style="color:#24292E;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#032F62;">}</span><span style="color:#005CC5;">\\&quot;</span><span style="color:#032F62;">&quot;</span></span>
<span class="line"><span style="color:#24292E;">    Restart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">on-failure</span></span>
<span class="line"><span style="color:#24292E;">    LimitNOFILE</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">65536</span></span>
<span class="line"><span style="color:#24292E;">    [Install]</span></span>
<span class="line"><span style="color:#24292E;">    WantedBy</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">multi-user.target</span></span></code></pre></div><blockquote><p>注意几点</p><p>1、--listen-client-urls用于监听客户端消息,必须设置为真实ip地址，如果机器为云主机，可以设置为云主机的私有ip地址或0.0.0.0(代表监听所有地址),不能设置为公网ip地址，因为云主机的公网ip是虚拟的，如果设置为公网ip会报“bind: cannot assign requested address”的错</p><p>2、--listen-peer-urls用于监听其他member发送过来的消息，跟listen-client-urls一样，必须设置为真实ip地址,如果机器为云主机,不能设置为公网ip</p><p>3、--initial-advertise-peer-urls用于监听其他member同步信号，该地址其他member必须能直接访问，所以如果是云主机该地址必须设置为云主机的公网ip地址</p><p>4、--initial-cluster群集列表，该列表中的值必须跟各个member的initial-advertise-peer-urls值一样</p></blockquote><h2 id="_2-命令行方式集群" tabindex="-1">2.命令行方式集群 <a class="header-anchor" href="#_2-命令行方式集群" aria-label="Permalink to &quot;2.命令行方式集群&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ETCD1=http://10.0.0.1</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ETCD2=http://10.0.0.2</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ETCD2=http://10.0.0.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 节点1为4核4GB的机器</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcd1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-advertise-peer-urls $ETCD1</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--listen-peer-urls $ETCD1</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--listen-client-urls $ETCD1</span><span style="color:#9ECBFF;">:2379,http://127.0.0.1:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--advertise-client-urls $ETCD1</span><span style="color:#9ECBFF;">:2379</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-cluster-token </span><span style="color:#9ECBFF;">etcd-cluster</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-cluster </span><span style="color:#9ECBFF;">etcd1=</span><span style="color:#E1E4E8;">$ETCD1</span><span style="color:#9ECBFF;">:2380,etcd2=</span><span style="color:#E1E4E8;">$ETCD2</span><span style="color:#9ECBFF;">:2380,etcd3=</span><span style="color:#E1E4E8;">$ETCD3</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--auto-compaction-retention=1 </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--quota-backend-bytes=$((4*1024*1024*1024)) \\</span></span>
<span class="line"><span style="color:#B392F0;">--initial-cluster-state</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">new</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 节点2为4核4GB的机器</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcd</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcd2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-advertise-peer-urls $ETCD2</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--listen-peer-urls $ETCD2</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--listen-client-urls $ETCD2</span><span style="color:#9ECBFF;">:2379,http://127.0.0.1:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--advertise-client-urls $ETCD2</span><span style="color:#9ECBFF;">:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-cluster-token </span><span style="color:#9ECBFF;">etcd-cluster</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-cluster </span><span style="color:#9ECBFF;">etcd1=</span><span style="color:#E1E4E8;">$ETCD1</span><span style="color:#9ECBFF;">:2380,etcd2=</span><span style="color:#E1E4E8;">$ETCD2</span><span style="color:#9ECBFF;">:2380,etcd3=</span><span style="color:#E1E4E8;">$ETCD3</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--auto-compaction-retention=1 </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--quota-backend-bytes=$((4*1024*1024*1024)) \\</span></span>
<span class="line"><span style="color:#B392F0;">--initial-cluster-state</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">new</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 节点3为4核4GB的机器</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcd</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcd3</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-advertise-peer-urls $ETCD3</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--listen-peer-urls $ETCD3</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--listen-client-urls $ETCD3</span><span style="color:#9ECBFF;">:2379,http://127.0.0.1:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--advertise-client-urls $ETCD3</span><span style="color:#9ECBFF;">:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-cluster-token </span><span style="color:#9ECBFF;">etcd-cluster</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--initial-cluster </span><span style="color:#9ECBFF;">etcd1=</span><span style="color:#E1E4E8;">$ETCD1</span><span style="color:#9ECBFF;">:2380,etcd2=</span><span style="color:#E1E4E8;">$ETCD2</span><span style="color:#9ECBFF;">:2380,etcd3=</span><span style="color:#E1E4E8;">$ETCD3</span><span style="color:#9ECBFF;">:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--auto-compaction-retention=1 </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--quota-backend-bytes=$((4*1024*1024*1024)) \\</span></span>
<span class="line"><span style="color:#B392F0;">--initial-cluster-state</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">new</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 检查集群是否正确启动</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">etcdctl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--endpoints=</span><span style="color:#E1E4E8;">$ETCD1</span><span style="color:#79B8FF;">:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">member</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">list</span></span>
<span class="line"><span style="color:#B392F0;">400938f1eaf1d0ed:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">name=etcd3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">peerURLs=http://10.0.0.1:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clientURLs=http://10.0.0.1:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">isLeader=</span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">bd0ff97b33ac1165:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">name=etcd2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">peerURLs=http://10.0.0.2:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clientURLs=http://10.0.0.2:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">isLeader=</span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">be62429afec4445f:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">name=etcd1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">peerURLs=http://10.0.0.3:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clientURLs=http://10.0.0.3:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">isLeader=</span><span style="color:#79B8FF;">true</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ETCD1=http://10.0.0.1</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ETCD2=http://10.0.0.2</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ETCD2=http://10.0.0.3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 节点1为4核4GB的机器</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcd1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-advertise-peer-urls $ETCD1</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--listen-peer-urls $ETCD1</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--listen-client-urls $ETCD1</span><span style="color:#032F62;">:2379,http://127.0.0.1:2379</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--advertise-client-urls $ETCD1</span><span style="color:#032F62;">:2379</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-cluster-token </span><span style="color:#032F62;">etcd-cluster</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-cluster </span><span style="color:#032F62;">etcd1=</span><span style="color:#24292E;">$ETCD1</span><span style="color:#032F62;">:2380,etcd2=</span><span style="color:#24292E;">$ETCD2</span><span style="color:#032F62;">:2380,etcd3=</span><span style="color:#24292E;">$ETCD3</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--auto-compaction-retention=1 </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--quota-backend-bytes=$((4*1024*1024*1024)) \\</span></span>
<span class="line"><span style="color:#6F42C1;">--initial-cluster-state</span><span style="color:#24292E;"> </span><span style="color:#032F62;">new</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 节点2为4核4GB的机器</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcd</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">--name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcd2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-advertise-peer-urls $ETCD2</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--listen-peer-urls $ETCD2</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--listen-client-urls $ETCD2</span><span style="color:#032F62;">:2379,http://127.0.0.1:2379</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--advertise-client-urls $ETCD2</span><span style="color:#032F62;">:2379</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-cluster-token </span><span style="color:#032F62;">etcd-cluster</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-cluster </span><span style="color:#032F62;">etcd1=</span><span style="color:#24292E;">$ETCD1</span><span style="color:#032F62;">:2380,etcd2=</span><span style="color:#24292E;">$ETCD2</span><span style="color:#032F62;">:2380,etcd3=</span><span style="color:#24292E;">$ETCD3</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--auto-compaction-retention=1 </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--quota-backend-bytes=$((4*1024*1024*1024)) \\</span></span>
<span class="line"><span style="color:#6F42C1;">--initial-cluster-state</span><span style="color:#24292E;"> </span><span style="color:#032F62;">new</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 节点3为4核4GB的机器</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcd</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">--name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcd3</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-advertise-peer-urls $ETCD3</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--listen-peer-urls $ETCD3</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--listen-client-urls $ETCD3</span><span style="color:#032F62;">:2379,http://127.0.0.1:2379</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--advertise-client-urls $ETCD3</span><span style="color:#032F62;">:2379</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-cluster-token </span><span style="color:#032F62;">etcd-cluster</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--initial-cluster </span><span style="color:#032F62;">etcd1=</span><span style="color:#24292E;">$ETCD1</span><span style="color:#032F62;">:2380,etcd2=</span><span style="color:#24292E;">$ETCD2</span><span style="color:#032F62;">:2380,etcd3=</span><span style="color:#24292E;">$ETCD3</span><span style="color:#032F62;">:2380</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--auto-compaction-retention=1 </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--quota-backend-bytes=$((4*1024*1024*1024)) \\</span></span>
<span class="line"><span style="color:#6F42C1;">--initial-cluster-state</span><span style="color:#24292E;"> </span><span style="color:#032F62;">new</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 检查集群是否正确启动</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">etcdctl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--endpoints=</span><span style="color:#24292E;">$ETCD1</span><span style="color:#005CC5;">:2379</span><span style="color:#24292E;"> </span><span style="color:#032F62;">member</span><span style="color:#24292E;"> </span><span style="color:#032F62;">list</span></span>
<span class="line"><span style="color:#6F42C1;">400938f1eaf1d0ed:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">name=etcd3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">peerURLs=http://10.0.0.1:2380</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clientURLs=http://10.0.0.1:2379</span><span style="color:#24292E;"> </span><span style="color:#032F62;">isLeader=</span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">bd0ff97b33ac1165:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">name=etcd2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">peerURLs=http://10.0.0.2:2380</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clientURLs=http://10.0.0.2:2379</span><span style="color:#24292E;"> </span><span style="color:#032F62;">isLeader=</span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">be62429afec4445f:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">name=etcd1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">peerURLs=http://10.0.0.3:2380</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clientURLs=http://10.0.0.3:2379</span><span style="color:#24292E;"> </span><span style="color:#032F62;">isLeader=</span><span style="color:#005CC5;">true</span></span></code></pre></div><h3 id="_2-1-查看集群状态" tabindex="-1">2.1 查看集群状态 <a class="header-anchor" href="#_2-1-查看集群状态" aria-label="Permalink to &quot;2.1 查看集群状态&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">etcdctl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--endpoint=http://10...:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cluster-health（version：3.3.9）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#这个的一台一台查看</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s3 etcd_data]# etcdctl endpoint status --write-out=table</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">ENDPOINT</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">VERSION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">DB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SIZE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEADER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">TERM</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">APPLIED</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ERRORS</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">127.0.0.1:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">467cafa3ad8836df</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">3.4.13</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">247</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">          </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                  </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#或者</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s3 etcd_data]# etcdctl  --endpoints=http://192.168.17.134:2380,http://192.168.17.133:2380,http://192.168.17.132:2380 endpoint status --write-out=table</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">          </span><span style="color:#B392F0;">ENDPOINT</span><span style="color:#E1E4E8;">          </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">VERSION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">DB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SIZE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEADER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">TERM</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">APPLIED</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ERRORS</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://192.168.17.134:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">467cafa3ad8836df</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">3.4.13</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">247</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">          </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                  </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://192.168.17.133:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">c9a1488472af4d3f</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">3.4.13</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">247</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">          </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                  </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://192.168.17.132:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e73ab1a36f7d200a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">3.4.13</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#B392F0;">247</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">          </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                  </span><span style="color:#B392F0;">9</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">etcdctl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--endpoint=http://10...:2380</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cluster-health（version：3.3.9）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#这个的一台一台查看</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s3 etcd_data]# etcdctl endpoint status --write-out=table</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">    </span><span style="color:#6F42C1;">ENDPOINT</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">VERSION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SIZE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEADER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">TERM</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">APPLIED</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ERRORS</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">127.0.0.1:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">467cafa3ad8836df</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">3.4.13</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">20</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">247</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">          </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                  </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#或者</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s3 etcd_data]# etcdctl  --endpoints=http://192.168.17.134:2380,http://192.168.17.133:2380,http://192.168.17.132:2380 endpoint status --write-out=table</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">          </span><span style="color:#6F42C1;">ENDPOINT</span><span style="color:#24292E;">          </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">VERSION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SIZE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEADER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">TERM</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">APPLIED</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ERRORS</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://192.168.17.134:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">467cafa3ad8836df</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">3.4.13</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">20</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">247</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">          </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                  </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://192.168.17.133:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">c9a1488472af4d3f</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">3.4.13</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">20</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">247</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">          </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                  </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://192.168.17.132:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e73ab1a36f7d200a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">3.4.13</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">20</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#6F42C1;">247</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">          </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                  </span><span style="color:#6F42C1;">9</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+----------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span></code></pre></div><h3 id="_2-2-查看集群健康性" tabindex="-1">2.2 查看集群健康性 <a class="header-anchor" href="#_2-2-查看集群健康性" aria-label="Permalink to &quot;2.2 查看集群健康性&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@k8s3 etcd_data]# etcdctl  --endpoints=http://192.168.17.134:2380,http://192.168.17.133:2380,http://192.168.17.132:2380 endpoint health --write-out=table</span></span>
<span class="line"><span style="color:#e1e4e8;">+----------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#e1e4e8;">|          ENDPOINT          | HEALTH |    TOOK    | ERROR |</span></span>
<span class="line"><span style="color:#e1e4e8;">+----------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#e1e4e8;">| http://192.168.17.132:2380 |   true | 4.246671ms |       |</span></span>
<span class="line"><span style="color:#e1e4e8;">| http://192.168.17.134:2380 |   true | 4.186323ms |       |</span></span>
<span class="line"><span style="color:#e1e4e8;">| http://192.168.17.133:2380 |   true | 5.224277ms |       |</span></span>
<span class="line"><span style="color:#e1e4e8;">+----------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#或者--write-out=tabl   更换成 -w table</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@k8s3 etcd_data]# etcdctl  --endpoints=http://192.168.17.134:2380,http://192.168.17.133:2380,http://192.168.17.132:2380 endpoint health --write-out=table</span></span>
<span class="line"><span style="color:#24292e;">+----------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#24292e;">|          ENDPOINT          | HEALTH |    TOOK    | ERROR |</span></span>
<span class="line"><span style="color:#24292e;">+----------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#24292e;">| http://192.168.17.132:2380 |   true | 4.246671ms |       |</span></span>
<span class="line"><span style="color:#24292e;">| http://192.168.17.134:2380 |   true | 4.186323ms |       |</span></span>
<span class="line"><span style="color:#24292e;">| http://192.168.17.133:2380 |   true | 5.224277ms |       |</span></span>
<span class="line"><span style="color:#24292e;">+----------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#或者--write-out=tabl   更换成 -w table</span></span></code></pre></div><h3 id="_2-3-查看集群成员" tabindex="-1">2.3 查看集群成员 <a class="header-anchor" href="#_2-3-查看集群成员" aria-label="Permalink to &quot;2.3 查看集群成员&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">etcdctl  --endpoints=http://192.168.17.134:2380,http://192.168.17.133:2380,http://192.168.17.132:2380 member list --write-out=table</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">etcdctl  --endpoints=http://192.168.17.134:2380,http://192.168.17.133:2380,http://192.168.17.132:2380 member list --write-out=table</span></span></code></pre></div><h3 id="_2-4-集群添加新节点" tabindex="-1">2.4 集群添加新节点 <a class="header-anchor" href="#_2-4-集群添加新节点" aria-label="Permalink to &quot;2.4 集群添加新节点&quot;">​</a></h3><h4 id="查看当前集群节点信息" tabindex="-1">查看当前集群节点信息 <a class="header-anchor" href="#查看当前集群节点信息" aria-label="Permalink to &quot;查看当前集群节点信息&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">STATUS</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">           </span><span style="color:#B392F0;">PEER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                    </span><span style="color:#B392F0;">CLIENT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">                     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-01</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-03</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-02</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">STATUS</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">           </span><span style="color:#6F42C1;">PEER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">CLIENT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">                     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-01</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-03</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-02</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre></div><p>添加新节点sht-sgmhadoopdn-04(172.16.101.66)</p><ul><li>添加集群节点对应hosts文件解析</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cat /etc/hosts</span></span>
<span class="line"><span style="color:#B392F0;">127.0.0.1</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">localhost</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost.localdomain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost4</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost4.localdomain4</span></span>
<span class="line"><span style="color:#79B8FF;">:</span><span style="color:#E1E4E8;">:1         </span><span style="color:#9ECBFF;">localhost</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost.localdomain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost6</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost6.localdomain6</span></span>
<span class="line"><span style="color:#B392F0;">172.16.101.58</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">sht-sgmhadoopdn-01</span></span>
<span class="line"><span style="color:#B392F0;">172.16.101.59</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">sht-sgmhadoopdn-02</span></span>
<span class="line"><span style="color:#B392F0;">172.16.101.60</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">sht-sgmhadoopdn-03</span></span>
<span class="line"><span style="color:#B392F0;">172.16.101.66</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">sht-sgmhadoopdn-04</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cat /etc/hosts</span></span>
<span class="line"><span style="color:#6F42C1;">127.0.0.1</span><span style="color:#24292E;">   </span><span style="color:#032F62;">localhost</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost.localdomain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost4</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost4.localdomain4</span></span>
<span class="line"><span style="color:#005CC5;">:</span><span style="color:#24292E;">:1         </span><span style="color:#032F62;">localhost</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost.localdomain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost6</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost6.localdomain6</span></span>
<span class="line"><span style="color:#6F42C1;">172.16.101.58</span><span style="color:#24292E;">    </span><span style="color:#032F62;">sht-sgmhadoopdn-01</span></span>
<span class="line"><span style="color:#6F42C1;">172.16.101.59</span><span style="color:#24292E;">    </span><span style="color:#032F62;">sht-sgmhadoopdn-02</span></span>
<span class="line"><span style="color:#6F42C1;">172.16.101.60</span><span style="color:#24292E;">    </span><span style="color:#032F62;">sht-sgmhadoopdn-03</span></span>
<span class="line"><span style="color:#6F42C1;">172.16.101.66</span><span style="color:#24292E;">    </span><span style="color:#032F62;">sht-sgmhadoopdn-04</span></span></code></pre></div><h4 id="在现有集群接点添加新节点" tabindex="-1">在现有集群接点添加新节点 <a class="header-anchor" href="#在现有集群接点添加新节点" aria-label="Permalink to &quot;在现有集群接点添加新节点&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># etcdctl member add sht-sgmhadoopdn-04 --peer-urls=&quot;http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#B392F0;">Member</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">7796493</span><span style="color:#9ECBFF;">c3943f891</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">added</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cluster</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">69</span><span style="color:#9ECBFF;">bef0b9ccf44365</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-04&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-04=http://sht-sgmhadoopdn-04:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;existing&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># etcdctl member add sht-sgmhadoopdn-04 --peer-urls=&quot;http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#6F42C1;">Member</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">7796493</span><span style="color:#032F62;">c3943f891</span><span style="color:#24292E;"> </span><span style="color:#032F62;">added</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cluster</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">69</span><span style="color:#032F62;">bef0b9ccf44365</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">ETCD_NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-04&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-04=http://sht-sgmhadoopdn-04:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;existing&quot;</span></span></code></pre></div><p><code>新节点的etcd配置文件必须包括以上输出内容</code></p><ul><li>查看当前集群信息</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+-----------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">           </span><span style="color:#B392F0;">PEER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                    </span><span style="color:#B392F0;">CLIENT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">                     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+-----------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-01</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">7796493c3943f891</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">unstarted</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                    </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-04:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                                                     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-03</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-02</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+-----------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+-----------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">  </span><span style="color:#6F42C1;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">           </span><span style="color:#6F42C1;">PEER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">CLIENT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">                     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+-----------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-01</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">7796493c3943f891</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">unstarted</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                    </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-04:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                                                     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-03</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-02</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+-----------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre></div><h4 id="新节点配置etcd" tabindex="-1">新节点配置etcd <a class="header-anchor" href="#新节点配置etcd" aria-label="Permalink to &quot;新节点配置etcd&quot;">​</a></h4><ul><li>etcd系统服务文件</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cat /usr/lib/systemd/system/etcd.service</span></span>
<span class="line"><span style="color:#E1E4E8;">[Unit]</span></span>
<span class="line"><span style="color:#E1E4E8;">Description</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">etcd</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">service</span></span>
<span class="line"><span style="color:#E1E4E8;">Documentation</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">https://github.com/etcd-io/etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network.target</span></span>
<span class="line"><span style="color:#E1E4E8;">After</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"><span style="color:#E1E4E8;">Wants</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[Service]</span></span>
<span class="line"><span style="color:#E1E4E8;">User</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">tnuser</span></span>
<span class="line"><span style="color:#E1E4E8;">Type</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">notify</span></span>
<span class="line"><span style="color:#E1E4E8;">EnvironmentFile</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/usr/local/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#E1E4E8;">WorkingDirectory</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/usr/local/etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">ExecStart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">/usr/local/etcd/etcd</span></span>
<span class="line"><span style="color:#E1E4E8;">Restart</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">always</span></span>
<span class="line"><span style="color:#E1E4E8;">RestartSec</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">s</span></span>
<span class="line"><span style="color:#E1E4E8;">LimitNOFILE</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">65536</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[Install]</span></span>
<span class="line"><span style="color:#E1E4E8;">WantedBy</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">multi-user.target</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cat /usr/lib/systemd/system/etcd.service</span></span>
<span class="line"><span style="color:#24292E;">[Unit]</span></span>
<span class="line"><span style="color:#24292E;">Description</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">etcd</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">service</span></span>
<span class="line"><span style="color:#24292E;">Documentation</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">https://github.com/etcd-io/etcd</span></span>
<span class="line"><span style="color:#24292E;">After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network.target</span></span>
<span class="line"><span style="color:#24292E;">After</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"><span style="color:#24292E;">Wants</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">network-online.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[Service]</span></span>
<span class="line"><span style="color:#24292E;">User</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">tnuser</span></span>
<span class="line"><span style="color:#24292E;">Type</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">notify</span></span>
<span class="line"><span style="color:#24292E;">EnvironmentFile</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/usr/local/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#24292E;">WorkingDirectory</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/usr/local/etcd</span></span>
<span class="line"><span style="color:#24292E;">ExecStart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">/usr/local/etcd/etcd</span></span>
<span class="line"><span style="color:#24292E;">Restart</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">always</span></span>
<span class="line"><span style="color:#24292E;">RestartSec</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">10</span><span style="color:#032F62;">s</span></span>
<span class="line"><span style="color:#24292E;">LimitNOFILE</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">65536</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[Install]</span></span>
<span class="line"><span style="color:#24292E;">WantedBy</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">multi-user.target</span></span></code></pre></div><ul><li>etcd配置文件</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-04&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_DATA_DIR</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;/usr/local/etcd/data&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;existing&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-01:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_LISTEN_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_INITIAL_CLUSTER</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380,sht-sgmhadoopdn-04=http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">ETCD_ENABLE_V2</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&quot;true&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># cat /usr/local/etcd/etcd.conf</span></span>
<span class="line"><span style="color:#24292E;">ETCD_NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-04&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_DATA_DIR</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;/usr/local/etcd/data&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_TOKEN</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;etcd-cluster-01&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER_STATE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;existing&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ADVERTISE_CLIENT_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-01:2379,http://10.0.0.1:2379&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_LISTEN_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://0.0.0.0:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_ADVERTISE_PEER_URLS</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_INITIAL_CLUSTER</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;sht-sgmhadoopdn-01=http://sht-sgmhadoopdn-01:2380,sht-sgmhadoopdn-02=http://sht-sgmhadoopdn-02:2380,sht-sgmhadoopdn-03=http://sht-sgmhadoopdn-03:2380,sht-sgmhadoopdn-04=http://sht-sgmhadoopdn-04:2380&quot;</span></span>
<span class="line"><span style="color:#24292E;">ETCD_ENABLE_V2</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&quot;true&quot;</span></span></code></pre></div><ul><li>启动新节点</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># systemctl start etcd</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># systemctl start etcd</span></span></code></pre></div><ul><li>再次查看集群状态</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">STATUS</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">           </span><span style="color:#B392F0;">PEER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                    </span><span style="color:#B392F0;">CLIENT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">                     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-01</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">7796493c3943f891</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-04</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-04:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-03</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-02</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">STATUS</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">           </span><span style="color:#6F42C1;">PEER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">CLIENT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">                     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-01</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">7796493c3943f891</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-04</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-04:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-03</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-02</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre></div><p><code>将各节点etcd.conf配置文件的变量ETCD_INITIAL_CLUSTER添加新节点信息，然后依次重启</code></p><h3 id="_2-5-etcd集群移除节点" tabindex="-1">2.5 etcd集群移除节点 <a class="header-anchor" href="#_2-5-etcd集群移除节点" aria-label="Permalink to &quot;2.5 etcd集群移除节点&quot;">​</a></h3><h4 id="查看当前集群信息" tabindex="-1">查看当前集群信息 <a class="header-anchor" href="#查看当前集群信息" aria-label="Permalink to &quot;查看当前集群信息&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">STATUS</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">           </span><span style="color:#B392F0;">PEER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                    </span><span style="color:#B392F0;">CLIENT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">                     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-01</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">7796493c3943f891</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-04</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-04:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-03</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-02</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl endpoint status --endpoints=http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379,http://sht-sgmhadoopdn-04:2379 --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">ENDPOINT</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">VERSION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">DB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SIZE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEADER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">TERM</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">RAFT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">APPLIED</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INDEX</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ERRORS</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">3.4.1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">16</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">17</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                 </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">3.4.1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">16</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">17</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                 </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">3.4.1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">16</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">17</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                 </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-04:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">7796493c3943f891</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">3.4.1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">20</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kB</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">17</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">         </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                 </span><span style="color:#B392F0;">38</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl endpoint health --endpoints=http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379,http://sht-sgmhadoopdn-04:2379 --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">            </span><span style="color:#B392F0;">ENDPOINT</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">HEALTH</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">TOOK</span><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ERROR</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-04:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">5.329583ms</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">5.943424ms</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">4.715634ms</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">6.611197ms</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+--------------------------------+--------+------------+-------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">STATUS</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">           </span><span style="color:#6F42C1;">PEER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">CLIENT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">                     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-01</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">7796493c3943f891</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-04</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-04:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-03</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-02</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl endpoint status --endpoints=http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379,http://sht-sgmhadoopdn-04:2379 --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">            </span><span style="color:#6F42C1;">ENDPOINT</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">VERSION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">DB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SIZE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEADER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">TERM</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">RAFT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">APPLIED</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INDEX</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ERRORS</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">3.4.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">16</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">17</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                 </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">3.4.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">16</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">17</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                 </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">3.4.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">16</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">17</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                 </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-04:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">7796493c3943f891</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">3.4.1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#6F42C1;">20</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kB</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">17</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">         </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                 </span><span style="color:#6F42C1;">38</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl endpoint health --endpoints=http://sht-sgmhadoopdn-01:2379,http://sht-sgmhadoopdn-02:2379,http://sht-sgmhadoopdn-03:2379,http://sht-sgmhadoopdn-04:2379 --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">            </span><span style="color:#6F42C1;">ENDPOINT</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">HEALTH</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">    </span><span style="color:#6F42C1;">TOOK</span><span style="color:#24292E;">    </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ERROR</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+--------+------------+-------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-04:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">5.329583ms</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">5.943424ms</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">4.715634ms</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">6.611197ms</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+--------------------------------+--------+------------+-------+</span></span></code></pre></div><ul><li>将节点sht-sgmhadoopdn-04移除</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># etcdctl member remove 7796493c3943f891</span></span>
<span class="line"><span style="color:#B392F0;">Member</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">7796493</span><span style="color:#9ECBFF;">c3943f891</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">removed</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cluster</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">69</span><span style="color:#9ECBFF;">bef0b9ccf44365</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">STATUS</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">           </span><span style="color:#B392F0;">PEER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">                    </span><span style="color:#B392F0;">CLIENT</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ADDRS</span><span style="color:#E1E4E8;">                     </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LEARNER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">44d8bc3300880bcd</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-01</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">d446fbe3296eb85a</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-03</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">e9136c1ad1754783</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">started</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">sht-sgmhadoopdn-02</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span></span>
<span class="line"><span style="color:#B392F0;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># etcdctl member remove 7796493c3943f891</span></span>
<span class="line"><span style="color:#6F42C1;">Member</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">7796493</span><span style="color:#032F62;">c3943f891</span><span style="color:#24292E;"> </span><span style="color:#032F62;">removed</span><span style="color:#24292E;"> </span><span style="color:#032F62;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cluster</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">69</span><span style="color:#032F62;">bef0b9ccf44365</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># etcdctl member list --write-out=table</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">STATUS</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">        </span><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">           </span><span style="color:#6F42C1;">PEER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">                    </span><span style="color:#6F42C1;">CLIENT</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ADDRS</span><span style="color:#24292E;">                     </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LEARNER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">44d8bc3300880bcd</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-01</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-01:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-01:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">d446fbe3296eb85a</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-03</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-03:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">e9136c1ad1754783</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">started</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">sht-sgmhadoopdn-02</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://sht-sgmhadoopdn-02:2380</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">http://10.0.0.1:2379,http://sht-sgmhadoopdn-02:2379</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span></span>
<span class="line"><span style="color:#6F42C1;">+------------------+---------+--------------------+--------------------------------+-----------------------------------------------------+------------+</span></span></code></pre></div><p><code>修改配置文件etcd.conf，修改参数ETCD_INITIAL_CLUSTER并移除节点信息，重启etcd服务</code></p><h2 id="_3-操作" tabindex="-1">3. 操作 <a class="header-anchor" href="#_3-操作" aria-label="Permalink to &quot;3. 操作&quot;">​</a></h2><ul><li>写</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem put /chj/3 api3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem put /chj/3 api3</span></span></code></pre></div><ul><li>读</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem get /chj/3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem get /chj/3</span></span></code></pre></div><ul><li>查看所有key</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem get / --prefix --keys-only</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem get / --prefix --keys-only</span></span></code></pre></div><ul><li>删除所有key</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem del &quot;&quot; --prefix</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem del &quot;&quot; --prefix</span></span></code></pre></div><ul><li>查看集群成员</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem member list --write-out=table</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem member list --write-out=table</span></span></code></pre></div><ul><li>查看集群健康状态</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem endpoint health</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem endpoint health</span></span></code></pre></div><ul><li>查看节点状态</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem endpoint status --write-out=table</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ETCDCTL_API=3 etcdctl --endpoints=&quot;https://192.168.9.87:2379,https://192.168.9.88:2379,https://192.168.9.89:2379&quot; --cert=/etc/etcd/ssl/etcd.pem --key=/etc/etcd/ssl/etcd-key.pem --cacert=/etc/etcd/ssl/ca.pem endpoint status --write-out=table</span></span></code></pre></div><h2 id="_4-etcd集群必须是奇数节点" tabindex="-1">4.<strong>Etcd集群必须是奇数节点？</strong> <a class="header-anchor" href="#_4-etcd集群必须是奇数节点" aria-label="Permalink to &quot;4.**Etcd集群必须是奇数节点？**&quot;">​</a></h2><p>etcd官方推荐3、5、7个节点，虽然raft算法也是半数以上投票才能有 leader，但奇数只是推荐，其实偶数也是可以的。如 2、4、8个节点。分情况说明：</p><ul><li>1 个节点：就是单实例，没有集群概念，不做讨论；</li><li>2 个节点：是集群，但没人会这么配，这里说点废话：双节点的etcd能启动，启动时也能有主，可以正常提供服务，但是一台挂掉之后，就选不出主了，因为他只能拿到1票，剩下的那台也无法提供服务，也就是双节点无容错能力，不要使用</li></ul><p><img src="`+l+`" alt=""></p><p>发现偶数节点虽然多了一台机器，但是容错能力是一样的，也就是说，你可以设置偶数节点，但没增加什么能力，还浪费了一台机器。同时etcd 是通过复制数据给所有节点来达到一致性，因此偶数的多一台机器增加不了性能，反而会拉低写入速度</p><h2 id="_5-etcd集群机器越多越好" tabindex="-1">5.Etcd集群机器越多越好？ <a class="header-anchor" href="#_5-etcd集群机器越多越好" aria-label="Permalink to &quot;5.Etcd集群机器越多越好？&quot;">​</a></h2><p>etcd 集群是一个 Raft Group，没有 shared。所以它的极限有两部分，一是单机的容量限制，内存和磁盘；二是网络开销，每次 Raft 操作需要所有节点参与，每一次写操作需要集群中大多数节点将日志落盘成功后，Leader 节点才能修改内部状态机，并将结果返回给客户端。因此节点越多性能越低，所以扩展很多 etcd 节点是没有意义的，一般是 3、5、7， 7 个也足够了</p><h2 id="_6-etcd有脑裂问题" tabindex="-1">6.Etcd有脑裂问题？ <a class="header-anchor" href="#_6-etcd有脑裂问题" aria-label="Permalink to &quot;6.Etcd有脑裂问题？&quot;">​</a></h2><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">The majority side becomes the available cluster </span><span style="color:#F97583;">and</span><span style="color:#E1E4E8;"> the minority side </span><span style="color:#F97583;">is</span><span style="color:#E1E4E8;"> unavailable; there </span><span style="color:#F97583;">is</span><span style="color:#E1E4E8;"> no “split</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">brain” </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> etcd.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">The majority side becomes the available cluster </span><span style="color:#D73A49;">and</span><span style="color:#24292E;"> the minority side </span><span style="color:#D73A49;">is</span><span style="color:#24292E;"> unavailable; there </span><span style="color:#D73A49;">is</span><span style="color:#24292E;"> no “split</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">brain” </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> etcd.</span></span></code></pre></div><h2 id="_7-ssl证书方式搭建" tabindex="-1">7.ssl证书方式搭建 <a class="header-anchor" href="#_7-ssl证书方式搭建" aria-label="Permalink to &quot;7.ssl证书方式搭建&quot;">​</a></h2><h2 id="_4-集群形式" tabindex="-1">4.集群形式 <a class="header-anchor" href="#_4-集群形式" aria-label="Permalink to &quot;4.集群形式&quot;">​</a></h2><ul><li>主要有三种形式</li></ul><p>1)静态发现: 预先已知 Etcd 集群中有哪些节点，在启动时直接指定好Etcd的各个node节点地址</p><p>2)Etcd动态发现: 通过已有的Etcd集群作为数据交互点，然后在扩展新的集群时实现通过已有集群进行服务发现的机制</p><p>3)DNS动态发现: 通过DNS查询方式获取其他节点地址信息</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">集群服务中的通信一般包括两种场景：</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">对外提供服务的通信，发生在集群外部的客户端和集群某个节点之间，etcd默认端口为2379，例如 etcdctl 就属于客户端</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">集群内部的通信，发生在集群内部的任意两个节点之间，etcd的默认端口为2380</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">集群服务中的通信一般包括两种场景：</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">对外提供服务的通信，发生在集群外部的客户端和集群某个节点之间，etcd默认端口为2379，例如 etcdctl 就属于客户端</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">集群内部的通信，发生在集群内部的任意两个节点之间，etcd的默认端口为2380</span></span></code></pre></div>`,101),e=[t];function c(r,E,y,F,i,d){return a(),n("div",null,e)}const D=s(o,[["render",c]]);export{C as __pageData,D as default};
