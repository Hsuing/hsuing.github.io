import{_ as s,o as n,c as a,R as l}from"./chunks/framework.zUbWieqp.js";const d=JSON.parse('{"title":"1. ç‰ˆæœ¬å…¼å®¹","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/å¤‡ä»½/2-velero.md","filePath":"guide/container/k8s/å¤‡ä»½/2-velero.md","lastUpdated":1723447064000}'),p={name:"guide/container/k8s/å¤‡ä»½/2-velero.md"},o=l(`<p><a href="https://velero.io/docs/v1.11/" target="_blank" rel="noreferrer">å®˜å½“</a></p><p><a href="https://github.com/vmware-tanzu/velero" target="_blank" rel="noreferrer">github</a></p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202408081453841.svg" alt=""></p><h1 id="_1-ç‰ˆæœ¬å…¼å®¹" tabindex="-1">1. ç‰ˆæœ¬å…¼å®¹ <a class="header-anchor" href="#_1-ç‰ˆæœ¬å…¼å®¹" aria-label="Permalink to &quot;1. ç‰ˆæœ¬å…¼å®¹&quot;">â€‹</a></h1><table><thead><tr><th>Velero version</th><th>Expected Kubernetes version compatibility</th><th>Tested on Kubernetes version</th></tr></thead><tbody><tr><td>1.14</td><td>1.18-latest</td><td>1.27.9, 1.28.9, and 1.29.4</td></tr><tr><td>1.13</td><td>1.18-latest</td><td>1.26.5, 1.27.3, 1.27.8, and 1.28.3</td></tr><tr><td>1.12</td><td>1.18-latest</td><td>1.25.7, 1.26.5, 1.26.7, and 1.27.3</td></tr><tr><td>1.11</td><td>1.18-latest</td><td>1.23.10, 1.24.9, 1.25.5, and 1.26.1</td></tr><tr><td>1.10</td><td>1.18-latest</td><td>1.22.5, 1.23.8, 1.24.6 and 1.25.1</td></tr></tbody></table><h1 id="_2-veleroéƒ¨ç½²" tabindex="-1">2. veleroéƒ¨ç½² <a class="header-anchor" href="#_2-veleroéƒ¨ç½²" aria-label="Permalink to &quot;2. veleroéƒ¨ç½²&quot;">â€‹</a></h1><h2 id="_2-0-å­˜å‚¨æä¾›å•†" tabindex="-1">2.0 å­˜å‚¨æä¾›å•† <a class="header-anchor" href="#_2-0-å­˜å‚¨æä¾›å•†" aria-label="Permalink to &quot;2.0 å­˜å‚¨æä¾›å•†&quot;">â€‹</a></h2><h3 id="veleroæ”¯æŒçš„æä¾›å•†" tabindex="-1"><strong>Veleroæ”¯æŒçš„æä¾›å•†</strong> <a class="header-anchor" href="#veleroæ”¯æŒçš„æä¾›å•†" aria-label="Permalink to &quot;**Veleroæ”¯æŒçš„æä¾›å•†**&quot;">â€‹</a></h3><table><thead><tr><th style="text-align:left;">æä¾›å•†</th><th style="text-align:left;">å¯¹è±¡å­˜å‚¨</th><th style="text-align:left;">å·å¿«ç…§</th><th style="text-align:left;">æ’ä»¶æä¾›å•†Repo</th><th style="text-align:left;">å®‰è£…è¯´æ˜</th></tr></thead><tbody><tr><td style="text-align:left;">Amazon Web Services (AWS)</td><td style="text-align:left;">AWS S3</td><td style="text-align:left;">AWS EBS</td><td style="text-align:left;">Velero plugin for AWS</td><td style="text-align:left;">AWS Plugin Setup</td></tr><tr><td style="text-align:left;">Google Cloud Platform (GCP)</td><td style="text-align:left;">Google Cloud Storage</td><td style="text-align:left;">Google Compute Engine Disks</td><td style="text-align:left;">Velero plugin for GCP</td><td style="text-align:left;">GCP Plugin Setup</td></tr><tr><td style="text-align:left;">Microsoft Azure</td><td style="text-align:left;">Azure Blob Storage</td><td style="text-align:left;">Azure Managed Disks</td><td style="text-align:left;">Velero plugin for Microsoft Azure</td><td style="text-align:left;">Azure Plugin Setup</td></tr><tr><td style="text-align:left;">VMware vSphere</td><td style="text-align:left;">ğŸš«</td><td style="text-align:left;">vSphere Volumes</td><td style="text-align:left;">VMware vSphere</td><td style="text-align:left;">vSphere Plugin Setup</td></tr><tr><td style="text-align:left;">Container Storage Interface (CSI)</td><td style="text-align:left;">ğŸš«</td><td style="text-align:left;">CSI Volumes</td><td style="text-align:left;">Velero plugin for CSI</td><td style="text-align:left;">CSI Plugin Setup</td></tr></tbody></table><h3 id="ç¤¾åŒºæ”¯æŒçš„æä¾›å•†" tabindex="-1"><strong>ç¤¾åŒºæ”¯æŒçš„æä¾›å•†</strong> <a class="header-anchor" href="#ç¤¾åŒºæ”¯æŒçš„æä¾›å•†" aria-label="Permalink to &quot;**ç¤¾åŒºæ”¯æŒçš„æä¾›å•†**&quot;">â€‹</a></h3><table><thead><tr><th style="text-align:left;">Provider</th><th style="text-align:left;">Object Store</th><th style="text-align:left;">Volume Snapshotter</th><th style="text-align:left;">Plugin Documentation</th><th style="text-align:left;">Contact</th></tr></thead><tbody><tr><td style="text-align:left;">AlibabaCloud</td><td style="text-align:left;">Alibaba Cloud OSS</td><td style="text-align:left;">Alibaba Cloud</td><td style="text-align:left;">AlibabaCloud</td><td style="text-align:left;">GitHub Issue</td></tr><tr><td style="text-align:left;">DigitalOcean</td><td style="text-align:left;">DigitalOcean Object Storage</td><td style="text-align:left;">DigitalOcean Volumes Block Storage</td><td style="text-align:left;">StackPointCloud</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;">Hewlett Packard</td><td style="text-align:left;">ğŸš«</td><td style="text-align:left;">HPE Storage</td><td style="text-align:left;">Hewlett Packard</td><td style="text-align:left;">Slack, GitHub Issue</td></tr><tr><td style="text-align:left;">OpenEBS</td><td style="text-align:left;">ğŸš«</td><td style="text-align:left;">OpenEBS CStor Volume</td><td style="text-align:left;">OpenEBS</td><td style="text-align:left;">Slack, GitHub Issue</td></tr><tr><td style="text-align:left;">Portworx</td><td style="text-align:left;">ğŸš«</td><td style="text-align:left;">Portworx Volume</td><td style="text-align:left;">Portworx</td><td style="text-align:left;">Slack, GitHub Issue</td></tr><tr><td style="text-align:left;">Storj</td><td style="text-align:left;">Storj Object Storage</td><td style="text-align:left;">ğŸš«</td><td style="text-align:left;">Storj</td><td style="text-align:left;">GitHub Issue</td></tr></tbody></table><h2 id="_2-1-å­˜å‚¨æ–¹å¼" tabindex="-1">2.1 å­˜å‚¨æ–¹å¼ <a class="header-anchor" href="#_2-1-å­˜å‚¨æ–¹å¼" aria-label="Permalink to &quot;2.1 å­˜å‚¨æ–¹å¼&quot;">â€‹</a></h2><h3 id="_2-1-1-å­˜å‚¨æ–¹å¼" tabindex="-1">2.1.1 å­˜å‚¨æ–¹å¼ <a class="header-anchor" href="#_2-1-1-å­˜å‚¨æ–¹å¼" aria-label="Permalink to &quot;2.1.1 å­˜å‚¨æ–¹å¼&quot;">â€‹</a></h3><h4 id="minio" tabindex="-1">minio <a class="header-anchor" href="#minio" aria-label="Permalink to &quot;minio&quot;">â€‹</a></h4><h5 id="minioå®¹å™¨æ–¹å¼" tabindex="-1">minioå®¹å™¨æ–¹å¼ <a class="header-anchor" href="#minioå®¹å™¨æ–¹å¼" aria-label="Permalink to &quot;minioå®¹å™¨æ–¹å¼&quot;">â€‹</a></h5><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-dit</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">minio</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-u</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">-h</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">minio</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--net</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">host</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--restart</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">always</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">-e</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MINIO_ROOT_USER=&quot;minio&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">-e</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MINIO_ROOT_PASSWORD=&quot;miniow2p0w2r4&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">-v</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/minio:/data</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-w</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/minio:RELEASE.2022-11-29T23-40-49Z </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">minio</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--console-address</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;0.0.0.0:9001&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--address=</span><span style="color:#9ECBFF;">&quot;0.0.0.0:9000&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#è§£é‡Š</span></span>
<span class="line"><span style="color:#B392F0;">9001</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">---</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">UIè®¿é—®ç•Œé¢</span></span>
<span class="line"><span style="color:#B392F0;">9000</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">---</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apiåœ°å€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºbucket velero</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">exec</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-it</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">minio</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bash</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;mc mb velero; mc ls&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#minioå‚¨å­˜åœ°å€ http://minio-ip:9000</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-dit</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">minio</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-u</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">-h</span><span style="color:#24292E;"> </span><span style="color:#032F62;">minio</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--net</span><span style="color:#24292E;"> </span><span style="color:#032F62;">host</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--restart</span><span style="color:#24292E;"> </span><span style="color:#032F62;">always</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MINIO_ROOT_USER=&quot;minio&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MINIO_ROOT_PASSWORD=&quot;miniow2p0w2r4&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">-v</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/minio:/data</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-w</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/minio:RELEASE.2022-11-29T23-40-49Z </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#032F62;">minio</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--console-address</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;0.0.0.0:9001&#39;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--address=</span><span style="color:#032F62;">&quot;0.0.0.0:9000&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#è§£é‡Š</span></span>
<span class="line"><span style="color:#6F42C1;">9001</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">---</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">UIè®¿é—®ç•Œé¢</span></span>
<span class="line"><span style="color:#6F42C1;">9000</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">---</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apiåœ°å€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºbucket velero</span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">exec</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-it</span><span style="color:#24292E;"> </span><span style="color:#032F62;">minio</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bash</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;mc mb velero; mc ls&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#minioå‚¨å­˜åœ°å€ http://minio-ip:9000</span></span></code></pre></div><h5 id="minio-k8sæ–¹å¼" tabindex="-1">minio k8sæ–¹å¼ <a class="header-anchor" href="#minio-k8sæ–¹å¼" aria-label="Permalink to &quot;minio k8sæ–¹å¼&quot;">â€‹</a></h5><ul><li>åˆ›å»ºminio-dp.yaml</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Namespace</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">velero</span></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">apps/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Deployment</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">velero</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">component</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">strategy</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Recreate</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">matchLabels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">component</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">component</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">nodeSelector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">kubernetes.io/hostname</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">k8smaster1</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">hostPath</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/data/minio</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">DirectoryOrCreate</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">storage</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">config</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">emptyDir</span><span style="color:#E1E4E8;">: {}</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/minio:RELEASE.2022-11-29T23-40-49Z</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">imagePullPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">IfNotPresent</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">args</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">server</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">/data</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">--config-dir=/config</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">--console-address=:9001</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">env</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">MINIO_ROOT_USER</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;admin&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">MINIO_ROOT_PASSWORD</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">value</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;minio123&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">containerPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9000</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">containerPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9001</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">storage</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/data</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">config</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;/config&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Service</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">velero</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">component</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">sessionAffinity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">None</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">NodePort</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">api</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9000</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">protocol</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TCP</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">targetPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9000</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">nodePort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">30080</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">console</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9001</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">protocol</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">TCP</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">targetPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9001</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">nodePort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">30081</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">component</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#B392F0;">---</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">batch/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Job</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">velero</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio-setup</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">component</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">minio-setup</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">nodeSelector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">kubernetes.io/hostname</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">k8s-master01</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æ ¹æ®è‡ªå·±çš„ç¯å¢ƒä¿®æ”¹</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">restartPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">OnFailure</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">config</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">emptyDir</span><span style="color:#E1E4E8;">: {}</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">mc</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">airbyte/mc:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">imagePullPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">IfNotPresent</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">/bin/sh</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">-c</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">&quot;mc --config-dir=/config config host add velero http://minio.velero.svc.cluster.local:9000 admin minio123 &amp;&amp; mc --config-dir=/config mb -p velero/velero&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">config</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;/config&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Namespace</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">velero</span></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">apps/v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Deployment</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">velero</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">component</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">strategy</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Recreate</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">selector</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">matchLabels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">component</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">template</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">component</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">nodeSelector</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">kubernetes.io/hostname</span><span style="color:#24292E;">: </span><span style="color:#032F62;">k8smaster1</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">hostPath</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/data/minio</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">DirectoryOrCreate</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">storage</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">config</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">emptyDir</span><span style="color:#24292E;">: {}</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/minio:RELEASE.2022-11-29T23-40-49Z</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">imagePullPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">IfNotPresent</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">args</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">server</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">/data</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">--config-dir=/config</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">--console-address=:9001</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">env</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">MINIO_ROOT_USER</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">value</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;admin&quot;</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">MINIO_ROOT_PASSWORD</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">value</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;minio123&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">containerPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9000</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">containerPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9001</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">storage</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/data</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">config</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;/config&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Service</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">velero</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">component</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">sessionAffinity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">None</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">NodePort</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">api</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9000</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">protocol</span><span style="color:#24292E;">: </span><span style="color:#032F62;">TCP</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">targetPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9000</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">nodePort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">30080</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">console</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9001</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">protocol</span><span style="color:#24292E;">: </span><span style="color:#032F62;">TCP</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">targetPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9001</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">nodePort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">30081</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">selector</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">component</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#6F42C1;">---</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">batch/v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Job</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">velero</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio-setup</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">component</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">template</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">minio-setup</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">nodeSelector</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">kubernetes.io/hostname</span><span style="color:#24292E;">: </span><span style="color:#032F62;">k8s-master01</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æ ¹æ®è‡ªå·±çš„ç¯å¢ƒä¿®æ”¹</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">restartPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">OnFailure</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">config</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">emptyDir</span><span style="color:#24292E;">: {}</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">mc</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">airbyte/mc:latest</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">imagePullPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">IfNotPresent</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">command</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">/bin/sh</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">-c</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">&quot;mc --config-dir=/config config host add velero http://minio.velero.svc.cluster.local:9000 admin minio123 &amp;&amp; mc --config-dir=/config mb -p velero/velero&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">config</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;/config&quot;</span></span></code></pre></div><ul><li>æ‰§è¡Œapply</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl apply -f minio-dp.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl apply -f minio-dp.yaml</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl get all -n velero</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl get all -n velero</span></span></code></pre></div><h4 id="oss" tabindex="-1">oss <a class="header-anchor" href="#oss" aria-label="Permalink to &quot;oss&quot;">â€‹</a></h4><p>åœ¨é˜¿é‡Œäº‘ossåˆ›å»ºbucket bucketåç§°k8s-hsuing regionä¸ºoss-cn-shanghai</p><p>ossçš„regionå’Œè®¿é—®åŸŸå <a href="https://help.aliyun.com/zh/oss/user-guide/regions-and-endpoints" target="_blank" rel="noreferrer">https://help.aliyun.com/zh/oss/user-guide/regions-and-endpoints</a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºå‡­è¯ create auth</span></span>
<span class="line"><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">/root/velero/auth-oss.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#9ECBFF;">[default]</span></span>
<span class="line"><span style="color:#9ECBFF;">aws_access_key_id = LTAI4FoDtp4y7ENqv9X4emSE</span></span>
<span class="line"><span style="color:#9ECBFF;">aws_secret_access_key = lVNCxCVGciaJqUa5axxx</span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#install</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--plugins</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--provider</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">aws</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--use-volume-snapshots=false</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--bucket</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-hsuing</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--secret-file</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">~/k8s/velero/auth-oss.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--backup-location-config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">region=oss-cn-shanghai,s3ForcePathStyle=&quot;false&quot;,s3Url=http://oss-cn-shanghai.aliyuncs.com</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#ossä½¿ç”¨virtual hostingè®¿é—®æ–¹å¼,é…ç½®s3ForcePathStyle=&quot;false&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºå‡­è¯ create auth</span></span>
<span class="line"><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">/root/velero/auth-oss.txt</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#032F62;">[default]</span></span>
<span class="line"><span style="color:#032F62;">aws_access_key_id = LTAI4FoDtp4y7ENqv9X4emSE</span></span>
<span class="line"><span style="color:#032F62;">aws_secret_access_key = lVNCxCVGciaJqUa5axxx</span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#install</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--plugins</span><span style="color:#24292E;">  </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--provider</span><span style="color:#24292E;"> </span><span style="color:#032F62;">aws</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--use-volume-snapshots=false</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--bucket</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-hsuing</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--secret-file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">~/k8s/velero/auth-oss.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--backup-location-config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">region=oss-cn-shanghai,s3ForcePathStyle=&quot;false&quot;,s3Url=http://oss-cn-shanghai.aliyuncs.com</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#ossä½¿ç”¨virtual hostingè®¿é—®æ–¹å¼,é…ç½®s3ForcePathStyle=&quot;false&quot;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span></span></code></pre></div><h4 id="ä¸ƒç‰›äº‘" tabindex="-1">ä¸ƒç‰›äº‘ <a class="header-anchor" href="#ä¸ƒç‰›äº‘" aria-label="Permalink to &quot;ä¸ƒç‰›äº‘&quot;">â€‹</a></h4><p>åœ¨ä¸ƒç‰›äº‘åˆ›å»ºå‚¨å­˜<a href="https://portal.qiniu.com/kodo/bucket" target="_blank" rel="noreferrer">https://portal.qiniu.com/kodo/bucket</a></p><p>è·å–S3ç©ºé—´åŸŸå,æ‰“å¼€åˆ›å»ºçš„å‚¨å­˜,ç©ºé—´æ¦‚è¿°,<code>S3 åŸŸå</code>,ç‚¹å‡»æŸ¥è¯¢</p><p>ä¸ƒç‰›äº‘å‚¨å­˜regionå’Œè®¿é—®åŸŸå <a href="https://developer.qiniu.com/kodo/4088/s3-access-domainname" target="_blank" rel="noreferrer">https://developer.qiniu.com/kodo/4088/s3-access-domainname</a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºå‡­è¯ create auth</span></span>
<span class="line"><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">/root/velero/auth-qiniu.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#9ECBFF;">[default]</span></span>
<span class="line"><span style="color:#9ECBFF;">aws_access_key_id = foqsLZBJSr7yF59_3sB5RguezMh0l223s2NcC9Kz</span></span>
<span class="line"><span style="color:#9ECBFF;">aws_secret_access_key = BTBwrrCE7TLKjztpsBZX2GA45Cb3yR9Fxxxx</span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#install</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--plugins</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--provider</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">aws</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--use-volume-snapshots=false</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--bucket</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">817</span><span style="color:#9ECBFF;">nb3</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--secret-file</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/root/velero/auth-qiniu.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--backup-location-config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">region=cn-east-1,s3ForcePathStyle=&quot;false&quot;,s3Url=http://s3.cn-east-1.qiniucs.com</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#ä¸ƒç‰›äº‘bucketä½¿ç”¨S3ç©ºé—´åŸŸåå‰éƒ¨åˆ†</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºå‡­è¯ create auth</span></span>
<span class="line"><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">/root/velero/auth-qiniu.txt</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#032F62;">[default]</span></span>
<span class="line"><span style="color:#032F62;">aws_access_key_id = foqsLZBJSr7yF59_3sB5RguezMh0l223s2NcC9Kz</span></span>
<span class="line"><span style="color:#032F62;">aws_secret_access_key = BTBwrrCE7TLKjztpsBZX2GA45Cb3yR9Fxxxx</span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#install</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--plugins</span><span style="color:#24292E;">  </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--provider</span><span style="color:#24292E;"> </span><span style="color:#032F62;">aws</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--use-volume-snapshots=false</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--bucket</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">817</span><span style="color:#032F62;">nb3</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--secret-file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/root/velero/auth-qiniu.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--backup-location-config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">region=cn-east-1,s3ForcePathStyle=&quot;false&quot;,s3Url=http://s3.cn-east-1.qiniucs.com</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#ä¸ƒç‰›äº‘bucketä½¿ç”¨S3ç©ºé—´åŸŸåå‰éƒ¨åˆ†</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span></span></code></pre></div><h3 id="_2-1-2-resticæ–¹å¼" tabindex="-1">2.1.2 resticæ–¹å¼ <a class="header-anchor" href="#_2-1-2-resticæ–¹å¼" aria-label="Permalink to &quot;2.1.2 resticæ–¹å¼&quot;">â€‹</a></h3><p>Restic æ˜¯ä¸€æ¬¾ GO è¯­è¨€å¼€å‘çš„å¼€æºå…è´¹ä¸”å¿«é€Ÿã€é«˜æ•ˆå’Œå®‰å…¨çš„è·¨å¹³å°å¤‡ä»½å·¥å…·ã€‚å®ƒæ˜¯æ–‡ä»¶ç³»ç»Ÿçº§åˆ«å¤‡ä»½æŒä¹…å·æ•°æ®å¹¶å°†å…¶å‘é€åˆ° Velero çš„å¯¹è±¡å­˜å‚¨ã€‚æ‰§è¡Œé€Ÿåº¦å–å†³äºæœ¬åœ° IO èƒ½åŠ›ï¼Œç½‘ç»œå¸¦å®½å’Œå¯¹è±¡å­˜å‚¨æ€§èƒ½ï¼Œç›¸å¯¹å¿«ç…§æ–¹å¼å¤‡ä»½æ…¢ã€‚ä½†å¦‚æœå½“å‰é›†ç¾¤æˆ–è€…å­˜å‚¨å‡ºç°é—®é¢˜ï¼Œç”±äºæ‰€æœ‰èµ„æºå’Œæ•°æ®éƒ½å­˜å‚¨åœ¨è¿œç«¯çš„å¯¹è±¡å­˜å‚¨ä¸Šï¼Œç”¨ Restic æ–¹å¼å¤‡ä»½å¯ä»¥å¾ˆå®¹æ˜“çš„å°†åº”ç”¨æ¢å¤ã€‚ <strong>Tipsï¼š</strong> ä½¿ç”¨ Restic æ¥å¯¹ PV è¿›è¡Œå¤‡ä»½ä¼šæœ‰ä¸€äº›é™åˆ¶ï¼š</p><ul><li>ä¸æ”¯æŒå¤‡ä»½ hostPathï¼Œæ”¯æŒ EFSã€AzureFileã€NFSã€emptyDirã€local æˆ–å…¶ä»–æ²¡æœ‰æœ¬åœ°å¿«ç…§æ¦‚å¿µçš„å·ç±»å‹</li><li>å¤‡ä»½æ•°æ®æ ‡å¿—åªèƒ½é€šè¿‡ Pod æ¥è¯†åˆ«</li><li>å•çº¿ç¨‹æ“ä½œå¤§é‡æ–‡ä»¶æ¯”è¾ƒæ…¢</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--provider </span><span style="color:#9ECBFF;">aws</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--bucket </span><span style="color:#9ECBFF;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--image </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--plugins  </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--namespace </span><span style="color:#9ECBFF;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--secret-file </span><span style="color:#9ECBFF;">/home/qm/velero/velero-v1.8.1-linux-amd64/credentials-velero</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--use-volume-snapshots=false </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--default-volumes-to-restic=true </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--kubeconfig=/root/.kube/config </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--use-restic </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">--backup-location-config </span><span style="color:#9ECBFF;">region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://10.103.236.199:9000</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--provider </span><span style="color:#032F62;">aws</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--bucket </span><span style="color:#032F62;">velero</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--image </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--plugins  </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--namespace </span><span style="color:#032F62;">velero</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--secret-file </span><span style="color:#032F62;">/home/qm/velero/velero-v1.8.1-linux-amd64/credentials-velero</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--use-volume-snapshots=false </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--default-volumes-to-restic=true </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--kubeconfig=/root/.kube/config </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--use-restic </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">--backup-location-config </span><span style="color:#032F62;">region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://10.103.236.199:9000</span></span></code></pre></div><p>è§£é‡Šï¼š</p><ul><li>--use-restic è¡¨ç¤ºä½¿ç”¨å¼€æºå…è´¹å¤‡ä»½å·¥å…· restic å¤‡ä»½å’Œè¿˜åŸæŒä¹…å·æ•°æ®ï¼Œå¯ç”¨è¯¥å‚æ•°åä¼šéƒ¨ç½²ä¸€ä¸ªåä¸º restic çš„ DaemonSet å¯¹è±¡</li></ul><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>æ³¨æ„çš„æ˜¯å¯åŠ¨éœ€è¦ä¿®æ”¹ Restic DaemonSet spec é…ç½®ï¼Œè°ƒæ•´ä¸ºå®é™…ç¯å¢ƒä¸­ Kubernetes æŒ‡å®š pod ä¿å­˜è·¯å¾„çš„ hostPath</p></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># æ ¹æ®å®é™…Kubernetes éƒ¨ç½²ç¯å¢ƒä¿®æ”¹hostPathè·¯å¾„</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-n</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">patch</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">daemonset</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restic</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;volumes&quot;:[{&quot;name&quot;:&quot;host-pods&quot;,&quot;hostPath&quot;:{&quot;path&quot;:&quot;/apps/data/kubelet/pods&quot;}}]}}}}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹æœåŠ¡</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-n</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># æ ¹æ®å®é™…Kubernetes éƒ¨ç½²ç¯å¢ƒä¿®æ”¹hostPathè·¯å¾„</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-n</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">patch</span><span style="color:#24292E;"> </span><span style="color:#032F62;">daemonset</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restic</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;{&quot;spec&quot;:{&quot;template&quot;:{&quot;spec&quot;:{&quot;volumes&quot;:[{&quot;name&quot;:&quot;host-pods&quot;,&quot;hostPath&quot;:{&quot;path&quot;:&quot;/apps/data/kubelet/pods&quot;}}]}}}}&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹æœåŠ¡</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-n</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero</span></span></code></pre></div><h2 id="_2-2-æœåŠ¡ç«¯å®‰è£…" tabindex="-1">2.2 æœåŠ¡ç«¯å®‰è£… <a class="header-anchor" href="#_2-2-æœåŠ¡ç«¯å®‰è£…" aria-label="Permalink to &quot;2.2 æœåŠ¡ç«¯å®‰è£…&quot;">â€‹</a></h2><p>å®˜æ¡£,<a href="https://velero.io/docs/v1.8/customize-installation/" target="_blank" rel="noreferrer">https://velero.io/docs/v1.8/customize-installation/</a></p><h3 id="_2-2-1-k8s-minioæ–¹å¼" tabindex="-1">2.2.1 k8s-minioæ–¹å¼ <a class="header-anchor" href="#_2-2-1-k8s-minioæ–¹å¼" aria-label="Permalink to &quot;2.2.1 k8s-minioæ–¹å¼&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºå‡­è¯ create auth</span></span>
<span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/k8s/velero</span></span>
<span class="line"><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">~/k8s/velero/auth-minio.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#9ECBFF;">[default]</span></span>
<span class="line"><span style="color:#9ECBFF;">aws_access_key_id = minio</span></span>
<span class="line"><span style="color:#9ECBFF;">aws_secret_access_key = miniow2p0w2r4</span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#velero install</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--plugins</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--provider</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">aws</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--bucket</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--use-volume-snapshots=false</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--secret-file</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">~/k8s/velero/auth-minio.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--backup-location-config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://minio.kube-public.svc:9000</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#è‡ªå®šä¹‰é•œåƒåœ°å€ --image --plugins</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# velero version</span></span>
<span class="line"><span style="color:#B392F0;">Client:</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">Version:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">v1.13.2</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">Git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">commit:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4</span><span style="color:#9ECBFF;">d961fb6fec384ed7f3c1b7c65c818106107f5a6</span></span>
<span class="line"><span style="color:#B392F0;">Server:</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">Version:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">v1.13.2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# kubectl api-versions </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero</span></span>
<span class="line"><span style="color:#B392F0;">velero.io/v1</span></span>
<span class="line"><span style="color:#B392F0;">velero.io/v2alpha1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹pod</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# kubectl get pod -n velero</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                      </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">velero-5cdfb5ccc4-xphcj</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">h25m</span></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹crd</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-n</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">crds</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-l</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">component=velero</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#åˆ›å»ºå‡­è¯ create auth</span></span>
<span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/k8s/velero</span></span>
<span class="line"><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">~/k8s/velero/auth-minio.txt</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#032F62;">[default]</span></span>
<span class="line"><span style="color:#032F62;">aws_access_key_id = minio</span></span>
<span class="line"><span style="color:#032F62;">aws_secret_access_key = miniow2p0w2r4</span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#velero install</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero:v1.13.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--plugins</span><span style="color:#24292E;"> </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/velero-plugin-for-aws:v1.9.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--provider</span><span style="color:#24292E;"> </span><span style="color:#032F62;">aws</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--bucket</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--use-volume-snapshots=false</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--secret-file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">~/k8s/velero/auth-minio.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--backup-location-config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://minio.kube-public.svc:9000</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#è‡ªå®šä¹‰é•œåƒåœ°å€ --image --plugins</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹ç‰ˆæœ¬</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# velero version</span></span>
<span class="line"><span style="color:#6F42C1;">Client:</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">Version:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">v1.13.2</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">Git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">commit:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#032F62;">d961fb6fec384ed7f3c1b7c65c818106107f5a6</span></span>
<span class="line"><span style="color:#6F42C1;">Server:</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">Version:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">v1.13.2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# kubectl api-versions </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero</span></span>
<span class="line"><span style="color:#6F42C1;">velero.io/v1</span></span>
<span class="line"><span style="color:#6F42C1;">velero.io/v2alpha1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹pod</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# kubectl get pod -n velero</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                      </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">velero-5cdfb5ccc4-xphcj</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">h25m</span></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹crd</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-n</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">crds</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-l</span><span style="color:#24292E;"> </span><span style="color:#032F62;">component=velero</span></span></code></pre></div><h3 id="_2-2-2-å®¹å™¨æ–¹å¼" tabindex="-1">2.2.2 å®¹å™¨æ–¹å¼ <a class="header-anchor" href="#_2-2-2-å®¹å™¨æ–¹å¼" aria-label="Permalink to &quot;2.2.2 å®¹å™¨æ–¹å¼&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">registry.aliyuncs.com/elvin/velero:v1.13.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--plugins</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">registry.aliyuncs.com/elvin/velero-plugin-for-aws:v1.9.2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--provider</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">aws</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--bucket</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--use-volume-snapshots=false</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--secret-file</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/root/velero/auth-minio.txt</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">\\</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--backup-location-config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://10.103.236.199:9001</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">registry.aliyuncs.com/elvin/velero:v1.13.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--plugins</span><span style="color:#24292E;"> </span><span style="color:#032F62;">registry.aliyuncs.com/elvin/velero-plugin-for-aws:v1.9.2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--provider</span><span style="color:#24292E;"> </span><span style="color:#032F62;">aws</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--bucket</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--use-volume-snapshots=false</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--secret-file</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/root/velero/auth-minio.txt</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">\\</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#005CC5;">--backup-location-config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">region=minio,s3ForcePathStyle=&quot;true&quot;,s3Url=http://10.103.236.199:9001</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">## æŸ¥çœ‹æœåŠ¡å¯åŠ¨æƒ…å†µ</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# kubectl get all -n velero</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                          </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">pod/velero-5cdfb5ccc4-kmwbs</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">m8s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                     </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">UP-TO-DATE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AVAILABLE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">deployment.apps/velero</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">           </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">m8s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                                </span><span style="color:#9ECBFF;">DESIRED</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CURRENT</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">replicaset.apps/velero-5cdfb5ccc4</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">       </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">m8s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">## æŸ¥çœ‹æœåŠ¡å¯åŠ¨æƒ…å†µ</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# kubectl get all -n velero</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                          </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">pod/velero-5cdfb5ccc4-kmwbs</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">m8s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                     </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">UP-TO-DATE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AVAILABLE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">deployment.apps/velero</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">            </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">           </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">m8s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                                </span><span style="color:#032F62;">DESIRED</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CURRENT</span><span style="color:#24292E;">   </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">replicaset.apps/velero-5cdfb5ccc4</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">       </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">m8s</span></span></code></pre></div><h2 id="_2-3-å®¢æˆ·ç«¯å®‰è£…" tabindex="-1">2.3 å®¢æˆ·ç«¯å®‰è£… <a class="header-anchor" href="#_2-3-å®¢æˆ·ç«¯å®‰è£…" aria-label="Permalink to &quot;2.3 å®¢æˆ·ç«¯å®‰è£…&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#ä¸‹è½½</span></span>
<span class="line"><span style="color:#B392F0;">wget</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/vmware-tanzu/velero/releases/download/v1.13.2/velero-v1.13.2-linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#è§£å‹ï¼Œç”±äºæ˜¯äºŒè¿›åˆ¶åŒ…ï¼Œç›´æ¥è§£å‹ä½¿ç”¨</span></span>
<span class="line"><span style="color:#B392F0;">tar</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">zxvf</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero-v1.13.2-linux-amd64.tar.gz</span><span style="color:#E1E4E8;"> &amp;&amp; </span><span style="color:#B392F0;">mv</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">velero-v1.13.2-linux-amd64/velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/usr/local/bin/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#éªŒè¯</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero-v1.13.2-linux-amd64]# velero version</span></span>
<span class="line"><span style="color:#B392F0;">Client:</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">Version:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">v1.13.2</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">Git</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">commit:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">4</span><span style="color:#9ECBFF;">d961fb6fec384ed7f3c1b7c65c818106107f5a6</span></span>
<span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">error getting server version: no matches </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> kind </span><span style="color:#9ECBFF;">&quot;ServerStatusRequest&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> version </span><span style="color:#9ECBFF;">&quot;velero.io/v1&quot;</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#å‡ºç°ä¸Šé¢çš„åŸå› ï¼ŒæœåŠ¡ç«¯è¿˜æ²¡æœ‰å®‰è£…</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#ä¸‹è½½</span></span>
<span class="line"><span style="color:#6F42C1;">wget</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/vmware-tanzu/velero/releases/download/v1.13.2/velero-v1.13.2-linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#è§£å‹ï¼Œç”±äºæ˜¯äºŒè¿›åˆ¶åŒ…ï¼Œç›´æ¥è§£å‹ä½¿ç”¨</span></span>
<span class="line"><span style="color:#6F42C1;">tar</span><span style="color:#24292E;"> </span><span style="color:#032F62;">zxvf</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero-v1.13.2-linux-amd64.tar.gz</span><span style="color:#24292E;"> &amp;&amp; </span><span style="color:#6F42C1;">mv</span><span style="color:#24292E;"> </span><span style="color:#032F62;">velero-v1.13.2-linux-amd64/velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/usr/local/bin/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#éªŒè¯</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero-v1.13.2-linux-amd64]# velero version</span></span>
<span class="line"><span style="color:#6F42C1;">Client:</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">Version:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">v1.13.2</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">Git</span><span style="color:#24292E;"> </span><span style="color:#032F62;">commit:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">4</span><span style="color:#032F62;">d961fb6fec384ed7f3c1b7c65c818106107f5a6</span></span>
<span class="line"><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">error getting server version: no matches </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> kind </span><span style="color:#032F62;">&quot;ServerStatusRequest&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> version </span><span style="color:#032F62;">&quot;velero.io/v1&quot;</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#å‡ºç°ä¸Šé¢çš„åŸå› ï¼ŒæœåŠ¡ç«¯è¿˜æ²¡æœ‰å®‰è£…</span></span></code></pre></div><ul><li>å¯ç”¨å‘½ä»¤è¡¥å…¨</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#å¯ç”¨å‘½ä»¤è¡¥å…¨</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">completion</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bash</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/bash_completion.d/velero</span></span>
<span class="line"><span style="color:#79B8FF;">.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/bash_completion.d/velero</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å¸®åŠ©</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-h</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#å¯ç”¨å‘½ä»¤è¡¥å…¨</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">completion</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bash</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/bash_completion.d/velero</span></span>
<span class="line"><span style="color:#005CC5;">.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/bash_completion.d/velero</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å¸®åŠ©</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-h</span></span></code></pre></div><h1 id="_3-veleroå¸¸ç”¨æ“ä½œ" tabindex="-1">3. veleroå¸¸ç”¨æ“ä½œ <a class="header-anchor" href="#_3-veleroå¸¸ç”¨æ“ä½œ" aria-label="Permalink to &quot;3. veleroå¸¸ç”¨æ“ä½œ&quot;">â€‹</a></h1><h2 id="_3-0-åŸºæœ¬å‘½ä»¤" tabindex="-1">3.0 åŸºæœ¬å‘½ä»¤ <a class="header-anchor" href="#_3-0-åŸºæœ¬å‘½ä»¤" aria-label="Permalink to &quot;3.0 åŸºæœ¬å‘½ä»¤&quot;">â€‹</a></h2><p><code>å¸®åŠ©</code>ï¼švelero --help</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#veleroåŸºæœ¬å‘½ä»¤</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹å¤‡ä»½</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹å®šæ—¶å¤‡ä»½</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹å·²æœ‰çš„æ¢å¤</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">plugins</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹æ’ä»¶</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#å¤‡ä»½æ‰€æœ‰</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--ttl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">72</span><span style="color:#9ECBFF;">h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æ¢å¤é›†ç¾¤æ‰€æœ‰å¤‡ä»½,å¯¹å·²ç»å­˜åœ¨çš„æœåŠ¡ä¸ä¼šè¦†ç›–</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--from-backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ä»…æ¢å¤defaultçš„namespace,åŒ…æ‹¬é›†ç¾¤èµ„æº</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--from-backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">default</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-cluster-resources=true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æ¢å¤å‚¨å­˜pv,pvc</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pvc</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--from-backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-resources</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">persistentvolumeclaims,persistentvolumes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æ¢å¤æŒ‡å®šèµ„æºdeployments,configmaps </span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deploy-test</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--from-backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-resources</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployments,configmaps</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ç­›é€‰å¤‡ä»½name=nginx-demo -l, --selectorï¼šé€šè¿‡æŒ‡å®šlabelæ¥åŒ¹é…è¦backupçš„èµ„æº</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx-demo</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--from-backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--selector</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">name=nginx-demo</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#ç­›é€‰å¤‡ä»½æ¢å¤å¯¹è±¡</span></span>
<span class="line"><span style="color:#B392F0;">--include-namespaces</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">ç­›é€‰å‘½åç©ºé—´æ‰€æœ‰èµ„æº,ä¸åŒ…æ‹¬é›†ç¾¤èµ„æº</span></span>
<span class="line"><span style="color:#B392F0;">--include-resources</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ç­›é€‰çš„èµ„æºç±»å‹</span></span>
<span class="line"><span style="color:#B392F0;">--exclude-resources</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">æ’é™¤çš„èµ„æºç±»å‹</span></span>
<span class="line"><span style="color:#E1E4E8;">--include-cluster-resources</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">true</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">åŒ…æ‹¬é›†ç¾¤èµ„æº</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#å°†test1å‘½åç©ºé—´èµ„æºæ¢å¤åˆ°test2  </span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">test1-test2</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--from-backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespace-mappings</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">test1:test2</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#å¤‡ä»½hooks</span></span>
<span class="line"><span style="color:#6A737D;">#Veleroæ”¯æŒåœ¨å¤‡ä»½ä»»åŠ¡æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œååœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸€äº›é¢„å…ˆè®¾å®šå¥½çš„å‘½ä»¤</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#veleroåŸºæœ¬å‘½ä»¤</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹å¤‡ä»½</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹å®šæ—¶å¤‡ä»½</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹å·²æœ‰çš„æ¢å¤</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">plugins</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æŸ¥çœ‹æ’ä»¶</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#å¤‡ä»½æ‰€æœ‰</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--ttl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">72</span><span style="color:#032F62;">h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æ¢å¤é›†ç¾¤æ‰€æœ‰å¤‡ä»½,å¯¹å·²ç»å­˜åœ¨çš„æœåŠ¡ä¸ä¼šè¦†ç›–</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--from-backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ä»…æ¢å¤defaultçš„namespace,åŒ…æ‹¬é›†ç¾¤èµ„æº</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--from-backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-namespaces</span><span style="color:#24292E;"> </span><span style="color:#032F62;">default</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-cluster-resources=true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æ¢å¤å‚¨å­˜pv,pvc</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pvc</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--from-backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-resources</span><span style="color:#24292E;"> </span><span style="color:#032F62;">persistentvolumeclaims,persistentvolumes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æ¢å¤æŒ‡å®šèµ„æºdeployments,configmaps </span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deploy-test</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--from-backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-resources</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployments,configmaps</span><span style="color:#24292E;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ç­›é€‰å¤‡ä»½name=nginx-demo -l, --selectorï¼šé€šè¿‡æŒ‡å®šlabelæ¥åŒ¹é…è¦backupçš„èµ„æº</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx-demo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--from-backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--selector</span><span style="color:#24292E;"> </span><span style="color:#032F62;">name=nginx-demo</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#ç­›é€‰å¤‡ä»½æ¢å¤å¯¹è±¡</span></span>
<span class="line"><span style="color:#6F42C1;">--include-namespaces</span><span style="color:#24292E;">  </span><span style="color:#032F62;">ç­›é€‰å‘½åç©ºé—´æ‰€æœ‰èµ„æº,ä¸åŒ…æ‹¬é›†ç¾¤èµ„æº</span></span>
<span class="line"><span style="color:#6F42C1;">--include-resources</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ç­›é€‰çš„èµ„æºç±»å‹</span></span>
<span class="line"><span style="color:#6F42C1;">--exclude-resources</span><span style="color:#24292E;">   </span><span style="color:#032F62;">æ’é™¤çš„èµ„æºç±»å‹</span></span>
<span class="line"><span style="color:#24292E;">--include-cluster-resources</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">true</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">åŒ…æ‹¬é›†ç¾¤èµ„æº</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#å°†test1å‘½åç©ºé—´èµ„æºæ¢å¤åˆ°test2  </span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">test1-test2</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--from-backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespace-mappings</span><span style="color:#24292E;"> </span><span style="color:#032F62;">test1:test2</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#å¤‡ä»½hooks</span></span>
<span class="line"><span style="color:#6A737D;">#Veleroæ”¯æŒåœ¨å¤‡ä»½ä»»åŠ¡æ‰§è¡Œä¹‹å‰å’Œæ‰§è¡Œååœ¨å®¹å™¨ä¸­æ‰§è¡Œä¸€äº›é¢„å…ˆè®¾å®šå¥½çš„å‘½ä»¤</span></span></code></pre></div><h2 id="_3-1-å¤‡ä»½" tabindex="-1">3.1 å¤‡ä»½ <a class="header-anchor" href="#_3-1-å¤‡ä»½" aria-label="Permalink to &quot;3.1 å¤‡ä»½&quot;">â€‹</a></h2><ul><li>åˆ›å»ºbucketname</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#åˆ›å»ºbucket velero</span></span>
<span class="line"><span style="color:#B392F0;">docker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">exec</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-it</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">minio</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bash</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;mc mb velero; mc ls&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#åˆ›å»ºbucket velero</span></span>
<span class="line"><span style="color:#6F42C1;">docker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">exec</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-it</span><span style="color:#24292E;"> </span><span style="color:#032F62;">minio</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bash</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;mc mb velero; mc ls&#39;</span></span></code></pre></div><ul><li>åˆ›å»º</li></ul><p>è¯­æ³•ï¼švelero backup create backname --include-namespaces namespace</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@kube-master velero]# velero backup create k8s-backup-test --include-namespaces default</span></span>
<span class="line"><span style="color:#e1e4e8;">Backup request &quot;k8s-backup-test&quot; submitted successfully.</span></span>
<span class="line"><span style="color:#e1e4e8;">Run \`velero backup describe k8s-backup-test\` or \`velero backup logs k8s-backup-test\` for more details.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@kube-master velero]# velero backup create k8s-backup-test --include-namespaces default</span></span>
<span class="line"><span style="color:#24292e;">Backup request &quot;k8s-backup-test&quot; submitted successfully.</span></span>
<span class="line"><span style="color:#24292e;">Run \`velero backup describe k8s-backup-test\` or \`velero backup logs k8s-backup-test\` for more details.</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹defaultç©ºé—´ä¸‹çš„èµ„æº</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# kubectl get pod</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                                      </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">app-prod-97dfb4bf-h59vq</span><span style="color:#E1E4E8;">                   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">25</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">app-prod-tcp-7bdfd5577c-tb8ls</span><span style="color:#E1E4E8;">             </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">25</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">custom-nginx-errors-6df8ddcc64-ztqnz</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">24</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">demo-6d4fc77748-dmg94</span><span style="color:#E1E4E8;">                     </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)    8d</span></span>
<span class="line"><span style="color:#B392F0;">demo-6d4fc77748-fbvg6</span><span style="color:#E1E4E8;">                     </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">6</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)    8d</span></span>
<span class="line"><span style="color:#B392F0;">nfs-client-provisioner-7f5bc48c68-8wld4</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">old-demo-687c6ccd99-2rzwr</span><span style="color:#E1E4E8;">                 </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">17</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   18d</span></span>
<span class="line"><span style="color:#B392F0;">old-demo-687c6ccd99-rv9fz</span><span style="color:#E1E4E8;">                 </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">53</span><span style="color:#E1E4E8;"> (35m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   59d</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# velero backup get</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">ERRORS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">WARNINGS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CREATED</span><span style="color:#E1E4E8;">                         </span><span style="color:#9ECBFF;">EXPIRES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STORAGE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LOCATION</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">SELECTOR</span></span>
<span class="line"><span style="color:#B392F0;">k8s-backup-test</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Completed</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-07-25</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:12:23</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+0800</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CST</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">29</span><span style="color:#9ECBFF;">d</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">default</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹defaultç©ºé—´ä¸‹çš„èµ„æº</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# kubectl get pod</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                                      </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">       </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">app-prod-97dfb4bf-h59vq</span><span style="color:#24292E;">                   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">25</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">app-prod-tcp-7bdfd5577c-tb8ls</span><span style="color:#24292E;">             </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">25</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">custom-nginx-errors-6df8ddcc64-ztqnz</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">24</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">demo-6d4fc77748-dmg94</span><span style="color:#24292E;">                     </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)    8d</span></span>
<span class="line"><span style="color:#6F42C1;">demo-6d4fc77748-fbvg6</span><span style="color:#24292E;">                     </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">6</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)    8d</span></span>
<span class="line"><span style="color:#6F42C1;">nfs-client-provisioner-7f5bc48c68-8wld4</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">32</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">old-demo-687c6ccd99-2rzwr</span><span style="color:#24292E;">                 </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">17</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   18d</span></span>
<span class="line"><span style="color:#6F42C1;">old-demo-687c6ccd99-rv9fz</span><span style="color:#24292E;">                 </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">53</span><span style="color:#24292E;"> (35m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   59d</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# velero backup get</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">              </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">      </span><span style="color:#032F62;">ERRORS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">WARNINGS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CREATED</span><span style="color:#24292E;">                         </span><span style="color:#032F62;">EXPIRES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STORAGE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LOCATION</span><span style="color:#24292E;">   </span><span style="color:#032F62;">SELECTOR</span></span>
<span class="line"><span style="color:#6F42C1;">k8s-backup-test</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Completed</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-07-25</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:12:23</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+0800</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CST</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">29</span><span style="color:#032F62;">d</span><span style="color:#24292E;">       </span><span style="color:#032F62;">default</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><table><thead><tr><th>åˆ—è¡¨åå­—</th><th>æè¿°</th></tr></thead><tbody><tr><td>NAME</td><td>veleroå¤‡ä»½åå­—</td></tr><tr><td>STATUS</td><td>å¤‡ä»½çŠ¶æ€</td></tr><tr><td>ERRORS</td><td></td></tr><tr><td>WARNINGS</td><td></td></tr><tr><td>CREATED</td><td>åˆ›å»ºæ—¶é—´</td></tr><tr><td>EXPIRES</td><td>è¿‡æœŸæ—¶é—´</td></tr><tr><td>STORAGE LOCATION</td><td>å¤‡ä»½å­˜å‚¨ç©ºé—´åå­—</td></tr><tr><td>SELECTOR</td><td></td></tr></tbody></table><ul><li>æ•ˆæœ</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202407251013913.png" alt="image-20240725101325377"></p><h2 id="_3-2-è¿˜åŸ" tabindex="-1">3.2 è¿˜åŸ <a class="header-anchor" href="#_3-2-è¿˜åŸ" aria-label="Permalink to &quot;3.2 è¿˜åŸ&quot;">â€‹</a></h2><ul><li>åˆ é™¤å…¶ä¸­çš„pod</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# helm list</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">NAMESPACE</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">REVISION</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">UPDATED</span><span style="color:#E1E4E8;">                                	</span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">  	</span><span style="color:#9ECBFF;">CHART</span><span style="color:#E1E4E8;">     	</span><span style="color:#9ECBFF;">APP</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">VERSION</span></span>
<span class="line"><span style="color:#B392F0;">demo</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">default</span><span style="color:#E1E4E8;">  	</span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">       	</span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-07-16</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">18</span><span style="color:#9ECBFF;">:06:26.685169771</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+0800</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CST</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">deployed</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">demo-1.0.0</span><span style="color:#E1E4E8;">	</span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# helm uninstall demo</span></span>
<span class="line"><span style="color:#B392F0;">release</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;demo&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">uninstalled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# kubectl get pod</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                                      </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">app-prod-97dfb4bf-h59vq</span><span style="color:#E1E4E8;">                   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">25</span><span style="color:#E1E4E8;"> (36m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">app-prod-tcp-7bdfd5577c-tb8ls</span><span style="color:#E1E4E8;">             </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">25</span><span style="color:#E1E4E8;"> (36m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">custom-nginx-errors-6df8ddcc64-ztqnz</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">24</span><span style="color:#E1E4E8;"> (36m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">nfs-client-provisioner-7f5bc48c68-8wld4</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">32</span><span style="color:#E1E4E8;"> (36m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   23d</span></span>
<span class="line"><span style="color:#B392F0;">old-demo-687c6ccd99-2rzwr</span><span style="color:#E1E4E8;">                 </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">17</span><span style="color:#E1E4E8;"> (36m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   18d</span></span>
<span class="line"><span style="color:#B392F0;">old-demo-687c6ccd99-rv9fz</span><span style="color:#E1E4E8;">                 </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">53</span><span style="color:#E1E4E8;"> (36m </span><span style="color:#9ECBFF;">ago</span><span style="color:#E1E4E8;">)   59d</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master velero]# helm list</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">	</span><span style="color:#032F62;">NAMESPACE</span><span style="color:#24292E;">	</span><span style="color:#032F62;">REVISION</span><span style="color:#24292E;">	</span><span style="color:#032F62;">UPDATED</span><span style="color:#24292E;">                                	</span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">  	</span><span style="color:#032F62;">CHART</span><span style="color:#24292E;">     	</span><span style="color:#032F62;">APP</span><span style="color:#24292E;"> </span><span style="color:#032F62;">VERSION</span></span>
<span class="line"><span style="color:#6F42C1;">demo</span><span style="color:#24292E;">	</span><span style="color:#032F62;">default</span><span style="color:#24292E;">  	</span><span style="color:#005CC5;">3</span><span style="color:#24292E;">       	</span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-07-16</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">18</span><span style="color:#032F62;">:06:26.685169771</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+0800</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CST</span><span style="color:#24292E;">	</span><span style="color:#032F62;">deployed</span><span style="color:#24292E;">	</span><span style="color:#032F62;">demo-1.0.0</span><span style="color:#24292E;">	</span><span style="color:#032F62;">v1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# helm uninstall demo</span></span>
<span class="line"><span style="color:#6F42C1;">release</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;demo&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">uninstalled</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@kube-master velero]# kubectl get pod</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                                      </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">       </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">app-prod-97dfb4bf-h59vq</span><span style="color:#24292E;">                   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">25</span><span style="color:#24292E;"> (36m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">app-prod-tcp-7bdfd5577c-tb8ls</span><span style="color:#24292E;">             </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">25</span><span style="color:#24292E;"> (36m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">custom-nginx-errors-6df8ddcc64-ztqnz</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">24</span><span style="color:#24292E;"> (36m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">nfs-client-provisioner-7f5bc48c68-8wld4</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">32</span><span style="color:#24292E;"> (36m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   23d</span></span>
<span class="line"><span style="color:#6F42C1;">old-demo-687c6ccd99-2rzwr</span><span style="color:#24292E;">                 </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">17</span><span style="color:#24292E;"> (36m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   18d</span></span>
<span class="line"><span style="color:#6F42C1;">old-demo-687c6ccd99-rv9fz</span><span style="color:#24292E;">                 </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">53</span><span style="color:#24292E;"> (36m </span><span style="color:#032F62;">ago</span><span style="color:#24292E;">)   59d</span></span></code></pre></div><ul><li>è¿˜åŸ</li></ul><p>è¯­æ³•ï¼š</p><p>velero restore create pod_name --from-backup k8s-backup-test --include-namespaces default</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]#  velero restore create demo --from-backup k8s-backup-test  --include-namespaces default</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#è§£é‡Š</span></span>
<span class="line"><span style="color:#B392F0;">demo</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">----</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Pod_name</span></span>
<span class="line"><span style="color:#B392F0;">k8s-backup-test</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">---</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">veleroå¤‡ä»½åå­—</span></span>
<span class="line"><span style="color:#B392F0;">default</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">---</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">namespace</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master velero]#  velero restore create demo --from-backup k8s-backup-test  --include-namespaces default</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#è§£é‡Š</span></span>
<span class="line"><span style="color:#6F42C1;">demo</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">----</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Pod_name</span></span>
<span class="line"><span style="color:#6F42C1;">k8s-backup-test</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">---</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">veleroå¤‡ä»½åå­—</span></span>
<span class="line"><span style="color:#6F42C1;">default</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">---</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">namespace</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# kubectl get pod</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                                      </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">demo-6d4fc77748-dmg94</span><span style="color:#E1E4E8;">                     </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">              </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">s</span></span>
<span class="line"><span style="color:#B392F0;">demo-6d4fc77748-fbvg6</span><span style="color:#E1E4E8;">                     </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">              </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master velero]# kubectl get pod</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                                      </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">       </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">demo-6d4fc77748-dmg94</span><span style="color:#24292E;">                     </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">              </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">s</span></span>
<span class="line"><span style="color:#6F42C1;">demo-6d4fc77748-fbvg6</span><span style="color:#24292E;">                     </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">              </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">s</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><ul><li>åœ¨veleroå¤‡ä»½çš„æ—¶å€™ï¼Œå¤‡ä»½è¿‡ç¨‹ä¸­åˆ›å»ºçš„å¯¹è±¡æ˜¯ä¸ä¼šè¢«å¤‡ä»½çš„ã€‚</li><li><code>velero restore</code> æ¢å¤ä¸ä¼šè¦†ç›–<code>å·²æœ‰çš„èµ„æº</code>ï¼Œåªæ¢å¤å½“å‰é›†ç¾¤ä¸­<code>ä¸å­˜åœ¨çš„èµ„æº</code>ã€‚å·²æœ‰çš„èµ„æºä¸ä¼šå›æ»šåˆ°ä¹‹å‰çš„ç‰ˆæœ¬ï¼Œå¦‚éœ€è¦å›æ»šï¼Œéœ€åœ¨restoreä¹‹å‰æå‰åˆ é™¤ç°æœ‰çš„èµ„æº</li></ul></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# velero restore get</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">BACKUP</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">STARTED</span><span style="color:#E1E4E8;">                         </span><span style="color:#9ECBFF;">COMPLETED</span><span style="color:#E1E4E8;">                       </span><span style="color:#9ECBFF;">ERRORS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">WARNINGS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CREATED</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">SELECTOR</span></span>
<span class="line"><span style="color:#B392F0;">demo</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">k8s-backup-test</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Completed</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-07-25</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:21:21</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+0800</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CST</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-07-25</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:21:25</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+0800</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CST</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">12</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-07-25</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:21:21</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+0800</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CST</span><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master velero]# velero restore get</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">BACKUP</span><span style="color:#24292E;">            </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">      </span><span style="color:#032F62;">STARTED</span><span style="color:#24292E;">                         </span><span style="color:#032F62;">COMPLETED</span><span style="color:#24292E;">                       </span><span style="color:#032F62;">ERRORS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">WARNINGS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CREATED</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">SELECTOR</span></span>
<span class="line"><span style="color:#6F42C1;">demo</span><span style="color:#24292E;">   </span><span style="color:#032F62;">k8s-backup-test</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Completed</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-07-25</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:21:21</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+0800</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CST</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-07-25</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:21:25</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+0800</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CST</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">12</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-07-25</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:21:21</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+0800</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CST</span><span style="color:#24292E;">   </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h2 id="_3-3-æŸ¥çœ‹" tabindex="-1">3.3 æŸ¥çœ‹ <a class="header-anchor" href="#_3-3-æŸ¥çœ‹" aria-label="Permalink to &quot;3.3 æŸ¥çœ‹&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# velero backup get</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                        </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">ERRORS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">WARNINGS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CREATED</span><span style="color:#E1E4E8;">                         </span><span style="color:#9ECBFF;">EXPIRES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STORAGE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">LOCATION</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">SELECTOR</span></span>
<span class="line"><span style="color:#B392F0;">k8s-backup-test</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">Completed</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-07-25</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:12:23</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+0800</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CST</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">29</span><span style="color:#9ECBFF;">d</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">default</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">k8s-bakcup-all-2024-07-25</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Completed</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-07-25</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">:43:26</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+0800</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CST</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">d</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">default</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å¤‡ä»½ç»“æœ</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">describe</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-backup-test</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-backup-test</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master velero]# velero backup get</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                        </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">      </span><span style="color:#032F62;">ERRORS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">WARNINGS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CREATED</span><span style="color:#24292E;">                         </span><span style="color:#032F62;">EXPIRES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STORAGE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">LOCATION</span><span style="color:#24292E;">   </span><span style="color:#032F62;">SELECTOR</span></span>
<span class="line"><span style="color:#6F42C1;">k8s-backup-test</span><span style="color:#24292E;">             </span><span style="color:#032F62;">Completed</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-07-25</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:12:23</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+0800</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CST</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">29</span><span style="color:#032F62;">d</span><span style="color:#24292E;">       </span><span style="color:#032F62;">default</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">k8s-bakcup-all-2024-07-25</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Completed</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-07-25</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">:43:26</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+0800</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CST</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">d</span><span style="color:#24292E;">        </span><span style="color:#032F62;">default</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å¤‡ä»½ç»“æœ</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">describe</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-backup-test</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-backup-test</span></span></code></pre></div><h2 id="_3-4-åˆ é™¤" tabindex="-1">3.4 åˆ é™¤ <a class="header-anchor" href="#_3-4-åˆ é™¤" aria-label="Permalink to &quot;3.4 åˆ é™¤&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master velero]# velero delete backup k8s-bakcup-all-2024-07-25</span></span>
<span class="line"><span style="color:#B392F0;">Are</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">you</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sure</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">you</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">want</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">continue</span><span style="color:#E1E4E8;"> (Y/N)</span><span style="color:#F97583;">?</span><span style="color:#E1E4E8;"> Y</span></span>
<span class="line"><span style="color:#B392F0;">Request</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;k8s-bakcup-all-2024-07-25&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">submitted</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">successfully.</span></span>
<span class="line"><span style="color:#B392F0;">The</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">will</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">be</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">fully</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deleted</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">after</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">all</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">associated</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">data</span><span style="color:#E1E4E8;"> (disk </span><span style="color:#9ECBFF;">snapshots,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">files,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restores</span><span style="color:#E1E4E8;">) are removed.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ç›´æ¥ä¸ç”¨è¾“å…¥Y</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all-2024-07-25</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--confirm</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master velero]# velero delete backup k8s-bakcup-all-2024-07-25</span></span>
<span class="line"><span style="color:#6F42C1;">Are</span><span style="color:#24292E;"> </span><span style="color:#032F62;">you</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sure</span><span style="color:#24292E;"> </span><span style="color:#032F62;">you</span><span style="color:#24292E;"> </span><span style="color:#032F62;">want</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">continue</span><span style="color:#24292E;"> (Y/N)</span><span style="color:#D73A49;">?</span><span style="color:#24292E;"> Y</span></span>
<span class="line"><span style="color:#6F42C1;">Request</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;k8s-bakcup-all-2024-07-25&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">submitted</span><span style="color:#24292E;"> </span><span style="color:#032F62;">successfully.</span></span>
<span class="line"><span style="color:#6F42C1;">The</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">will</span><span style="color:#24292E;"> </span><span style="color:#032F62;">be</span><span style="color:#24292E;"> </span><span style="color:#032F62;">fully</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deleted</span><span style="color:#24292E;"> </span><span style="color:#032F62;">after</span><span style="color:#24292E;"> </span><span style="color:#032F62;">all</span><span style="color:#24292E;"> </span><span style="color:#032F62;">associated</span><span style="color:#24292E;"> </span><span style="color:#032F62;">data</span><span style="color:#24292E;"> (disk </span><span style="color:#032F62;">snapshots,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">files,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restores</span><span style="color:#24292E;">) are removed.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#ç›´æ¥ä¸ç”¨è¾“å…¥Y</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all-2024-07-25</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--confirm</span></span></code></pre></div><h2 id="_3-5-å¸è½½velero" tabindex="-1">3.5 å¸è½½velero <a class="header-anchor" href="#_3-5-å¸è½½velero" aria-label="Permalink to &quot;3.5 å¸è½½velero&quot;">â€‹</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">uninstall</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#å¸è½½veleroï¼Œæ³¨æ„è¿™é‡Œçš„uninstallä¸ä¼šåˆ é™¤namespaceï¼š</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">namespace/velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clusterrolebinding/velero</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">crds</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-l</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">component=velero</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">uninstall</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#å¸è½½veleroï¼Œæ³¨æ„è¿™é‡Œçš„uninstallä¸ä¼šåˆ é™¤namespaceï¼š</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">namespace/velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clusterrolebinding/velero</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">crds</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-l</span><span style="color:#24292E;"> </span><span style="color:#032F62;">component=velero</span></span></code></pre></div><h2 id="_3-6-ä»»åŠ¡" tabindex="-1">3.6 ä»»åŠ¡ <a class="header-anchor" href="#_3-6-ä»»åŠ¡" aria-label="Permalink to &quot;3.6 ä»»åŠ¡&quot;">â€‹</a></h2><h3 id="å®šæ—¶ä»»åŠ¡" tabindex="-1">å®šæ—¶ä»»åŠ¡ <a class="header-anchor" href="#å®šæ—¶ä»»åŠ¡" aria-label="Permalink to &quot;å®šæ—¶ä»»åŠ¡&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#å¤‡ä»½æ‰€æœ‰èµ„æºä¿ç•™72å°æ—¶</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all-$(</span><span style="color:#B392F0;">date</span><span style="color:#9ECBFF;"> +%F)</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--ttl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">72</span><span style="color:#9ECBFF;">h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å¤‡ä»½</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#å¤‡ä»½æ‰€æœ‰èµ„æºä¿ç•™72å°æ—¶</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all-$(</span><span style="color:#6F42C1;">date</span><span style="color:#032F62;"> +%F)</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--ttl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">72</span><span style="color:#032F62;">h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å¤‡ä»½</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span></span></code></pre></div><h3 id="å‘¨æœŸæ€§ä»»åŠ¡crongjob" tabindex="-1">å‘¨æœŸæ€§ä»»åŠ¡crongJob <a class="header-anchor" href="#å‘¨æœŸæ€§ä»»åŠ¡crongjob" aria-label="Permalink to &quot;å‘¨æœŸæ€§ä»»åŠ¡crongJob&quot;">â€‹</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#å‘¨æœŸæ€§ä»»åŠ¡</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-h</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#6A737D;">#å®šæ—¶ä»»åŠ¡,æ¯å¤©16ç‚¹(UTCæ—¶åŒº)å¤‡ä»½ï¼Œä¿ç•™7å¤©(168h)</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-bakcup-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;0 16 * * *&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--ttl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">168</span><span style="color:#9ECBFF;">h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a backup every 6 hours</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NAME</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;0 */6 * * *&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a backup every 6 hours with the @every notation</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NAME</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;@every 6h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a daily backup of the web namespace</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NAME</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;@every 24h&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">web</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a weekly backup, each living for 90 days (2160 hours)</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NAME</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;@every 168h&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--ttl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2160</span><span style="color:#9ECBFF;">h0m0s</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æ¯æ—¥å¯¹anchnet-devops-dev/anchnet-devops-test/anchnet-devops-prod/anchnet-devops-common-test åç§°ç©ºé—´è¿›è¡Œå¤‡ä»½</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-dev</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;@every 24h&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-dev</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-test</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;@every 24h&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-test</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-prod</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;@every 24h&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-prod</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-common-test</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--schedule=</span><span style="color:#9ECBFF;">&quot;@every 24h&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">anchnet-devops-common-test</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å®šæ—¶ä»»åŠ¡</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">schedule</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#å‘¨æœŸæ€§ä»»åŠ¡</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-h</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6A737D;">#å®šæ—¶ä»»åŠ¡,æ¯å¤©16ç‚¹(UTCæ—¶åŒº)å¤‡ä»½ï¼Œä¿ç•™7å¤©(168h)</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-bakcup-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;0 16 * * *&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--ttl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">168</span><span style="color:#032F62;">h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a backup every 6 hours</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NAME</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;0 */6 * * *&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a backup every 6 hours with the @every notation</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NAME</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;@every 6h&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a daily backup of the web namespace</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NAME</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;@every 24h&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-namespaces</span><span style="color:#24292E;"> </span><span style="color:#032F62;">web</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># Create a weekly backup, each living for 90 days (2160 hours)</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NAME</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;@every 168h&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--ttl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2160</span><span style="color:#032F62;">h0m0s</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># æ¯æ—¥å¯¹anchnet-devops-dev/anchnet-devops-test/anchnet-devops-prod/anchnet-devops-common-test åç§°ç©ºé—´è¿›è¡Œå¤‡ä»½</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-dev</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;@every 24h&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-namespaces</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-dev</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-test</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;@every 24h&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-namespaces</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-test</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-prod</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;@every 24h&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-namespaces</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-prod</span><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-common-test</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--schedule=</span><span style="color:#032F62;">&quot;@every 24h&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-namespaces</span><span style="color:#24292E;"> </span><span style="color:#032F62;">anchnet-devops-common-test</span><span style="color:#24292E;"> </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹å®šæ—¶ä»»åŠ¡</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">schedule</span></span></code></pre></div><h2 id="_3-7-è¿ç§»" tabindex="-1">3.7 è¿ç§» <a class="header-anchor" href="#_3-7-è¿ç§»" aria-label="Permalink to &quot;3.7 è¿ç§»&quot;">â€‹</a></h2><ul><li>åˆ›å»ºveleroä½¿ç”¨çš„å‚¨å­˜</li><li>åœ¨k8s-Aé›†ç¾¤å®‰è£…veleroå¹¶å¤‡ä»½</li><li>åœ¨k8s-Bé›†ç¾¤å®‰è£…veleroå¹¶æ¢å¤,å³å®Œæˆk8sè¿ç§»</li></ul><h1 id="_4-veleroå…¶å®ƒæ¡ˆä¾‹" tabindex="-1">4. veleroå…¶å®ƒæ¡ˆä¾‹ <a class="header-anchor" href="#_4-veleroå…¶å®ƒæ¡ˆä¾‹" aria-label="Permalink to &quot;4. veleroå…¶å®ƒæ¡ˆä¾‹&quot;">â€‹</a></h1><h2 id="_4-1-åŒé›†ç¾¤" tabindex="-1">4.1 åŒé›†ç¾¤ <a class="header-anchor" href="#_4-1-åŒé›†ç¾¤" aria-label="Permalink to &quot;4.1 åŒé›†ç¾¤&quot;">â€‹</a></h2><p>åŒé›†ç¾¤ä¸‹ï¼Œæ‰‹åŠ¨ä»å®Œæ•´å¤‡ä»½ä¸­æ¢å¤å…¶ä¸­ä¸€ä¸ªnamespaceåˆ°æŒ‡å®šnamespace</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#ä»test namespaceåˆ° test10000 namespace</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">k8s-jf-test-all-restore</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--from-backup</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">k8s-jf-test-all</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--include-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">test</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespace-mappings</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">test:test10000</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹æ¢å¤çŠ¶æ€</span></span>
<span class="line"><span style="color:#B392F0;">velero</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restore</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">describe</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">k8s-jf-test-all-restore</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#ä»test namespaceåˆ° test10000 namespace</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;">  </span><span style="color:#032F62;">k8s-jf-test-all-restore</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--from-backup</span><span style="color:#24292E;">  </span><span style="color:#032F62;">k8s-jf-test-all</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--include-namespaces</span><span style="color:#24292E;"> </span><span style="color:#032F62;">test</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespace-mappings</span><span style="color:#24292E;">  </span><span style="color:#032F62;">test:test10000</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹æ¢å¤çŠ¶æ€</span></span>
<span class="line"><span style="color:#6F42C1;">velero</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restore</span><span style="color:#24292E;"> </span><span style="color:#032F62;">describe</span><span style="color:#24292E;"> </span><span style="color:#032F62;">k8s-jf-test-all-restore</span></span></code></pre></div><h2 id="_4-2-è·¨é›†ç¾¤" tabindex="-1">4.2 è·¨é›†ç¾¤ <a class="header-anchor" href="#_4-2-è·¨é›†ç¾¤" aria-label="Permalink to &quot;4.2 è·¨é›†ç¾¤&quot;">â€‹</a></h2><p>å¯¹äºveleroï¼Œè·¨é›†ç¾¤éœ€è¦ä¿æŒ2ä¸ªé›†ç¾¤ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªäº‘å‚å•†æŒä¹…å·æ–¹æ¡ˆ</p><p>ä¸¤è¾¹ç¯å¢ƒä¿æŒä¸€è‡´å³å¯ã€‚</p>`,98),e=[o];function t(c,r,E,y,i,F){return n(),a("div",null,e)}const u=s(p,[["render",t]]);export{d as __pageData,u as default};
