import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const F=JSON.parse('{"title":"1.Pod èµ„æºé™åˆ¶","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/èµ„æºå¯¹è±¡/2-pod-èµ„æºé™åˆ¶.md","filePath":"guide/container/k8s/èµ„æºå¯¹è±¡/2-pod-èµ„æºé™åˆ¶.md","lastUpdated":1729073852000}'),p={name:"guide/container/k8s/èµ„æºå¯¹è±¡/2-pod-èµ„æºé™åˆ¶.md"},o=l(`<p>æ–‡æ¡£ï¼Œ<a href="https://kubernetes.io/zh-cn/docs/concepts/configuration/manage-resources-containers/" target="_blank" rel="noreferrer">https://kubernetes.io/zh-cn/docs/concepts/configuration/manage-resources-containers/</a></p><h1 id="_1-pod-èµ„æºé™åˆ¶" tabindex="-1">1.Pod èµ„æºé™åˆ¶ <a class="header-anchor" href="#_1-pod-èµ„æºé™åˆ¶" aria-label="Permalink to &quot;1.Pod èµ„æºé™åˆ¶&quot;">â€‹</a></h1><h2 id="_1-1-ä»€ä¹ˆæ˜¯èµ„æºé™åˆ¶" tabindex="-1">1.1 ä»€ä¹ˆæ˜¯èµ„æºé™åˆ¶ <a class="header-anchor" href="#_1-1-ä»€ä¹ˆæ˜¯èµ„æºé™åˆ¶" aria-label="Permalink to &quot;1.1 ä»€ä¹ˆæ˜¯èµ„æºé™åˆ¶&quot;">â€‹</a></h2><p>åœ¨ Kubernetes é›†ç¾¤ä¸­ï¼Œä¸ºäº†ä½¿ç³»ç»Ÿèƒ½å¤Ÿç¨³å®šçš„è¿â¾ï¼Œé€šå¸¸ä¼šå¯¹ Pod çš„èµ„æºä½¿â½¤é‡è¿›â¾é™åˆ¶</p><p>åœ¨ Kubernetes é›†ç¾¤ä¸­ï¼Œå¦‚æœæœ‰â¼€ä¸ªç¨‹åºå‡ºç°å¼‚å¸¸ï¼Œå¹¶å â½¤â¼¤é‡çš„ç³»ç»Ÿèµ„æºã€‚å¦‚æœæœªå¯¹è¯¥ Pod è¿›â¾èµ„æºé™åˆ¶çš„è¯ï¼Œå¯èƒ½ä¼šå½±å“å…¶ä»–çš„ Pod æ­£å¸¸è¿â¾ï¼Œä»â½½é€ æˆä¸šåŠ¡çš„ä¸ç¨³å®šæ€§</p><h2 id="_1-2-å¦‚ä½•å®ç°èµ„æºé™åˆ¶" tabindex="-1">1.2 å¦‚ä½•å®ç°èµ„æºé™åˆ¶ <a class="header-anchor" href="#_1-2-å¦‚ä½•å®ç°èµ„æºé™åˆ¶" aria-label="Permalink to &quot;1.2 å¦‚ä½•å®ç°èµ„æºé™åˆ¶&quot;">â€‹</a></h2><p>Kubernetes é€šè¿‡ <code>Requests</code> å’Œ <code>Limits</code> å­—æ®µæ¥å®ç°å¯¹ Pod çš„èµ„æºè¿›â¾é™åˆ¶</p><ul><li>Requestsï¼šå¯åŠ¨ Pod æ—¶ç”³è¯·åˆ†é…çš„èµ„æºâ¼¤â¼©ï¼›<code>ï¼ˆPodåœ¨è°ƒåº¦çš„æ—¶å€™requestsâ½è¾ƒé‡è¦ï¼‰</code></li><li>Limitsï¼šé™åˆ¶ Pod è¿â¾æ—¶æœ€â¼¤å¯â½¤çš„èµ„æºâ¼¤â¼©ï¼›<code>ï¼ˆPodåœ¨è¿â¾æ—¶limitsâ½è¾ƒé‡è¦ï¼‰</code></li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">spec.containers[].resources.requests.cpu		//å®šä¹‰åˆ›å»ºå®¹å™¨æ—¶é¢„åˆ†é…çš„CPUèµ„æº</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">spec.containers[].resources.requests.memory		//å®šä¹‰åˆ›å»ºå®¹å™¨æ—¶é¢„åˆ†é…çš„å†…å­˜èµ„æº</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">spec.containers[].resources.limits.cpu			//å®šä¹‰ cpu çš„èµ„æºä¸Šé™</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">spec.containers[].resources.limits.memory		//å®šä¹‰å†…å­˜çš„èµ„æºä¸Šé™</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">spec.containers[].resources.requests.cpu		//å®šä¹‰åˆ›å»ºå®¹å™¨æ—¶é¢„åˆ†é…çš„CPUèµ„æº</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">spec.containers[].resources.requests.memory		//å®šä¹‰åˆ›å»ºå®¹å™¨æ—¶é¢„åˆ†é…çš„å†…å­˜èµ„æº</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">spec.containers[].resources.limits.cpu			//å®šä¹‰ cpu çš„èµ„æºä¸Šé™</span><span style="color:#24292E;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">spec.containers[].resources.limits.memory		//å®šä¹‰å†…å­˜çš„èµ„æºä¸Šé™</span></span></code></pre></div><h2 id="_1-3-èµ„æºé™åˆ¶çš„ç›®çš„ä¸æ„ä¹‰" tabindex="-1">1.3 èµ„æºé™åˆ¶çš„â½¬çš„ä¸æ„ä¹‰ <a class="header-anchor" href="#_1-3-èµ„æºé™åˆ¶çš„ç›®çš„ä¸æ„ä¹‰" aria-label="Permalink to &quot;1.3 èµ„æºé™åˆ¶çš„â½¬çš„ä¸æ„ä¹‰&quot;">â€‹</a></h2><p>CPUï¼š<code>ä¸ºé›†ç¾¤ä¸­è¿â¾çš„å®¹å™¨é…ç½®CPUè¯·æ±‚å’Œé™åˆ¶</code>ï¼Œå¯ä»¥æœ‰æ•ˆåˆ©â½¤é›†ç¾¤ä¸Šå¯â½¤çš„ CPU èµ„æº</p><ul><li>è®¾ç½® Pod CPU è¯·æ±‚ è®¾å®šåœ¨è¾ƒä½çš„æ•°å€¼ï¼Œå¯ä»¥ä½¿ Pod æ›´æœ‰æœºä¼šè¢«è°ƒåº¦</li><li>è®¾ç½® CPU é™åˆ¶â¼¤äº CPU è¯·æ±‚ï¼Œå¯ä»¥å®Œæˆå¦‚ä¸‹ä¸¤ä»¶äº‹ <ul><li>1ã€å½“ Pod ç¢°åˆ°â¼€äº›çªå‘è´Ÿè½½æ—¶ï¼Œå®ƒå¯ä»¥åˆç†åˆ©â½¤å¯â½¤çš„ CPU èµ„æº</li><li>2ã€å½“ Pod åœ¨çªå‘æµé‡æœŸé—´ å¯ä½¿â½¤çš„ CPU è¢«é™åˆ¶ä¸ºåˆç†çš„æ•°å€¼ï¼Œä»â½½å¯ä»¥é¿å…å½±å“å…¶ä»– Pod çš„æ­£å¸¸è¿â¾ï¼›</li></ul></li></ul><p>å†…å­˜ï¼š<code>ä¸ºé›†ç¾¤ä¸­è¿â¾çš„å®¹å™¨é…ç½®å†…å­˜è¯·æ±‚å’Œé™åˆ¶</code>ï¼Œå¯ä»¥æœ‰æ•ˆåˆ©â½¤é›†ç¾¤èŠ‚ç‚¹ä¸Šå¯â½¤çš„å†…å­˜èµ„æº</p><ul><li>é€šè¿‡å°† Pod çš„å†…å­˜è¯·æ±‚è®¾å®šåœ¨è¾ƒä½çš„æ•°å€¼ï¼Œå¯ä»¥ä½¿ Pod æ›´æœ‰æœºä¼šè¢«è°ƒåº¦</li><li>é€šè¿‡è®© <code>å†…å­˜é™åˆ¶â¼¤äºå†…å­˜è¯·æ±‚</code>ï¼Œå¯ä»¥å®Œæˆå¦‚ä¸‹ä¸¤ä»¶äº‹ï¼š <ul><li>å½“ Pod ç¢°åˆ°â¼€äº›çªå‘è´Ÿè½½æ—¶ï¼Œå¯ä»¥æ›´å¥½çš„åˆ©â½¤å…¶ä¸»æœºä¸Šçš„å¯â½¤å†…å­˜</li><li>å½“ Pod åœ¨çªå‘è´Ÿè½½æœŸé—´ <code>å¯ä½¿â½¤çš„å†…å­˜è¢«é™åˆ¶ä¸ºåˆç†çš„æ•°å€¼</code>ï¼Œä»â½½å¯ä»¥é¿å…å½±å“å…¶ä»– Pod çš„è¿â¾</li></ul></li></ul><h1 id="_2-èµ„æºé™åˆ¶å•ä½æ¢ç®—" tabindex="-1">2.èµ„æºé™åˆ¶å•ä½æ¢ç®— <a class="header-anchor" href="#_2-èµ„æºé™åˆ¶å•ä½æ¢ç®—" aria-label="Permalink to &quot;2.èµ„æºé™åˆ¶å•ä½æ¢ç®—&quot;">â€‹</a></h1><h2 id="_2-1-cpu-é™åˆ¶å•ä½" tabindex="-1">2.1 CPU é™åˆ¶å•ä½ <a class="header-anchor" href="#_2-1-cpu-é™åˆ¶å•ä½" aria-label="Permalink to &quot;2.1 CPU é™åˆ¶å•ä½&quot;">â€‹</a></h2><p>1 æ ¸ CPU ç­‰äº 1000 æ¯«æ ¸ï¼Œå½“å®šä¹‰å®¹å™¨ä¸º 0.5 æ—¶ï¼Œæ‰€èƒ½â½¤åˆ°çš„ CPU èµ„æºæ—¶ 1 æ ¸â¼¼ CPU çš„â¼€åŠï¼Œå¯¹äº CPU èµ„æºå•ä½ï¼Œè¡¨è¾¾å¼ <code>0.1</code> ç­‰ä»·äºè¡¨è¾¾å¼ <code>100m</code>ï¼Œå¯ä»¥çœ‹ä½œ <code>100 millicpu</code></p><blockquote><p>åœ¨ Kubernetes ç³»ç»Ÿä¸Šï¼Œ1 ä¸ªå•ä½çš„ CPU ç›¸å½“äºè™šæ‹Ÿæœºä¸Šçš„ 1 é¢—è™šæ‹Ÿ CPU(vCPUï¼‰æˆ–ç‰©ç†æœºä¸Šçš„ä¸€ä¸ªè¶…çº¿ç¨‹ï¼ˆHyperthreadï¼Œæˆ–ç§°ä¸ºä¸€ä¸ªé€»è¾‘ CPUï¼‰ï¼Œå®ƒæ”¯æŒåˆ†æ•°è®¡é‡æ–¹å¼ï¼Œä¸€ä¸ªæ ¸å¿ƒï¼ˆ1coreï¼‰ç›¸å½“äº 1000 ä¸ªå¾®æ ¸å¿ƒï¼ˆmillicoresï¼‰ï¼Œå› æ­¤ 500m ç›¸å½“äºæ˜¯ 0.5 ä¸ªæ ¸å¿ƒï¼Œå³äºŒåˆ†ä¹‹ä¸€ä¸ªæ ¸å¿ƒ</p></blockquote><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">æ ¸â¼¼</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">millicpu</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ï¼ˆ1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Core</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1000</span><span style="color:#9ECBFF;">mï¼‰</span></span>
<span class="line"><span style="color:#B392F0;">0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">æ ¸</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">millicpu</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ï¼ˆ0.5</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Core</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">mï¼‰</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">æ ¸â¼¼</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1000</span><span style="color:#24292E;"> </span><span style="color:#032F62;">millicpu</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ï¼ˆ1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Core</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1000</span><span style="color:#032F62;">mï¼‰</span></span>
<span class="line"><span style="color:#6F42C1;">0.5</span><span style="color:#24292E;"> </span><span style="color:#032F62;">æ ¸</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">500</span><span style="color:#24292E;"> </span><span style="color:#032F62;">millicpu</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ï¼ˆ0.5</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Core</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">mï¼‰</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>m æ¯«æ ¸ï¼Œcpu å•ä½ï¼›Kubernetes é›†ç¾¤ä¸­çš„æ¯ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥é€šè¿‡æ“ä½œç³»ç»Ÿçš„å‘½ä»¤æ¥ç¡®è®¤æœ¬èŠ‚ç‚¹çš„ CPU å†…æ ¸æ•°é‡ï¼Œç„¶åå°†è¿™ä¸ªæ•°é‡ä¹˜ä»¥ 1000ï¼Œå¾—åˆ°çš„å°±æ˜¯èŠ‚ç‚¹æ€» CPU æ€»æ¯«æ•°ã€‚æ¯”å¦‚ä¸€ä¸ªèŠ‚ç‚¹æœ‰å››æ ¸ï¼Œé‚£ä¹ˆè¯¥èŠ‚ç‚¹çš„ CPU æ€»æ¯«é‡ä¸º 4000mï¼Œå¦‚æœä½ è¦ä½¿ç”¨ 0.5 coreï¼Œåˆ™ä½ è¦æ±‚çš„æ˜¯ 4000*0.5 = 2000m :::</p><p>ä¸¾ä¾‹ï¼šå½“æˆ‘ä»¬æœ‰ 1 ä¸ªç‰©ç† CPUï¼Œ16 æ ¸â¼¼ï¼Œå¦‚æœæŸä¸ª Pod æœ€å¤šä½¿â½¤â¼€åŠçš„æ ¸â¼¼æ•°ï¼Œåˆ™è¡¨è¾¾å¼å¯ä»¥å†™â¼Šå¦‚ä¸‹ä¸¤ç§ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">limits.cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">limits.cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">8000m è®¡ç®—å…¬å¼ï¼š(16000*0.5=8000m)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">limits.cpu</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">limits.cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">8000m è®¡ç®—å…¬å¼ï¼š(16000*0.5=8000m)</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>Kubernetes ä¸å…è®¸è®¾ç½®ç²¾åº¦â¼©äº 1m çš„ CPU èµ„æºã€‚å› æ­¤å½“ CPU å•ä½â¼©äº 1 æ—¶ï¼Œåªèƒ½ä½¿â½¤æ¯«æ ¸æ¥è¡¨ç¤ºã€‚ä¾‹å¦‚ï¼šæœŸæœ›ä½¿â½¤ 1 ä¸ª CPU çš„ 0.5%ï¼Œåº”è¯¥å†™ 5m â½½ä¸æ˜¯ 0.005</p></div></div><h2 id="_2-2-å†…å­˜åˆ†é…å•ä½" tabindex="-1">2.2 å†…å­˜åˆ†é…å•ä½ <a class="header-anchor" href="#_2-2-å†…å­˜åˆ†é…å•ä½" aria-label="Permalink to &quot;2.2 å†…å­˜åˆ†é…å•ä½&quot;">â€‹</a></h2><p>å†…å­˜çš„åŸºæœ¬å•ä½æ˜¯å­—èŠ‚æ•°(Bytes)ï¼Œä¹Ÿå¯ä»¥åŠ ä¸Šå›½é™…å•ä½ï¼Œâ¼—è¿›åˆ¶çš„ Eã€Pã€Tã€Gã€Mï¼ŒKã€mï¼Œæˆ–â¼†è¿›åˆ¶çš„ Eiã€Piã€Tiã€Giã€Miã€Kiï¼Œ<code>å†…å­˜çš„è®¡é‡æ–¹å¼ä¸æ—¥å¸¸ä½¿ç”¨æ–¹å¼ç›¸åŒ</code></p><blockquote><p>MiB â‰  MBï¼ŒMB æ˜¯åè¿›åˆ¶å•ä½ï¼ŒMiB æ˜¯äºŒè¿›åˆ¶ï¼Œå¹³æ—¶æˆ‘ä»¬ä»¥ä¸º MB ç­‰äº 1024KBï¼Œå…¶å® 1MB=1000KBï¼Œ1MiB æ‰ç­‰äº 1024KiBã€‚ä¸­é—´å¸¦å­—æ¯ i çš„æ˜¯å›½é™…ç”µå·¥åä¼šï¼ˆIECï¼‰å®šçš„ï¼Œèµ° 1024 ä¹˜ç§¯ï¼›KBã€MBã€GB æ˜¯å›½é™…å•ä½åˆ¶ï¼Œèµ° 1000 ä¹˜ç§¯</p></blockquote><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">1MB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">KB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1000000</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Bytes</span></span>
<span class="line"><span style="color:#B392F0;">1Mi</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1024</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">KB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1048576</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bytes</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">1MB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1000</span><span style="color:#24292E;"> </span><span style="color:#032F62;">KB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1000000</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Bytes</span></span>
<span class="line"><span style="color:#6F42C1;">1Mi</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1024</span><span style="color:#24292E;"> </span><span style="color:#032F62;">KB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1048576</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bytes</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>å¦‚æœä½ ä¸ºæŸä¸ªèµ„æºæŒ‡å®šäº†é™åˆ¶ï¼Œä½†ä¸æŒ‡å®šè¯·æ±‚ï¼Œ å¹¶ä¸”æ²¡æœ‰åº”ç”¨å‡†å…¥æ—¶æœºåˆ¶ä¸ºè¯¥èµ„æºè®¾ç½®é»˜è®¤è¯·æ±‚ï¼Œ ç„¶å Kubernetes å¤åˆ¶ä½ æ‰€æŒ‡å®šçš„é™åˆ¶å€¼ï¼Œå°†å…¶ç”¨ä½œèµ„æºçš„è¯·æ±‚å€¼</p><p>å†…å­˜çš„è®¡é‡æ–¹å¼ä¸æ—¥å¸¸ä½¿ç”¨æ–¹å¼ç›¸åŒ</p></div><h2 id="_2-3-è®¡ç®—" tabindex="-1">2.3 è®¡ç®— <a class="header-anchor" href="#_2-3-è®¡ç®—" aria-label="Permalink to &quot;2.3 è®¡ç®—&quot;">â€‹</a></h2><h3 id="cpu" tabindex="-1">cpu <a class="header-anchor" href="#cpu" aria-label="Permalink to &quot;cpu&quot;">â€‹</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">##æŸ¥çœ‹CPUçš„é™åˆ¶##</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-node1 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# docker exec -it 6933185dbe4b /bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">root@pod-limits:/#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/cpu/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">root@pod-limits:/sys/fs/cgroup/cpu#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.cfs_period_us</span></span>
<span class="line"><span style="color:#B392F0;">100000</span></span>
<span class="line"><span style="color:#B392F0;">root@pod-limits:/sys/fs/cgroup/cpu#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu.cfs_quota_us</span></span>
<span class="line"><span style="color:#B392F0;">200000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#åå‘è®¡ç®—å‡º--cpuså‚æ•°</span></span>
<span class="line"><span style="color:#6A737D;">#cpu.cfs_quota_us / cpu.cfs_period_us = cpuçš„é™åˆ¶</span></span>
<span class="line"><span style="color:#B392F0;">root@pod-limits:/sys/fs/cgroup/cpu#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">expr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`</span><span style="color:#B392F0;">cat</span><span style="color:#9ECBFF;"> cpu.cfs_quota_us\`</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">\`</span><span style="color:#B392F0;">cat</span><span style="color:#9ECBFF;"> cpu.cfs_period_us\`</span></span>
<span class="line"><span style="color:#B392F0;">2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">##æŸ¥çœ‹CPUçš„é™åˆ¶##</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-node1 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# docker exec -it 6933185dbe4b /bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">root@pod-limits:/#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/cpu/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">root@pod-limits:/sys/fs/cgroup/cpu#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.cfs_period_us</span></span>
<span class="line"><span style="color:#6F42C1;">100000</span></span>
<span class="line"><span style="color:#6F42C1;">root@pod-limits:/sys/fs/cgroup/cpu#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu.cfs_quota_us</span></span>
<span class="line"><span style="color:#6F42C1;">200000</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#åå‘è®¡ç®—å‡º--cpuså‚æ•°</span></span>
<span class="line"><span style="color:#6A737D;">#cpu.cfs_quota_us / cpu.cfs_period_us = cpuçš„é™åˆ¶</span></span>
<span class="line"><span style="color:#6F42C1;">root@pod-limits:/sys/fs/cgroup/cpu#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">expr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`</span><span style="color:#6F42C1;">cat</span><span style="color:#032F62;"> cpu.cfs_quota_us\`</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">\`</span><span style="color:#6F42C1;">cat</span><span style="color:#032F62;"> cpu.cfs_period_us\`</span></span>
<span class="line"><span style="color:#6F42C1;">2</span></span></code></pre></div><blockquote><p>cpu.cfs_period_us å’Œ cpu.cfs_quota_us æ¥é™åˆ¶è¯¥ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹åœ¨å•ä½æ—¶é—´é‡Œå¯ä»¥ä½¿ç”¨çš„ cpu æ—¶é—´ã€‚ cpu.cfs_period_usï¼šæ—¶é—´å‘¨æœŸï¼ˆå¾®ç§’ï¼‰ï¼› cpu.cfs_quota_usï¼šæŒ‡çš„æ˜¯åœ¨ cpu.cfs_period_us å‘¨æœŸå†…å¯ä½¿ç”¨çš„ cpu çš„æ—¶é—´ï¼ˆå¾®ç§’ï¼‰ï¼›å¤šæ ¸åœºæ™¯ä¸‹ï¼Œå¦‚é…ç½® cpu.cfs_period_us=10000ï¼Œè€Œ cfs_quota_us=20000ï¼Œè¡¨ç¤ºè¯¥ cgroup å¯ä»¥å®Œå…¨ä½¿ç”¨ 2 ä¸ª cpuã€‚æ‰€ä»¥ cpu çš„è®¡ç®—æ–¹æ³•ä¸ºï¼šcfs_quota_us / cpu.cfs_period_us</p></blockquote><h3 id="mem" tabindex="-1">mem <a class="header-anchor" href="#mem" aria-label="Permalink to &quot;mem&quot;">â€‹</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">##æŸ¥çœ‹å†…å­˜çš„é™åˆ¶##</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@k8s-node1 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# docker exec -it 6933185dbe4b /bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">root@pod-limits:~#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/sys/fs/cgroup/memory/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">root@pod-limits:/sys/fs/cgroup/memory#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">memory.limit_in_bytes</span></span>
<span class="line"><span style="color:#B392F0;">2147483648</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ï¼ˆByteå­—èŠ‚ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">å†…å­˜çš„è®¡ç®—æ–¹æ³•ä¸ºï¼š2147483648Ã·1024Ã·1024Ã·1024</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">ï¼ˆGï¼‰</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">##æŸ¥çœ‹å†…å­˜çš„é™åˆ¶##</span></span>
<span class="line"><span style="color:#24292E;">[root@k8s-node1 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# docker exec -it 6933185dbe4b /bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">root@pod-limits:~#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/sys/fs/cgroup/memory/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">root@pod-limits:/sys/fs/cgroup/memory#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cat</span><span style="color:#24292E;"> </span><span style="color:#032F62;">memory.limit_in_bytes</span></span>
<span class="line"><span style="color:#6F42C1;">2147483648</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ï¼ˆByteå­—èŠ‚ï¼‰</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">å†…å­˜çš„è®¡ç®—æ–¹æ³•ä¸ºï¼š2147483648Ã·1024Ã·1024Ã·1024</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">ï¼ˆGï¼‰</span></span></code></pre></div><h1 id="_3-å®è·µ" tabindex="-1">3.å®è·µ <a class="header-anchor" href="#_3-å®è·µ" aria-label="Permalink to &quot;3.å®è·µ&quot;">â€‹</a></h1><p>å®‰è£… metrics-server</p><p>å®˜æ–¹æ–‡æ¡£ï¼Œ<a href="https://github.com/kubernetes-sigs/metrics-server" target="_blank" rel="noreferrer">https://github.com/kubernetes-sigs/metrics-server</a></p><h3 id="requests" tabindex="-1">requests <a class="header-anchor" href="#requests" aria-label="Permalink to &quot;requests&quot;">â€‹</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">explain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pod.spec.containers.resources</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">explain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pod.spec.containers.resources</span></span></code></pre></div><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master yaml</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat requests-pod.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">requests-pod</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">args</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;/bin/sh&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;sleep 60000&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:			</span><span style="color:#6A737D;">#èµ„æºç”³è¯·</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">500m</span><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·500æ¯«æ ¸(ä¸€ä¸ªCPUæ ¸å¿ƒæ—¶é—´çš„1/2)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">500Mi</span><span style="color:#E1E4E8;">	</span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·500Må†…å­˜</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master yaml</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat requests-pod.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">requests-pod</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">args</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&quot;/bin/sh&quot;</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&quot;sleep 60000&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:			</span><span style="color:#6A737D;">#èµ„æºç”³è¯·</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">500m</span><span style="color:#24292E;">		</span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·500æ¯«æ ¸(ä¸€ä¸ªCPUæ ¸å¿ƒæ—¶é—´çš„1/2)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">500Mi</span><span style="color:#24292E;">	</span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·500Må†…å­˜</span></span></code></pre></div><ul><li>è¶…å‡ºå†…å­˜</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# cat requests-pod.yaml</span></span>
<span class="line"><span style="color:#B392F0;">apiVersion:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#B392F0;">kind:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#B392F0;">metadata:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">name:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">requests-pod</span></span>
<span class="line"><span style="color:#B392F0;">spec:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">containers:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">name:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">args:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;/bin/sh&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;sleep 60000&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">resources:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">requests:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">cpu:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">memory:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2048</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">nodeName:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kube-node01</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master yaml]# cat requests-pod.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">apiVersion:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#6F42C1;">kind:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#6F42C1;">metadata:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">name:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">requests-pod</span></span>
<span class="line"><span style="color:#6F42C1;">spec:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">containers:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">-</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">name:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">args:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">-</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;/bin/sh&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">-</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;-c&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">-</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;sleep 60000&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">resources:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">requests:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">cpu:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">m</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">memory:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2048</span><span style="color:#032F62;">Mi</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">nodeName:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kube-node01</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl get pod</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                              </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">requests-pod</span><span style="color:#E1E4E8;">                      </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">OutOfmemory</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">               </span><span style="color:#79B8FF;">4</span><span style="color:#9ECBFF;">s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl get pod</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                              </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">        </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">        </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">requests-pod</span><span style="color:#24292E;">                      </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">OutOfmemory</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">               </span><span style="color:#005CC5;">4</span><span style="color:#032F62;">s</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe pod requests-pod</span></span>
<span class="line"><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#B392F0;">Status:</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">Failed</span></span>
<span class="line"><span style="color:#B392F0;">Reason:</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">OutOfmemory</span></span>
<span class="line"><span style="color:#B392F0;">Message:</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">Pod</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Node</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">didn&#39;t have enough resource: memory, requested: 2147483648, used: 0, capacity: 1934282752</span></span>
<span class="line"><span style="color:#9ECBFF;">...</span></span>
<span class="line"><span style="color:#9ECBFF;">Events:</span></span>
<span class="line"><span style="color:#9ECBFF;">  Type     Reason       Age   From     Message</span></span>
<span class="line"><span style="color:#9ECBFF;">  ----     ------       ----  ----     -------</span></span>
<span class="line"><span style="color:#9ECBFF;">  Warning  OutOfmemory  10s   kubelet  Node didn&#39;t</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">have</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enough</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">resource:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">memory,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">requested:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2147483648</span><span style="color:#9ECBFF;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">used:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">capacity:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1934282752</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe pod requests-pod</span></span>
<span class="line"><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#6F42C1;">Status:</span><span style="color:#24292E;">       </span><span style="color:#032F62;">Failed</span></span>
<span class="line"><span style="color:#6F42C1;">Reason:</span><span style="color:#24292E;">       </span><span style="color:#032F62;">OutOfmemory</span></span>
<span class="line"><span style="color:#6F42C1;">Message:</span><span style="color:#24292E;">      </span><span style="color:#032F62;">Pod</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Node</span><span style="color:#24292E;"> </span><span style="color:#032F62;">didn&#39;t have enough resource: memory, requested: 2147483648, used: 0, capacity: 1934282752</span></span>
<span class="line"><span style="color:#032F62;">...</span></span>
<span class="line"><span style="color:#032F62;">Events:</span></span>
<span class="line"><span style="color:#032F62;">  Type     Reason       Age   From     Message</span></span>
<span class="line"><span style="color:#032F62;">  ----     ------       ----  ----     -------</span></span>
<span class="line"><span style="color:#032F62;">  Warning  OutOfmemory  10s   kubelet  Node didn&#39;t</span><span style="color:#24292E;"> </span><span style="color:#032F62;">have</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enough</span><span style="color:#24292E;"> </span><span style="color:#032F62;">resource:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">memory,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">requested:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2147483648</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">used:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">capacity:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1934282752</span></span></code></pre></div><h3 id="limits" tabindex="-1">limits <a class="header-anchor" href="#limits" aria-label="Permalink to &quot;limits&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master yaml</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat limit-pod.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">limited-pod</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;sleep&quot;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&quot;600000&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:         </span><span style="color:#6A737D;">#èµ„æºç”³è¯·</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">200m</span><span style="color:#E1E4E8;">       </span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·200æ¯«æ ¸(ä¸€ä¸ªCPUæ ¸å¿ƒæ—¶é—´çš„1/5)</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">80Mi</span><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·80Må†…å­˜</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:           </span><span style="color:#6A737D;">#èµ„æºé™åˆ¶</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">          </span><span style="color:#6A737D;">#å®¹å™¨æœ€å¤§å…è®¸ä½¿ç”¨2æ ¸CPU</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span><span style="color:#E1E4E8;">     </span><span style="color:#6A737D;">#å®¹å™¨æœ€å¤§å…è®¸ä½¿ç”¨2GBå†…å­˜</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">nodeName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">kube-node01</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master yaml</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat limit-pod.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">limited-pod</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;sleep&quot;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&quot;600000&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:         </span><span style="color:#6A737D;">#èµ„æºç”³è¯·</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">200m</span><span style="color:#24292E;">       </span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·200æ¯«æ ¸(ä¸€ä¸ªCPUæ ¸å¿ƒæ—¶é—´çš„1/5)</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">80Mi</span><span style="color:#24292E;">    </span><span style="color:#6A737D;">#å®¹å™¨ç”³è¯·80Må†…å­˜</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:           </span><span style="color:#6A737D;">#èµ„æºé™åˆ¶</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">          </span><span style="color:#6A737D;">#å®¹å™¨æœ€å¤§å…è®¸ä½¿ç”¨2æ ¸CPU</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span><span style="color:#24292E;">     </span><span style="color:#6A737D;">#å®¹å™¨æœ€å¤§å…è®¸ä½¿ç”¨2GBå†…å­˜</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">nodeName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">kube-node01</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">describe</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nodes</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kube-node01</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">describe</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nodes</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kube-node01</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202404261415196.png" alt="image-20240426141514746"></p><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>èŠ‚ç‚¹ä¸Šæ‰€æœ‰ pod çš„èµ„æº limits ä¹‹å’Œå¯ä»¥è¶…è¿‡èŠ‚ç‚¹èµ„æºæ€»é‡çš„ 100%</p><p>requests ä¸åŒçš„æ˜¯ï¼Œlimits å¹¶ä¸ä¼šå½±å“ pod çš„è°ƒåº¦ç»“æœ</p><p>å¦‚æœåªè®¾ç½®äº† limitï¼Œåˆ™ request é»˜è®¤ä¼šæ ¹æ® limit è‡ªåŠ¨è®¾å®š</p></div><h3 id="è¿è¡Œè¶…è¿‡å®¹å™¨å†…å­˜é™åˆ¶çš„åº”ç”¨" tabindex="-1">è¿â¾è¶…è¿‡å®¹å™¨å†…å­˜é™åˆ¶çš„åº”â½¤ <a class="header-anchor" href="#è¿è¡Œè¶…è¿‡å®¹å™¨å†…å­˜é™åˆ¶çš„åº”ç”¨" aria-label="Permalink to &quot;è¿â¾è¶…è¿‡å®¹å™¨å†…å­˜é™åˆ¶çš„åº”â½¤&quot;">â€‹</a></h3><p>å½“èŠ‚ç‚¹æ‹¥æœ‰è¶³å¤Ÿçš„å¯ç”¨å†…å­˜æ—¶ï¼Œå®¹å™¨å¯ä»¥ä½¿ç”¨å…¶è¯·æ±‚çš„å†…å­˜ã€‚ä½†æ˜¯ï¼Œ<code>å®¹å™¨ä¸å…è®¸ä½¿ç”¨è¶…è¿‡å…¶é™åˆ¶çš„å†…å­˜</code>ã€‚å¦‚æœå®¹å™¨åˆ†é…çš„å†…å­˜è¶…è¿‡å…¶é™åˆ¶ï¼Œè¯¥å®¹å™¨ä¼šæˆä¸ºè¢«ç»ˆæ­¢çš„å€™é€‰å®¹å™¨ã€‚å¦‚æœå®¹å™¨ç»§ç»­æ¶ˆè€—è¶…å‡ºå…¶é™åˆ¶çš„å†…å­˜ï¼Œåˆ™ç»ˆæ­¢å®¹å™¨ã€‚å¦‚æœç»ˆæ­¢çš„å®¹å™¨å¯ä»¥è¢«é‡å¯ï¼Œåˆ™ kubelet ä¼šé‡æ–°å¯åŠ¨å®ƒã€‚</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master yaml</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat memory-request-limit-2.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">memory-request-limit-2</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">memory-request</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">polinux/stress</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;stress&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;--vm&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;1&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;--vm-bytes&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;250M&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;--vm-hang&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;1&quot;</span><span style="color:#E1E4E8;">] </span><span style="color:#6A737D;">## å®¹å™¨ä¼šå°è¯•åˆ†é… 250 MiB å†…</span></span>
<span class="line"><span style="color:#9ECBFF;">å­˜ï¼Œè¿™è¿œâ¾¼äº 100 MiB çš„é™åˆ¶,æ¨¡æ‹Ÿ1ä¸ªè¿›ç¨‹äº§â½£250Må†…å­˜</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;100Mi&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;200Mi&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master yaml</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat memory-request-limit-2.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">memory-request-limit-2</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">memory-request</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">polinux/stress</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;stress&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;--vm&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;1&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;--vm-bytes&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;250M&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;--vm-hang&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;1&quot;</span><span style="color:#24292E;">] </span><span style="color:#6A737D;">## å®¹å™¨ä¼šå°è¯•åˆ†é… 250 MiB å†…</span></span>
<span class="line"><span style="color:#032F62;">å­˜ï¼Œè¿™è¿œâ¾¼äº 100 MiB çš„é™åˆ¶,æ¨¡æ‹Ÿ1ä¸ªè¿›ç¨‹äº§â½£250Må†…å­˜</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;100Mi&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;200Mi&quot;</span></span></code></pre></div><h1 id="_4-èµ„æºé…ç½®èŒƒå›´ç®¡ç†-limitrange" tabindex="-1">4.èµ„æºé…ç½®èŒƒå›´ç®¡ç† LimitRange <a class="header-anchor" href="#_4-èµ„æºé…ç½®èŒƒå›´ç®¡ç†-limitrange" aria-label="Permalink to &quot;4.èµ„æºé…ç½®èŒƒå›´ç®¡ç† LimitRange&quot;">â€‹</a></h1><h2 id="_4-1-æ¦‚å¿µ" tabindex="-1">4.1 æ¦‚å¿µ <a class="header-anchor" href="#_4-1-æ¦‚å¿µ" aria-label="Permalink to &quot;4.1 æ¦‚å¿µ&quot;">â€‹</a></h2><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒKubernetes ä¸­æ‰€æœ‰å®¹å™¨éƒ½æ²¡æœ‰ä»»ä½• CPU å’Œå†…å­˜é™åˆ¶ã€‚LimitRange ç”¨æ¥ç»™ Namespace å¢åŠ ä¸€ä¸ªèµ„æºé™åˆ¶ï¼ŒåŒ…æ‹¬æœ€å°ã€æœ€å¤§å’Œé»˜è®¤èµ„æºã€‚</p><h2 id="_4-2-ä¸ºä»€ä¹ˆéœ€è¦-limitrange" tabindex="-1">4.2 ä¸ºä»€ä¹ˆéœ€è¦ LimitRange <a class="header-anchor" href="#_4-2-ä¸ºä»€ä¹ˆéœ€è¦-limitrange" aria-label="Permalink to &quot;4.2 ä¸ºä»€ä¹ˆéœ€è¦ LimitRange&quot;">â€‹</a></h2><p>ä¸ºå•ä¸ªå®¹å™¨è®¾ç½®èµ„æº requests å’Œ limits å¾ˆæœ‰å¿…è¦æ€§ï¼š</p><p>1.æå‡ QoS ç­‰çº§ï¼Œé˜²æ­¢åœ¨ OOM æ—¶è¢«é¦–å…ˆ killï¼›</p><p>2.é»˜è®¤æƒ…å†µä¸‹ Pod ä¼šä»¥æ— é™åˆ¶çš„ CPU å’Œå†…å­˜è¿è¡Œï¼Œå¾ˆæœ‰å¯èƒ½å› æ•…åæ‰æ‰€åœ¨å·¥ä½œèŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰å¯ç”¨è®¡ç®—èµ„æºã€‚</p><p>é€šè¿‡é…ç½® Pod çš„è®¡ç®—èµ„æº Requests å’Œ Limitsï¼Œæˆ‘ä»¬å¯ä»¥é™åˆ¶ Pod çš„èµ„æºä½¿ç”¨ï¼Œä½†å¯¹äº Kubemetes é›†ç¾¤ç®¡ç†å‘˜è€Œè¨€ï¼Œé…ç½®æ¯ä¸€ä¸ª Pod çš„ Requests å’Œ Limits æ˜¯çƒ¦çä¸”é™åˆ¶æ€§è¿‡å¼ºçš„ã€‚æ›´å¤šæ—¶ï¼Œæˆ‘ä»¬éœ€è¦çš„æ˜¯å¯¹é›†ç¾¤å†… Requests å’Œ Limits çš„é…ç½®åšä¸€ä¸ªå…¨å±€çš„ç»Ÿä¸€çš„é™åˆ¶ã€‚</p><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>LimitRange èµ„æºæ”¯æŒé™åˆ¶ Containerã€Pod å’Œ PersistentVolumeClaim ä¸‰ç§èµ„æºå¯¹è±¡çš„ç³»ç»Ÿèµ„æºç”¨é‡</p></div><h3 id="åˆ›å»º" tabindex="-1">åˆ›å»º <a class="header-anchor" href="#åˆ›å»º" aria-label="Permalink to &quot;åˆ›å»º&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># more limits.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">LimitRange</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">limitrange</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æŒ‡å®šæ•´ä¸ªpodçš„èµ„æºlimits</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">min</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Requestså€¼çš„æ€»å’Œçš„ä¸‹é™</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">50m</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">5Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">max</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Limitså€¼çš„æ€»å’Œçš„ä¸Šé™</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Container</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æŒ‡å®šå®¹å™¨çš„èµ„æºé™åˆ¶</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">defaultRequest</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#å®¹å™¨Requestsé»˜è®¤å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">100m</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">10Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">default</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#å®¹å™¨Limitsé»˜è®¤å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">200m</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">100Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">min</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Requestså€¼çš„ä¸‹é™</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">50m</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">5Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">max</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Limitså€¼çš„ä¸Šé™</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">maxLimitRequestRatio</span><span style="color:#E1E4E8;">: </span><span style="color:#6A737D;">#æ¯ç§èµ„æºRequestsä¸Limitsçš„æœ€å¤§æ¯”å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">4</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#æŒ‡å®šè¯·æ±‚PVCå­˜å‚¨å®¹é‡çš„æœ€å°å€¼å’Œæœ€å¤§å€¼</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">min</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">max</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">10Gi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># more limits.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">LimitRange</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">limitrange</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æŒ‡å®šæ•´ä¸ªpodçš„èµ„æºlimits</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">min</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Requestså€¼çš„æ€»å’Œçš„ä¸‹é™</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">50m</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">5Mi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">max</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Limitså€¼çš„æ€»å’Œçš„ä¸Šé™</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Container</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æŒ‡å®šå®¹å™¨çš„èµ„æºé™åˆ¶</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">defaultRequest</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#å®¹å™¨Requestsé»˜è®¤å€¼</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">100m</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">10Mi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">default</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#å®¹å™¨Limitsé»˜è®¤å€¼</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">200m</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">100Mi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">min</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Requestså€¼çš„ä¸‹é™</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">50m</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">5Mi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">max</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#podä¸­æ‰€æœ‰å®¹å™¨çš„Limitså€¼çš„ä¸Šé™</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">maxLimitRequestRatio</span><span style="color:#24292E;">: </span><span style="color:#6A737D;">#æ¯ç§èµ„æºRequestsä¸Limitsçš„æœ€å¤§æ¯”å€¼</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">4</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#æŒ‡å®šè¯·æ±‚PVCå­˜å‚¨å®¹é‡çš„æœ€å°å€¼å’Œæœ€å¤§å€¼</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">min</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">max</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">10Gi</span></span></code></pre></div><h3 id="æŸ¥çœ‹" tabindex="-1">æŸ¥çœ‹ <a class="header-anchor" href="#æŸ¥çœ‹" aria-label="Permalink to &quot;æŸ¥çœ‹&quot;">â€‹</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#kubectl describe limitranges limitrange</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">limitrange</span></span>
<span class="line"><span style="color:#B392F0;">Namespace:</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#B392F0;">Type</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">Resource</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Min</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Max</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Default</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Request</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Default</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Limit</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Max</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Limit/Request</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Ratio</span></span>
<span class="line"><span style="color:#B392F0;">----</span><span style="color:#E1E4E8;">                   </span><span style="color:#79B8FF;">--------</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">---</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">---</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">---------------</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">-------------</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">-----------------------</span></span>
<span class="line"><span style="color:#B392F0;">Pod</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">cpu</span><span style="color:#E1E4E8;">       </span><span style="color:#79B8FF;">50</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">-</span></span>
<span class="line"><span style="color:#B392F0;">Pod</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">memory</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">-</span></span>
<span class="line"><span style="color:#B392F0;">Container</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">memory</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">             </span><span style="color:#79B8FF;">100</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#B392F0;">Container</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">cpu</span><span style="color:#E1E4E8;">       </span><span style="color:#79B8FF;">50</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">100</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">             </span><span style="color:#79B8FF;">200</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">           </span><span style="color:#79B8FF;">4</span></span>
<span class="line"><span style="color:#B392F0;">PersistentVolumeClaim</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">storage</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">10</span><span style="color:#9ECBFF;">Gi</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">-</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#kubectl describe limitranges limitrange</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">limitrange</span></span>
<span class="line"><span style="color:#6F42C1;">Namespace:</span><span style="color:#24292E;">             </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#6F42C1;">Type</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">Resource</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Min</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Max</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Default</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Request</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Default</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Limit</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Max</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Limit/Request</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Ratio</span></span>
<span class="line"><span style="color:#6F42C1;">----</span><span style="color:#24292E;">                   </span><span style="color:#005CC5;">--------</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">---</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">---</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">---------------</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">-------------</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">-----------------------</span></span>
<span class="line"><span style="color:#6F42C1;">Pod</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">cpu</span><span style="color:#24292E;">       </span><span style="color:#005CC5;">50</span><span style="color:#032F62;">m</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">-</span><span style="color:#24292E;">                </span><span style="color:#032F62;">-</span><span style="color:#24292E;">              </span><span style="color:#032F62;">-</span></span>
<span class="line"><span style="color:#6F42C1;">Pod</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">memory</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">   </span><span style="color:#032F62;">-</span><span style="color:#24292E;">                </span><span style="color:#032F62;">-</span><span style="color:#24292E;">              </span><span style="color:#032F62;">-</span></span>
<span class="line"><span style="color:#6F42C1;">Container</span><span style="color:#24292E;">              </span><span style="color:#032F62;">memory</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">             </span><span style="color:#005CC5;">100</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#6F42C1;">Container</span><span style="color:#24292E;">              </span><span style="color:#032F62;">cpu</span><span style="color:#24292E;">       </span><span style="color:#005CC5;">50</span><span style="color:#032F62;">m</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">100</span><span style="color:#032F62;">m</span><span style="color:#24292E;">             </span><span style="color:#005CC5;">200</span><span style="color:#032F62;">m</span><span style="color:#24292E;">           </span><span style="color:#005CC5;">4</span></span>
<span class="line"><span style="color:#6F42C1;">PersistentVolumeClaim</span><span style="color:#24292E;">  </span><span style="color:#032F62;">storage</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">10</span><span style="color:#032F62;">Gi</span><span style="color:#24292E;">  </span><span style="color:#032F62;">-</span><span style="color:#24292E;">                </span><span style="color:#032F62;">-</span><span style="color:#24292E;">              </span><span style="color:#032F62;">-</span></span></code></pre></div><p>LimitRange ä¸­å„é¡¹é…ç½®çš„æ„ä¹‰å’Œç‰¹ç‚¹å¦‚ä¸‹ï¼š</p><ol><li>ä¸è®ºæ˜¯ CPU è¿˜æ˜¯å†…å­˜ï¼Œåœ¨ LimitRange ä¸­ï¼ŒPod å’Œ Container éƒ½å¯ä»¥è®¾ç½® Minã€Max å’Œ Max Limit / Requests Ratio å‚æ•°ã€‚Container è¿˜å¯ä»¥è®¾ç½® Default Request å’Œ Default Limit å‚æ•°ï¼Œè€Œ Pod ä¸èƒ½è®¾ç½® Default Request å’ŒDefault Limit å‚æ•°ã€‚</li><li>å¯¹ Pod å’Œ Container çš„å‚æ•°è§£é‡Šå¦‚ä¸‹ã€‚ <ul><li>Containerï¼š <ul><li>Container çš„ Minï¼ˆä¸Šé¢çš„ 100m å’Œ 3Miï¼‰æ˜¯ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Requests å€¼ä¸‹é™ï¼›</li><li>Container çš„ Maxï¼ˆä¸Šé¢çš„ 2 å’Œ 1Giï¼‰æ˜¯ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Limits å€¼ä¸Šé™ï¼›</li><li>Container çš„ Default Requestï¼ˆä¸Šé¢çš„ 200m å’Œ 100Miï¼‰æ˜¯ Pod ä¸­æ‰€æœ‰æœªæŒ‡å®š Requests å€¼çš„å®¹å™¨çš„é»˜è®¤ Requests å€¼ï¼›</li><li>Container çš„ Default Limitï¼ˆä¸Šé¢çš„300må’Œ200Miï¼‰æ˜¯ Pod ä¸­æ‰€æœ‰æœªæŒ‡å®š Limits å€¼çš„å®¹å™¨çš„é»˜è®¤ Limits å€¼ã€‚</li><li>å¯¹äºåŒä¸€èµ„æºç±»å‹ï¼Œè¿™ 4 ä¸ªå‚æ•°å¿…é¡»æ»¡è¶³ä»¥ä¸‹å…³ç³»ï¼šMin â‰¤ Default Request â‰¤ Default Limit â‰¤ Maxã€‚</li></ul></li><li>Podï¼š <ul><li>Pod çš„ Minï¼ˆä¸Šé¢çš„ 200m å’Œ 6Miï¼‰æ˜¯ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Requests å€¼çš„æ€»å’Œä¸‹é™ï¼›</li><li>Pod çš„ Maxï¼ˆä¸Šé¢çš„ 4 å’Œ 2Giï¼‰æ˜¯ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Limits å€¼çš„æ€»å’Œä¸Šé™ã€‚</li><li>å®¹å™¨æœªæŒ‡å®š Requests å€¼æˆ–è€… Limits å€¼æ—¶ï¼Œå°†ä½¿ç”¨ Container çš„ Default Request å€¼æˆ–è€… Default Limit å€¼ã€‚</li></ul></li><li>Container çš„ Max Limit/Requests Ratioï¼ˆä¸Šé¢çš„ 5 å’Œ 4ï¼‰é™åˆ¶äº† Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Limits å€¼ä¸ Requests å€¼çš„æ¯”ä¾‹ä¸Šé™ï¼›è€Œ Pod çš„ Max Limit / Requests Ratioï¼ˆä¸Šé¢çš„ 3 å’Œ 2ï¼‰é™åˆ¶äº† Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Limits å€¼æ€»å’Œä¸ Requests å€¼æ€»å’Œçš„æ¯”ä¾‹ä¸Šé™ã€‚</li></ul></li><li>å¦‚æœè®¾ç½®äº† Container çš„ Maxï¼Œé‚£ä¹ˆå¯¹äºè¯¥ç±»èµ„æºè€Œè¨€ï¼Œæ•´ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å¿…é¡»è®¾ç½® Limitsï¼Œå¦åˆ™æ— æ³•æˆåŠŸåˆ›å»ºã€‚Pod å†…çš„å®¹å™¨æœªé…ç½® Limits æ—¶ï¼Œå°†ä½¿ç”¨ Default Limit çš„å€¼ï¼ˆæœ¬ä¾‹ä¸­çš„ 300m CPU å’Œ 200MiB å†…å­˜ï¼‰ï¼Œå¦‚æœä¹Ÿæœªé…ç½® Defaultï¼Œåˆ™æ— æ³•æˆåŠŸåˆ›å»ºã€‚</li><li>å¦‚æœè®¾ç½®äº† Container çš„ Minï¼Œé‚£ä¹ˆå¯¹äºè¯¥ç±»èµ„æºè€Œè¨€ï¼Œæ•´ä¸ªé›†ç¾¤ä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å¿…é¡»è®¾ç½® Requestsã€‚å¦‚æœåˆ›å»º Pod çš„å®¹å™¨æ—¶æœªé…ç½®è¯¥ç±»èµ„æºçš„ Requestsï¼Œé‚£ä¹ˆåœ¨åˆ›å»ºè¿‡ç¨‹ä¸­ä¼šæŠ¥éªŒè¯é”™è¯¯ã€‚Pod é‡Œå®¹å™¨çš„ Requests åœ¨æœªé…ç½®æ—¶ï¼Œå¯ä»¥ä½¿ç”¨é»˜è®¤å€¼ defaultRequestï¼ˆæœ¬ä¾‹ä¸­çš„ 200m CPU å’Œ 100MiB å†…å­˜ï¼‰ï¼›å¦‚æœæœªé…ç½®è€Œä¸”æ²¡æœ‰ä½¿ç”¨é»˜è®¤å€¼ defaultRequestï¼Œé‚£ä¹ˆé»˜è®¤ç­‰äºè¯¥å®¹å™¨çš„ Limitsï¼›å¦‚æœå®¹å™¨çš„ Limits ä¹Ÿæœªå®šä¹‰ï¼Œå°±ä¼šæŠ¥é”™ã€‚</li><li>å¯¹äºä»»æ„ä¸€ä¸ª Pod è€Œè¨€ï¼Œè¯¥ Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Requests æ€»å’Œéƒ½å¿…é¡»å¤§äºæˆ–ç­‰äº 6MiBï¼Œè€Œä¸”æ‰€æœ‰å®¹å™¨çš„ Limits æ€»å’Œéƒ½å¿…é¡»å°äºæˆ–ç­‰äº 1GiBï¼›åŒæ ·ï¼Œæ‰€æœ‰å®¹å™¨çš„ CPU Requests æ€»å’Œéƒ½å¿…é¡»å¤§äºæˆ–ç­‰äº 200mï¼Œè€Œä¸”æ‰€æœ‰å®¹å™¨çš„ CPU Limits æ€»å’Œéƒ½å¿…é¡»å°äºæˆ–ç­‰äº 2ã€‚</li><li>Podé‡Œä»»ä½•å®¹å™¨çš„ Limits ä¸ Requests çš„æ¯”ä¾‹éƒ½ä¸èƒ½è¶…è¿‡ Container çš„Max Limit / Requests Ratioï¼›Pod é‡Œæ‰€æœ‰å®¹å™¨çš„ Limits æ€»å’Œä¸ Requests æ€»å’Œçš„æ¯”ä¾‹éƒ½ä¸èƒ½è¶…è¿‡ Pod çš„ Max Limit / Requests Ratioã€‚</li></ol><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒCPU Limits å¼ºåˆ¶é…ç½®è¿™ä¸ªé€‰é¡¹ï¼Œåœ¨ Kubernetes é›†ç¾¤ä¸­é»˜è®¤æ˜¯å¼€å¯çš„ï¼›é™¤éåœ¨éƒ¨ç½²kubeletæœåŠ¡æ—¶é€šè¿‡è®¾ç½®<code>--cpu-cfs-quota=false</code>æ¥å…³é—­è¯¥é™åˆ¶ã€‚</p></div><h3 id="æµ‹è¯•" tabindex="-1">æµ‹è¯• <a class="header-anchor" href="#æµ‹è¯•" aria-label="Permalink to &quot;æµ‹è¯•&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#cat default.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">default-pod</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">args</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">/bin/sh</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">-c</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#9ECBFF;">sleep 60000</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#cat default.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">default-pod</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">args</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">/bin/sh</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">-c</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#032F62;">sleep 60000</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@kube-master yaml]# kubectl describe pod default-pod</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@kube-master yaml]# kubectl describe pod default-pod</span></span></code></pre></div><blockquote><p>å®¹å™¨çš„ requests å’Œ limits ä¸æˆ‘ä»¬åœ¨ LimitRange å¯¹è±¡ä¸­è®¾ç½®çš„ä¸€è‡´</p></blockquote><h4 id="cpu-è¶…é™åˆ¶" tabindex="-1">cpu è¶…é™åˆ¶ <a class="header-anchor" href="#cpu-è¶…é™åˆ¶" aria-label="Permalink to &quot;cpu è¶…é™åˆ¶&quot;">â€‹</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># kubectl run  cpu-over --image=busybox --restart=Never --requests=&#39;cpu=1200m,memory=30Mi&#39; sleep 6000</span></span>
<span class="line"><span style="color:#B392F0;">The</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Pod</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;cpu-over&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">invalid:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">spec.containers[</span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">].resources.requests:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Invalid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">value:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;1200m&quot;:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">must</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">be</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">less</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">than</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">or</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">equal</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">limit</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># kubectl run  cpu-over --image=busybox --restart=Never --requests=&#39;cpu=1200m,memory=30Mi&#39; sleep 6000</span></span>
<span class="line"><span style="color:#6F42C1;">The</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Pod</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;cpu-over&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#032F62;">invalid:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">spec.containers[</span><span style="color:#005CC5;">0</span><span style="color:#032F62;">].resources.requests:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Invalid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">value:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;1200m&quot;:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">must</span><span style="color:#24292E;"> </span><span style="color:#032F62;">be</span><span style="color:#24292E;"> </span><span style="color:#032F62;">less</span><span style="color:#24292E;"> </span><span style="color:#032F62;">than</span><span style="color:#24292E;"> </span><span style="color:#032F62;">or</span><span style="color:#24292E;"> </span><span style="color:#032F62;">equal</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu</span><span style="color:#24292E;"> </span><span style="color:#032F62;">limit</span></span></code></pre></div><h4 id="å†…å­˜è¶…é™åˆ¶" tabindex="-1">å†…å­˜è¶…é™åˆ¶ <a class="header-anchor" href="#å†…å­˜è¶…é™åˆ¶" aria-label="Permalink to &quot;å†…å­˜è¶…é™åˆ¶&quot;">â€‹</a></h4><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># kubectl run  cpu-over --image=busybox --restart=Never --requests=&#39;cpu=200m,memory=300Mi&#39; sleep 6000</span></span>
<span class="line"><span style="color:#B392F0;">The</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Pod</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;cpu-over&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">invalid:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">spec.containers[</span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">].resources.requests:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Invalid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">value:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;300Mi&quot;:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">must</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">be</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">less</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">than</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">or</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">equal</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">memory</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">limit</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># kubectl run  cpu-over --image=busybox --restart=Never --requests=&#39;cpu=200m,memory=300Mi&#39; sleep 6000</span></span>
<span class="line"><span style="color:#6F42C1;">The</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Pod</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;cpu-over&quot;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#032F62;">invalid:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">spec.containers[</span><span style="color:#005CC5;">0</span><span style="color:#032F62;">].resources.requests:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Invalid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">value:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;300Mi&quot;:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">must</span><span style="color:#24292E;"> </span><span style="color:#032F62;">be</span><span style="color:#24292E;"> </span><span style="color:#032F62;">less</span><span style="color:#24292E;"> </span><span style="color:#032F62;">than</span><span style="color:#24292E;"> </span><span style="color:#032F62;">or</span><span style="color:#24292E;"> </span><span style="color:#032F62;">equal</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">memory</span><span style="color:#24292E;"> </span><span style="color:#032F62;">limit</span></span></code></pre></div><h3 id="ä¸æŒ‡å®š-cpu-å’Œ-mem-limits" tabindex="-1">ä¸æŒ‡å®š CPU å’Œ mem Limits <a class="header-anchor" href="#ä¸æŒ‡å®š-cpu-å’Œ-mem-limits" aria-label="Permalink to &quot;ä¸æŒ‡å®š CPU å’Œ mem Limits&quot;">â€‹</a></h3><p>å¦‚æœæ²¡æœ‰ä¸ºå®¹å™¨æŒ‡å®š CPU é™åˆ¶ï¼Œé‚£ä¹ˆå®¹å™¨åœ¨å¯ä»¥ä½¿ç”¨çš„ CPU èµ„æºæ˜¯æ²¡æœ‰ä¸Šé™ã€‚å› è€Œå¯ä»¥ä½¿ç”¨æ‰€åœ¨èŠ‚ç‚¹ä¸Šæ‰€æœ‰çš„å¯ç”¨ CPU èµ„æºï¼Œè¿™æ ·å¯èƒ½ä¼šé€ æˆæŸä¸€ä¸ª Pod å ç”¨äº†å¤§é‡çš„ CPU æ—¶é—´ï¼Œå¯èƒ½ä¼šå½±å“å…¶ä»–çš„ Pod æ­£å¸¸è¿è¡Œï¼Œä»è€Œé€ æˆä¸šåŠ¡çš„ä¸ç¨³å®šæ€§ã€‚</p><p>è¿™ä¸ªä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œåœ¨ Kubernetes ä¸­ï¼Œå¯ä»¥é€šè¿‡<a href="https://kubernetes.io/zh-cn/docs/concepts/policy/limit-range/" target="_blank" rel="noreferrer">LimitRange</a>è‡ªåŠ¨ä¸ºå®¹å™¨è®¾å®šï¼Œæ‰€ä½¿ç”¨çš„ CPU èµ„æºå’Œå†…å­˜èµ„æºæœ€å¤§æœ€å°å€¼</p><h1 id="_5-èµ„æºé…é¢ç®¡ç†-resourcequota" tabindex="-1">5.èµ„æºé…é¢ç®¡ç†ï¼ˆResourceQuotaï¼‰ <a class="header-anchor" href="#_5-èµ„æºé…é¢ç®¡ç†-resourcequota" aria-label="Permalink to &quot;5.èµ„æºé…é¢ç®¡ç†ï¼ˆResourceQuotaï¼‰&quot;">â€‹</a></h1><p>èµ„æºé…é¢ç®¡ç†ï¼ˆ<code>Resource Quotas</code>ï¼‰é€šè¿‡ <code>ResourceQuota</code> å¯¹è±¡ï¼Œå¯ä»¥å®šä¹‰èµ„æºé…é¢ï¼Œè¿™ä¸ªèµ„æºé…é¢å¯ä»¥ä¸ºæ¯ä¸ªå‘½åç©ºé—´éƒ½æä¾›ä¸€ä¸ªæ€»ä½“çš„èµ„æºé™åˆ¶ï¼šå®ƒå¯ä»¥é™åˆ¶å‘½åç©ºé—´ä¸­æŸç§ç±»å‹çš„å¯¹è±¡çš„æ€»æ•°é‡ä¸Šé™ï¼Œä¹Ÿå¯ä»¥è®¾ç½®å‘½åç©ºé—´ä¸­ Pod å¯ä»¥ä½¿ç”¨çš„è®¡ç®—èµ„æºçš„æ€»ä¸Šé™ã€‚</p><p>åœ¨ä½¿ç”¨èµ„æºé…é¢æ—¶ï¼Œéœ€è¦æ³¨æ„ä»¥ä¸‹ä¸¤ç‚¹ï¼š</p><ol><li>å¦‚æœé›†ç¾¤ä¸­æ€»çš„å¯ç”¨èµ„æºå°äºå„å‘½åç©ºé—´ä¸­èµ„æºé…é¢çš„æ€»å’Œï¼Œé‚£ä¹ˆå¯èƒ½ä¼šå¯¼è‡´èµ„æºç«äº‰ã€‚åœ¨å‘ç”Ÿèµ„æºç«äº‰æ—¶ï¼ŒKubernetes ç³»ç»Ÿä¼šéµå¾ªå…ˆåˆ°å…ˆå¾—çš„åŸåˆ™ã€‚</li><li>ä¸ç®¡æ˜¯èµ„æºç«äº‰è¿˜æ˜¯é…é¢ä¿®æ”¹ï¼Œéƒ½ä¸ä¼šå½±å“å·²åˆ›å»ºçš„èµ„æºä½¿ç”¨å¯¹è±¡ã€‚</li></ol><h2 id="_5-1-æ¦‚å¿µ" tabindex="-1">5.1 æ¦‚å¿µ <a class="header-anchor" href="#_5-1-æ¦‚å¿µ" aria-label="Permalink to &quot;5.1 æ¦‚å¿µ&quot;">â€‹</a></h2><p>Kubemetes å¯ä»¥é€šè¿‡å­˜æ´»æ¢é’ˆ(liveness probe)æ£€æŸ¥å®¹å™¨æ˜¯å¦è¿˜åœ¨è¿è¡Œã€‚å¯ä»¥ä¸º pod ä¸­çš„æ¯ä¸ªå®¹å™¨å•ç‹¬æŒ‡å®šå­˜æ´»æ¢é’ˆã€‚å¦‚æœæ¢æµ‹å¤±è´¥ï¼ŒKubemetes å°†å®šæœŸæ‰§è¡Œæ¢é’ˆå¹¶é‡æ–°å¯åŠ¨å®¹å™¨ã€‚</p><p>èµ„æºé…é¢ï¼ˆResource Quotasï¼‰æ˜¯ç”¨æ¥é™åˆ¶ç”¨æˆ·èµ„æºç”¨é‡çš„ä¸€ç§æœºåˆ¶ï¼Œé™åˆ¶ Pod çš„è¯·æ±‚ä¸ä¼šè¶…è¿‡é…é¢ï¼Œéœ€è¦åœ¨ namespace ä¸­åˆ›å»ºä¸€ä¸ª ResourceQuota å¯¹è±¡</p><p><strong>èµ„æºé…é¢ç±»å‹ï¼š</strong></p><ul><li>è®¡ç®—èµ„æºã€‚åŒ…æ‹¬ cpu å’Œ memory</li><li>å­˜å‚¨èµ„æºã€‚åŒ…æ‹¬å­˜å‚¨èµ„æºçš„æ€»é‡ä»¥åŠæŒ‡å®š storage class çš„æ€»é‡</li><li>å¯¹è±¡æ•°ã€‚å³å¯åˆ›å»ºçš„å¯¹è±¡çš„ä¸ªæ•°</li></ul><h2 id="_5-2-resourcequota-ä½œç”¨" tabindex="-1">5.2 ResourceQuota ä½œç”¨ <a class="header-anchor" href="#_5-2-resourcequota-ä½œç”¨" aria-label="Permalink to &quot;5.2 ResourceQuota ä½œç”¨&quot;">â€‹</a></h2><p>å°½ç®¡ LimitRange èµ„æºèƒ½é™åˆ¶å•ä¸ªå®¹å™¨ã€Pod åŠ PVC ç­‰ç›¸å…³è®¡ç®—èµ„æºæˆ–å­˜å‚¨èµ„æºçš„ç”¨é‡ï¼Œä½†ç”¨æˆ·ä¾ç„¶å¯ä»¥åˆ›å»ºæ•°é‡ä¼—å¤šçš„æ­¤ç±»èµ„æºå¯¹è±¡è¿›è€Œä¾µå æ‰€æœ‰çš„ç³»ç»Ÿèµ„æºã€‚äºæ˜¯ï¼ŒKubernetes æä¾›äº† ResourceQuota èµ„æºç”¨äºå®šä¹‰åç§°ç©ºé—´çš„å¯¹è±¡æ•°é‡æˆ–ç³»ç»Ÿèµ„æºé…é¢</p><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>LimitRange åº”ç”¨äºå•ç‹¬çš„ podï¼ŒResourceQuota åº”ç”¨äºå‘½åç©ºé—´ä¸­æ‰€æœ‰çš„ pod</p></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202404261601532.png" alt="image-20240426160154222"></p><h2 id="_5-3-åœ¨-master-ä¸­å¼€å¯èµ„æºé…é¢é€‰å‹" tabindex="-1">5.3 åœ¨ Master ä¸­å¼€å¯èµ„æºé…é¢é€‰å‹ <a class="header-anchor" href="#_5-3-åœ¨-master-ä¸­å¼€å¯èµ„æºé…é¢é€‰å‹" aria-label="Permalink to &quot;5.3 åœ¨ Master ä¸­å¼€å¯èµ„æºé…é¢é€‰å‹&quot;">â€‹</a></h2><p>èµ„æºé…é¢å¯ä»¥é€šè¿‡åœ¨ kube-apiserver çš„ <code>--admission-control</code>å‚æ•°å€¼ä¸­æ·»åŠ  <code>ResourceQuota</code>å‚æ•°è¿›è¡Œå¼€å¯ã€‚å¦‚æœåœ¨æŸä¸ªå‘½åç©ºé—´çš„å®šä¹‰ä¸­å­˜åœ¨ ResourceQuotaï¼Œé‚£ä¹ˆå¯¹äºè¯¥å‘½åç©ºé—´è€Œè¨€ï¼Œèµ„æºé…é¢å°±æ˜¯é»˜è®¤å¼€å¯çš„ã€‚ä¸€ä¸ªå‘½åç©ºé—´å¯ä»¥æœ‰å¤šä¸ª ResourceQuota é…ç½®é¡¹ã€‚ï¼ˆé‡å¯æœåŠ¡çš„æ—¶å€™ä¼šæç¤ºï¼šâ€“admission-control has been deprecated, Use --enable-admission-plugins or --disable-admission-plugins instead. Will be removed in a future version.ï¼‰æ›´æ¢ä½¿ç”¨ <code>--enable-admission-plugins</code>å³å¯ã€‚</p><h3 id="_5-3-1-è®¡ç®—èµ„æºé…é¢-compute-resource-quota" tabindex="-1">5.3.1 è®¡ç®—èµ„æºé…é¢ï¼ˆCompute Resource Quotaï¼‰ <a class="header-anchor" href="#_5-3-1-è®¡ç®—èµ„æºé…é¢-compute-resource-quota" aria-label="Permalink to &quot;5.3.1 è®¡ç®—èµ„æºé…é¢ï¼ˆCompute Resource Quotaï¼‰&quot;">â€‹</a></h3><p>èµ„æºé…é¢å¯ä»¥é™åˆ¶ä¸€ä¸ªå‘½åç©ºé—´ä¸­æ‰€æœ‰ Pod çš„è®¡ç®—èµ„æºçš„æ€»å’Œã€‚ResourceQuota ç›®å‰æ”¯æŒé—²ç½®çš„è®¡ç®—èµ„æºç±»å‹å¦‚è¡¨ï¼š</p><table><thead><tr><th>èµ„æºåç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>cpu</td><td>æ‰€æœ‰éç»ˆæ­¢çŠ¶æ€çš„ Podï¼ŒCPU Requests çš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼</td></tr><tr><td>requests.cpu</td><td>æ‰€æœ‰éç»ˆæ­¢çŠ¶æ€çš„ Podï¼ŒCPU Requests çš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼</td></tr><tr><td>limits.cpu</td><td>æ‰€æœ‰éç»ˆæ­¢çŠ¶æ€çš„ Podï¼ŒCPU Limits çš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼</td></tr><tr><td>memory</td><td>æ‰€æœ‰éç»ˆæ­¢çŠ¶æ€çš„ Podï¼Œå†…å­˜ Requests çš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼</td></tr><tr><td>requests.memory</td><td>æ‰€æœ‰éç»ˆæ­¢çŠ¶æ€çš„ Podï¼Œå†…å­˜ Requests çš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼</td></tr><tr><td>limits.memory</td><td>æ‰€æœ‰éç»ˆæ­¢çŠ¶æ€çš„ Podï¼Œå†…å­˜ Limits çš„æ€»å’Œä¸èƒ½è¶…è¿‡è¯¥å€¼</td></tr></tbody></table><h3 id="_5-3-2-å­˜å‚¨èµ„æºé…é¢-volume-count-quota" tabindex="-1">5.3.2 å­˜å‚¨èµ„æºé…é¢ï¼ˆVolume Count Quotaï¼‰ <a class="header-anchor" href="#_5-3-2-å­˜å‚¨èµ„æºé…é¢-volume-count-quota" aria-label="Permalink to &quot;5.3.2 å­˜å‚¨èµ„æºé…é¢ï¼ˆVolume Count Quotaï¼‰&quot;">â€‹</a></h3><p>å¯ä»¥åœ¨ç»™å®šçš„å‘½åç©ºé—´ä¸­é™åˆ¶æ‰€ä½¿ç”¨çš„å­˜å‚¨èµ„æºï¼ˆStorage Resourcesï¼‰çš„æ€»é‡ï¼Œç›®å‰æ”¯æŒçš„å­˜å‚¨èµ„æºåç§°å¦‚è¡¨ï¼š</p><table><thead><tr><th>èµ„æºåç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>requests.storage</td><td>æ‰€æœ‰ PVCï¼Œå­˜å‚¨èµ„æºçš„éœ€æ±‚æ€»é‡ä¸èƒ½è¶…è¿‡è¯¥å€¼</td></tr><tr><td>persistentvolumeclaims</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­æ‰€å…è®¸çš„ PVC æ€»é‡</td></tr><tr><td>storage-class-name.storageclass.storage.k8s.io/requests.storage</td><td>åœ¨æ‰€æœ‰ä¸<code>&lt;storage-class-name&gt;</code> ç›¸å…³çš„ PVC è¯·æ±‚çš„å­˜å‚¨æ€»é‡éƒ½ä¸èƒ½è¶…è¿‡è¯¥å€¼ï¼Œä¾‹å¦‚ <code>gold.storageclass.storage.k8s.io/requests.storage: 500Gi</code>è¡¨ç¤ºç±»å‹ä¸º gold çš„ storageClass å¯¹åº”çš„ PVC çš„ç”³è¯·å­˜å‚¨æ€»é‡æœ€å¤šå¯è¾¾ 500Gi</td></tr><tr><td>storage-class-name.storageclass.storage.k8s.io/persistentvolumeclaims</td><td>æ‰€æœ‰ä¸<code>&lt;storage-class-name&gt;</code> ç›¸å…³çš„ PVC æ€»æ•°éƒ½ä¸è¶…è¿‡è¯¥å€¼ã€‚</td></tr><tr><td>ephemeral-storageã€requests.ephemeral-storageã€limits.ephemeral-storage</td><td>æœ¬åœ°ä¸´æ—¶å­˜å‚¨ï¼ˆephemeral-storageï¼‰çš„æ€»é‡é™åˆ¶</td></tr></tbody></table><h2 id="_5-3-3-å¯¹è±¡æ•°é‡é…é¢-object-count-quota" tabindex="-1">5.3.3 å¯¹è±¡æ•°é‡é…é¢ï¼ˆObject Count Quotaï¼‰ <a class="header-anchor" href="#_5-3-3-å¯¹è±¡æ•°é‡é…é¢-object-count-quota" aria-label="Permalink to &quot;5.3.3 å¯¹è±¡æ•°é‡é…é¢ï¼ˆObject Count Quotaï¼‰&quot;">â€‹</a></h2><p>æŒ‡å®šç±»å‹çš„å¯¹è±¡æ•°é‡å¯ä»¥è¢«é™åˆ¶ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥é€šè¿‡èµ„æºé…é¢æ¥é™åˆ¶åœ¨å‘½åç©ºé—´ä¸­åˆ›å»ºçš„ Pod çš„æœ€å¤§æ•°é‡ã€‚è¿™ç§é…ç½®å¯ä»¥é˜²æ­¢æŸäº›ç”¨æˆ·å¤§é‡åˆ›å»º Pod è€Œè¿…é€Ÿè€—å°½æ•´ä¸ªé›†ç¾¤çš„ Pod IP å’Œè®¡ç®—èµ„æºã€‚ä¸‹è¡¨åˆ—å‡º ResourceQuota æ”¯æŒé™åˆ¶çš„å¯¹è±¡ç±»å‹ã€‚</p><table><thead><tr><th>èµ„æºåç§°</th><th>æè¿°</th></tr></thead><tbody><tr><td>configmaps</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­å…è®¸å­˜åœ¨çš„ ConfigMap æ€»æ•°ä¸Šé™ã€‚</td></tr><tr><td>pods</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„éç»ˆæ­¢çŠ¶æ€ Pod çš„æ€»æ•°ä¸Šé™ã€‚Pod çš„ç»ˆæ­¢çŠ¶æ€ç­‰ä»·äº Pod çš„ <code>status.phase in (Failed, Successded) = true</code></td></tr><tr><td>replicationcontrollers</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„ RC çš„æ€»æ•°ä¸Šé™ã€‚</td></tr><tr><td>resourcequotas</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„èµ„æºé…é¢çš„æ€»æ•°ä¸Šé™ã€‚</td></tr><tr><td>services</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„ Service çš„æ€»æ•°ä¸Šé™ã€‚</td></tr><tr><td>services.loadbalancers</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„ LoadBalancer ç±»å‹çš„ Service æ€»æ•°ä¸Šé™ã€‚</td></tr><tr><td>services.nodeports</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„ NodePort ç±»å‹çš„ Service æ€»æ•°ä¸Šé™ã€‚</td></tr><tr><td>secrets</td><td>åœ¨è¯¥å‘½åç©ºé—´ä¸­èƒ½å­˜åœ¨çš„ Secret çš„æ€»æ•°ä¸Šé™ã€‚</td></tr></tbody></table><p>å…·ä½“è¡¨ç¤ºå¦‚ä¸‹ï¼š</p><ul><li><code>count/&lt;resource&gt;.&lt;group&gt;</code>: ç”¨äºéæ ¸å¿ƒï¼ˆcoreï¼‰ç»„æˆçš„èµ„æºï¼Œä¾‹å¦‚ <code>count/deployments.apps</code>ã€<code>count/cronjobs.batch</code>ã€‚</li><li><code>count/resource</code>: ç”¨äºæ ¸å¿ƒç»„çš„èµ„æºï¼Œä¾‹å¦‚ <code>count/services</code>ã€<code>count/pods</code>ã€‚</li></ul><h2 id="_5-4-é…é¢çš„ä½œç”¨åŸŸ-quota-scopes" tabindex="-1">5.4 é…é¢çš„ä½œç”¨åŸŸï¼ˆQuota Scopesï¼‰ <a class="header-anchor" href="#_5-4-é…é¢çš„ä½œç”¨åŸŸ-quota-scopes" aria-label="Permalink to &quot;5.4 é…é¢çš„ä½œç”¨åŸŸï¼ˆQuota Scopesï¼‰&quot;">â€‹</a></h2><p>å¯¹æ¯é¡¹èµ„æºé…é¢éƒ½å¯ä»¥å•ç‹¬é…ç½®ä¸€ç»„ä½œç”¨åŸŸï¼Œé…ç½®äº†ä½œç”¨åŸŸçš„èµ„æºé…é¢åªä¼šå¯¹ç¬¦åˆå…¶ä½œç”¨åŸŸçš„èµ„æºä½¿ç”¨æƒ…å†µè¿›è¡Œè®¡é‡å’Œé™åˆ¶ï¼Œä½œç”¨åŸŸèŒƒå›´è¶…å‡ºäº†èµ„æºé…é¢çš„è¯·æ±‚éƒ½ä¼šè¢«æŠ¥éªŒè¯é”™è¯¯ã€‚ä¸‹è¡¨åˆ—å‡ºäº† ResourceQuota çš„ 4 ç§ä½œç”¨åŸŸã€‚</p><table><thead><tr><th>ä½œç”¨åŸŸ</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>Terminating</td><td>åŒ¹é…æ‰€æœ‰ spec.activeDeadlineSeconds ä¸å°äº 0 çš„ Pod</td></tr><tr><td>NotTerminating</td><td>åŒ¹é…æ‰€æœ‰ spec.activeDeadlineSeconds æ˜¯ nil çš„ Pod</td></tr><tr><td>BestEffort</td><td>åŒ¹é…æ‰€æœ‰ Qos æ˜¯ BestEffort çš„ Pod</td></tr><tr><td>NotBestEffort</td><td>åŒ¹é…æ‰€æœ‰ Qos ä¸æ˜¯ BestEffort çš„ Pod</td></tr><tr><td>PriorityClass</td><td>åŒ¹é…æ‰€æœ‰å¼•ç”¨äº†æ‰€æŒ‡å®šçš„ä¼˜å…ˆçº§ç±»çš„ Pods</td></tr></tbody></table><p>å…¶ä¸­ï¼š</p><ul><li>BestEffort ä½œç”¨åŸŸå¯ä»¥é™å®šèµ„æºé…é¢æ¥è¿½è¸ª Pod èµ„æºçš„ä½¿ç”¨ã€‚</li><li>è€Œ Terminatingã€NotTerminatingã€NotBestEffortã€PriorityClass é™¤äº†å¯ä»¥è¿½è¸ª Podï¼Œè¿˜å¯ä»¥è¿½è¸ª CPUã€Limits.cpuã€Limits.memoryã€memoryã€requests.cpuã€ requests.memory ç­‰èµ„æºçš„ä½¿ç”¨æƒ…å†µã€‚</li></ul><h2 id="_5-5-èµ„æºé…é¢çš„å®šä¹‰" tabindex="-1">5.5 èµ„æºé…é¢çš„å®šä¹‰ <a class="header-anchor" href="#_5-5-èµ„æºé…é¢çš„å®šä¹‰" aria-label="Permalink to &quot;5.5 èµ„æºé…é¢çš„å®šä¹‰&quot;">â€‹</a></h2><p>ä¸ LimitRange ç›¸ä¼¼ï¼ŒResourceQuota ä¹Ÿè¢«è®¾ç½®åœ¨å‘½åç©ºé—´ä¸­ã€‚åˆ›å»ºåä¸º myspace çš„å‘½åç©ºé—´ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl create namespace myspace</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl create namespace myspace</span></span></code></pre></div><p>åˆ›å»º ResourceQuota é…ç½®æ–‡ä»¶ compute-resource.yaml</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ResourceQuota</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">compute-resources</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">hard</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">pods</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;4&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests.cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests.memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">limits.cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">limits.memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">ResourceQuota</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">compute-resources</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">hard</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">pods</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;4&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests.cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests.memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">limits.cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">limits.memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"> kubectl create -f compute-resource.yaml --namespace=myspace</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"> kubectl create -f compute-resource.yaml --namespace=myspace</span></span></code></pre></div><p>åˆ›å»ºå¦ä¸€ä¸ªåä¸º object-counts.yaml çš„æ–‡ä»¶ï¼Œç”¨äºè®¾ç½®å¯¹è±¡æ•°é‡çš„é…é¢</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ResourceQuota</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">object-counts</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">hard</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">configmaps</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;10&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">persistentvolumeclaims</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;4&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">replicationcontrollers</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;20&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">secrets</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;10&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">services</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;10&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">services.loadbalancers</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;2&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">ResourceQuota</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">object-counts</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">hard</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">configmaps</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;10&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">persistentvolumeclaims</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;4&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">replicationcontrollers</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;20&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">secrets</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;10&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">services</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;10&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">services.loadbalancers</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;2&quot;</span></span></code></pre></div><p>åˆ›å»ºè¯¥ ResourceQuotaï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl create -f object-counts.yaml --namespace=myspace</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl create -f object-counts.yaml --namespace=myspace</span></span></code></pre></div><p>æŸ¥çœ‹å„ ResourceQuota çš„è¯¦ç»†ä¿¡æ¯</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;"> kubectl describe quota compute-resources --namespace=myspace</span></span>
<span class="line"><span style="color:#e1e4e8;"> </span></span>
<span class="line"><span style="color:#e1e4e8;"> Name:            compute-resources</span></span>
<span class="line"><span style="color:#e1e4e8;">Namespace:       myspace</span></span>
<span class="line"><span style="color:#e1e4e8;">Resource         Used  Hard</span></span>
<span class="line"><span style="color:#e1e4e8;">--------         ----  ----</span></span>
<span class="line"><span style="color:#e1e4e8;">limits.cpu       0     2</span></span>
<span class="line"><span style="color:#e1e4e8;">limits.memory    0     2Gi</span></span>
<span class="line"><span style="color:#e1e4e8;">pods             0     4</span></span>
<span class="line"><span style="color:#e1e4e8;">requests.cpu     0     1</span></span>
<span class="line"><span style="color:#e1e4e8;">requests.memory  0     1Gi</span></span>
<span class="line"><span style="color:#e1e4e8;">[root@master1 ]# kubectl describe quota object-counts --namespace=myspace </span></span>
<span class="line"><span style="color:#e1e4e8;">Name:                   object-counts</span></span>
<span class="line"><span style="color:#e1e4e8;">Namespace:              myspace</span></span>
<span class="line"><span style="color:#e1e4e8;">Resource                Used  Hard</span></span>
<span class="line"><span style="color:#e1e4e8;">--------                ----  ----</span></span>
<span class="line"><span style="color:#e1e4e8;">configmaps              0     10</span></span>
<span class="line"><span style="color:#e1e4e8;">persistentvolumeclaims  0     4</span></span>
<span class="line"><span style="color:#e1e4e8;">replicationcontrollers  0     20</span></span>
<span class="line"><span style="color:#e1e4e8;">secrets                 1     10</span></span>
<span class="line"><span style="color:#e1e4e8;">services                0     10</span></span>
<span class="line"><span style="color:#e1e4e8;">services.loadbalancers  0     2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;"> kubectl describe quota compute-resources --namespace=myspace</span></span>
<span class="line"><span style="color:#24292e;"> </span></span>
<span class="line"><span style="color:#24292e;"> Name:            compute-resources</span></span>
<span class="line"><span style="color:#24292e;">Namespace:       myspace</span></span>
<span class="line"><span style="color:#24292e;">Resource         Used  Hard</span></span>
<span class="line"><span style="color:#24292e;">--------         ----  ----</span></span>
<span class="line"><span style="color:#24292e;">limits.cpu       0     2</span></span>
<span class="line"><span style="color:#24292e;">limits.memory    0     2Gi</span></span>
<span class="line"><span style="color:#24292e;">pods             0     4</span></span>
<span class="line"><span style="color:#24292e;">requests.cpu     0     1</span></span>
<span class="line"><span style="color:#24292e;">requests.memory  0     1Gi</span></span>
<span class="line"><span style="color:#24292e;">[root@master1 ]# kubectl describe quota object-counts --namespace=myspace </span></span>
<span class="line"><span style="color:#24292e;">Name:                   object-counts</span></span>
<span class="line"><span style="color:#24292e;">Namespace:              myspace</span></span>
<span class="line"><span style="color:#24292e;">Resource                Used  Hard</span></span>
<span class="line"><span style="color:#24292e;">--------                ----  ----</span></span>
<span class="line"><span style="color:#24292e;">configmaps              0     10</span></span>
<span class="line"><span style="color:#24292e;">persistentvolumeclaims  0     4</span></span>
<span class="line"><span style="color:#24292e;">replicationcontrollers  0     20</span></span>
<span class="line"><span style="color:#24292e;">secrets                 1     10</span></span>
<span class="line"><span style="color:#24292e;">services                0     10</span></span>
<span class="line"><span style="color:#24292e;">services.loadbalancers  0     2</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>èµ„æºé…é¢ä¸é›†ç¾¤èµ„æºæ€»é‡æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚èµ„æºé…é¢æ˜¯é€šè¿‡ç»å¯¹çš„å•ä½æ¥é…ç½®çš„ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€å¦‚æœåœ¨é›†ç¾¤ä¸­æ–°æ·»åŠ äº†èŠ‚ç‚¹ï¼Œé‚£ä¹ˆèµ„æºé…é¢ä¸ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œè€Œè¯¥èµ„æºé…é¢æ‰€å¯¹åº”çš„å‘½åç©ºé—´ä¸­çš„å¯¹è±¡ä¹Ÿä¸èƒ½è‡ªåŠ¨å¢åŠ èµ„æºä¸Šé™.</p></div><h2 id="_5-3-åˆ›å»º" tabindex="-1">5.3 åˆ›å»º <a class="header-anchor" href="#_5-3-åˆ›å»º" aria-label="Permalink to &quot;5.3 åˆ›å»º&quot;">â€‹</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#cat quota-cpu-memory.yaml</span></span>
<span class="line"><span style="color:#B392F0;">apiVersion:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#B392F0;">kind:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ResourceQuota</span></span>
<span class="line"><span style="color:#B392F0;">metadata:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">name:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">cpu-and-mem</span></span>
<span class="line"><span style="color:#B392F0;">spec:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">hard:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">requests.cpu:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">requests.memory:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">limits.cpu:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1500</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">limits.memory:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1500</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># kubectl apply -f quota-cpu-memory.yaml</span></span>
<span class="line"><span style="color:#B392F0;">resourcequota/cpu-and-mem</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#cat quota-cpu-memory.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">apiVersion:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#6F42C1;">kind:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ResourceQuota</span></span>
<span class="line"><span style="color:#6F42C1;">metadata:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">name:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">cpu-and-mem</span></span>
<span class="line"><span style="color:#6F42C1;">spec:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">hard:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">requests.cpu:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">requests.memory:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">limits.cpu:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1500</span><span style="color:#032F62;">m</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">limits.memory:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1500</span><span style="color:#032F62;">Mi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># kubectl apply -f quota-cpu-memory.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">resourcequota/cpu-and-mem</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span></code></pre></div><h3 id="æŸ¥çœ‹-1" tabindex="-1">æŸ¥çœ‹ <a class="header-anchor" href="#æŸ¥çœ‹-1" aria-label="Permalink to &quot;æŸ¥çœ‹&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#kubectl describe resourcequotas cpu-and-mem</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#kubectl describe resourcequotas cpu-and-mem</span></span></code></pre></div><h3 id="æµ‹è¯•-resourcequota" tabindex="-1">æµ‹è¯• resourcequota <a class="header-anchor" href="#æµ‹è¯•-resourcequota" aria-label="Permalink to &quot;æµ‹è¯• resourcequota&quot;">â€‹</a></h3><ul><li>åˆ›å»º</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@kube-master yaml]# cat replicas-quota-test.yaml</span></span>
<span class="line"><span style="color:#e1e4e8;">apiVersion: apps/v1</span></span>
<span class="line"><span style="color:#e1e4e8;">kind: Deployment</span></span>
<span class="line"><span style="color:#e1e4e8;">metadata:</span></span>
<span class="line"><span style="color:#e1e4e8;">  name: replicas-quota-test</span></span>
<span class="line"><span style="color:#e1e4e8;">spec:</span></span>
<span class="line"><span style="color:#e1e4e8;">  replicas: 10</span></span>
<span class="line"><span style="color:#e1e4e8;">  selector:</span></span>
<span class="line"><span style="color:#e1e4e8;">    matchLabels:</span></span>
<span class="line"><span style="color:#e1e4e8;">      app: replicas-quota-test</span></span>
<span class="line"><span style="color:#e1e4e8;">  template:</span></span>
<span class="line"><span style="color:#e1e4e8;">    metadata:</span></span>
<span class="line"><span style="color:#e1e4e8;">      labels:</span></span>
<span class="line"><span style="color:#e1e4e8;">        app: replicas-quota-test</span></span>
<span class="line"><span style="color:#e1e4e8;">    spec:</span></span>
<span class="line"><span style="color:#e1e4e8;">      containers:</span></span>
<span class="line"><span style="color:#e1e4e8;">      - name: replicas-quota-test</span></span>
<span class="line"><span style="color:#e1e4e8;">        image: busybox</span></span>
<span class="line"><span style="color:#e1e4e8;">        command: [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;sleep 60000&quot;]</span></span>
<span class="line"><span style="color:#e1e4e8;">        resources:</span></span>
<span class="line"><span style="color:#e1e4e8;">          limits:</span></span>
<span class="line"><span style="color:#e1e4e8;">            cpu: &quot;200m&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;">            memory: &quot;90Mi&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@kube-master yaml]# cat replicas-quota-test.yaml</span></span>
<span class="line"><span style="color:#24292e;">apiVersion: apps/v1</span></span>
<span class="line"><span style="color:#24292e;">kind: Deployment</span></span>
<span class="line"><span style="color:#24292e;">metadata:</span></span>
<span class="line"><span style="color:#24292e;">  name: replicas-quota-test</span></span>
<span class="line"><span style="color:#24292e;">spec:</span></span>
<span class="line"><span style="color:#24292e;">  replicas: 10</span></span>
<span class="line"><span style="color:#24292e;">  selector:</span></span>
<span class="line"><span style="color:#24292e;">    matchLabels:</span></span>
<span class="line"><span style="color:#24292e;">      app: replicas-quota-test</span></span>
<span class="line"><span style="color:#24292e;">  template:</span></span>
<span class="line"><span style="color:#24292e;">    metadata:</span></span>
<span class="line"><span style="color:#24292e;">      labels:</span></span>
<span class="line"><span style="color:#24292e;">        app: replicas-quota-test</span></span>
<span class="line"><span style="color:#24292e;">    spec:</span></span>
<span class="line"><span style="color:#24292e;">      containers:</span></span>
<span class="line"><span style="color:#24292e;">      - name: replicas-quota-test</span></span>
<span class="line"><span style="color:#24292e;">        image: busybox</span></span>
<span class="line"><span style="color:#24292e;">        command: [&quot;/bin/sh&quot;,&quot;-c&quot;,&quot;sleep 60000&quot;]</span></span>
<span class="line"><span style="color:#24292e;">        resources:</span></span>
<span class="line"><span style="color:#24292e;">          limits:</span></span>
<span class="line"><span style="color:#24292e;">            cpu: &quot;200m&quot;</span></span>
<span class="line"><span style="color:#24292e;">            memory: &quot;90Mi&quot;</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@kube-master yaml]# kubectl get pod</span></span>
<span class="line"><span style="color:#e1e4e8;">NAME                                   READY   STATUS    RESTARTS         AGE</span></span>
<span class="line"><span style="color:#e1e4e8;">replicas-quota-test-84bd8d9fb4-bnbm9   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#e1e4e8;">replicas-quota-test-84bd8d9fb4-ctjdz   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#e1e4e8;">replicas-quota-test-84bd8d9fb4-n2kv9   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#e1e4e8;">replicas-quota-test-84bd8d9fb4-n445x   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#e1e4e8;">replicas-quota-test-84bd8d9fb4-s8jt2   1/1     Running   0                7m6s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@kube-master yaml]# kubectl get pod</span></span>
<span class="line"><span style="color:#24292e;">NAME                                   READY   STATUS    RESTARTS         AGE</span></span>
<span class="line"><span style="color:#24292e;">replicas-quota-test-84bd8d9fb4-bnbm9   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#24292e;">replicas-quota-test-84bd8d9fb4-ctjdz   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#24292e;">replicas-quota-test-84bd8d9fb4-n2kv9   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#24292e;">replicas-quota-test-84bd8d9fb4-n445x   1/1     Running   0                7m6s</span></span>
<span class="line"><span style="color:#24292e;">replicas-quota-test-84bd8d9fb4-s8jt2   1/1     Running   0                7m6s</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>å‘ç°åªè¿è¡Œäº†5ä¸ªpodï¼ŒåŸå› æ˜¯requestsçš„cpuä¸º200ï¼ˆrequestså€¼æœªè®¾ç½®æ—¶ä¸limitsç›¸åŒï¼‰ï¼Œresourcequotasä¸­requests.cpuçš„é™åˆ¶å€¼ä¸º1500m,æ‰€ä»¥æœ€å¤šåªèƒ½æ–°å»º5ä¸ªpod</p></div><h3 id="é™åˆ¶å¯åˆ›å»ºå¯¹è±¡çš„ä¸ªæ•°" tabindex="-1">é™åˆ¶å¯åˆ›å»ºå¯¹è±¡çš„ä¸ªæ•° <a class="header-anchor" href="#é™åˆ¶å¯åˆ›å»ºå¯¹è±¡çš„ä¸ªæ•°" aria-label="Permalink to &quot;é™åˆ¶å¯åˆ›å»ºå¯¹è±¡çš„ä¸ªæ•°&quot;">â€‹</a></h3><ul><li>åˆ›å»º</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master yaml</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat quota-count.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ResourceQuota</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">count-quota</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">hard</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">pods</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">replicationcontrollers</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">5</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">secrets</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">configmaps</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">persistentvolumeclaims</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">5</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">services</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">5</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">services.loadbalancers</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">services.nodeports</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">2</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">ssd.storageclass.storage.k8s.io/persistentvolumeclaims</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master yaml</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat quota-count.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">ResourceQuota</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">count-quota</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">hard</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">pods</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">replicationcontrollers</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">5</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">secrets</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">configmaps</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">persistentvolumeclaims</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">5</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">services</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">5</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">services.loadbalancers</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">services.nodeports</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">ssd.storageclass.storage.k8s.io/persistentvolumeclaims</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">2</span></span></code></pre></div><p>è¯¥å‘½åç©ºé—´æœ€å¤šåˆ›å»º 10 ä¸ª podã€5 ä¸ª Replication Controllerã€10 ä¸ª Secretã€10 ä¸ª ConfigMapã€4 ä¸ª PVCã€5 ä¸ª Serviceã€1 ä¸ª LoadBalancerã€2 ä¸ª NodePort å’Œ 2 ä¸ª StorageClass ä¸º ssd çš„ PVCã€‚</p><table><thead><tr><th style="text-align:left;">pod</th><th style="text-align:left;">Replication Controller</th><th style="text-align:left;">Secret</th><th style="text-align:left;">ConfigMap</th><th style="text-align:left;">PVC</th><th style="text-align:left;">Service</th><th style="text-align:left;">LoadBalancer</th><th style="text-align:left;">NodePort</th><th style="text-align:left;">ssd PVC</th></tr></thead><tbody><tr><td style="text-align:left;">10</td><td style="text-align:left;">5</td><td style="text-align:left;">10</td><td style="text-align:left;">10</td><td style="text-align:left;">4</td><td style="text-align:left;">5</td><td style="text-align:left;">1</td><td style="text-align:left;">2</td><td style="text-align:left;">2</td></tr></tbody></table><ul><li>æŸ¥çœ‹</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl apply  -f quota-count.yaml</span></span>
<span class="line"><span style="color:#B392F0;">resourcequota/count-quota</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe resourcequotas count-quota</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">                                                   </span><span style="color:#9ECBFF;">count-quota</span></span>
<span class="line"><span style="color:#B392F0;">Namespace:</span><span style="color:#E1E4E8;">                                              </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#B392F0;">Resource</span><span style="color:#E1E4E8;">                                                </span><span style="color:#9ECBFF;">Used</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Hard</span></span>
<span class="line"><span style="color:#B392F0;">--------</span><span style="color:#E1E4E8;">                                                </span><span style="color:#79B8FF;">----</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">----</span></span>
<span class="line"><span style="color:#B392F0;">configmaps</span><span style="color:#E1E4E8;">                                              </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolumeclaims</span><span style="color:#E1E4E8;">                                  </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">5</span></span>
<span class="line"><span style="color:#B392F0;">pods</span><span style="color:#E1E4E8;">                                                    </span><span style="color:#79B8FF;">11</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#B392F0;">replicationcontrollers</span><span style="color:#E1E4E8;">                                  </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">5</span></span>
<span class="line"><span style="color:#B392F0;">secrets</span><span style="color:#E1E4E8;">                                                 </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">10</span></span>
<span class="line"><span style="color:#B392F0;">services</span><span style="color:#E1E4E8;">                                                </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">5</span></span>
<span class="line"><span style="color:#B392F0;">services.loadbalancers</span><span style="color:#E1E4E8;">                                  </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#B392F0;">services.nodeports</span><span style="color:#E1E4E8;">                                      </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">2</span></span>
<span class="line"><span style="color:#B392F0;">ssd.storageclass.storage.k8s.io/persistentvolumeclaims</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">2</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl apply  -f quota-count.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">resourcequota/count-quota</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe resourcequotas count-quota</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">                                                   </span><span style="color:#032F62;">count-quota</span></span>
<span class="line"><span style="color:#6F42C1;">Namespace:</span><span style="color:#24292E;">                                              </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#6F42C1;">Resource</span><span style="color:#24292E;">                                                </span><span style="color:#032F62;">Used</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Hard</span></span>
<span class="line"><span style="color:#6F42C1;">--------</span><span style="color:#24292E;">                                                </span><span style="color:#005CC5;">----</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">----</span></span>
<span class="line"><span style="color:#6F42C1;">configmaps</span><span style="color:#24292E;">                                              </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolumeclaims</span><span style="color:#24292E;">                                  </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">5</span></span>
<span class="line"><span style="color:#6F42C1;">pods</span><span style="color:#24292E;">                                                    </span><span style="color:#005CC5;">11</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#6F42C1;">replicationcontrollers</span><span style="color:#24292E;">                                  </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">5</span></span>
<span class="line"><span style="color:#6F42C1;">secrets</span><span style="color:#24292E;">                                                 </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">10</span></span>
<span class="line"><span style="color:#6F42C1;">services</span><span style="color:#24292E;">                                                </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">5</span></span>
<span class="line"><span style="color:#6F42C1;">services.loadbalancers</span><span style="color:#24292E;">                                  </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#6F42C1;">services.nodeports</span><span style="color:#24292E;">                                      </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#6F42C1;">ssd.storageclass.storage.k8s.io/persistentvolumeclaims</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">2</span></span></code></pre></div><h1 id="_6-pod-æœåŠ¡è´¨é‡-qos" tabindex="-1">6.Pod æœåŠ¡è´¨é‡ QoS <a class="header-anchor" href="#_6-pod-æœåŠ¡è´¨é‡-qos" aria-label="Permalink to &quot;6.Pod æœåŠ¡è´¨é‡ QoS&quot;">â€‹</a></h1><p>å®¹å™¨çš„èµ„æºé…ç½®æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li>Requests â‰¤ èŠ‚ç‚¹å¯ç”¨èµ„æº</li><li>Requests â‰¤ Limits</li></ul><h2 id="_6-0-èµ„æº" tabindex="-1">6.0 èµ„æº <a class="header-anchor" href="#_6-0-èµ„æº" aria-label="Permalink to &quot;6.0 èµ„æº&quot;">â€‹</a></h2><h3 id="å¯å‹ç¼©èµ„æº" tabindex="-1">å¯å‹ç¼©èµ„æº <a class="header-anchor" href="#å¯å‹ç¼©èµ„æº" aria-label="Permalink to &quot;å¯å‹ç¼©èµ„æº&quot;">â€‹</a></h3><ul><li>Kubernetes ç›®å‰æ”¯æŒçš„å¯å‹ç¼©èµ„æºæ˜¯ CPUã€‚</li><li>Pod å¯ä»¥å¾—åˆ° Requests é…ç½®çš„ CPU ä½¿ç”¨é‡ï¼Œè€Œèƒ½å¦ä½¿ç”¨è¶…è¿‡ Requests å€¼çš„éƒ¨åˆ†å–å†³äºç³»ç»Ÿçš„è´Ÿè½½å’Œè°ƒåº¦ã€‚</li><li>ç©ºé—²çš„ CPU èµ„æºæŒ‰ç…§å®¹å™¨ Requests å€¼çš„æ¯”ä¾‹åˆ†é…ã€‚æ¯”å¦‚å®¹å™¨ A çš„ CPU é…ç½®ä¸º Requests 1 Limits 10ï¼Œå®¹å™¨ B çš„ CPU é…ç½®ä¸º Requests 2 Limits 8ã€‚åˆå§‹çŠ¶æ€ä¸‹å®¹å™¨å¯ä»¥ç”¨çš„ CPU ä¸º 3coresï¼Œé‚£ä¹ˆ A å’Œ B æ°å¥½å¾—åˆ°å†å…¶ Requests ä¸­å®šä¹‰çš„ CPU ç”¨é‡ï¼Œå³ 1CPU å’Œ 2CPUã€‚å¦‚æœ A å’Œ B éƒ½éœ€è¦æ›´å¤šçš„ CPU èµ„æºï¼Œè€Œæ°å¥½æ­¤æ—¶ç³»ç»Ÿçš„å…¶ä»–ä»»åŠ¡é‡Šæ”¾äº† 1.5CPUï¼Œé‚£ä¹ˆè¿™ 1.5CPU å°†æŒ‰ç…§ A å’Œ B çš„ Requests å€¼çš„æ¯”ä¾‹ 1:2 åˆ†é…ç»™ A å’Œ Bï¼Œå³æœ€ç»ˆ A å¯ä½¿ç”¨ 1.5CPUï¼ŒB å¯ä½¿ç”¨ 3CPUã€‚</li><li>å¦‚æœ Pod çš„ CPU ç”¨æ¥è¶…è¿‡äº†åœ¨ Limits 10 ä¸­é…ç½®çš„ CPU ç”¨é‡ï¼Œé‚£ä¹ˆ cgroups ä¼šå¯¹ Pod ä¸­å®¹å™¨çš„ CPU ç”¨æ¥è¿›è¡Œé™æµï¼ˆThrottledï¼‰ï¼›å¦‚æœ Pod æ²¡æœ‰é…ç½® Limits 10ï¼Œé‚£ä¹ˆ Pod ä¼šå°è¯•æŠ¢å æ‰€æœ‰ç©ºé—´çš„ CPU èµ„æºã€‚</li></ul><h3 id="ä¸å¯å‹ç¼©èµ„æº" tabindex="-1">ä¸å¯å‹ç¼©èµ„æº <a class="header-anchor" href="#ä¸å¯å‹ç¼©èµ„æº" aria-label="Permalink to &quot;ä¸å¯å‹ç¼©èµ„æº&quot;">â€‹</a></h3><ul><li>Kubernetes ç›®å‰æ”¯æŒçš„ä¸å¯å‹ç¼©èµ„æºæ˜¯å†…å­˜ã€‚</li><li>Pod å¯ä»¥å¾—åˆ°åœ¨ Requests ä¸­é…ç½®çš„å†…å­˜ã€‚ <ul><li>å¦‚æœ Pod çš„å†…å­˜ç”¨é‡å°äºå®ƒçš„ Requests çš„é…ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ª Pod å¯ä»¥æ­£å¸¸è¿è¡Œï¼ˆé™¤éå‡ºç°æ“ä½œç³»ç»Ÿçº§åˆ«å†…å­˜ä¸è¶³ç­‰ä¸¥é‡é—®é¢˜ï¼‰ã€‚</li><li>å¦‚æœ Pod çš„å†…å­˜ç”¨é‡è¶…è¿‡å®ƒçš„ Requests çš„é…ç½®ï¼Œé‚£ä¹ˆè¿™ä¸ª Pod æœ‰å¯èƒ½ä¼šè¢« Kubernetes â€œæ€æ‰â€ï¼š <ul><li>æ¯”å¦‚ Pod A ä½¿ç”¨çš„å†…å­˜é‡åœ¨ Requests ~ Limits ä¹‹é—´ï¼ŒåŒä¸€æœºå™¨ä¸Šçš„å¦ä¸€ä¸ª Pod B ä¹‹å‰ä½¿ç”¨çš„å†…å­˜å°äº Requests çš„å€¼ï¼Œæ­¤æ—¶ Pod B å‹åŠ›å¢å¤§ï¼ŒPod B å‘ç³»ç»Ÿç”³è¯·çš„æ€»é‡ä¸è¶…è¿‡è‡ªå·±çš„ Requests å€¼çš„å†…å­˜ï¼Œé‚£ä¹ˆ Pod A å¯èƒ½ä¼šç›´æ¥è¢« Kubernetes â€œæ€æ‰â€ã€‚</li><li>å¦ä¸€ç§æƒ…å†µæ˜¯ Pod A ä½¿ç”¨çš„å†…å­˜é‡åœ¨ Requests ~ Limits ä¹‹é—´ï¼Œæ­¤æ—¶ Kubernetes å°†ä¸€ä¸ªæ–°çš„ Pod è°ƒåº¦åˆ°è¿™å°æœºå™¨ä¸Šï¼Œåªæœ‰ Pod A ä½¿ç”¨é‡è¶…è¿‡è‡ªå·±çš„ Requests å€¼çš„å†…å­˜ï¼Œé‚£ä¹ˆä¹Ÿå¯èƒ½ä¼šç›´æ¥è¢« Kubernetes â€œæ€æ‰â€ã€‚</li></ul></li></ul></li><li>å¦‚æœ Pod çš„å†…å­˜ç”¨é‡è¶…è¿‡å®ƒçš„ Limits å€¼ï¼Œé‚£ä¹ˆæ“ä½œç³»ç»Ÿå†…æ ¸ä¼šâ€œæ€æ‰â€Pod æ‰€æœ‰å®¹å™¨çš„æ‰€æœ‰è¿›ç¨‹ä¸­å†…å­˜ä½¿ç”¨é‡æœ€å¤šçš„ä¸€ä¸ªï¼Œç›´åˆ°å†…å­˜ä¸è¶…è¿‡ Limits æ—¶ä¸ºæ­¢ã€‚</li></ul><h3 id="å¯¹è°ƒåº¦ç­–ç•¥çš„å½±å“" tabindex="-1"><strong>å¯¹è°ƒåº¦ç­–ç•¥çš„å½±å“</strong> <a class="header-anchor" href="#å¯¹è°ƒåº¦ç­–ç•¥çš„å½±å“" aria-label="Permalink to &quot;**å¯¹è°ƒåº¦ç­–ç•¥çš„å½±å“**&quot;">â€‹</a></h3><ul><li>Kubernetes çš„ kube-scheduler é€šè¿‡è®¡ç®— Pod ä¸­æ‰€æœ‰å®¹å™¨çš„ Requests æ€»å’Œæ¥å†³å®šå¯¹ Pod çš„è°ƒåº¦ã€‚</li><li>ä¸ç®¡æ˜¯ CPU è¿˜æ˜¯å†…å­˜ï¼ŒKubernetes è°ƒåº¦å™¨å’Œ kubelet éƒ½ä¼šç¡®ä¿èŠ‚ç‚¹ä¸Šçš„æ‰€æœ‰ Pod çš„ Requests æ€»å’Œä¸ä¼šè¶…è¿‡åœ¨è¯¥èŠ‚ç‚¹ä¸Šå¯åˆ†é…ç»™å®¹å™¨ä½¿ç”¨çš„èµ„æºå®¹é‡ä¸Šé™ã€‚</li></ul><h2 id="_6-1-qos-å®šä¹‰" tabindex="-1">6.1 QoS å®šä¹‰ <a class="header-anchor" href="#_6-1-qos-å®šä¹‰" aria-label="Permalink to &quot;6.1 QoS å®šä¹‰&quot;">â€‹</a></h2><p>QoSï¼ˆQualityofServiceï¼‰ï¼Œå¯è¯‘ä¸º&quot;æœåŠ¡è´¨é‡ç­‰çº§&quot;ï¼Œæˆ–è€…è¯‘ä½œ&quot;æœåŠ¡è´¨é‡ä¿è¯&quot;ï¼Œæ˜¯ä½œç”¨åœ¨ Pod ä¸Šçš„ä¸€ä¸ªé…ç½®ï¼Œå½“</p><p>Kubernetes åˆ›å»ºä¸€ä¸ª Pod æ—¶ï¼Œå®ƒå°±ä¼šç»™è¿™ä¸ª Pod åˆ†é…ä¸€ä¸ª QoS ç­‰çº§ã€‚</p><p>åœ¨ Kubernetes çš„ç¯å¢ƒä¸­ï¼ŒKubernetes å…è®¸èŠ‚ç‚¹çš„ Pod è¿‡è½½ä½¿ç”¨èµ„æºï¼Œè¿™æ„å‘³ç€èŠ‚ç‚¹æ— æ³•åŒæ—¶æ»¡è¶³æ‰€æœ‰ Pod ä»¥è¿‡è½½çš„æ–¹å¼è¿è¡Œã€‚å› æ­¤åœ¨å†…å­˜èµ„æºç´§ç¼ºçš„æƒ…å†µä¸‹ï¼ŒKubernetes éœ€è¦å€ŸåŠ© Pod å¯¹è±¡çš„æœåŠ¡è´¨é‡å’Œä¼˜å…ˆçº§ç­‰å®Œæˆåˆ¤å®šï¼Œè¿›è€ŒæŒ‘é€‰å¯¹åº”çš„ Pod æ€æ­»ã€‚Kubernetes æ ¹æ® pod çš„ Requests å’Œ Limits å±æ€§ï¼ŒæŠŠ Pod å¯¹è±¡å½’ç±»ä¸ºä¸‰ç±»: <code>Guaranteedï¼ˆå®Œå…¨å¯é çš„ï¼‰</code>ã€<code>Burstableï¼ˆå¼¹æ€§æ³¢åŠ¨ã€è¾ƒå¯é çš„ï¼‰</code>å’Œ <code>BestEffort</code>ï¼ˆå°½åŠ›è€Œä¸ºã€ä¸å¤ªå¯é çš„ï¼‰ï¼Œè¿™ä¸‰ç§ä¾æ¬¡é€’å‡çš„ä¼˜å…ˆçº§æ¥å†³å®šä¼˜å…ˆâ€œæ€æ‰â€å“ªäº›å®¹å™¨ã€‚</p><p>ä¼˜å…ˆçº§ï¼ŒGuaranteed &gt; BurStabLe &gt; BestEffort</p><h2 id="_6-2-qos-ç±»åˆ«" tabindex="-1">6.2 QoS ç±»åˆ« <a class="header-anchor" href="#_6-2-qos-ç±»åˆ«" aria-label="Permalink to &quot;6.2 QoS ç±»åˆ«&quot;">â€‹</a></h2><h3 id="guaranteed-å®Œå…¨å¯é çš„" tabindex="-1">Guaranteedï¼ˆå®Œå…¨å¯é çš„ï¼‰ <a class="header-anchor" href="#guaranteed-å®Œå…¨å¯é çš„" aria-label="Permalink to &quot;Guaranteedï¼ˆå®Œå…¨å¯é çš„ï¼‰&quot;">â€‹</a></h3><p>å¦‚æœ Pod ä¸­çš„æ‰€æœ‰å®¹å™¨å¯¹æ‰€æœ‰èµ„æºç±»å‹éƒ½å®šä¹‰äº† Limits å’Œ Requestsï¼Œå¹¶ä¸”æ‰€æœ‰å®¹å™¨çš„ Limits å€¼éƒ½å’Œ Requests å€¼ç›¸ç­‰ï¼ˆä¸”éƒ½ä¸ä¸º 0ï¼‰ï¼Œé‚£ä¹ˆè¯¥ Pod çš„ QoS çº§åˆ«å°±æ˜¯ Guaranteedã€‚</p><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå®¹å™¨å¯ä»¥ä¸å®šä¹‰ Requestsï¼Œå› ä¸º Requests å€¼åœ¨æœªå®šä¹‰æ—¶é»˜è®¤ç­‰äº Limitsã€‚</p></div><h3 id="burstable-å¼¹æ€§æ³¢åŠ¨ã€è¾ƒå¯é çš„" tabindex="-1">Burstableï¼ˆå¼¹æ€§æ³¢åŠ¨ã€è¾ƒå¯é çš„ï¼‰ <a class="header-anchor" href="#burstable-å¼¹æ€§æ³¢åŠ¨ã€è¾ƒå¯é çš„" aria-label="Permalink to &quot;Burstableï¼ˆå¼¹æ€§æ³¢åŠ¨ã€è¾ƒå¯é çš„ï¼‰&quot;">â€‹</a></h3><p>Burstable çº§åˆ«çš„ Pod æ¶‰åŠä¸¤ç§æƒ…å†µï¼š</p><ol><li>Pod ä¸­çš„ä¸€éƒ¨åˆ†å®¹å™¨åœ¨ä¸€ç§æˆ–å¤šç§ç±»å‹çš„èµ„æºé…ç½®ä¸­å®šä¹‰äº† Requests å€¼å’Œ Limits å€¼ï¼ˆéƒ½ä¸ä¸º 0ï¼‰ï¼Œä¸” Requests å€¼å°äº Limits å€¼ã€‚</li><li>Pod ä¸­çš„ä¸€éƒ¨åˆ†å®¹å™¨æœªå®šä¹‰èµ„æºé…ç½®ï¼ˆRequests å’Œ Limits éƒ½æœªå®šä¹‰ï¼‰ã€‚</li></ol><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>å®¹å™¨æœªå®šä¹‰ Limits æ—¶ï¼ŒLimits å€¼é»˜è®¤ç­‰äºèŠ‚ç‚¹èµ„æºå®¹é‡çš„ä¸Šé™ã€‚</p></div><h3 id="besteffort-å°½åŠ›è€Œä¸ºã€ä¸å¤ªå¯é çš„" tabindex="-1">BestEffortï¼ˆå°½åŠ›è€Œä¸ºã€ä¸å¤ªå¯é çš„ï¼‰ <a class="header-anchor" href="#besteffort-å°½åŠ›è€Œä¸ºã€ä¸å¤ªå¯é çš„" aria-label="Permalink to &quot;BestEffortï¼ˆå°½åŠ›è€Œä¸ºã€ä¸å¤ªå¯é çš„ï¼‰&quot;">â€‹</a></h3><p>å¦‚æœ Pod ä¸­æ‰€æœ‰å®¹å™¨éƒ½æœªå®šä¹‰èµ„æºé…ç½®ï¼ˆRequests å’Œ Limits éƒ½æœªå®šä¹‰ï¼‰ï¼Œé‚£ä¹ˆè¯¥ Pod çš„ QoS çº§åˆ«å°±æ˜¯ BestEffortã€‚</p><p>å½“ Kubernetes é›†ç¾¤å†…å­˜èµ„æºç´§ç¼ºï¼Œä¼˜å…ˆæ€æ­» BestEffort ç±»åˆ«çš„å®¹å™¨ï¼Œå› ä¸ºç³»ç»Ÿä¸ä¸ºè¯¥ç±»èµ„æºæä¾›ä»»ä½•æœåŠ¡ä¿è¯ï¼Œä½†æ­¤ç±»èµ„æºæœ€â¼¤çš„å¥½å¤„å°±æ˜¯èƒ½å¤Ÿå°½å¯èƒ½çš„ä½¿â½¤èµ„æº.</p><p>å¦‚æœç³»ç»Ÿä¸­æ²¡æœ‰ BestEffort ç±»åˆ«çš„å®¹å™¨ï¼Œæ¥ä¸‹æ¥å°±è½®åˆ° Burstable ç±»åˆ«çš„å®¹å™¨ï¼Œå¦‚æœæœ‰å¤šä¸ª Burstable ç±»åˆ«çš„å®¹å™¨ï¼Œå°±çœ‹è°çš„å†…å­˜èµ„æºå â½¤å¤šï¼Œå°±ä¼˜å…ˆâ¼²æ‰è°ã€‚â½å¦‚ A å®¹å™¨ç”³è¯· 1G å†…å­˜èµ„æºï¼Œå®é™…ä½¿â½¤äº† 95%ï¼Œâ½½ B å®¹å™¨ç”³è¯·äº† 2G å†…å­˜èµ„æºï¼Œå®é™…ä½¿â½¤äº† 80%ï¼Œä½†ä»»ç„¶ä¼šä¼˜å…ˆâ¼²æ‰ A å®¹å™¨ï¼Œè™½ç„¶ A å®¹å™¨çš„â½¤é‡å°‘ï¼Œä½†ä¸â¾ƒèº«çš„ Requests å€¼ç›¸â½ï¼Œå®ƒçš„å â½è¦â¼¤äº B å®¹å™¨ã€‚</p><p>å¯¹äº Guaranteed ç±»åˆ«çš„å®¹å™¨æ‹¥æœ‰æœ€é«˜ä¼˜å…ˆçº§ï¼Œå®ƒä»¬ä¸ä¼šè¢«æ€æ­»ï¼Œé™¤éå…¶å†…å­˜èµ„æºéœ€æ±‚è¶…é™ï¼Œæˆ–è€… 00M æ—¶æ²¡æœ‰å…¶ä»–æ›´ä½ä¼˜å…ˆçº§çš„ Pod å¯¹è±¡å­˜åœ¨ï¼Œæ‰ä¼šå¹²æ‰ Guaranteed ç±»å®¹å™¨.</p><h2 id="_6-3-qos-çš„å·¥ä½œç‰¹ç‚¹" tabindex="-1">6.3 QoS çš„å·¥ä½œç‰¹ç‚¹ <a class="header-anchor" href="#_6-3-qos-çš„å·¥ä½œç‰¹ç‚¹" aria-label="Permalink to &quot;6.3 QoS çš„å·¥ä½œç‰¹ç‚¹&quot;">â€‹</a></h2><p>åœ¨ Pod çš„ CPU Requests æ— æ³•å¾—åˆ°æ»¡è¶³ï¼ˆæ¯”å¦‚èŠ‚ç‚¹çš„ç³»ç»Ÿä»»åŠ¡å ç”¨è¿‡å¤šçš„ CPU å¯¼è‡´æ— æ³•åˆ†é…è¶³å¤Ÿçš„ CPU ç»™å®¹å™¨ä½¿ç”¨ï¼‰æ—¶ï¼Œå®¹å™¨å¾—åˆ°çš„ CPU ä¼šè¢«é™æµ</p><p>ç”±äºå†…å­˜æ˜¯ä¸å¯å‹ç¼©çš„èµ„æºï¼Œæ‰€ä»¥é’ˆå¯¹å†…å­˜èµ„æºç´§ç¼ºçš„æƒ…å†µï¼Œä¼šæŒ‰ç…§ä»¥ä¸‹é€»è¾‘å¤„ç†ï¼š</p><ol><li>BestEffort Pod çš„ä¼˜å…ˆçº§æœ€ä½ï¼Œåœ¨è¿™ç±» Pod ä¸­è¿è¡Œçš„è¿›ç¨‹ä¼šåœ¨ç³»ç»Ÿå†…å­˜ç´§ç¼ºæ—¶è¢«ç¬¬ä¸€ä¼˜å…ˆâ€œæ€æ‰â€ã€‚ä»å¦ä¸€ä¸ªè§’åº¦çœ‹ï¼Œç”±äºæ²¡æœ‰è®¾ç½®èµ„æº Limitsï¼Œæ‰€ä»¥åœ¨èµ„æºå……è¶³æ—¶å®ƒä»¬å¯ä»¥å……åˆ†åˆ©ç”¨æ‰€æœ‰é—²ç½®èµ„æºã€‚</li><li>Burstable Pod çš„ä¼˜å…ˆçº§å±…ä¸­ï¼Œè¿™ç±» Pod åœ¨åˆå§‹æ—¶ä¼šè¢«åˆ†é…è¾ƒå°‘çš„å¯é èµ„æºï¼Œä½†å¯ä»¥æŒ‰éœ€ç”³è¯·æ›´å¤šèµ„æºã€‚å¦‚æœæ•´ä¸ªç³»ç»Ÿå†…å­˜ç´§ç¼ºï¼Œåˆæ²¡æœ‰ BestEffort å®¹å™¨å¯ä»¥è¢«â€œæ€æ‰â€ä»¥é‡Šæ”¾èµ„æºï¼Œé‚£ä¹ˆè¿™ç±» Pod ä¸­çš„è¿›ç¨‹å¯èƒ½ä¼šè¢«â€œæ€æ‰â€ã€‚</li><li>Guaranteed Pod çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œè€Œä¸”ä¸€èˆ¬æƒ…å†µä¸‹è¿™ç±» Pod åªè¦ä¸è¶…è¿‡å…¶èµ„æº Limits çš„é™åˆ¶å°±ä¸ä¼šè¢«â€œæ€æ‰â€ã€‚å¦‚æœæ•´ä¸ªç³»ç»Ÿå†…å­˜ç´§ç¼ºï¼Œåˆæ²¡æœ‰å…¶ä»–ä¼˜å…ˆçº§æ›´ä½çš„å®¹å™¨å¯ä»¥è¢«â€œæ€æ‰â€ä»¥é‡Šæ”¾èµ„æºï¼Œé‚£ä¹ˆè¿™ç±» Pod ä¸­çš„è¿›ç¨‹ä¹Ÿå¯èƒ½ä¼šè¢«â€œæ€æ‰â€ã€‚</li></ol><h2 id="_6-4-oom-è®¡åˆ†è§„åˆ™" tabindex="-1">6.4 OOM è®¡åˆ†è§„åˆ™ <a class="header-anchor" href="#_6-4-oom-è®¡åˆ†è§„åˆ™" aria-label="Permalink to &quot;6.4 OOM è®¡åˆ†è§„åˆ™&quot;">â€‹</a></h2><p>OOMï¼ˆOut Of Memoryï¼‰è®¡åˆ†è§„åˆ™åŒ…æ‹¬å¦‚ä¸‹å†…å®¹ï¼š</p><ul><li>OOM è®¡åˆ†çš„è®¡ç®—æ–¹æ³•ï¼šè®¡ç®—è¿›ç¨‹æ‰€ä½¿ç”¨çš„å†…å­˜åœ¨ç³»ç»Ÿä¸­æ‰€å çš„ç™¾åˆ†æ¯”ï¼Œå–å…¶ä¸­ä¸å«ç™¾åˆ†å·çš„æ•°å€¼ï¼Œå†ä¹˜ä»¥ 10ï¼Œè¯¥ç»“æœæ˜¯è¿›ç¨‹ OOM çš„åŸºç¡€åˆ†ï¼›å°†è¿›ç¨‹ OOM åŸºç¡€åˆ†çš„åˆ†å€¼å†åŠ ä¸Šè¿™ä¸ªè¿›ç¨‹ OOM_SCORE_ADJï¼ˆåˆ†æ•°è°ƒæ•´ï¼‰å€¼ï¼Œä½œä¸ºè¿›ç¨‹ OOM çš„æœ€ç»ˆåˆ†å€¼ï¼ˆé™¤ root å¯åŠ¨çš„è¿›ç¨‹å¤–ï¼‰ã€‚åœ¨ç³»ç»Ÿå‘ç”Ÿ OOM æ—¶ï¼ŒOOM Killer ä¼šä¼˜å…ˆâ€œæ€æ‰â€OOM è®¡åˆ†æ›´é«˜çš„è¿›ç¨‹ã€‚</li><li>è¿›ç¨‹çš„ OOM è®¡åˆ†çš„åŸºæœ¬åˆ†æ•°èŒƒå›´æ˜¯ 0 ~ 1000ï¼Œå¦‚æœ A è¿›ç¨‹çš„è°ƒæ•´å€¼ OOM_SCORE_ADJ å‡å» B è¿›ç¨‹çš„è°ƒæ•´å€¼çš„ç»“æœå¤§äº 1000ï¼Œé‚£ä¹ˆ A è¿›ç¨‹çš„ OOM è®¡åˆ†æœ€ç»ˆå€¼å¿…ç„¶å¤§äº B è¿›ç¨‹ï¼Œä¼šä¼˜å…ˆâ€œæ€æ‰â€A è¿›ç¨‹ã€‚</li><li>ä¸è®ºè°ƒæ•´ OOM_SCORE_ADJ å€¼ä¸ºå¤šå°‘ï¼Œä»»ä½•è¿›ç¨‹çš„æœ€ç»ˆåˆ†å€¼èŒƒå›´ä¹Ÿæ˜¯ 0 ~ 1000ã€‚</li></ul><p>åœ¨ Kubernetes ä¸­ï¼Œä¸åŒ QoS çš„ OOM è®¡åˆ†è°ƒæ•´å€¼å¦‚è¡¨æ‰€ç¤ºï¼š</p><table><thead><tr><th>QoS</th><th>oom_score_adj</th></tr></thead><tbody><tr><td>Guaranteed</td><td>-998</td></tr><tr><td>BestEffort</td><td>1000</td></tr><tr><td>Burstable</td><td>min(max(2, 1000 - (1000 * memoryRequestBytes) / machineMemoryCapacityBytes), 999)</td></tr></tbody></table><h3 id="é©±é€" tabindex="-1">é©±é€ <a class="header-anchor" href="#é©±é€" aria-label="Permalink to &quot;é©±é€&quot;">â€‹</a></h3><p>å…·ä½“åœ°è¯´ï¼Œå½“ Kubernetes æ‰€ç®¡ç†çš„å®¿ä¸»æœºä¸Šä¸å¯å‹ç¼©èµ„æºçŸ­ç¼ºæ—¶ï¼Œå°±æœ‰å¯èƒ½è§¦å‘ Eviction é©±é€ã€‚ç›®å‰ï¼ŒKubernetes ä¸ºä½ è®¾ç½®çš„ Eviction çš„é»˜è®¤é˜ˆå€¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">memory.available&lt;100Mi</span></span>
<span class="line"><span style="color:#e1e4e8;">nodefs.available&lt;10%</span></span>
<span class="line"><span style="color:#e1e4e8;">nodefs.inodesFree&lt;5%</span></span>
<span class="line"><span style="color:#e1e4e8;">imagefs.available&lt;15%</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">memory.available&lt;100Mi</span></span>
<span class="line"><span style="color:#24292e;">nodefs.available&lt;10%</span></span>
<span class="line"><span style="color:#24292e;">nodefs.inodesFree&lt;5%</span></span>
<span class="line"><span style="color:#24292e;">imagefs.available&lt;15%</span></span></code></pre></div><p>å½“å®¿ä¸»æœºçš„ Eviction é˜ˆå€¼è¾¾åˆ°åï¼Œå°±ä¼šè¿›å…¥ MemoryPressure æˆ–è€… DiskPressure çŠ¶æ€ï¼Œä»è€Œé¿å…æ–°çš„ Pod è¢«è°ƒåº¦åˆ°è¿™å°å®¿ä¸»æœºä¸Šï¼Œç„¶å kubelet ä¼šæ ¹æ® QoS çš„çº§åˆ«æ¥æŒ‘é€‰ Pod è¿›è¡Œé©±é€ï¼Œ</p><p>å…·ä½“é©±é€ä¼˜å…ˆçº§æ˜¯ï¼šBestEffort -&gt; Burstable -&gt; Guaranteedã€‚</p><p>QoS çš„çº§åˆ«æ˜¯é€šè¿‡ Linux å†…æ ¸ OOM åˆ†æ•°å€¼æ¥å®ç°çš„ï¼ŒOOM åˆ†æ•°å€¼å–å€¼èŒƒå›´åœ¨-1000 ~1000 ä¹‹é—´ã€‚åœ¨ Kubernetes ä¸­ï¼Œå¸¸ç”¨æœåŠ¡çš„ OOM çš„åˆ†å€¼å¦‚ä¸‹ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">-1000  =&gt; sshdç­‰è¿›ç¨‹ </span></span>
<span class="line"><span style="color:#e1e4e8;">-999   =&gt; Kubernetes ç®¡ç†è¿›ç¨‹</span></span>
<span class="line"><span style="color:#e1e4e8;">-998   =&gt; Guaranteed Pod</span></span>
<span class="line"><span style="color:#e1e4e8;">0      =&gt; å…¶ä»–è¿›ç¨‹ 0</span></span>
<span class="line"><span style="color:#e1e4e8;">2~999  =&gt; Burstable Pod  </span></span>
<span class="line"><span style="color:#e1e4e8;">1000   =&gt; BestEffort Pod</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">-1000  =&gt; sshdç­‰è¿›ç¨‹ </span></span>
<span class="line"><span style="color:#24292e;">-999   =&gt; Kubernetes ç®¡ç†è¿›ç¨‹</span></span>
<span class="line"><span style="color:#24292e;">-998   =&gt; Guaranteed Pod</span></span>
<span class="line"><span style="color:#24292e;">0      =&gt; å…¶ä»–è¿›ç¨‹ 0</span></span>
<span class="line"><span style="color:#24292e;">2~999  =&gt; Burstable Pod  </span></span>
<span class="line"><span style="color:#24292e;">1000   =&gt; BestEffort Pod</span></span></code></pre></div><p>OOM åˆ†æ•°è¶Šé«˜ï¼Œå°±ä»£è¡¨è¿™ä¸ª Pod çš„ä¼˜å…ˆçº§è¶Šä½ï¼Œåœ¨å‡ºç°èµ„æºç«äº‰çš„æ—¶å€™ï¼Œå°±è¶Šæ—©è¢«æ€æ‰ï¼Œåˆ†æ•°ä¸º-999 å’Œ-1000 çš„è¿›ç¨‹æ°¸è¿œä¸ä¼šå› ä¸º OOM è€Œè¢«æ€æ‰ã€‚</p><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>å¦‚æœæœŸæœ› Pod å°½å¯èƒ½çš„ä¸è¢«é©±é€ï¼Œå°±åº”å½“æŠŠ Pod é‡Œçš„æ¯ä¸€ä¸ª Container çš„ requests å’Œ limits éƒ½è®¾ç½®é½å…¨ï¼Œå¹¶ä¸” requests å’Œ limits å€¼è¦ç›¸ç­‰ã€‚</p></div><h2 id="_6-5-æ¡ˆä¾‹" tabindex="-1">6.5 æ¡ˆä¾‹ <a class="header-anchor" href="#_6-5-æ¡ˆä¾‹" aria-label="Permalink to &quot;6.5 æ¡ˆä¾‹&quot;">â€‹</a></h2><h3 id="åˆ›å»º-guaranteed-çš„-pod" tabindex="-1">åˆ›å»º Guaranteed çš„ Pod <a class="header-anchor" href="#åˆ›å»º-guaranteed-çš„-pod" aria-label="Permalink to &quot;åˆ›å»º Guaranteed çš„ Pod&quot;">â€‹</a></h3><p>å¯¹äº QoS ç±»ä¸º Guaranteed çš„ Pod</p><ul><li><p>Pod ä¸­çš„æ¯ä¸ªå®¹å™¨éƒ½å¿…é¡»æŒ‡å®šå†…å­˜è¯·æ±‚å’Œå†…å­˜é™åˆ¶ï¼Œä¸” Pod ä¸­æ¯ä¸ªå®¹å™¨å†…å­˜è¯·æ±‚å¿…é¡»ç­‰äºå†…å­˜é™åˆ¶</p></li><li><p>Pod ä¸­çš„æ¯ä¸ªå®¹å™¨éƒ½å¿…é¡»æŒ‡å®š CPU è¯·æ±‚å’Œ CPU é™åˆ¶ï¼Œä¸” Pod ä¸­æ¯ä¸ªå®¹å™¨ CPU è¯·æ±‚å¿…é¡»ç­‰äº CPU é™åˆ¶</p><p>1.åˆ›å»ºâ¼€ä¸ª Podï¼Œå®¹å™¨è®¾ç½®äº†å†…å­˜è¯·æ±‚å’Œå†…å­˜é™åˆ¶ï¼Œå€¼éƒ½æ˜¯ 200MiBã€‚å®¹å™¨è®¾ç½®äº† CPU è¯·æ±‚å’Œ CPU é™åˆ¶ï¼Œå€¼éƒ½æ˜¯ 700 milliCPU.</p></li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">cat pod-qos-guaranteed.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-qos-guaranteed</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;500m&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;128Mi&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;500m&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;128Mi&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">cat pod-qos-guaranteed.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-qos-guaranteed</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;500m&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;128Mi&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;500m&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;128Mi&quot;</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# kubectl describe pod pod-qos-guaranteed</span></span>
<span class="line"><span style="color:#B392F0;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Limits:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">cpu:</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">memory:</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">128</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Requests:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">cpu:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">memory:</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">128</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"><span style="color:#B392F0;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#B392F0;">QoS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Class:</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">Guaranteed</span></span>
<span class="line"><span style="color:#B392F0;">ã€‚ã€‚ã€‚</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# kubectl describe pod pod-qos-guaranteed</span></span>
<span class="line"><span style="color:#6F42C1;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Limits:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">cpu:</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">m</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">memory:</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">128</span><span style="color:#032F62;">Mi</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Requests:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">cpu:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">m</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">memory:</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">128</span><span style="color:#032F62;">Mi</span></span>
<span class="line"><span style="color:#6F42C1;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#6F42C1;">QoS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Class:</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">Guaranteed</span></span>
<span class="line"><span style="color:#6F42C1;">ã€‚ã€‚ã€‚</span></span></code></pre></div><h3 id="åˆ›å»º-burstable-çš„-pod" tabindex="-1">åˆ›å»º Burstable çš„ Pod <a class="header-anchor" href="#åˆ›å»º-burstable-çš„-pod" aria-label="Permalink to &quot;åˆ›å»º Burstable çš„ Pod&quot;">â€‹</a></h3><p>å¦‚æœæ»¡â¾œä¸‹â¾¯æ¡ä»¶ï¼Œå°†ä¼šæŒ‡å®š Pod çš„ QoS ç±»ä¸º Burstableï¼š</p><ul><li><p>Pod ä¸ç¬¦åˆ Guaranteed QoS ç±»çš„æ ‡å‡†</p></li><li><p>Pod ä¸­â¾„å°‘â¼€ä¸ªå®¹å™¨æŒ‡å®šäº†ï¼Œå†…å­˜æˆ– CPU çš„è¯·æ±‚æˆ–é™åˆ¶</p><p>1.åˆ›å»ºâ¼€ä¸ª Podï¼Œå®¹å™¨è®¾ç½®äº†å†…å­˜è¯·æ±‚ 100 MiBï¼Œä»¥åŠå†…å­˜é™åˆ¶ 200MiB</p></li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">cat pod-qos-burstable.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-qos-burstable</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;128Mi&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;128Mi&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">cat pod-qos-burstable.yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-qos-burstable</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;128Mi&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;128Mi&quot;</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe pod pod-qos-burstable</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Limits:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">cpu:</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">memory:</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">128</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Requests:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">cpu:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">500</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">memory:</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">128</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"><span style="color:#B392F0;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#B392F0;">QoS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Class:</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">Burstable</span></span>
<span class="line"><span style="color:#B392F0;">ã€‚ã€‚ã€‚</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe pod pod-qos-burstable</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Limits:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">cpu:</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">m</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">memory:</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">128</span><span style="color:#032F62;">Mi</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Requests:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">cpu:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">500</span><span style="color:#032F62;">m</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">memory:</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">128</span><span style="color:#032F62;">Mi</span></span>
<span class="line"><span style="color:#6F42C1;">ã€‚ã€‚ã€‚</span></span>
<span class="line"><span style="color:#6F42C1;">QoS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Class:</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">Burstable</span></span>
<span class="line"><span style="color:#6F42C1;">ã€‚ã€‚ã€‚</span></span></code></pre></div><h3 id="åˆ›å»º-besteffort-çš„-pod" tabindex="-1">åˆ›å»º BestEffort çš„ Pod <a class="header-anchor" href="#åˆ›å»º-besteffort-çš„-pod" aria-label="Permalink to &quot;åˆ›å»º BestEffort çš„ Pod&quot;">â€‹</a></h3><p>å¯¹äº QoS ç±»ä¸º BestEffort çš„ Podï¼ŒPod ä¸­çš„å®¹å™¨å¿…é¡» <code>æ²¡æœ‰è®¾ç½®å†…å­˜å’Œ CPU é™åˆ¶æˆ–è¯·æ±‚</code></p><p>1.åˆ›å»ºâ¼€ä¸ª Podï¼Œå®¹å™¨æ²¡æœ‰è®¾ç½®å†…å­˜å’Œ CPU é™åˆ¶æˆ–è¯·æ±‚</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master yaml</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat pod-qos-besteffort.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-qos-besteffort</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master yaml</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat pod-qos-besteffort.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-qos-besteffort</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe pod pod-qos-besteffort</span></span>
<span class="line"><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#B392F0;">QoS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Class:</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">BestEffort</span></span>
<span class="line"><span style="color:#79B8FF;">...</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe pod pod-qos-besteffort</span></span>
<span class="line"><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#6F42C1;">QoS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Class:</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">BestEffort</span></span>
<span class="line"><span style="color:#005CC5;">...</span></span></code></pre></div><h3 id="åˆ›å»ºå¤šå®¹å™¨-pod" tabindex="-1">åˆ›å»ºå¤šå®¹å™¨ Pod <a class="header-anchor" href="#åˆ›å»ºå¤šå®¹å™¨-pod" aria-label="Permalink to &quot;åˆ›å»ºå¤šå®¹å™¨ Pod&quot;">â€‹</a></h3><p>1.åˆ›å»ºâ¼€ä¸ª Podï¼Œâ¼€ä¸ªå®¹å™¨æŒ‡å®šäº†å†…å­˜è¯·æ±‚ 200 MiBã€‚ å¦å¤–â¼€ä¸ªå®¹å™¨æ²¡æœ‰æŒ‡å®šä»»ä½•è¯·æ±‚å’Œé™åˆ¶ã€‚æ­¤ Pod æ»¡â¾œ Burstable QoS ç±»çš„æ ‡å‡†ã€‚ä½†å®ƒä¸æ»¡â¾œ Guaranteed QoS ç±»æ ‡å‡†ï¼Œå› ä¸ºå®ƒçš„â¼€ä¸ªå®¹å™¨è®¾æœ‰å†…å­˜è¯·æ±‚</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-qos-mutil</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;100Mi&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis:latest</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-qos-mutil</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;100Mi&#39;</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis:latest</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe pod pod-qos-mutil</span></span>
<span class="line"><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Limits:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">memory:</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">100</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Requests:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#B392F0;">memory:</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">100</span><span style="color:#9ECBFF;">Mi</span></span>
<span class="line"><span style="color:#79B8FF;">...</span></span>
<span class="line"><span style="color:#B392F0;">QoS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Class:</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">Burstable</span></span>
<span class="line"><span style="color:#79B8FF;">...</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe pod pod-qos-mutil</span></span>
<span class="line"><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Limits:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">memory:</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">100</span><span style="color:#032F62;">Mi</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Requests:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6F42C1;">memory:</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">100</span><span style="color:#032F62;">Mi</span></span>
<span class="line"><span style="color:#005CC5;">...</span></span>
<span class="line"><span style="color:#6F42C1;">QoS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Class:</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">Burstable</span></span>
<span class="line"><span style="color:#005CC5;">...</span></span></code></pre></div><h2 id="_6-6-resourcequota-å’Œ-limitrange-å®è·µ" tabindex="-1">6.6 ResourceQuota å’Œ LimitRange å®è·µ <a class="header-anchor" href="#_6-6-resourcequota-å’Œ-limitrange-å®è·µ" aria-label="Permalink to &quot;6.6 ResourceQuota å’Œ LimitRange å®è·µ&quot;">â€‹</a></h2><p>æ ¹æ®é›†ç¾¤ç”¨æˆ·æ•°é‡æ¥è°ƒæ•´é›†ç¾¤é…ç½®ï¼Œä»¥è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼šèƒ½æ§åˆ¶ç‰¹å®šå‘½åç©ºé—´ä¸­çš„èµ„æºä½¿ç”¨é‡ï¼Œæœ€ç»ˆå®ç°é›†ç¾¤çš„å…¬å¹³ä½¿ç”¨å’Œæˆæœ¬æ§åˆ¶ã€‚</p><p>éœ€è¦å®ç°çš„åŠŸèƒ½å¦‚ä¸‹ï¼š</p><ul><li>é™åˆ¶è¿è¡ŒçŠ¶æ€çš„ Pod çš„è®¡ç®—èµ„æºç”¨é‡ã€‚</li><li>é™åˆ¶æŒä¹…å·çš„æ•°é‡ä»¥æ§åˆ¶å¯¹å­˜å‚¨çš„è®¿é—®ã€‚</li><li>é™åˆ¶è´Ÿè½½å‡è¡¡å™¨çš„æ•°é‡ä»¥æ§åˆ¶æˆæœ¬ã€‚</li><li>é˜²æ­¢æ»¥ç”¨ç½‘ç»œç«¯å£è¿™ç±»ç¨€ç¼ºèµ„æºã€‚</li><li>æä¾›é»˜è®¤çš„è®¡ç®—èµ„æº Requests ä»¥ä¾¿ç³»ç»Ÿåšå‡ºæ›´ä¼˜åŒ–çš„è°ƒåº¦ã€‚</li></ul><h3 id="_1-åˆ›å»ºå‘½åç©ºé—´" tabindex="-1"><strong>1. åˆ›å»ºå‘½åç©ºé—´</strong> <a class="header-anchor" href="#_1-åˆ›å»ºå‘½åç©ºé—´" aria-label="Permalink to &quot;**1. åˆ›å»ºå‘½åç©ºé—´**&quot;">â€‹</a></h3><p>åˆ›å»ºåä¸º quota-example çš„å‘½åç©ºé—´ï¼Œnamespace.yaml æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Namespace</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Namespace</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">quota-example</span></span></code></pre></div><ul><li>åˆ›å»º</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl create -f namespace.yaml</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#e1e4e8;">kubectl get namespaces | grep -v &#39;kube&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl create -f namespace.yaml</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#24292e;">kubectl get namespaces | grep -v &#39;kube&#39;</span></span></code></pre></div><h3 id="_2-è®¾ç½®é™å®šå¯¹è±¡æ•°é‡çš„èµ„æºé…é¢" tabindex="-1"><strong>2.è®¾ç½®é™å®šå¯¹è±¡æ•°é‡çš„èµ„æºé…é¢</strong> <a class="header-anchor" href="#_2-è®¾ç½®é™å®šå¯¹è±¡æ•°é‡çš„èµ„æºé…é¢" aria-label="Permalink to &quot;**2.è®¾ç½®é™å®šå¯¹è±¡æ•°é‡çš„èµ„æºé…é¢**&quot;">â€‹</a></h3><p>é€šè¿‡è®¾ç½®é™å®šå¯¹æ•°é‡çš„èµ„æºé…é¢ï¼Œå¯ä»¥æ§åˆ¶æŒä¹…å­˜å‚¨å·ã€è´Ÿè½½å‡è¡¡å™¨ã€NodePort è¿™äº›èµ„æºçš„æ•°é‡ã€‚ åˆ›å»ºåä¸º object-counts çš„ ResourceQuotaï¼Œobject-counts.yaml æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ResourceQuota</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">object-counts</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">hard</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">persistentvolumeclaims</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">services.loadbalancers</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">services.nodeports</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;0&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">ResourceQuota</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">object-counts</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">hard</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">persistentvolumeclaims</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">services.loadbalancers</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">services.nodeports</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;0&quot;</span></span></code></pre></div><ul><li>åˆ›å»º</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl create -f object-counts.yaml --namespace=quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl create -f object-counts.yaml --namespace=quota-example</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl describe quota object-counts --namespace=quota-example</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">Name:                   object-counts</span></span>
<span class="line"><span style="color:#e1e4e8;">Namespace:              quota-example</span></span>
<span class="line"><span style="color:#e1e4e8;">Resource                Used  Hard</span></span>
<span class="line"><span style="color:#e1e4e8;">--------                ----  ----</span></span>
<span class="line"><span style="color:#e1e4e8;">persistentvolumeclaims  0     2</span></span>
<span class="line"><span style="color:#e1e4e8;">services.loadbalancers  0     2</span></span>
<span class="line"><span style="color:#e1e4e8;">services.nodeports      0     0</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl describe quota object-counts --namespace=quota-example</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">Name:                   object-counts</span></span>
<span class="line"><span style="color:#24292e;">Namespace:              quota-example</span></span>
<span class="line"><span style="color:#24292e;">Resource                Used  Hard</span></span>
<span class="line"><span style="color:#24292e;">--------                ----  ----</span></span>
<span class="line"><span style="color:#24292e;">persistentvolumeclaims  0     2</span></span>
<span class="line"><span style="color:#24292e;">services.loadbalancers  0     2</span></span>
<span class="line"><span style="color:#24292e;">services.nodeports      0     0</span></span></code></pre></div><p>è‡³æ­¤ï¼Œé…é¢ç³»ç»Ÿä¼šè‡ªåŠ¨é˜»æ­¢é‚£äº›ä½¿èµ„æºç”¨é‡è¶…è¿‡èµ„æºé…é¢é™å®šå€¼çš„è¯·æ±‚</p><h3 id="_3-è®¾ç½®é™å®šè®¡ç®—èµ„æºçš„èµ„æºé…é¢" tabindex="-1"><strong>3. è®¾ç½®é™å®šè®¡ç®—èµ„æºçš„èµ„æºé…é¢</strong>* <a class="header-anchor" href="#_3-è®¾ç½®é™å®šè®¡ç®—èµ„æºçš„èµ„æºé…é¢" aria-label="Permalink to &quot;**3. è®¾ç½®é™å®šè®¡ç®—èµ„æºçš„èµ„æºé…é¢***&quot;">â€‹</a></h3><p>åˆ›å»ºä¸€é¡¹é™å®šè®¡ç®—èµ„æºçš„èµ„æºé…é¢ï¼Œä»¥é™åˆ¶è¯¥å‘½åç©ºé—´ä¸­è®¡ç®—èµ„æºçš„ä½¿ç”¨æ€»é‡ã€‚</p><p>åˆ›å»ºåä¸º compute-resources çš„ ResourceQuotaï¼Œcompute-resources.yaml æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">ResourceQuota</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">compute-resources</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">hard</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">pods</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;4&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests.cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests.memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">limits.cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">limits.memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">2Gi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">ResourceQuota</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">compute-resources</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">hard</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">pods</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;4&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests.cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests.memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Gi</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">limits.cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;2&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">limits.memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">2Gi</span></span></code></pre></div><ul><li>åˆ›å»º</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl create -f compute-resources.yaml --namespace=quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl create -f compute-resources.yaml --namespace=quota-example</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">describe</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">quota</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">compute-resources</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--namespace=quota-example</span><span style="color:#E1E4E8;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">compute-resources</span></span>
<span class="line"><span style="color:#B392F0;">Namespace:</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">quota-example</span></span>
<span class="line"><span style="color:#B392F0;">Resource</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">Used</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Hard</span></span>
<span class="line"><span style="color:#B392F0;">--------</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">----</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">----</span></span>
<span class="line"><span style="color:#B392F0;">limits.cpu</span><span style="color:#E1E4E8;">       </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">2</span></span>
<span class="line"><span style="color:#B392F0;">limits.memory</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">Gi</span></span>
<span class="line"><span style="color:#B392F0;">pods</span><span style="color:#E1E4E8;">             </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">4</span></span>
<span class="line"><span style="color:#B392F0;">requests.cpu</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#B392F0;">requests.memory</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">Gi</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">describe</span><span style="color:#24292E;"> </span><span style="color:#032F62;">quota</span><span style="color:#24292E;"> </span><span style="color:#032F62;">compute-resources</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--namespace=quota-example</span><span style="color:#24292E;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">            </span><span style="color:#032F62;">compute-resources</span></span>
<span class="line"><span style="color:#6F42C1;">Namespace:</span><span style="color:#24292E;">       </span><span style="color:#032F62;">quota-example</span></span>
<span class="line"><span style="color:#6F42C1;">Resource</span><span style="color:#24292E;">         </span><span style="color:#032F62;">Used</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Hard</span></span>
<span class="line"><span style="color:#6F42C1;">--------</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">----</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">----</span></span>
<span class="line"><span style="color:#6F42C1;">limits.cpu</span><span style="color:#24292E;">       </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">2</span></span>
<span class="line"><span style="color:#6F42C1;">limits.memory</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">Gi</span></span>
<span class="line"><span style="color:#6F42C1;">pods</span><span style="color:#24292E;">             </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">4</span></span>
<span class="line"><span style="color:#6F42C1;">requests.cpu</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#6F42C1;">requests.memory</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">Gi</span></span></code></pre></div><p>é…é¢ç³»ç»Ÿä¼šè‡ªåŠ¨é˜²æ­¢åœ¨è¯¥å‘½åç©ºé—´ä¸­åŒæ—¶æ‹¥æœ‰è¶…è¿‡4ä¸ªéâ€œç»ˆæ­¢æ€â€çš„ Podã€‚æ­¤å¤–ï¼Œç”±äºè¯¥é¡¹èµ„æºé…é¢é™åˆ¶äº† CPU å’Œ å†…å­˜çš„ Limits å’Œ Requests æ€»é‡ï¼Œå› æ­¤ä¼šå¼ºåˆ¶è¦æ±‚è¯¥å‘½åç©ºé—´ä¸­æ‰€æœ‰çš„å®¹å™¨éƒ½æ˜¾å¼å®šä¹‰ CPU å’Œå†…å­˜çš„ Limitsã€Requestsï¼ˆå¯ä½¿ç”¨é»˜è®¤å€¼ï¼ŒRequests é»˜è®¤ç­‰äº Limitsï¼‰ã€‚</p><h3 id="_4-é…ç½®é»˜è®¤çš„-requests-å’Œ-limits" tabindex="-1"><strong>4. é…ç½®é»˜è®¤çš„ Requests å’Œ Limits</strong> <a class="header-anchor" href="#_4-é…ç½®é»˜è®¤çš„-requests-å’Œ-limits" aria-label="Permalink to &quot;**4. é…ç½®é»˜è®¤çš„ Requests å’Œ Limits**&quot;">â€‹</a></h3><p><strong>åœ¨å‘½åç©ºé—´å·²ç»é…ç½®äº†é™å®šè®¡ç®—èµ„æºé…é¢çš„æƒ…å†µä¸‹ï¼Œå¦‚æœå°è¯•åœ¨è¯¥å‘½åç©ºé—´ä¸­åˆ›å»ºä¸€ä¸ªä¸æŒ‡å®š Requests å’Œ Limits çš„ Podï¼Œé‚£ä¹ˆ Pod çš„åˆ›å»ºå¯èƒ½ä¼šå¤±è´¥ã€‚</strong> ä¸‹é¢æ˜¯ä¸€ä¸ªå¤±è´¥çš„ä¾‹å­ã€‚</p><ul><li>åˆ›å»º</li></ul><p>åˆ›å»ºä¸€ä¸ª Nginx çš„ Deploymentï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl create deployment nginx --image=nginx --replicas=1 --namespace=quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl create deployment nginx --image=nginx --replicas=1 --namespace=quota-example</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><p>æŸ¥çœ‹åˆ›å»ºçš„ Podï¼Œä¼šå‘ç° Pod æ²¡æœ‰åˆ›å»ºæˆåŠŸï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl get pods --namespace=quota-example </span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">No resources found in quota-example namespace.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl get pods --namespace=quota-example </span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">No resources found in quota-example namespace.</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl get deployments --namespace=quota-example</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">NAME    READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#e1e4e8;">nginx   0/1     0            0           2m38s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl get deployments --namespace=quota-example</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">NAME    READY   UP-TO-DATE   AVAILABLE   AGE</span></span>
<span class="line"><span style="color:#24292e;">nginx   0/1     0            0           2m38s</span></span></code></pre></div><p>å†æŸ¥çœ‹ Deployment çš„è¯¦ç»†ä¿¡æ¯ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl describe deployments nginx --namespace=quota-example</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">kubectl describe replicasets nginx-6799fc88d8  --namespace=quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl describe deployments nginx --namespace=quota-example</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">kubectl describe replicasets nginx-6799fc88d8  --namespace=quota-example</span></span></code></pre></div><p>æç¤ºåˆ›å»ºå¤±è´¥ï¼ŒMaster æ‹’ç»è¿™ä¸ª ReplicaSet åˆ›å»º Podï¼Œå› ä¸ºåœ¨è¿™ä¸ª Pod ä¸­æ²¡æœ‰æŒ‡å®š CPU å’Œ å†…å­˜çš„ Requestsã€Limits</p><p>ä¸ºäº†é¿å…è¿™ç§å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ LimitRange ä¸ºè¿™ä¸ªå‘½åç©ºé—´ä¸­æ‰€æœ‰ Pod éƒ½æä¾›ä¸€ä¸ªèµ„æºé…ç½®çš„é»˜è®¤å€¼</p><p>åˆ›å»ºä¸€ä¸ªåä¸º limits çš„ LimitRangeï¼Œlimits.yaml æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">LimitRange</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">limits</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">default</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">200m</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">512Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">defaultRequest</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">100m</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">256Mi</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Container</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">LimitRange</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">limits</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">default</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">200m</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">512Mi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">defaultRequest</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">100m</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">256Mi</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Container</span></span></code></pre></div><ul><li>åˆ›å»ºèµ„æº</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl create -f limits.yaml --namespace=quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl create -f limits.yaml --namespace=quota-example</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl describe limitranges --namespace=quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl describe limitranges --namespace=quota-example</span></span></code></pre></div><p>åœ¨ LimitRange åˆ›å»ºæˆåŠŸåï¼Œè‹¥ç”¨æˆ·åœ¨è¯¥å‘½åç©ºé—´ä¸­åˆ›å»ºäº†æœªæŒ‡å®šèµ„æºé™åˆ¶çš„ Podï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨ä¸ºè¯¥ Pod è®¾ç½®é»˜è®¤çš„èµ„æºé™åˆ¶ã€‚</p><p>ä¾‹å¦‚ï¼Œæ¯ä¸ªæ–°å»ºçš„æœªæŒ‡å®šèµ„æºé™åˆ¶çš„ Pod éƒ½ç­‰ä»·äºä½¿ç”¨ä¸‹é¢çš„èµ„æºé™åˆ¶ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl run nginx --image=nginx --requests=cpu=100m,memory=256Mi --limits=cpu=200m,memory=512Mi --namespace=quota-example</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl run nginx --image=nginx --requests=cpu=100m,memory=256Mi --limits=cpu=200m,memory=512Mi --namespace=quota-example</span></span></code></pre></div><h1 id="_7-downward-api" tabindex="-1">7. Downward API <a class="header-anchor" href="#_7-downward-api" aria-label="Permalink to &quot;7. Downward API&quot;">â€‹</a></h1><p>æ–‡æ¡£ï¼Œ<a href="https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/downward-api/" target="_blank" rel="noreferrer">https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/downward-api/</a></p><p><strong>ä½œç”¨ï¼šè®© Pod é‡Œçš„å®¹å™¨èƒ½å¤Ÿç›´æ¥è·å–åˆ°è¿™ä¸ª Pod API å¯¹è±¡æœ¬èº«çš„ä¿¡æ¯</strong></p><p>DownwardAPI å¯ä»¥è®©å®¹å™¨è·å– Pod çš„ç›¸å…³å…ƒæ•°æ®ä¿¡æ¯ï¼Œæ¯”å¦‚ Pod åç§°ï¼ŒPod çš„ IPï¼ŒPod çš„èµ„æºé™åˆ¶ç­‰ï¼Œè·å–åé€šè¿‡ envã€voLume çš„æ–¹å¼å°†ç›¸å…³çš„ç¯å¢ƒä¿¡æ¯æ³¨å…¥åˆ°å®¹å™¨ä¸­ï¼Œä»è€Œè®©å®¹å™¨é€šè¿‡ç¯å¢ƒå˜é‡è¿™äº›ä¿¡æ¯ï¼Œæ¥è®¾å®šå®¹å™¨çš„è¿è¡Œç‰¹æ€§ã€‚</p><ul><li>ä¾‹å¦‚ï¼šNginx è¿›ç¨‹æ ¹æ®èŠ‚ç‚¹çš„ CPU æ ¸å¿ƒæ•°é‡è‡ªåŠ¨è®¾å®šè¦å¯åŠ¨çš„ worker è¿›ç¨‹æ•°</li><li>ä¾‹å¦‚ï¼šJVM è™šæ‹Ÿæ ¹æ® Pod çš„å†…å­˜èµ„æºé™åˆ¶ï¼Œæ¥è®¾å®šå¯¹åº”å®¹å™¨çš„å †å†…å­˜å¤§å°</li><li>ä¾‹å¦‚ï¼šè·å– Pod åç§°ï¼Œä»¥ Pod åç§°æ³¨å†Œåˆ°æŸä¸ªæœåŠ¡ï¼Œå½“ Pod ç»“æŸåï¼Œè°ƒç”¨ prestop æ¸…ç†å¯¹åº”åç§°çš„æ³¨å†Œä¿¡æ¯</li></ul><h2 id="_7-1-å¯æ³¨å…¥çš„å…ƒæ•°æ®ä¿¡æ¯" tabindex="-1">7.1 å¯æ³¨â¼Šçš„å…ƒæ•°æ®ä¿¡æ¯ <a class="header-anchor" href="#_7-1-å¯æ³¨å…¥çš„å…ƒæ•°æ®ä¿¡æ¯" aria-label="Permalink to &quot;7.1 å¯æ³¨â¼Šçš„å…ƒæ•°æ®ä¿¡æ¯&quot;">â€‹</a></h2><p>ä½¿â½¤ <code>pod.spec.containers.env.valueFrom.fieldRef</code> å¯ä»¥æ³¨â¼Šçš„å­—æ®µæœ‰ï¼š</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">metadata.nameï¼šPodå¯¹è±¡çš„åç§°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">metadata.namespaceï¼šPodå¯¹è±¡éš¶å±çš„åç§°ç©ºé—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">metadata.uidï¼šPodå¯¹è±¡çš„UID</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">metadata.abels[</span><span style="color:#B392F0;">&#39;&lt;KEY&gt;&#39;</span><span style="color:#B392F0;">]ï¼šè·å–LabeLæŒ‡å®šKEYå¯¹åº”çš„å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">metadata.annotations[</span><span style="color:#B392F0;">&#39;&lt;KEY&gt;&#39;</span><span style="color:#B392F0;">]ï¼šè·å–Annotationså¯¹åº”KEYçš„å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">status.podIPï¼šPodå¯¹è±¡çš„IPåœ°å€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">status.hostIP:èŠ‚ç‚¹IP</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">status.nodeNameï¼šèŠ‚ç‚¹åç§°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">spec.serviceAccountNameï¼šPodå¯¹è±¡ä½¿ç”¨çš„ServiceAccountèµ„æºåç§°</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">metadata.nameï¼šPodå¯¹è±¡çš„åç§°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">metadata.namespaceï¼šPodå¯¹è±¡éš¶å±çš„åç§°ç©ºé—´</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">metadata.uidï¼šPodå¯¹è±¡çš„UID</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">metadata.abels[</span><span style="color:#6F42C1;">&#39;&lt;KEY&gt;&#39;</span><span style="color:#6F42C1;">]ï¼šè·å–LabeLæŒ‡å®šKEYå¯¹åº”çš„å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">metadata.annotations[</span><span style="color:#6F42C1;">&#39;&lt;KEY&gt;&#39;</span><span style="color:#6F42C1;">]ï¼šè·å–Annotationså¯¹åº”KEYçš„å€¼</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">status.podIPï¼šPodå¯¹è±¡çš„IPåœ°å€</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">status.hostIP:èŠ‚ç‚¹IP</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">status.nodeNameï¼šèŠ‚ç‚¹åç§°</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">spec.serviceAccountNameï¼šPodå¯¹è±¡ä½¿ç”¨çš„ServiceAccountèµ„æºåç§°</span></span></code></pre></div><p>ä½¿â½¤<code>pod.spec.containers.env.valueFrom.resourceFieldRef</code> å¯ä»¥æ³¨â¼Šçš„å­—æ®µæœ‰ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">requests.cpu</span></span>
<span class="line"><span style="color:#e1e4e8;">requests.memory</span></span>
<span class="line"><span style="color:#e1e4e8;">limits.cpu</span></span>
<span class="line"><span style="color:#e1e4e8;">limits.memory</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">requests.cpu</span></span>
<span class="line"><span style="color:#24292e;">requests.memory</span></span>
<span class="line"><span style="color:#24292e;">limits.cpu</span></span>
<span class="line"><span style="color:#24292e;">limits.memory</span></span></code></pre></div><h2 id="_7-2-ç¯å¢ƒå˜é‡æ–¹å¼æ³¨å…¥å…ƒæ•°æ®" tabindex="-1">7.2 ç¯å¢ƒå˜é‡â½…å¼æ³¨â¼Šå…ƒæ•°æ® <a class="header-anchor" href="#_7-2-ç¯å¢ƒå˜é‡æ–¹å¼æ³¨å…¥å…ƒæ•°æ®" aria-label="Permalink to &quot;7.2 ç¯å¢ƒå˜é‡â½…å¼æ³¨â¼Šå…ƒæ•°æ®&quot;">â€‹</a></h2><p>1.åˆ›å»º Pod å®¹å™¨ï¼Œå°† Pod ç›¸å…³ç¯å¢ƒå˜é‡æ³¨â¼Šåˆ°å®¹å™¨ä¸­ï¼Œâ½å¦‚ï¼ˆpod åç§°ã€å‘½åç©ºé—´ã€æ ‡ç­¾ã€ä»¥åŠ cpuã€å†…å­˜çš„è¯·æ±‚å’Œé™åˆ¶ï¼‰</p><p>[root@kube-master yaml]# kubectl apply pod-downward.yaml</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-downward</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-downward</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-downward</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;/bin/sh&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;-c&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;env&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;200m&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;128Mi&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;200m&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;64Mi&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">env</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">THIS_POD_NAME</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">valueFrom</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">fieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#85E89D;">fieldPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">metadata.name</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">THIS_POD_NAMESPACE</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">valueFrom</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">fieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#85E89D;">fieldPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">metadata.namespace</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">THIS_POD_APP_LABEL</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">valueFrom</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">fieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#85E89D;">fieldPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">metadata.labels[&#39;app&#39;]</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">THIS_CPU_LIMIT</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">valueFrom</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">resourceFieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#85E89D;">resource</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">limits.cpu</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">THIS_MEMORY_REQUEST</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">valueFrom</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#85E89D;">resourceFieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#85E89D;">resource</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">requests.memory</span></span>
<span class="line"><span style="color:#E1E4E8;">              </span><span style="color:#85E89D;">divisor</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1Mi</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># é»˜è®¤æ˜¾ç¤ºä¸ºå­—èŠ‚ï¼Œé€šè¿‡divisorè°ƒæ•´æ˜¾ç¤ºå•ä½ä¸ºå…†</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-downward</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-downward</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-downward</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;/bin/sh&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;-c&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;env&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;200m&#39;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;128Mi&#39;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;200m&#39;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;64Mi&#39;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">env</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">THIS_POD_NAME</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">valueFrom</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">fieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#22863A;">fieldPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">metadata.name</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">THIS_POD_NAMESPACE</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">valueFrom</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">fieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#22863A;">fieldPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">metadata.namespace</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">THIS_POD_APP_LABEL</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">valueFrom</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">fieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#22863A;">fieldPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">metadata.labels[&#39;app&#39;]</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">THIS_CPU_LIMIT</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">valueFrom</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">resourceFieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#22863A;">resource</span><span style="color:#24292E;">: </span><span style="color:#032F62;">limits.cpu</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">THIS_MEMORY_REQUEST</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">valueFrom</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#22863A;">resourceFieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#22863A;">resource</span><span style="color:#24292E;">: </span><span style="color:#032F62;">requests.memory</span></span>
<span class="line"><span style="color:#24292E;">              </span><span style="color:#22863A;">divisor</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1Mi</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># é»˜è®¤æ˜¾ç¤ºä¸ºå­—èŠ‚ï¼Œé€šè¿‡divisorè°ƒæ•´æ˜¾ç¤ºå•ä½ä¸ºå…†</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl logs pod-downward </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">THIS</span></span>
<span class="line"><span style="color:#E1E4E8;">THIS_CPU_LIMIT</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">THIS_POD_APP_LABEL</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">pod-downward</span></span>
<span class="line"><span style="color:#E1E4E8;">THIS_POD_NAME</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">pod-downward</span></span>
<span class="line"><span style="color:#E1E4E8;">THIS_MEMORY_REQUEST</span><span style="color:#F97583;">=</span><span style="color:#79B8FF;">64</span></span>
<span class="line"><span style="color:#E1E4E8;">THIS_POD_NAMESPACE</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">default</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl logs pod-downward </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">THIS</span></span>
<span class="line"><span style="color:#24292E;">THIS_CPU_LIMIT</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">THIS_POD_APP_LABEL</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">pod-downward</span></span>
<span class="line"><span style="color:#24292E;">THIS_POD_NAME</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">pod-downward</span></span>
<span class="line"><span style="color:#24292E;">THIS_MEMORY_REQUEST</span><span style="color:#D73A49;">=</span><span style="color:#005CC5;">64</span></span>
<span class="line"><span style="color:#24292E;">THIS_POD_NAMESPACE</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">default</span></span></code></pre></div><h2 id="_7-3-å­˜å‚¨å·æ–¹å¼æ³¨å…¥å…ƒæ•°æ®" tabindex="-1">7.3 å­˜å‚¨å·â½…å¼æ³¨â¼Šå…ƒæ•°æ® <a class="header-anchor" href="#_7-3-å­˜å‚¨å·æ–¹å¼æ³¨å…¥å…ƒæ•°æ®" aria-label="Permalink to &quot;7.3 å­˜å‚¨å·â½…å¼æ³¨â¼Šå…ƒæ•°æ®&quot;">â€‹</a></h2><p>å‘å®¹å™¨æ³¨å…¥å…ƒæ•°æ®ä¿¡æ¯çš„å¦å¤–ä¸€ç§æ–¹å¼æ˜¯ä½¿ç”¨ downwardAPI å­˜å‚¨å·ï¼Œå®ƒå°†é…ç½®çš„å­—æ®µæ•°æ®æ˜ å°„ä¸ºæ–‡ä»¶å¹¶å¯é€šè¿‡å®¹å™¨ä¸­çš„æŒ‚è½½è¿›è¡Œè®¿é—®</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#æŸ¥çœ‹å¸®åŠ©</span></span>
<span class="line"><span style="color:#e1e4e8;"> kubectl explain pod.spec.volumes.downwardAPI</span></span>
<span class="line"><span style="color:#e1e4e8;"> </span></span>
<span class="line"><span style="color:#e1e4e8;"> kubectl explain pod.spec.volumes.downwardAPI.items</span></span>
<span class="line"><span style="color:#e1e4e8;"> </span></span>
<span class="line"><span style="color:#e1e4e8;"> kubectl explain pod.spec.volumes.downwardAPI.items.resourceFieldRef</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#æŸ¥çœ‹å¸®åŠ©</span></span>
<span class="line"><span style="color:#24292e;"> kubectl explain pod.spec.volumes.downwardAPI</span></span>
<span class="line"><span style="color:#24292e;"> </span></span>
<span class="line"><span style="color:#24292e;"> kubectl explain pod.spec.volumes.downwardAPI.items</span></span>
<span class="line"><span style="color:#24292e;"> </span></span>
<span class="line"><span style="color:#24292e;"> kubectl explain pod.spec.volumes.downwardAPI.items.resourceFieldRef</span></span></code></pre></div><p>åœ¨ downwardAPI å­˜å‚¨å·ä¸­ä½¿ç”¨ fieldRef å¼•ç”¨å¦‚ä¸‹ä¸¤ä¸ªæ•°æ®æºï¼š</p><ul><li>metadata.labels: Pod å¯¹è±¡çš„æ‰€æœ‰æ ‡ç­¾ä¿¡æ¯ï¼Œæ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼ä¸º label-key=&quot;escaped-label-value&quot;</li><li>metadata.annotations: Pod å¯¹è±¡çš„æ‰€æœ‰æ³¨è§£ä¿¡æ¯ï¼Œæ¯è¡Œä¸€ä¸ªï¼Œæ ¼å¼ä¸º annotation-key=&quot;escaped-annotation-value&quot;ã€‚</li></ul><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">east-china</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">rack</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">rack-101</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dapi-vol-pod</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">dapi-vol-pod</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">annotations</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">annotation1</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;test-value-1&quot;</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume-test-container</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;/bin/sh&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;-c&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;sleep 864000&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;32Mi&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;125m&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">limits</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">memory</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;64Mi&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">cpu</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;256m&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">volueMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">podinfo</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/etc/podinfo</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">readOnly</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">podinfo</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">downwardAPI</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">defaultMode</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">420</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">items</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">fieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">fieldPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">metadata.namespace</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod_namespace</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">fieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">fieldPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">metadata.labels</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod_labels</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">fieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">fieldPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">metadata.annotations</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod_annotations</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">resourceFieldRef</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">containerName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume-test-container</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">resource</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">requests.memory</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">divisor</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;1Mi&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;mem_request&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">: </span><span style="color:#032F62;">east-china</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">rack</span><span style="color:#24292E;">: </span><span style="color:#032F62;">rack-101</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dapi-vol-pod</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">dapi-vol-pod</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">annotations</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">annotation1</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;test-value-1&quot;</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume-test-container</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;/bin/sh&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;-c&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;sleep 864000&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;32Mi&quot;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;125m&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">limits</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">memory</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;64Mi&quot;</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">cpu</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;256m&quot;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">volueMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">podinfo</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/etc/podinfo</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">readOnly</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">podinfo</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">downwardAPI</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">defaultMode</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">420</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">items</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">fieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">fieldPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">metadata.namespace</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod_namespace</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">fieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">fieldPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">metadata.labels</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod_labels</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">fieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">fieldPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">metadata.annotations</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod_annotations</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">resourceFieldRef</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">containerName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume-test-container</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">resource</span><span style="color:#24292E;">: </span><span style="color:#032F62;">requests.memory</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">divisor</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1Mi&quot;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;mem_request&quot;</span></span></code></pre></div><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#e1e4e8;">kubectl exec dapi-vol-pod -- cat /etc/podinfo/pod_labels</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#24292e;">kubectl exec dapi-vol-pod -- cat /etc/podinfo/pod_labels</span></span></code></pre></div>`,275),e=[o];function t(c,r,y,E,i,d){return a(),n("div",null,e)}const m=s(p,[["render",t]]);export{F as __pageData,m as default};
