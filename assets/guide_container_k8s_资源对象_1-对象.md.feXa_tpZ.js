import{_ as s,o as a,c as n,R as p}from"./chunks/framework.zUbWieqp.js";const C=JSON.parse('{"title":"1.Kubernetes对象","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/资源对象/1-对象.md","filePath":"guide/container/k8s/资源对象/1-对象.md","lastUpdated":1720533756000}'),l={name:"guide/container/k8s/资源对象/1-对象.md"},o=p(`<h1 id="_1-kubernetes对象" tabindex="-1">1.Kubernetes对象 <a class="header-anchor" href="#_1-kubernetes对象" aria-label="Permalink to &quot;1.Kubernetes对象&quot;">​</a></h1><h2 id="_1-1-什么是对象" tabindex="-1">1.1 什么是对象 <a class="header-anchor" href="#_1-1-什么是对象" aria-label="Permalink to &quot;1.1 什么是对象&quot;">​</a></h2><p>在Kubernetes系统中，我们所操作的资源就是对象，而对象是一个持久化的实体，也就是说会将我们对资源的操作记录下来。Kubernetes需要使用这些实体来表示整个集群的状态。它们描述了如下信息</p><ul><li>哪些容器化应用在运行，以及这些应用运行在哪些节点上</li><li>应用程序可以被使用的资源</li><li>应用程序运行时的策略，比如重启策略、升级策略，以及容错策略</li></ul><p>Kubernetes对象是目标性记录，也就是说一旦创建对象，Kubernetes系统将持续工作以确保该对象存在，并达到用户所期望的状态。一旦我们想要操作 Kubernetes 对象，无论是创建、修改，或者删除，都需要使用到Kubernetes API 接口</p><h2 id="_1-2-对象规范与状态" tabindex="-1">1.2 对象规范与状态 <a class="header-anchor" href="#_1-2-对象规范与状态" aria-label="Permalink to &quot;1.2 对象规范与状态&quot;">​</a></h2><p>​ Kubernetes几乎每个对象都包含两个嵌套的对象字段，对象spec(规范）和对象status(状态)。</p><ul><li>spec：是在创建该对象时设定其内容，通过spec来描述你希望对象所具有的特征：期望状态（DesiredState</li><li>status描述了对象的当前状态（Current State），它是由Kubernetes系统和组件设置并更新的</li></ul><p>任何时刻，Kubernetes控制平面都一直积极地管理着对象的<code>实际状态</code>，与<code>期望状态</code>相匹配</p><p>​ 例如，Kubernetes中的 Deployment 对象能够表示运行在集群中的应用。当创建Deployment 时，可能需要设置DepLoyment的spec，用于指定该应用需要有3个副本运行。Kubernetes系统读取Deployment 规范，并启动我们所期望的应用的3个实例，更新当前状态以与规范中期望状态橡皮匹配。如果这些实例中有的失败了（一种状态变更），Kubernetes系统通过执行修正操作来响应<code>spec</code>与<code>status</code>状态间出现的不一致，可能会启动一个新的实例来替换失败的实例。</p><h2 id="_1-3-理解对象" tabindex="-1">1.3 理解对象 <a class="header-anchor" href="#_1-3-理解对象" aria-label="Permalink to &quot;1.3 理解对象&quot;">​</a></h2><p>创建Kubernetes对象时，必须提供对象的 spec（规范），用来描述该对象的期望状态，以及对象的一些基本信息（例如名称）。使用kubectl创建资源对象时，请求KubernetesAPI必须在请求体中包含JSON格式的信息。 1但大多数情况下我们都是使用的YAML格式来创建资源，所以只需要在YAML格式文件中描述对应的spec规范。在kubectl发起API请求时，会将这些信息转换成JSON 格式。</p><p>这里有一个．yaml示例文件，展示了Kubernetes Deployment 创建时的必需字段和对象spec规范:</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">apps/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Deployment</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx-deploy</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">                   </span><span style="color:#6A737D;"># 期望的副本数</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">selector</span><span style="color:#E1E4E8;">:                     </span><span style="color:#6A737D;"># Deployment要管理的Pod有哪些 只要标签app=nginx就加入进行管理</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">matchLabels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">:                     </span><span style="color:#6A737D;"># Pod模板；有标签；有Pod规范</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:1.16</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">http</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">containerPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">apps/v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Deployment</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx-deploy</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">replicas</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">                   </span><span style="color:#6A737D;"># 期望的副本数</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">selector</span><span style="color:#24292E;">:                     </span><span style="color:#6A737D;"># Deployment要管理的Pod有哪些 只要标签app=nginx就加入进行管理</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">matchLabels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">template</span><span style="color:#24292E;">:                     </span><span style="color:#6A737D;"># Pod模板；有标签；有Pod规范</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:1.16</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">http</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">containerPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">80</span></span></code></pre></div><p>接下来就可以通过kubectl应用该文件，然后kubectl会将该文件转为json提交给KubernetesAPI</p><h2 id="_1-4-对象必须字段" tabindex="-1">1.4 对象必须字段 <a class="header-anchor" href="#_1-4-对象必须字段" aria-label="Permalink to &quot;1.4 对象必须字段&quot;">​</a></h2><p>在想要创建的Kubernetes 对象对应的．yam文件中，需要配置如下的字段</p><ul><li>apiVersion－创建该对象所使用的 Kubernetes API 的版本</li><li>kind－想要创建的对象的类别，pod，deployment，service</li><li>metadataa－标识对象唯一性的一些数据，包括一个name e字符串、UID和可选的Jnamespace</li><li>specC-1你所期望的该对象的状态</li></ul><h3 id="创建" tabindex="-1">创建 <a class="header-anchor" href="#创建" aria-label="Permalink to &quot;创建&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">my-nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--image=nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pod</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">my-nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-o</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#⼲跑⼀次</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">my-nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--image=nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-dry-run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-o</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">my-nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--image=nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pod</span><span style="color:#24292E;"> </span><span style="color:#032F62;">my-nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-o</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yaml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#⼲跑⼀次</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">create</span><span style="color:#24292E;"> </span><span style="color:#032F62;">my-nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--image=nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-dry-run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-o</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yaml</span></span></code></pre></div><h2 id="_1-5-对象实践" tabindex="-1">1.5 对象实践 <a class="header-anchor" href="#_1-5-对象实践" aria-label="Permalink to &quot;1.5 对象实践&quot;">​</a></h2><h3 id="pod" tabindex="-1">pod <a class="header-anchor" href="#pod" aria-label="Permalink to &quot;pod&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">explain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pod.spec</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">explain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pod.spec</span></span></code></pre></div><h3 id="containers" tabindex="-1">containers <a class="header-anchor" href="#containers" aria-label="Permalink to &quot;containers&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">explain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pod.spec.containers</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">explain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pod.spec.containers</span></span></code></pre></div><h3 id="deployment" tabindex="-1">deployment <a class="header-anchor" href="#deployment" aria-label="Permalink to &quot;deployment&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl explain deployment</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl explain deployment</span></span></code></pre></div><h3 id="service" tabindex="-1">service <a class="header-anchor" href="#service" aria-label="Permalink to &quot;service&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">explain</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">service</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">explain</span><span style="color:#24292E;"> </span><span style="color:#032F62;">service</span></span></code></pre></div><h1 id="_2-实战" tabindex="-1">2. 实战 <a class="header-anchor" href="#_2-实战" aria-label="Permalink to &quot;2. 实战&quot;">​</a></h1><h2 id="_2-1-部署应用" tabindex="-1">2.1 部署应用 <a class="header-anchor" href="#_2-1-部署应用" aria-label="Permalink to &quot;2.1 部署应用&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">vi dp_demoapp.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">apps/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Deployment</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">demoapp-deploy</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">namespace</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;"># 副本数</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">selector</span><span style="color:#E1E4E8;">:             </span><span style="color:#6A737D;"># 通过标签选择器选择要管理的Pod</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">matchLabels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">demoapp</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">:             </span><span style="color:#6A737D;">#定义Pod模板</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:			</span><span style="color:#6A737D;">#给Pod添加一个标签，标签的key为run，标签的value为app</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">demoapp</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">webserver</span><span style="color:#E1E4E8;">					</span><span style="color:#6A737D;">#容器的名称</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/demoapp/demoapp:v1</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">#容器需要的对象</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">http</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">containerPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;">				</span><span style="color:#6A737D;">#容器对外的端口是80</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">vi dp_demoapp.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">apps/v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Deployment</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">demoapp-deploy</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">namespace</span><span style="color:#24292E;">: </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">replicas</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">            </span><span style="color:#6A737D;"># 副本数</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">selector</span><span style="color:#24292E;">:             </span><span style="color:#6A737D;"># 通过标签选择器选择要管理的Pod</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">matchLabels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">demoapp</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">template</span><span style="color:#24292E;">:             </span><span style="color:#6A737D;">#定义Pod模板</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:			</span><span style="color:#6A737D;">#给Pod添加一个标签，标签的key为run，标签的value为app</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">demoapp</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">webserver</span><span style="color:#24292E;">					</span><span style="color:#6A737D;">#容器的名称</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">registry.cn-zhangjiakou.aliyuncs.com/hsuing/demoapp/demoapp:v1</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">#容器需要的对象</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">http</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">containerPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">80</span><span style="color:#24292E;">				</span><span style="color:#6A737D;">#容器对外的端口是80</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#创建</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apply</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dp_demoapp.yml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#创建</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apply</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dp_demoapp.yml</span></span></code></pre></div><h2 id="_2-2-访问应用" tabindex="-1">2.2 访问应用 <a class="header-anchor" href="#_2-2-访问应用" aria-label="Permalink to &quot;2.2 访问应用&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">vim dp_demoapp_svc.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Service</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">demoapp-service</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">demoapp</span><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># Service通过标签选择器将对应的Pod定义为一组backend，而后将所有请求调度到这组Pod上</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">http</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">port</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">9090</span><span style="color:#E1E4E8;">            </span><span style="color:#6A737D;"># 负载均衡的端口（User--&gt; ServiceIP+ServicePort --&gt; PodIP+PodPort）</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">targetPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;"># 后端节点的端口（容器对外的端口）</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">vim dp_demoapp_svc.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Service</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">demoapp-service</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">selector</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">demoapp</span><span style="color:#24292E;">        </span><span style="color:#6A737D;"># Service通过标签选择器将对应的Pod定义为一组backend，而后将所有请求调度到这组Pod上</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">http</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">port</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">9090</span><span style="color:#24292E;">            </span><span style="color:#6A737D;"># 负载均衡的端口（User--&gt; ServiceIP+ServicePort --&gt; PodIP+PodPort）</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">targetPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">80</span><span style="color:#24292E;">        </span><span style="color:#6A737D;"># 后端节点的端口（容器对外的端口）</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#创建</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">apply</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">dp_demoapp_svc.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看负载后端ip地址</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe service demoapp-service</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">demoapp-service</span></span>
<span class="line"><span style="color:#B392F0;">Namespace:</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#B392F0;">Labels:</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Annotations:</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Selector:</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">app=demoapp</span></span>
<span class="line"><span style="color:#B392F0;">Type:</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">ClusterIP</span></span>
<span class="line"><span style="color:#B392F0;">IP</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Family</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Policy:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">SingleStack</span></span>
<span class="line"><span style="color:#B392F0;">IP</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Families:</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">IPv4</span></span>
<span class="line"><span style="color:#B392F0;">IP:</span><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.63.161</span></span>
<span class="line"><span style="color:#B392F0;">IPs:</span><span style="color:#E1E4E8;">               </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.63.161</span></span>
<span class="line"><span style="color:#B392F0;">Port:</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">http</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">9090</span><span style="color:#9ECBFF;">/TCP</span></span>
<span class="line"><span style="color:#B392F0;">TargetPort:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">80</span><span style="color:#9ECBFF;">/TCP</span></span>
<span class="line"><span style="color:#B392F0;">Endpoints:</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">172.17</span><span style="color:#9ECBFF;">.74.82:80,172.23.127.81:80,172.30.0.137:80</span></span>
<span class="line"><span style="color:#B392F0;">Session</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Affinity:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">None</span></span>
<span class="line"><span style="color:#B392F0;">Events:</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#创建</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">apply</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">dp_demoapp_svc.yml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看负载后端ip地址</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe service demoapp-service</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">              </span><span style="color:#032F62;">demoapp-service</span></span>
<span class="line"><span style="color:#6F42C1;">Namespace:</span><span style="color:#24292E;">         </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#6F42C1;">Labels:</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Annotations:</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Selector:</span><span style="color:#24292E;">          </span><span style="color:#032F62;">app=demoapp</span></span>
<span class="line"><span style="color:#6F42C1;">Type:</span><span style="color:#24292E;">              </span><span style="color:#032F62;">ClusterIP</span></span>
<span class="line"><span style="color:#6F42C1;">IP</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Family</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Policy:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">SingleStack</span></span>
<span class="line"><span style="color:#6F42C1;">IP</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Families:</span><span style="color:#24292E;">       </span><span style="color:#032F62;">IPv4</span></span>
<span class="line"><span style="color:#6F42C1;">IP:</span><span style="color:#24292E;">                </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.63.161</span></span>
<span class="line"><span style="color:#6F42C1;">IPs:</span><span style="color:#24292E;">               </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.63.161</span></span>
<span class="line"><span style="color:#6F42C1;">Port:</span><span style="color:#24292E;">              </span><span style="color:#032F62;">http</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">9090</span><span style="color:#032F62;">/TCP</span></span>
<span class="line"><span style="color:#6F42C1;">TargetPort:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">80</span><span style="color:#032F62;">/TCP</span></span>
<span class="line"><span style="color:#6F42C1;">Endpoints:</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">172.17</span><span style="color:#032F62;">.74.82:80,172.23.127.81:80,172.30.0.137:80</span></span>
<span class="line"><span style="color:#6F42C1;">Session</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Affinity:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">None</span></span>
<span class="line"><span style="color:#6F42C1;">Events:</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h2 id="_2-3-scale应用" tabindex="-1">2.3 Scale应⽤ <a class="header-anchor" href="#_2-3-scale应用" aria-label="Permalink to &quot;2.3 Scale应⽤&quot;">​</a></h2><h3 id="扩容" tabindex="-1">扩容 <a class="header-anchor" href="#扩容" aria-label="Permalink to &quot;扩容&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">scale</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployment</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">demoapp-deploy</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--replicas=5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe svc demoapp-service</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">demoapp-service</span></span>
<span class="line"><span style="color:#B392F0;">Namespace:</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#B392F0;">Labels:</span><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Annotations:</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Selector:</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">app=demoapp</span></span>
<span class="line"><span style="color:#B392F0;">Type:</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">ClusterIP</span></span>
<span class="line"><span style="color:#B392F0;">IP</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Family</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Policy:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">SingleStack</span></span>
<span class="line"><span style="color:#B392F0;">IP</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Families:</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">IPv4</span></span>
<span class="line"><span style="color:#B392F0;">IP:</span><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.63.161</span></span>
<span class="line"><span style="color:#B392F0;">IPs:</span><span style="color:#E1E4E8;">               </span><span style="color:#79B8FF;">192.168</span><span style="color:#9ECBFF;">.63.161</span></span>
<span class="line"><span style="color:#B392F0;">Port:</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">http</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">9090</span><span style="color:#9ECBFF;">/TCP</span></span>
<span class="line"><span style="color:#B392F0;">TargetPort:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">80</span><span style="color:#9ECBFF;">/TCP</span></span>
<span class="line"><span style="color:#B392F0;">Endpoints:</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">172.17</span><span style="color:#9ECBFF;">.74.82:80,172.23.127.81:80,172.23.127.82:80</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">more...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看Endpoints</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl get Endpoints</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">ENDPOINTS</span><span style="color:#E1E4E8;">                                                       </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">demoapp-service</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">172.17</span><span style="color:#9ECBFF;">.74.82:80,172.23.127.81:80,172.23.127.82:80</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">+</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">more...</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">142</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看+2 more更多隐藏的ip</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe endpoints demoapp-service</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">demoapp-service</span></span>
<span class="line"><span style="color:#B392F0;">Namespace:</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">default</span></span>
<span class="line"><span style="color:#B392F0;">Labels:</span><span style="color:#E1E4E8;">       </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Annotations:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">endpoints.kubernetes.io/last-change-trigger-time:</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2024</span><span style="color:#9ECBFF;">-04-14T12:57:37Z</span></span>
<span class="line"><span style="color:#B392F0;">Subsets:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Addresses:</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">172.17</span><span style="color:#9ECBFF;">.74.82,172.23.127.81,172.23.127.82,172.30.0.137,172.30.0.138</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">NotReadyAddresses:</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Ports:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Name</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Port</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Protocol</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">----</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">----</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--------</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">http</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">80</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">TCP</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">Events:</span><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">scale</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployment</span><span style="color:#24292E;"> </span><span style="color:#032F62;">demoapp-deploy</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--replicas=5</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe svc demoapp-service</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">              </span><span style="color:#032F62;">demoapp-service</span></span>
<span class="line"><span style="color:#6F42C1;">Namespace:</span><span style="color:#24292E;">         </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#6F42C1;">Labels:</span><span style="color:#24292E;">            </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Annotations:</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Selector:</span><span style="color:#24292E;">          </span><span style="color:#032F62;">app=demoapp</span></span>
<span class="line"><span style="color:#6F42C1;">Type:</span><span style="color:#24292E;">              </span><span style="color:#032F62;">ClusterIP</span></span>
<span class="line"><span style="color:#6F42C1;">IP</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Family</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Policy:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">SingleStack</span></span>
<span class="line"><span style="color:#6F42C1;">IP</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Families:</span><span style="color:#24292E;">       </span><span style="color:#032F62;">IPv4</span></span>
<span class="line"><span style="color:#6F42C1;">IP:</span><span style="color:#24292E;">                </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.63.161</span></span>
<span class="line"><span style="color:#6F42C1;">IPs:</span><span style="color:#24292E;">               </span><span style="color:#005CC5;">192.168</span><span style="color:#032F62;">.63.161</span></span>
<span class="line"><span style="color:#6F42C1;">Port:</span><span style="color:#24292E;">              </span><span style="color:#032F62;">http</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">9090</span><span style="color:#032F62;">/TCP</span></span>
<span class="line"><span style="color:#6F42C1;">TargetPort:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">80</span><span style="color:#032F62;">/TCP</span></span>
<span class="line"><span style="color:#6F42C1;">Endpoints:</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">172.17</span><span style="color:#032F62;">.74.82:80,172.23.127.81:80,172.23.127.82:80</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">more...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看Endpoints</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl get Endpoints</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">              </span><span style="color:#032F62;">ENDPOINTS</span><span style="color:#24292E;">                                                       </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">demoapp-service</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">172.17</span><span style="color:#032F62;">.74.82:80,172.23.127.81:80,172.23.127.82:80</span><span style="color:#24292E;"> </span><span style="color:#032F62;">+</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#032F62;">more...</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">142</span><span style="color:#032F62;">m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看+2 more更多隐藏的ip</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe endpoints demoapp-service</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">         </span><span style="color:#032F62;">demoapp-service</span></span>
<span class="line"><span style="color:#6F42C1;">Namespace:</span><span style="color:#24292E;">    </span><span style="color:#032F62;">default</span></span>
<span class="line"><span style="color:#6F42C1;">Labels:</span><span style="color:#24292E;">       </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Annotations:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">endpoints.kubernetes.io/last-change-trigger-time:</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2024</span><span style="color:#032F62;">-04-14T12:57:37Z</span></span>
<span class="line"><span style="color:#6F42C1;">Subsets:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Addresses:</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">172.17</span><span style="color:#032F62;">.74.82,172.23.127.81,172.23.127.82,172.30.0.137,172.30.0.138</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">NotReadyAddresses:</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Ports:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Name</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Port</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Protocol</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">----</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">----</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">--------</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">http</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">80</span><span style="color:#24292E;">    </span><span style="color:#032F62;">TCP</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">Events:</span><span style="color:#24292E;">  </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h3 id="缩减" tabindex="-1">缩减 <a class="header-anchor" href="#缩减" aria-label="Permalink to &quot;缩减&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@kube-master yaml]# kubectl scale deployment demoapp-deploy --replicas=3</span></span>
<span class="line"><span style="color:#e1e4e8;">deployment.apps/demoapp-deploy scaled</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@kube-master yaml]# kubectl scale deployment demoapp-deploy --replicas=3</span></span>
<span class="line"><span style="color:#24292e;">deployment.apps/demoapp-deploy scaled</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">💡 说明</p><p>有三种方式可以修改，</p><p>kubectl scale</p><p>kubectl edit deployment dp_name</p><p>vim yaml</p></div><h2 id="_2-4-滚动更新" tabindex="-1">2.4 滚动更新 <a class="header-anchor" href="#_2-4-滚动更新" aria-label="Permalink to &quot;2.4 滚动更新&quot;">​</a></h2><p>谓滚动更新，更新的是镜像，使用新的镜像逐步更新Pod，回退也是一样的。但对于用户而言是无感知</p><h3 id="查看pod使用哪个镜像-通过yaml观察" tabindex="-1">查看pod使用哪个镜像，通过yaml观察 <a class="header-anchor" href="#查看pod使用哪个镜像-通过yaml观察" aria-label="Permalink to &quot;查看pod使用哪个镜像，通过yaml观察&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pod</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">demoapp-deploy-56b485fd48-c4kjp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-oyaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pod</span><span style="color:#24292E;"> </span><span style="color:#032F62;">demoapp-deploy-56b485fd48-c4kjp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-oyaml</span></span></code></pre></div><h3 id="升级" tabindex="-1">升级 <a class="header-anchor" href="#升级" aria-label="Permalink to &quot;升级&quot;">​</a></h3><p>--record ，记录更新变化的详细内容，方便后续回滚</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">kubectl set image deployment demoapp-deploy *=oldxu3957/demoapp:v1.1 --record</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">kubectl set image deployment demoapp-deploy *=oldxu3957/demoapp:v1.1 --record</span></span></code></pre></div><ul><li>查看升级过程</li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#查看dp</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl get deployments.apps</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">UP-TO-DATE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AVAILABLE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">demoapp-deploy</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">/3</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">           </span><span style="color:#79B8FF;">3</span><span style="color:#9ECBFF;">h1m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看升级后的日志</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master yaml]# kubectl describe deployments.apps demoapp-deploy</span></span>
<span class="line"><span style="color:#B392F0;">。。。</span></span>
<span class="line"><span style="color:#B392F0;">Events:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Type</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Reason</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">Age</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">From</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">Message</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">----</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">------</span><span style="color:#E1E4E8;">             </span><span style="color:#79B8FF;">----</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">----</span><span style="color:#E1E4E8;">                   </span><span style="color:#79B8FF;">-------</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Normal</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">ScalingReplicaSet</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">30</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">deployment-controller</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Scaled</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">up</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">replica</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">demoapp-deploy-56b485fd48</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">5</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">Normal</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">ScalingReplicaSet</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">23</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">deployment-controller</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Scaled</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">down</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">replica</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">demoapp-deploy-56b485fd48</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#查看dp</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl get deployments.apps</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">             </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">UP-TO-DATE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AVAILABLE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">demoapp-deploy</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">/3</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">            </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">           </span><span style="color:#005CC5;">3</span><span style="color:#032F62;">h1m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#查看升级后的日志</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master yaml]# kubectl describe deployments.apps demoapp-deploy</span></span>
<span class="line"><span style="color:#6F42C1;">。。。</span></span>
<span class="line"><span style="color:#6F42C1;">Events:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Type</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Reason</span><span style="color:#24292E;">             </span><span style="color:#032F62;">Age</span><span style="color:#24292E;">   </span><span style="color:#032F62;">From</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">Message</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">----</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">------</span><span style="color:#24292E;">             </span><span style="color:#005CC5;">----</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">----</span><span style="color:#24292E;">                   </span><span style="color:#005CC5;">-------</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Normal</span><span style="color:#24292E;">  </span><span style="color:#032F62;">ScalingReplicaSet</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">30</span><span style="color:#032F62;">m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">deployment-controller</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Scaled</span><span style="color:#24292E;"> </span><span style="color:#032F62;">up</span><span style="color:#24292E;"> </span><span style="color:#032F62;">replica</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set</span><span style="color:#24292E;"> </span><span style="color:#032F62;">demoapp-deploy-56b485fd48</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">5</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">Normal</span><span style="color:#24292E;">  </span><span style="color:#032F62;">ScalingReplicaSet</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">23</span><span style="color:#032F62;">m</span><span style="color:#24292E;">   </span><span style="color:#032F62;">deployment-controller</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Scaled</span><span style="color:#24292E;"> </span><span style="color:#032F62;">down</span><span style="color:#24292E;"> </span><span style="color:#032F62;">replica</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set</span><span style="color:#24292E;"> </span><span style="color:#032F62;">demoapp-deploy-56b485fd48</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span></span></code></pre></div><h3 id="回滚" tabindex="-1">回滚 <a class="header-anchor" href="#回滚" aria-label="Permalink to &quot;回滚&quot;">​</a></h3><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#查看回滚版本</span></span>
<span class="line"><span style="color:#B392F0;">root@kube-master</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yaml]#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rollout</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">history</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployment</span></span>
<span class="line"><span style="color:#B392F0;">deployment.apps/demoapp-deploy</span></span>
<span class="line"><span style="color:#B392F0;">REVISION</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">CHANGE-CAUSE</span></span>
<span class="line"><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">deployment.apps/nginx</span></span>
<span class="line"><span style="color:#B392F0;">REVISION</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">CHANGE-CAUSE</span></span>
<span class="line"><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;">         </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#回滚到指定的版本</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rollout</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">undo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deploy</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">demoapp-deploy</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--to-revision=1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#查看回滚版本</span></span>
<span class="line"><span style="color:#6F42C1;">root@kube-master</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yaml]#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rollout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">history</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployment</span></span>
<span class="line"><span style="color:#6F42C1;">deployment.apps/demoapp-deploy</span></span>
<span class="line"><span style="color:#6F42C1;">REVISION</span><span style="color:#24292E;">  </span><span style="color:#032F62;">CHANGE-CAUSE</span></span>
<span class="line"><span style="color:#6F42C1;">1</span><span style="color:#24292E;">         </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">deployment.apps/nginx</span></span>
<span class="line"><span style="color:#6F42C1;">REVISION</span><span style="color:#24292E;">  </span><span style="color:#032F62;">CHANGE-CAUSE</span></span>
<span class="line"><span style="color:#6F42C1;">1</span><span style="color:#24292E;">         </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#回滚到指定的版本</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rollout</span><span style="color:#24292E;"> </span><span style="color:#032F62;">undo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deploy</span><span style="color:#24292E;"> </span><span style="color:#032F62;">demoapp-deploy</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--to-revision=1</span></span></code></pre></div>`,53),e=[o];function c(t,r,y,E,i,F){return a(),n("div",null,e)}const m=s(l,[["render",c]]);export{C as __pageData,m as default};
