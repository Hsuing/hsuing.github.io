import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const m=JSON.parse('{"title":"1. docker-compose方式","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Monitor/Prometheus/AlertManager/1-docker.md","filePath":"guide/Linux/Monitor/Prometheus/AlertManager/1-docker.md","lastUpdated":1733967691000}'),p={name:"guide/Linux/Monitor/Prometheus/AlertManager/1-docker.md"},o=l(`<h1 id="_1-docker-compose方式" tabindex="-1">1. docker-compose方式 <a class="header-anchor" href="#_1-docker-compose方式" aria-label="Permalink to &quot;1. docker-compose方式&quot;">​</a></h1><h2 id="_1-1-创建目录" tabindex="-1">1.1 创建目录 <a class="header-anchor" href="#_1-1-创建目录" aria-label="Permalink to &quot;1.1 创建目录&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/monitor/prometheus/alertmanager/config</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/monitor/prometheus/alertmanager/config</span></span></code></pre></div><h2 id="_1-2-创建配置文件" tabindex="-1">1.2 创建配置文件 <a class="header-anchor" href="#_1-2-创建配置文件" aria-label="Permalink to &quot;1.2 创建配置文件&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#9ECBFF;">cat &gt; /data/monitor/prometheus/alertmanager/config/alertmanager.yml &lt;&lt;EOF</span></span>
<span class="line"><span style="color:#85E89D;">global</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resolve_timeout</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1m</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">smtp_smarthost</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;smtp.qq.com:465&#39;</span><span style="color:#E1E4E8;">     </span><span style="color:#6A737D;"># 邮箱服务器的SMTP主机配置</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">smtp_from</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;xx@qq.com&#39;</span><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># 发送邮件主题</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">smtp_auth_username</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;xx@qq.com&#39;</span><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;"># 登录用户名</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">smtp_auth_password</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;djubruffhuolbeee&#39;</span><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># 此处的auth password是邮箱的第三方登录授权密码，而非用户密码</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">smtp_require_tls</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;">           </span><span style="color:#6A737D;"># 有些邮箱需要开启此配置，这里使用的是企微邮箱，仅做测试，不需要开启此功能。</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#templates:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#  - &#39;/etc/alertmanager/*.tmpl&#39;</span></span>
<span class="line"><span style="color:#85E89D;">route</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">group_by</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;env&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;instance&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;type&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;group&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;job&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;alertname&#39;</span><span style="color:#E1E4E8;">,</span><span style="color:#9ECBFF;">&#39;cluster&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">group_wait</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">10s</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># 分组内第一个告警等待时间，10s内如有第二个告警会合并一个告警</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">group_interval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">1m</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># 发送新告警间隔时间</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">repeat_interval</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">10m</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># 重复告警间隔发送时间，如果没处理过多久再次发送一次</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">receiver</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;webhook&#39;</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#  默认接收人</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">routes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">receiver</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;webhook&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">match</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">critical</span></span>
<span class="line"><span style="color:#85E89D;">receivers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;webhook&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">webhook_configs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">url</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;http://prometheus-alert-center.monitor.svc:8080/prometheusalert?type=fs&amp;tpl=prometheus-fs&amp;fsurl=https://open.feishu.cn/open-apis/bot/v2/hook/51eb144c-cc6a-47f6-942e-de9f734c9b23&amp;at=hanxiong&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">send_resolved</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">true</span></span>
<span class="line"><span style="color:#85E89D;">inhibit_rules</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">source_match</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;critical&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">target_match</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">severity</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;warning&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">equal</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&#39;alertname&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;dev&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&#39;instance&#39;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#032F62;">cat &gt; /data/monitor/prometheus/alertmanager/config/alertmanager.yml &lt;&lt;EOF</span></span>
<span class="line"><span style="color:#22863A;">global</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resolve_timeout</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1m</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">smtp_smarthost</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;smtp.qq.com:465&#39;</span><span style="color:#24292E;">     </span><span style="color:#6A737D;"># 邮箱服务器的SMTP主机配置</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">smtp_from</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;xx@qq.com&#39;</span><span style="color:#24292E;">    </span><span style="color:#6A737D;"># 发送邮件主题</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">smtp_auth_username</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;xx@qq.com&#39;</span><span style="color:#24292E;">      </span><span style="color:#6A737D;"># 登录用户名</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">smtp_auth_password</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;djubruffhuolbeee&#39;</span><span style="color:#24292E;">    </span><span style="color:#6A737D;"># 此处的auth password是邮箱的第三方登录授权密码，而非用户密码</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">smtp_require_tls</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">false</span><span style="color:#24292E;">           </span><span style="color:#6A737D;"># 有些邮箱需要开启此配置，这里使用的是企微邮箱，仅做测试，不需要开启此功能。</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">#templates:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6A737D;">#  - &#39;/etc/alertmanager/*.tmpl&#39;</span></span>
<span class="line"><span style="color:#22863A;">route</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">group_by</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;env&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;instance&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;type&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;group&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;job&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;alertname&#39;</span><span style="color:#24292E;">,</span><span style="color:#032F62;">&#39;cluster&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">group_wait</span><span style="color:#24292E;">: </span><span style="color:#032F62;">10s</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 分组内第一个告警等待时间，10s内如有第二个告警会合并一个告警</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">group_interval</span><span style="color:#24292E;">: </span><span style="color:#032F62;">1m</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 发送新告警间隔时间</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">repeat_interval</span><span style="color:#24292E;">: </span><span style="color:#032F62;">10m</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 重复告警间隔发送时间，如果没处理过多久再次发送一次</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">receiver</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;webhook&#39;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#  默认接收人</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">routes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">receiver</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;webhook&#39;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">match</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">critical</span></span>
<span class="line"><span style="color:#22863A;">receivers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;webhook&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">webhook_configs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">url</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;http://prometheus-alert-center.monitor.svc:8080/prometheusalert?type=fs&amp;tpl=prometheus-fs&amp;fsurl=https://open.feishu.cn/open-apis/bot/v2/hook/51eb144c-cc6a-47f6-942e-de9f734c9b23&amp;at=hanxiong&#39;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">send_resolved</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">true</span></span>
<span class="line"><span style="color:#22863A;">inhibit_rules</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">source_match</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;critical&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">target_match</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">severity</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;warning&#39;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">equal</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&#39;alertname&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;dev&#39;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&#39;instance&#39;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span></code></pre></div><h2 id="_1-3-创建docker-compose" tabindex="-1">1.3 创建docker-compose <a class="header-anchor" href="#_1-3-创建docker-compose" aria-label="Permalink to &quot;1.3 创建docker-compose&quot;">​</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">version</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&#39;3&#39;</span></span>
<span class="line"><span style="color:#85E89D;">services</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">alertmanager</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">prom/alertmanager:v0.27.0</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">container_name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">alertmanager</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">restart</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">always</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">environment</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">TZ=Asia/Shanghai</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&quot;19093:9093&quot;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&#39;--config.file=/etc/alertmanager/alertmanager.yml&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&#39;--storage.path=/alertmanager&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&#39;--log.level=debug&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">&#39;--log.format=logfmt&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#6A737D;">#- &#39;--web.external-url=http://alertmanager.xxx.net&#39; #由于我这里是nginx代理，暂时不需要这个参数</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#9ECBFF;">/data/monitor/prometheus/alertmanager/config/alertmanager.yml:/etc/alertmanager/alertmanager.yml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">version</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&#39;3&#39;</span></span>
<span class="line"><span style="color:#22863A;">services</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">alertmanager</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">prom/alertmanager:v0.27.0</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">container_name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">alertmanager</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">restart</span><span style="color:#24292E;">: </span><span style="color:#032F62;">always</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">environment</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">TZ=Asia/Shanghai</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&quot;19093:9093&quot;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">command</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&#39;--config.file=/etc/alertmanager/alertmanager.yml&#39;</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&#39;--storage.path=/alertmanager&#39;</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&#39;--log.level=debug&#39;</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">&#39;--log.format=logfmt&#39;</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#6A737D;">#- &#39;--web.external-url=http://alertmanager.xxx.net&#39; #由于我这里是nginx代理，暂时不需要这个参数</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#032F62;">/data/monitor/prometheus/alertmanager/config/alertmanager.yml:/etc/alertmanager/alertmanager.yml</span></span></code></pre></div><ul><li>启动</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">docker-compose</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">up</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-d</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">docker-compose</span><span style="color:#24292E;"> </span><span style="color:#032F62;">up</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span></span></code></pre></div><h2 id="_1-4-配置nginx" tabindex="-1">1.4 配置nginx <a class="header-anchor" href="#_1-4-配置nginx" aria-label="Permalink to &quot;1.4 配置nginx&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">location</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">^~</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">/alert/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">proxy_pass</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">http://172.18.110.129:19093/</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">proxy_set_header</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">X-Real-IP</span><span style="color:#E1E4E8;"> $remote_addr;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">proxy_set_header</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">X-Forwarded-For</span><span style="color:#E1E4E8;"> $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">proxy_http_version</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1.1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">proxy_set_header</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Connection</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Keep-Alive&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">proxy_set_header</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Host</span><span style="color:#E1E4E8;"> $http_host;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">proxy_set_header</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Upgrade</span><span style="color:#E1E4E8;"> $http_upgrade;</span></span>
<span class="line"><span style="color:#E1E4E8;">	</span><span style="color:#B392F0;">proxy_set_header</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Connection</span><span style="color:#E1E4E8;"> $connection_upgrade;</span></span>
<span class="line"><span style="color:#E1E4E8;">   }</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">location</span><span style="color:#24292E;"> </span><span style="color:#032F62;">^~</span><span style="color:#24292E;">  </span><span style="color:#032F62;">/alert/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">{</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">proxy_pass</span><span style="color:#24292E;">     </span><span style="color:#032F62;">http://172.18.110.129:19093/</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">proxy_set_header</span><span style="color:#24292E;"> </span><span style="color:#032F62;">X-Real-IP</span><span style="color:#24292E;"> $remote_addr;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">proxy_set_header</span><span style="color:#24292E;"> </span><span style="color:#032F62;">X-Forwarded-For</span><span style="color:#24292E;"> $proxy_add_x_forwarded_for;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">proxy_http_version</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">1.1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">proxy_set_header</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Connection</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Keep-Alive&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">proxy_set_header</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Host</span><span style="color:#24292E;"> $http_host;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">proxy_set_header</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Upgrade</span><span style="color:#24292E;"> $http_upgrade;</span></span>
<span class="line"><span style="color:#24292E;">	</span><span style="color:#6F42C1;">proxy_set_header</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Connection</span><span style="color:#24292E;"> $connection_upgrade;</span></span>
<span class="line"><span style="color:#24292E;">   }</span></span></code></pre></div><ul><li>效果</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202412111751922.png" alt="image-20241211175125240"></p><h1 id="_2-docker方式" tabindex="-1">2. docker方式 <a class="header-anchor" href="#_2-docker方式" aria-label="Permalink to &quot;2. docker方式&quot;">​</a></h1><h1 id="_3-k8s方式" tabindex="-1">3. k8s方式 <a class="header-anchor" href="#_3-k8s方式" aria-label="Permalink to &quot;3. k8s方式&quot;">​</a></h1><p>请看k8s章节</p>`,16),e=[o];function t(r,c,E,y,i,F){return a(),n("div",null,e)}const h=s(p,[["render",t]]);export{m as __pageData,h as default};
