import{_ as t,o as e,c as r,R as a}from"./chunks/framework.zUbWieqp.js";const b=JSON.parse('{"title":"1. Prometheus 简介","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Monitor/Prometheus/index.md","filePath":"guide/Linux/Monitor/Prometheus/index.md","lastUpdated":1735121496000}'),o={name:"guide/Linux/Monitor/Prometheus/index.md"},h=a('<p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202412251028026.jpeg" alt="img"></p><h1 id="_1-prometheus-简介" tabindex="-1">1. Prometheus <a href="https://prometheus.io/docs/introduction/overview/" target="_blank" rel="noreferrer">简介</a> <a class="header-anchor" href="#_1-prometheus-简介" aria-label="Permalink to &quot;1. Prometheus [简介](https://prometheus.io/docs/introduction/overview/)&quot;">​</a></h1><p><a href="https://github.com/prometheus" target="_blank" rel="noreferrer">Prometheus</a> 是由前 Google 工程师从 2012 年开始在 <a href="http://soundcloud.com/" target="_blank" rel="noreferrer">Soundcloud</a> 以开源软件的形式进行研发的系统监控和告警工具包，自此以后，许多公司和组织都采用了 Prometheus 作为监控告警工具。Prometheus 的开发者和用户社区非常活跃，它现在是一个独立的开源项目，可以独立于任何公司进行维护。为了证明这一点，Prometheus 于 2016 年 5 月加入 <a href="https://cncf.io/" target="_blank" rel="noreferrer">CNCF</a> 基金会，成为继 <a href="http://kubernetes.io/" target="_blank" rel="noreferrer">Kubernetes</a> 之后的第二个 CNCF 托管项目。</p><ul><li>发布史</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411251814614.png" alt=""></p><h1 id="_2-prometheus特点" tabindex="-1">2. Prometheus特点 <a class="header-anchor" href="#_2-prometheus特点" aria-label="Permalink to &quot;2. Prometheus特点&quot;">​</a></h1><h3 id="_1-易于管理" tabindex="-1">1.易于管理 <a class="header-anchor" href="#_1-易于管理" aria-label="Permalink to &quot;1.易于管理&quot;">​</a></h3><p>Prometheus核心部分只有一个单独的二进制文件，不存在任何的第三方依赖（例如数据库、缓存等）。唯一需要的就是本地磁盘，因此不会有潜在的级联故障的风险。</p><h3 id="_2-强大的数据模型" tabindex="-1">2.强大的数据模型 <a class="header-anchor" href="#_2-强大的数据模型" aria-label="Permalink to &quot;2.强大的数据模型&quot;">​</a></h3><p>所有采集的监控数据均以指标（metric）的形式保存在内置的时间序列数据库（TSDB）中。所有的样本除了基本的指标名称以外，还包含一组用于描述该样本特征的标签</p><h3 id="_3-强大的查询语言promql" tabindex="-1">3.强大的查询语言PromQL <a class="header-anchor" href="#_3-强大的查询语言promql" aria-label="Permalink to &quot;3.强大的查询语言PromQL&quot;">​</a></h3><p>Prometheus内置了一个强大的数据查询语言PromQL。通过PromQL可以实现对监控数据的查询、聚合。同时PromQL也被应用于数据可视化（如Grafana）以及告警当中。</p><h3 id="_4-高效" tabindex="-1">4.高效 <a class="header-anchor" href="#_4-高效" aria-label="Permalink to &quot;4.高效&quot;">​</a></h3><p>对于监控系统而言，大量的监控任务必然导致有大量的数据产生，而Prometheus可以高效地处理这些数据。对于单一Prometheus Server实例而言，它可以处理：</p><ul><li><p>数以百万的监控指标</p></li><li><p>每秒处理数十万的数据点</p></li></ul><h3 id="_5-可扩展" tabindex="-1">5.可扩展 <a class="header-anchor" href="#_5-可扩展" aria-label="Permalink to &quot;5.可扩展&quot;">​</a></h3><p>可以在每个数据中心、每个团队运行独立的Prometheus Server。Prometheus对于联邦集群的支持，可以让多个Prometheus实例产生1个逻辑集群。当单个Prometheus Server处理的任务量过大时，通过使用功能分区（sharding）+联邦集群（federation），可以对其扩展。</p><h3 id="_6-易于集成" tabindex="-1">6.易于集成 <a class="header-anchor" href="#_6-易于集成" aria-label="Permalink to &quot;6.易于集成&quot;">​</a></h3><p>使用Prometheus可以快速搭建监控服务，并且可以非常方便地在应用程序中进行<a href="https://prometheus.io/docs/instrumenting/clientlibs/" target="_blank" rel="noreferrer">集成</a>。</p><h3 id="_7-可视化" tabindex="-1">7.可视化 <a class="header-anchor" href="#_7-可视化" aria-label="Permalink to &quot;7.可视化&quot;">​</a></h3><p>Prometheus Server中自带的Prometheus UI，基于Prometheus提供的API还可以实现自己的监控可视化UI，也可以结合grafana进行展示</p><h3 id="_8-开放性" tabindex="-1">8.开放性 <a class="header-anchor" href="#_8-开放性" aria-label="Permalink to &quot;8.开放性&quot;">​</a></h3><p>通常来说当我们需要监控一个应用程序时，一般需要该应用程序提供对相应监控系统协议的支持，因此应用程序会与所选择的监控系统进行绑定。为了减少这种绑定所带来的限制，对于决策者而言要么你就直接在应用中集成该监控系统的支持，要么就在外部创建单独的服务来适配不同的监控系统。</p><p>而对于Prometheus来说，使用Prometheus的client library的输出格式不止支持Prometheus的格式化数据，也可以输出支持其它监控系统的格式化数据，比如Graphite。 因此你甚至可以在不使用Prometheus的情况下，采用Prometheus的client library来让你的应用程序支持监控数据采集。</p><h1 id="_3-prometheus生态圈组件" tabindex="-1">3. Prometheus生态圈组件 <a class="header-anchor" href="#_3-prometheus生态圈组件" aria-label="Permalink to &quot;3. Prometheus生态圈组件&quot;">​</a></h1><table><thead><tr><th>组件名字</th><th>描述</th></tr></thead><tbody><tr><td>Prometheus Server</td><td>主服务器，负责收集和存储时间序列数据</td></tr><tr><td>Client libraries</td><td>应用程序代码插桩，将监控指标嵌入到被监控应用程序中</td></tr><tr><td>Pushgateway</td><td>推送网关，为支持short-lived作业提供一个推送网关</td></tr><tr><td>Exporter</td><td>为一些应用开发的数据摄取组件-exporter，例如：HAProxy、StatsD、Graphite等</td></tr><tr><td>Altermanager</td><td>专门用于处理alert的组件</td></tr></tbody></table><h1 id="_4-prometheus架构" tabindex="-1">4. Prometheus架构 <a class="header-anchor" href="#_4-prometheus架构" aria-label="Permalink to &quot;4. Prometheus架构&quot;">​</a></h1><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202411251729595.png" alt="image-20241125172930415"></p><h2 id="_4-1大致分为三类" tabindex="-1">4.1大致分为三类 <a class="header-anchor" href="#_4-1大致分为三类" aria-label="Permalink to &quot;4.1大致分为三类&quot;">​</a></h2><h3 id="采集层" tabindex="-1">采集层： <a class="header-anchor" href="#采集层" aria-label="Permalink to &quot;采集层：&quot;">​</a></h3><p>采集层分为2类，一类是生命周期较短的作业，还有一类市生命周期较长的作业：</p><table><thead><tr><th>生命周期</th><th>描述</th></tr></thead><tbody><tr><td>短作业（例如executor）</td><td>直接通过API，在退出时间指标推送给Pushgateway</td></tr><tr><td>长作业</td><td>Retrieval组件直接从Job或者Exporter拉取数据</td></tr></tbody></table><h3 id="存储层" tabindex="-1">存储层： <a class="header-anchor" href="#存储层" aria-label="Permalink to &quot;存储层：&quot;">​</a></h3><table><thead><tr><th>名称</th><th>描述</th></tr></thead><tbody><tr><td>Prometheus Server</td><td>包含了存储引擎和计算引擎</td></tr><tr><td>Retrieval组件为取数组件</td><td>主动从Pushgateway或者Exporter拉取指标数据</td></tr><tr><td>Service discovery</td><td>可以动态发现要监控的目标</td></tr><tr><td>TSDB</td><td>数据核心存储与查询</td></tr><tr><td>HTTP server</td><td>对外提供HTTP服务</td></tr></tbody></table><h3 id="应用层" tabindex="-1">应用层： <a class="header-anchor" href="#应用层" aria-label="Permalink to &quot;应用层：&quot;">​</a></h3><p>应用层主要分为2种，一种是AlertManager，另一种是数据可视化。</p><table><thead><tr><th>应用名字</th><th>描述</th></tr></thead><tbody><tr><td>AlertManager</td><td>对接报警</td></tr><tr><td>数据可视化</td><td>grafana或者Prometheus WebUI</td></tr></tbody></table><p><a href="https://erdong.site/prometheus-notes/chapter01-Basic/1.1-prometheus-introduction.html" target="_blank" rel="noreferrer">https://erdong.site/prometheus-notes/chapter01-Basic/1.1-prometheus-introduction.html</a></p><p><a href="https://www.cnblogs.com/panwenbin-logs/p/18396013" target="_blank" rel="noreferrer">https://www.cnblogs.com/panwenbin-logs/p/18396013</a></p><p><a href="https://www.cnblogs.com/kevingrace/p/11151649.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/kevingrace/p/11151649.html</a></p><p><a href="https://cloud.tencent.com/document/product/1416/56011" target="_blank" rel="noreferrer">https://cloud.tencent.com/document/product/1416/56011</a></p><p><a href="https://www.alibabacloud.com/help/zh/prometheus/user-guide/using-container-monitoring-pro?spm=a2c63.p38356.0.0.428350a43VvtrW" target="_blank" rel="noreferrer">https://www.alibabacloud.com/help/zh/prometheus/user-guide/using-container-monitoring-pro?spm=a2c63.p38356.0.0.428350a43VvtrW</a></p><p>视频：</p><p><a href="https://www.youtube.com/watch?v=h4Sl21AKiDg" target="_blank" rel="noreferrer">https://www.youtube.com/watch?v=h4Sl21AKiDg</a></p><p><a href="https://www.youtube.com/watch?v=rx6CPDK_5mU&amp;list=PLy_6D98if3ULEtXtNSY_2qN21VCKgoQAE" target="_blank" rel="noreferrer">https://www.youtube.com/watch?v=rx6CPDK_5mU&amp;list=PLy_6D98if3ULEtXtNSY_2qN21VCKgoQAE</a></p>',45),s=[h];function n(i,d,l,u,p,m){return e(),r("div",null,s)}const P=t(o,[["render",n]]);export{b as __pageData,P as default};
