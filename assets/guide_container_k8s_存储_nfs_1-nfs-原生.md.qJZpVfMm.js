import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const C=JSON.parse('{"title":"1. åˆ›å»ºyaml","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/å­˜å‚¨/nfs/1-nfs-åŸç”Ÿ.md","filePath":"guide/container/k8s/å­˜å‚¨/nfs/1-nfs-åŸç”Ÿ.md","lastUpdated":1717511420000}'),p={name:"guide/container/k8s/å­˜å‚¨/nfs/1-nfs-åŸç”Ÿ.md"},o=l(`<h1 id="_1-åˆ›å»ºyaml" tabindex="-1">1. åˆ›å»ºyaml <a class="header-anchor" href="#_1-åˆ›å»ºyaml" aria-label="Permalink to &quot;1. åˆ›å»ºyaml&quot;">â€‹</a></h1><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master nfs</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 1.nfs.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">apps/v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Deployment</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-nfs-deployment</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">replicas</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">1</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">selector</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">matchLabels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-nfs-app</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">template</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">app</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-nfs-app</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-nfs-container</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">ports</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">containerPort</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">80</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">        - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-nfs-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/usr/share/nginx/html</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-nfs-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">nfs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">server</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">192.168.1.100</span></span>
<span class="line"><span style="color:#E1E4E8;">          </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/data/nfs</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#nfsä¸­æ­¤æ–‡ä»¶å¤¹å¿…é¡»äº‹å…ˆå­˜åœ¨(éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šé¢åˆ›å»ºï¼Œå› ä¸ºä½ ä¸çŸ¥é“podåœ¨é‚£ä¸ªèŠ‚ç‚¹ä¸Šé¢åˆ›å»º)ï¼Œå¦åˆ™podå»ºç«‹ä¸äº†</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master nfs</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 1.nfs.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">apps/v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Deployment</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-nfs-deployment</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">replicas</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">1</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">selector</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">matchLabels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-nfs-app</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">template</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">app</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-nfs-app</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-nfs-container</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">ports</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">containerPort</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">80</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">        - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-nfs-volume</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/usr/share/nginx/html</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-nfs-volume</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">nfs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">server</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">192.168.1.100</span></span>
<span class="line"><span style="color:#24292E;">          </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/data/nfs</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#nfsä¸­æ­¤æ–‡ä»¶å¤¹å¿…é¡»äº‹å…ˆå­˜åœ¨(éœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šé¢åˆ›å»ºï¼Œå› ä¸ºä½ ä¸çŸ¥é“podåœ¨é‚£ä¸ªèŠ‚ç‚¹ä¸Šé¢åˆ›å»º)ï¼Œå¦åˆ™podå»ºç«‹ä¸äº†</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>è¿™å°±æ˜¯åŸç”Ÿçš„ä¸€ä¸ªç¼ºç‚¹ï¼Œéœ€è¦åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸Šé¢åˆ›å»ºè¿™ä¸ªç›®å½•</p></div><h1 id="_2-æ‰§è¡Œapply" tabindex="-1">2. æ‰§è¡Œapply <a class="header-anchor" href="#_2-æ‰§è¡Œapply" aria-label="Permalink to &quot;2. æ‰§è¡Œapply&quot;">â€‹</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# kubectl apply -f 1.nfs.yaml</span></span>
<span class="line"><span style="color:#B392F0;">deployment.apps/my-nfs-deployment</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">created</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# kubectl apply -f 1.nfs.yaml</span></span>
<span class="line"><span style="color:#6F42C1;">deployment.apps/my-nfs-deployment</span><span style="color:#24292E;"> </span><span style="color:#032F62;">created</span></span></code></pre></div><h1 id="_3-æŸ¥çœ‹" tabindex="-1">3. æŸ¥çœ‹ <a class="header-anchor" href="#_3-æŸ¥çœ‹" aria-label="Permalink to &quot;3. æŸ¥çœ‹&quot;">â€‹</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# kubectl get pod -owide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                                   </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">IP</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">NODE</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">NOMINATED</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NODE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">READINESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">GATES</span></span>
<span class="line"><span style="color:#B392F0;">my-nfs-deployment-59b75555dd-qwtbl</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">               </span><span style="color:#79B8FF;">4</span><span style="color:#9ECBFF;">m35s</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">172.30</span><span style="color:#9ECBFF;">.0.148</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">kube-node01</span><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# kubectl get pod -owide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                                   </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">        </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">     </span><span style="color:#032F62;">IP</span><span style="color:#24292E;">              </span><span style="color:#032F62;">NODE</span><span style="color:#24292E;">          </span><span style="color:#032F62;">NOMINATED</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NODE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">READINESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">GATES</span></span>
<span class="line"><span style="color:#6F42C1;">my-nfs-deployment-59b75555dd-qwtbl</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">               </span><span style="color:#005CC5;">4</span><span style="color:#032F62;">m35s</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">172.30</span><span style="color:#032F62;">.0.148</span><span style="color:#24292E;">    </span><span style="color:#032F62;">kube-node01</span><span style="color:#24292E;">   </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h1 id="_4-åœ¨nfsä¸Šé¢åˆ›å»ºæ–‡ä»¶" tabindex="-1">4. åœ¨nfsä¸Šé¢åˆ›å»ºæ–‡ä»¶ <a class="header-anchor" href="#_4-åœ¨nfsä¸Šé¢åˆ›å»ºæ–‡ä»¶" aria-label="Permalink to &quot;4. åœ¨nfsä¸Šé¢åˆ›å»ºæ–‡ä»¶&quot;">â€‹</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#åœ¨serverç«¯æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#79B8FF;">echo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;hello nfs&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/nfs/index.html</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#åœ¨serverç«¯æ‰§è¡Œ</span></span>
<span class="line"><span style="color:#005CC5;">echo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;hello nfs&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/nfs/index.html</span></span></code></pre></div><ul><li>éªŒè¯æ•ˆæœ</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# curl 172.30.0.148</span></span>
<span class="line"><span style="color:#B392F0;">hello</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nfs</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# curl 172.30.0.148</span></span>
<span class="line"><span style="color:#6F42C1;">hello</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nfs</span></span></code></pre></div><h1 id="_5-redisæ¡ˆä¾‹" tabindex="-1">5. redisæ¡ˆä¾‹ <a class="header-anchor" href="#_5-redisæ¡ˆä¾‹" aria-label="Permalink to &quot;5. redisæ¡ˆä¾‹&quot;">â€‹</a></h1><h2 id="_5-1-pv" tabindex="-1">5.1 pv <a class="header-anchor" href="#_5-1-pv" aria-label="Permalink to &quot;5.1 pv&quot;">â€‹</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master nfs</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 4.nfs-redis-pv.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolume</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nfs-pv</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:     </span><span style="color:#6A737D;">#æ ‡ç­¾</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">release</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nfs-redis</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">storageClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;nfs-storage&quot;</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#èµ„æºç±»å‹è¡¨ç¤º</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">persistentVolumeReclaimPolicy</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;Recycle&quot;</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#å›æ”¶ç­–ç•¥ä¸ºRecycleç›¸å½“rm -rf /</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">capacity</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0.5Gi</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">nfs</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">server</span><span style="color:#E1E4E8;">: </span><span style="color:#79B8FF;">10.103.236.199</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/data/nfs/redis</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master nfs</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 4.nfs-redis-pv.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolume</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nfs-pv</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:     </span><span style="color:#6A737D;">#æ ‡ç­¾</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">release</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nfs-redis</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">storageClassName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;nfs-storage&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#èµ„æºç±»å‹è¡¨ç¤º</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">persistentVolumeReclaimPolicy</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;Recycle&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#å›æ”¶ç­–ç•¥ä¸ºRecycleç›¸å½“rm -rf /</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">capacity</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0.5Gi</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">nfs</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">server</span><span style="color:#24292E;">: </span><span style="color:#005CC5;">10.103.236.199</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/data/nfs/redis</span></span></code></pre></div><h2 id="_5-2-pvc" tabindex="-1">5.2 pvc <a class="header-anchor" href="#_5-2-pvc" aria-label="Permalink to &quot;5.2 pvc&quot;">â€‹</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master nfs</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 5.nfs-redis-pvc.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nfs-pvc</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">labels</span><span style="color:#E1E4E8;">:    </span><span style="color:#6A737D;">#é¦–å…ˆæ ‡ç­¾é¡»åŒ¹é…ï¼Œä¸ç„¶æ— æ³•åŒ¹é…ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºå¼ºè¡Œç»‘å®šã€‚</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">release</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nfs-redis</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">storageClassName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;nfs-storage&quot;</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#é¡»åŒå±ä¸€ä¸ª</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">accessModes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#9ECBFF;">ReadWriteMany</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">resources</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">requests</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">storage</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">0.5Gi</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#æŒ‡å®šå¤§å°ã€‚</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master nfs</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 5.nfs-redis-pvc.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">PersistentVolumeClaim</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nfs-pvc</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">labels</span><span style="color:#24292E;">:    </span><span style="color:#6A737D;">#é¦–å…ˆæ ‡ç­¾é¡»åŒ¹é…ï¼Œä¸ç„¶æ— æ³•åŒ¹é…ï¼Œä¹Ÿå¯ä»¥ç§°ä¸ºå¼ºè¡Œç»‘å®šã€‚</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">release</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nfs-redis</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">storageClassName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;nfs-storage&quot;</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#é¡»åŒå±ä¸€ä¸ª</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">accessModes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#032F62;">ReadWriteMany</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">resources</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">requests</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">storage</span><span style="color:#24292E;">: </span><span style="color:#032F62;">0.5Gi</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#æŒ‡å®šå¤§å°ã€‚</span></span></code></pre></div><ul><li>æŸ¥çœ‹</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# kubectl get pvc,pv</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">VOLUME</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STORAGECLASS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolumeclaim/nfs-pvc</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">nfs-pv</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">512</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">nfs-storage</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">2</span><span style="color:#9ECBFF;">m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                      </span><span style="color:#9ECBFF;">CAPACITY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">ACCESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MODES</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">RECLAIM</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POLICY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">CLAIM</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">STORAGECLASS</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">REASON</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">AGE</span></span>
<span class="line"><span style="color:#B392F0;">persistentvolume/nfs-pv</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">512</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Recycle</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">default/nfs-pvc</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">nfs-storage</span><span style="color:#E1E4E8;">             </span><span style="color:#79B8FF;">5</span><span style="color:#9ECBFF;">m12s</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# kubectl get pvc,pv</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                            </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">VOLUME</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STORAGECLASS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolumeclaim/nfs-pvc</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">nfs-pv</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">512</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">      </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">nfs-storage</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">2</span><span style="color:#032F62;">m</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                      </span><span style="color:#032F62;">CAPACITY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">ACCESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MODES</span><span style="color:#24292E;">   </span><span style="color:#032F62;">RECLAIM</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POLICY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">CLAIM</span><span style="color:#24292E;">             </span><span style="color:#032F62;">STORAGECLASS</span><span style="color:#24292E;">   </span><span style="color:#032F62;">REASON</span><span style="color:#24292E;">   </span><span style="color:#032F62;">AGE</span></span>
<span class="line"><span style="color:#6F42C1;">persistentvolume/nfs-pv</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">512</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">      </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Recycle</span><span style="color:#24292E;">          </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">    </span><span style="color:#032F62;">default/nfs-pvc</span><span style="color:#24292E;">   </span><span style="color:#032F62;">nfs-storage</span><span style="color:#24292E;">             </span><span style="color:#005CC5;">5</span><span style="color:#032F62;">m12s</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# kubectl describe pv nfs-pv</span></span>
<span class="line"><span style="color:#B392F0;">Name:</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">nfs-pv</span></span>
<span class="line"><span style="color:#B392F0;">Labels:</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">release=nfs-redis</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># æ‰€å±æ ‡ç­¾</span></span>
<span class="line"><span style="color:#B392F0;">Annotations:</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">pv.kubernetes.io/bound-by-controller:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yes</span></span>
<span class="line"><span style="color:#B392F0;">Finalizers:</span><span style="color:#E1E4E8;">      [kubernetes.io/pv-protection]</span></span>
<span class="line"><span style="color:#B392F0;">StorageClass:</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">nfs-storage</span><span style="color:#E1E4E8;">       </span><span style="color:#6A737D;"># storageclassåç§°</span></span>
<span class="line"><span style="color:#B392F0;">Status:</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">Bound</span><span style="color:#E1E4E8;">			   </span><span style="color:#6A737D;"># ç»‘å®šçŠ¶æ€</span></span>
<span class="line"><span style="color:#B392F0;">Claim:</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">default/nfs-pvc</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;"># åç§°ç©ºé—´</span></span>
<span class="line"><span style="color:#B392F0;">Reclaim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Policy:</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Recycle</span><span style="color:#E1E4E8;">			</span><span style="color:#6A737D;"># å›æ”¶ç­–ç•¥</span></span>
<span class="line"><span style="color:#B392F0;">Access</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Modes:</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RWX</span><span style="color:#E1E4E8;">			    </span><span style="color:#6A737D;"># è®¿é—®æ¨¡å¼</span></span>
<span class="line"><span style="color:#B392F0;">VolumeMode:</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">Filesystem</span></span>
<span class="line"><span style="color:#B392F0;">Capacity:</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">512</span><span style="color:#9ECBFF;">Mi</span><span style="color:#E1E4E8;">			    </span><span style="color:#6A737D;"># å¤§å°</span></span>
<span class="line"><span style="color:#B392F0;">Node</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Affinity:</span><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">Message:</span></span>
<span class="line"><span style="color:#B392F0;">Source:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Type:</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">NFS</span><span style="color:#E1E4E8;"> (an </span><span style="color:#9ECBFF;">NFS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mount</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">that</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">lasts</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">lifetime</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">of</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pod</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Server:</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">10.103</span><span style="color:#9ECBFF;">.236.199</span><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;"># æ¥è‡ªé‚£ä¸ªnfsæœåŠ¡å™¨</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Path:</span><span style="color:#E1E4E8;">      </span><span style="color:#9ECBFF;">/data/nfs/redis</span><span style="color:#E1E4E8;">		</span><span style="color:#6A737D;"># å…±äº«æ•°æ®ç›®å½•</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">ReadOnly:</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">Events:</span><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# kubectl describe pv nfs-pv</span></span>
<span class="line"><span style="color:#6F42C1;">Name:</span><span style="color:#24292E;">            </span><span style="color:#032F62;">nfs-pv</span></span>
<span class="line"><span style="color:#6F42C1;">Labels:</span><span style="color:#24292E;">          </span><span style="color:#032F62;">release=nfs-redis</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># æ‰€å±æ ‡ç­¾</span></span>
<span class="line"><span style="color:#6F42C1;">Annotations:</span><span style="color:#24292E;">     </span><span style="color:#032F62;">pv.kubernetes.io/bound-by-controller:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yes</span></span>
<span class="line"><span style="color:#6F42C1;">Finalizers:</span><span style="color:#24292E;">      [kubernetes.io/pv-protection]</span></span>
<span class="line"><span style="color:#6F42C1;">StorageClass:</span><span style="color:#24292E;">    </span><span style="color:#032F62;">nfs-storage</span><span style="color:#24292E;">       </span><span style="color:#6A737D;"># storageclassåç§°</span></span>
<span class="line"><span style="color:#6F42C1;">Status:</span><span style="color:#24292E;">          </span><span style="color:#032F62;">Bound</span><span style="color:#24292E;">			   </span><span style="color:#6A737D;"># ç»‘å®šçŠ¶æ€</span></span>
<span class="line"><span style="color:#6F42C1;">Claim:</span><span style="color:#24292E;">           </span><span style="color:#032F62;">default/nfs-pvc</span><span style="color:#24292E;">   </span><span style="color:#6A737D;"># åç§°ç©ºé—´</span></span>
<span class="line"><span style="color:#6F42C1;">Reclaim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Policy:</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Recycle</span><span style="color:#24292E;">			</span><span style="color:#6A737D;"># å›æ”¶ç­–ç•¥</span></span>
<span class="line"><span style="color:#6F42C1;">Access</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Modes:</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RWX</span><span style="color:#24292E;">			    </span><span style="color:#6A737D;"># è®¿é—®æ¨¡å¼</span></span>
<span class="line"><span style="color:#6F42C1;">VolumeMode:</span><span style="color:#24292E;">      </span><span style="color:#032F62;">Filesystem</span></span>
<span class="line"><span style="color:#6F42C1;">Capacity:</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">512</span><span style="color:#032F62;">Mi</span><span style="color:#24292E;">			    </span><span style="color:#6A737D;"># å¤§å°</span></span>
<span class="line"><span style="color:#6F42C1;">Node</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Affinity:</span><span style="color:#24292E;">   </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">Message:</span></span>
<span class="line"><span style="color:#6F42C1;">Source:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Type:</span><span style="color:#24292E;">      </span><span style="color:#032F62;">NFS</span><span style="color:#24292E;"> (an </span><span style="color:#032F62;">NFS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mount</span><span style="color:#24292E;"> </span><span style="color:#032F62;">that</span><span style="color:#24292E;"> </span><span style="color:#032F62;">lasts</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">lifetime</span><span style="color:#24292E;"> </span><span style="color:#032F62;">of</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pod</span><span style="color:#24292E;">)</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Server:</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">10.103</span><span style="color:#032F62;">.236.199</span><span style="color:#24292E;">		</span><span style="color:#6A737D;"># æ¥è‡ªé‚£ä¸ªnfsæœåŠ¡å™¨</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Path:</span><span style="color:#24292E;">      </span><span style="color:#032F62;">/data/nfs/redis</span><span style="color:#24292E;">		</span><span style="color:#6A737D;"># å…±äº«æ•°æ®ç›®å½•</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">ReadOnly:</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">Events:</span><span style="color:#24292E;">        </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><h2 id="_5-3-pod" tabindex="-1">5.3 pod <a class="header-anchor" href="#_5-3-pod" aria-label="Permalink to &quot;5.3 pod&quot;">â€‹</a></h2><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master nfs</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 6.nfs-redis-pod.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis-data</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/data</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">redis-data</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">persistentVolumeClaim</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">claimName</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nfs-pvc</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master nfs</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 6.nfs-redis-pod.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis-data</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/data</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">redis-data</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">persistentVolumeClaim</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">claimName</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nfs-pvc</span></span></code></pre></div><ul><li>æ‰§è¡Œapply</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# kubectl apply -f  6.nfs-redis-pod.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# kubectl apply -f  6.nfs-redis-pod.yaml</span></span></code></pre></div><ul><li>æŸ¥çœ‹podåœ°å€</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# kubectl get pod -owide</span></span>
<span class="line"><span style="color:#B392F0;">NAME</span><span style="color:#E1E4E8;">                                   </span><span style="color:#9ECBFF;">READY</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">STATUS</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RESTARTS</span><span style="color:#E1E4E8;">         </span><span style="color:#9ECBFF;">AGE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">IP</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">NODE</span><span style="color:#E1E4E8;">          </span><span style="color:#9ECBFF;">NOMINATED</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NODE</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">READINESS</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">GATES</span></span>
<span class="line"><span style="color:#B392F0;">redis</span><span style="color:#E1E4E8;">                                  </span><span style="color:#79B8FF;">1</span><span style="color:#9ECBFF;">/1</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">Running</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">                </span><span style="color:#79B8FF;">11</span><span style="color:#9ECBFF;">m</span><span style="color:#E1E4E8;">   </span><span style="color:#79B8FF;">172.30</span><span style="color:#9ECBFF;">.0.170</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">kube-node01</span><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">           </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">non</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# kubectl get pod -owide</span></span>
<span class="line"><span style="color:#6F42C1;">NAME</span><span style="color:#24292E;">                                   </span><span style="color:#032F62;">READY</span><span style="color:#24292E;">   </span><span style="color:#032F62;">STATUS</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RESTARTS</span><span style="color:#24292E;">         </span><span style="color:#032F62;">AGE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">IP</span><span style="color:#24292E;">              </span><span style="color:#032F62;">NODE</span><span style="color:#24292E;">          </span><span style="color:#032F62;">NOMINATED</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NODE</span><span style="color:#24292E;">   </span><span style="color:#032F62;">READINESS</span><span style="color:#24292E;"> </span><span style="color:#032F62;">GATES</span></span>
<span class="line"><span style="color:#6F42C1;">redis</span><span style="color:#24292E;">                                  </span><span style="color:#005CC5;">1</span><span style="color:#032F62;">/1</span><span style="color:#24292E;">     </span><span style="color:#032F62;">Running</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">                </span><span style="color:#005CC5;">11</span><span style="color:#032F62;">m</span><span style="color:#24292E;">   </span><span style="color:#005CC5;">172.30</span><span style="color:#032F62;">.0.170</span><span style="color:#24292E;">    </span><span style="color:#032F62;">kube-node01</span><span style="color:#24292E;">   </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">           </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">non</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><ul><li>è¿›å…¥åˆ°redis</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master nfs]# kubectl exec -it redis -- /bin/bash</span></span>
<span class="line"><span style="color:#B392F0;">root@redis:/data#</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">redis-cli</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-h</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">127.0</span><span style="color:#9ECBFF;">.0.1</span></span>
<span class="line"><span style="color:#B392F0;">127.0.0.1:6379&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kety</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">han</span></span>
<span class="line"><span style="color:#B392F0;">OK</span></span>
<span class="line"><span style="color:#B392F0;">127.0.0.1:6379&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bgsave</span></span>
<span class="line"><span style="color:#B392F0;">Background</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">saving</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">started</span></span>
<span class="line"><span style="color:#B392F0;">127.0.0.1:6379&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">exit</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master nfs]# kubectl exec -it redis -- /bin/bash</span></span>
<span class="line"><span style="color:#6F42C1;">root@redis:/data#</span><span style="color:#24292E;"> </span><span style="color:#032F62;">redis-cli</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-h</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">127.0</span><span style="color:#032F62;">.0.1</span></span>
<span class="line"><span style="color:#6F42C1;">127.0.0.1:6379&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kety</span><span style="color:#24292E;"> </span><span style="color:#032F62;">han</span></span>
<span class="line"><span style="color:#6F42C1;">OK</span></span>
<span class="line"><span style="color:#6F42C1;">127.0.0.1:6379&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bgsave</span></span>
<span class="line"><span style="color:#6F42C1;">Background</span><span style="color:#24292E;"> </span><span style="color:#032F62;">saving</span><span style="color:#24292E;"> </span><span style="color:#032F62;">started</span></span>
<span class="line"><span style="color:#6F42C1;">127.0.0.1:6379&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">exit</span></span></code></pre></div><ul><li>æŸ¥çœ‹nfsç«¯</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@Rocky redis]# ls</span></span>
<span class="line"><span style="color:#B392F0;">dump.rdb</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@Rocky redis]# pwd</span></span>
<span class="line"><span style="color:#B392F0;">/data/nfs/redis</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@Rocky redis]# ls</span></span>
<span class="line"><span style="color:#6F42C1;">dump.rdb</span></span>
<span class="line"><span style="color:#24292E;">[root@Rocky redis]# pwd</span></span>
<span class="line"><span style="color:#6F42C1;">/data/nfs/redis</span></span></code></pre></div>`,29),e=[o];function t(c,r,E,y,i,F){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{C as __pageData,u as default};
