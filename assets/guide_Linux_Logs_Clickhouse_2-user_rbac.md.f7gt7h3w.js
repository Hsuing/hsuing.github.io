import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const A=JSON.parse('{"title":"1. ckRBAC管理","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Logs/Clickhouse/2-user_rbac.md","filePath":"guide/Linux/Logs/Clickhouse/2-user_rbac.md","lastUpdated":1731335909000}'),p={name:"guide/Linux/Logs/Clickhouse/2-user_rbac.md"},o=l(`<h1 id="_1-ckrbac管理" tabindex="-1">1. ckRBAC管理 <a class="header-anchor" href="#_1-ckrbac管理" aria-label="Permalink to &quot;1. ckRBAC管理&quot;">​</a></h1><h2 id="_1-1-介绍" tabindex="-1">1.1 介绍 <a class="header-anchor" href="#_1-1-介绍" aria-label="Permalink to &quot;1.1 介绍&quot;">​</a></h2><p>ClickHouse也支持基于RBAC（Role-Based Access Control）的访问控制管理，即通过SQL-driven来进行管理。在 RBAC 中，权限与角色相关联，通过成为角色的成员而得到这些角色的权限。简化了权限的管理。这样管理都是层级相互依赖的，权限赋予给角色，而把角色又赋予用户，ClickHouse推荐使用该方式进行用户权限管理。</p><h2 id="_1-2-sql-driven" tabindex="-1">1.2 SQL-driven <a class="header-anchor" href="#_1-2-sql-driven" aria-label="Permalink to &quot;1.2 SQL-driven&quot;">​</a></h2><p><a href="https://clickhouse.com/docs/en/operations/access-rights#enabling-sql-user-mode" target="_blank" rel="noreferrer">官当</a></p><p>ClickHouse提供了一个default账号，这个账号有所有的权限，但是不能使用SQL驱动方式的访问权限和账户管理。我们需要在配置文件中修改default账户，使其能够通过SQL驱动方式添加角色和用户。默认default用户是没有办法创建用户的</p><h3 id="_1-开启" tabindex="-1">1.开启 <a class="header-anchor" href="#_1-开启" aria-label="Permalink to &quot;1.开启&quot;">​</a></h3><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">access_management</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">access_management</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">named_collection_control</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">named_collection_control</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">show_named_collections</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">show_named_collections</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">show_named_collections_secrets</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">show_named_collections_secrets</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">access_management</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">access_management</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">named_collection_control</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">named_collection_control</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">show_named_collections</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">show_named_collections</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">show_named_collections_secrets</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">show_named_collections_secrets</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">vim /etc/clickhouse-server/user.xml</span></span>
<span class="line"><span style="color:#E1E4E8;">#创建管理员用户，或者用default用户</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;</span><span style="color:#85E89D;">users</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">&lt;!-- Previous settings --&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">&lt;!-- If user name was not specified, &#39;default&#39; user is used. --&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;</span><span style="color:#85E89D;">account_admin</span><span style="color:#E1E4E8;">&gt; </span><span style="color:#6A737D;">&lt;!-- user_name --&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">password</span><span style="color:#E1E4E8;">&gt;gRLTzih8mUqVpa88&lt;/</span><span style="color:#85E89D;">password</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">access_management</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">access_management</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">named_collection_control</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">named_collection_control</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">show_named_collections</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">show_named_collections</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">show_named_collections_secrets</span><span style="color:#E1E4E8;">&gt;1&lt;/</span><span style="color:#85E89D;">show_named_collections_secrets</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">networks</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">                </span><span style="color:#6A737D;">&lt;!-- &lt;ip&gt;::/0&lt;/ip&gt; --&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">                &lt;</span><span style="color:#85E89D;">ip</span><span style="color:#E1E4E8;">&gt;127.0.0.1&lt;/</span><span style="color:#85E89D;">ip</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">                &lt;</span><span style="color:#85E89D;">ip</span><span style="color:#E1E4E8;">&gt;10.132.60.101/10.132.60.104&lt;/</span><span style="color:#85E89D;">ip</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;/</span><span style="color:#85E89D;">networks</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">profile</span><span style="color:#E1E4E8;">&gt;default&lt;/</span><span style="color:#85E89D;">profile</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">            &lt;</span><span style="color:#85E89D;">quota</span><span style="color:#E1E4E8;">&gt;default&lt;/</span><span style="color:#85E89D;">quota</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">        &lt;/</span><span style="color:#85E89D;">account_admin</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">&lt;!-- Other users settings --&gt;</span></span>
<span class="line"><span style="color:#E1E4E8;">    &lt;/</span><span style="color:#85E89D;">users</span><span style="color:#E1E4E8;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">vim /etc/clickhouse-server/user.xml</span></span>
<span class="line"><span style="color:#24292E;">#创建管理员用户，或者用default用户</span></span>
<span class="line"><span style="color:#24292E;">    &lt;</span><span style="color:#22863A;">users</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">&lt;!-- Previous settings --&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">&lt;!-- If user name was not specified, &#39;default&#39; user is used. --&gt;</span></span>
<span class="line"><span style="color:#24292E;">        &lt;</span><span style="color:#22863A;">account_admin</span><span style="color:#24292E;">&gt; </span><span style="color:#6A737D;">&lt;!-- user_name --&gt;</span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">password</span><span style="color:#24292E;">&gt;gRLTzih8mUqVpa88&lt;/</span><span style="color:#22863A;">password</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">access_management</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">access_management</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">named_collection_control</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">named_collection_control</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">show_named_collections</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">show_named_collections</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">show_named_collections_secrets</span><span style="color:#24292E;">&gt;1&lt;/</span><span style="color:#22863A;">show_named_collections_secrets</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">networks</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">                </span><span style="color:#6A737D;">&lt;!-- &lt;ip&gt;::/0&lt;/ip&gt; --&gt;</span></span>
<span class="line"><span style="color:#24292E;">                &lt;</span><span style="color:#22863A;">ip</span><span style="color:#24292E;">&gt;127.0.0.1&lt;/</span><span style="color:#22863A;">ip</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">                &lt;</span><span style="color:#22863A;">ip</span><span style="color:#24292E;">&gt;10.132.60.101/10.132.60.104&lt;/</span><span style="color:#22863A;">ip</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">            &lt;/</span><span style="color:#22863A;">networks</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">profile</span><span style="color:#24292E;">&gt;default&lt;/</span><span style="color:#22863A;">profile</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">            &lt;</span><span style="color:#22863A;">quota</span><span style="color:#24292E;">&gt;default&lt;/</span><span style="color:#22863A;">quota</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">        &lt;/</span><span style="color:#22863A;">account_admin</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6A737D;">&lt;!-- Other users settings --&gt;</span></span>
<span class="line"><span style="color:#24292E;">    &lt;/</span><span style="color:#22863A;">users</span><span style="color:#24292E;">&gt;</span></span></code></pre></div><blockquote><p>1--&gt;开启 0--&gt;关闭</p></blockquote><ul><li>重启服务</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clickhouse-server.service</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clickhouse-server.service</span></span></code></pre></div><h3 id="_2-创建super用户" tabindex="-1">2.创建super用户 <a class="header-anchor" href="#_2-创建super用户" aria-label="Permalink to &quot;2.创建super用户&quot;">​</a></h3><ul><li>登录</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kubeadm-master01 clickhouse-server]# clickhouse-client -m</span></span>
<span class="line"><span style="color:#B392F0;">ClickHouse</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">client</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">version</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">23.12</span><span style="color:#9ECBFF;">.6.19</span><span style="color:#E1E4E8;"> (official </span><span style="color:#9ECBFF;">build</span><span style="color:#E1E4E8;">).</span></span>
<span class="line"><span style="color:#B392F0;">Connecting</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">localhost:9000</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">as</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">default.</span></span>
<span class="line"><span style="color:#B392F0;">Password</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user</span><span style="color:#E1E4E8;"> (default)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kubeadm-master01 clickhouse-server]# clickhouse-client -m</span></span>
<span class="line"><span style="color:#6F42C1;">ClickHouse</span><span style="color:#24292E;"> </span><span style="color:#032F62;">client</span><span style="color:#24292E;"> </span><span style="color:#032F62;">version</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">23.12</span><span style="color:#032F62;">.6.19</span><span style="color:#24292E;"> (official </span><span style="color:#032F62;">build</span><span style="color:#24292E;">).</span></span>
<span class="line"><span style="color:#6F42C1;">Connecting</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">localhost:9000</span><span style="color:#24292E;"> </span><span style="color:#032F62;">as</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user</span><span style="color:#24292E;"> </span><span style="color:#032F62;">default.</span></span>
<span class="line"><span style="color:#6F42C1;">Password</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user</span><span style="color:#24292E;"> (default)</span></span></code></pre></div><ul><li>创建超级管理员用户</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#E1E4E8;">#创建super_admin用户，默认密码保存方式是sha256_password</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">super_admin</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;passwd&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#E1E4E8;">#分配所有权限，并允许super_admin授权给其他用户</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> ALL </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> super_admin </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">OPTION</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#E1E4E8;">#查看用户</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">system</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">users</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#24292E;">#创建super_admin用户，默认密码保存方式是sha256_password</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">super_admin</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;passwd&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#24292E;">#分配所有权限，并允许super_admin授权给其他用户</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> ALL </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> super_admin </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">OPTION</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#24292E;">#查看用户</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">system</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">users</span><span style="color:#24292E;">;</span></span></code></pre></div><h2 id="_1-3-权限分类" tabindex="-1">1.3 权限分类 <a class="header-anchor" href="#_1-3-权限分类" aria-label="Permalink to &quot;1.3 权限分类&quot;">​</a></h2><p><a href="https://clickhouse.com/docs/en/operations/access-rights#enabling-access-control" target="_blank" rel="noreferrer">官当</a></p><h2 id="_1-4-创建用户" tabindex="-1">1.4 创建用户 <a class="header-anchor" href="#_1-4-创建用户" aria-label="Permalink to &quot;1.4 创建用户&quot;">​</a></h2><p><a href="https://clickhouse.com/docs/en/sql-reference/statements/create/user" target="_blank" rel="noreferrer">官当</a></p><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> USER [IF NOT EXISTS | OR REPLACE] name1 [, name2 [,...]] [ON CLUSTER cluster_name]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [NOT IDENTIFIED | IDENTIFIED {[WITH {plaintext_password | sha256_password | sha256_hash | double_sha1_password | double_sha1_hash}] </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> {</span><span style="color:#9ECBFF;">&#39;password&#39;</span><span style="color:#E1E4E8;"> | </span><span style="color:#9ECBFF;">&#39;hash&#39;</span><span style="color:#E1E4E8;">}} | </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> NO_PASSWORD | {</span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> ldap </span><span style="color:#F97583;">SERVER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;server_name&#39;</span><span style="color:#E1E4E8;">} | {</span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">kerberos</span><span style="color:#E1E4E8;"> [REALM &#39;realm&#39;]} | {</span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> ssl_certificate CN </span><span style="color:#9ECBFF;">&#39;common_name&#39;</span><span style="color:#E1E4E8;"> | SAN </span><span style="color:#9ECBFF;">&#39;TYPE:subject_alt_name&#39;</span><span style="color:#E1E4E8;">} | {</span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> ssh_key </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">KEY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;public_key&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TYPE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;ssh-rsa|...&#39;</span><span style="color:#E1E4E8;">} | {</span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">http</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SERVER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;server_name&#39;</span><span style="color:#E1E4E8;"> [SCHEME &#39;Basic&#39;]} [VALID UNTIL datetime] </span></span>
<span class="line"><span style="color:#E1E4E8;">    [, {[{plaintext_password | sha256_password | sha256_hash | ...}] </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> {</span><span style="color:#9ECBFF;">&#39;password&#39;</span><span style="color:#E1E4E8;"> | </span><span style="color:#9ECBFF;">&#39;hash&#39;</span><span style="color:#E1E4E8;">}} | {ldap </span><span style="color:#F97583;">SERVER</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;server_name&#39;</span><span style="color:#E1E4E8;">} | {...} | ... [,...]]]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [HOST {LOCAL | NAME &#39;name&#39; | REGEXP &#39;name_regexp&#39; | IP &#39;address&#39; | LIKE &#39;pattern&#39;} [,...] | ANY | </span><span style="color:#F97583;">NONE</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [VALID UNTIL datetime]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [IN access_storage_type]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [DEFAULT ROLE role [,...]]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [DEFAULT DATABASE database | NONE]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [GRANTEES {user | role | ANY | NONE} [,...] [EXCEPT {user | role} [,...]]]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [READONLY | WRITABLE] | </span><span style="color:#F97583;">PROFILE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;profile_name&#39;</span><span style="color:#E1E4E8;">] [,...]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> USER [IF NOT EXISTS | OR REPLACE] name1 [, name2 [,...]] [ON CLUSTER cluster_name]</span></span>
<span class="line"><span style="color:#24292E;">    [NOT IDENTIFIED | IDENTIFIED {[WITH {plaintext_password | sha256_password | sha256_hash | double_sha1_password | double_sha1_hash}] </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> {</span><span style="color:#032F62;">&#39;password&#39;</span><span style="color:#24292E;"> | </span><span style="color:#032F62;">&#39;hash&#39;</span><span style="color:#24292E;">}} | </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> NO_PASSWORD | {</span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> ldap </span><span style="color:#D73A49;">SERVER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;server_name&#39;</span><span style="color:#24292E;">} | {</span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">kerberos</span><span style="color:#24292E;"> [REALM &#39;realm&#39;]} | {</span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> ssl_certificate CN </span><span style="color:#032F62;">&#39;common_name&#39;</span><span style="color:#24292E;"> | SAN </span><span style="color:#032F62;">&#39;TYPE:subject_alt_name&#39;</span><span style="color:#24292E;">} | {</span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> ssh_key </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">KEY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;public_key&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TYPE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;ssh-rsa|...&#39;</span><span style="color:#24292E;">} | {</span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">http</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SERVER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;server_name&#39;</span><span style="color:#24292E;"> [SCHEME &#39;Basic&#39;]} [VALID UNTIL datetime] </span></span>
<span class="line"><span style="color:#24292E;">    [, {[{plaintext_password | sha256_password | sha256_hash | ...}] </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> {</span><span style="color:#032F62;">&#39;password&#39;</span><span style="color:#24292E;"> | </span><span style="color:#032F62;">&#39;hash&#39;</span><span style="color:#24292E;">}} | {ldap </span><span style="color:#D73A49;">SERVER</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;server_name&#39;</span><span style="color:#24292E;">} | {...} | ... [,...]]]</span></span>
<span class="line"><span style="color:#24292E;">    [HOST {LOCAL | NAME &#39;name&#39; | REGEXP &#39;name_regexp&#39; | IP &#39;address&#39; | LIKE &#39;pattern&#39;} [,...] | ANY | </span><span style="color:#D73A49;">NONE</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    [VALID UNTIL datetime]</span></span>
<span class="line"><span style="color:#24292E;">    [IN access_storage_type]</span></span>
<span class="line"><span style="color:#24292E;">    [DEFAULT ROLE role [,...]]</span></span>
<span class="line"><span style="color:#24292E;">    [DEFAULT DATABASE database | NONE]</span></span>
<span class="line"><span style="color:#24292E;">    [GRANTEES {user | role | ANY | NONE} [,...] [EXCEPT {user | role} [,...]]]</span></span>
<span class="line"><span style="color:#24292E;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [READONLY | WRITABLE] | </span><span style="color:#D73A49;">PROFILE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;profile_name&#39;</span><span style="color:#24292E;">] [,...]</span></span></code></pre></div><h3 id="_1-创建用户sha256-password" tabindex="-1">1.创建用户sha256_password <a class="header-anchor" href="#_1-创建用户sha256-password" aria-label="Permalink to &quot;1.创建用户sha256_password&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#E1E4E8;">#创建super_admin用户，默认密码保存方式是sha256_password，此处不授权只有登录的权限</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">super_admin</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;passwd&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#24292E;">#创建super_admin用户，默认密码保存方式是sha256_password，此处不授权只有登录的权限</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">super_admin</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;passwd&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><ul><li>查看用户</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">show users;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">show users;</span></span></code></pre></div><h3 id="_2-创建用户" tabindex="-1">2.创建用户 <a class="header-anchor" href="#_2-创建用户" aria-label="Permalink to &quot;2.创建用户&quot;">​</a></h3><p>指定加密方式</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">name2</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> plaintext_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;my_password&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">name2</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> plaintext_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;my_password&#39;</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">#创建管理设备表的角色</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ROLE</span><span style="color:#E1E4E8;"> xxx_read_write; </span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">INSERT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">db01</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">x1_table</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> xxx_read_write; </span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">db01</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">x2_table</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> device_read_write; </span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">user_001</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> sha256_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;12xxyy&#39;</span><span style="color:#E1E4E8;"> HOST IP </span><span style="color:#9ECBFF;">&#39;::/0&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DEFAULT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ROLE</span><span style="color:#E1E4E8;"> xxx_read_write;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">#创建管理设备表的角色</span></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ROLE</span><span style="color:#24292E;"> xxx_read_write; </span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">INSERT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">db01</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">x1_table</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> xxx_read_write; </span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">db01</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">x2_table</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> device_read_write; </span></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">user_001</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> sha256_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;12xxyy&#39;</span><span style="color:#24292E;"> HOST IP </span><span style="color:#032F62;">&#39;::/0&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DEFAULT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ROLE</span><span style="color:#24292E;"> xxx_read_write;</span></span></code></pre></div><h3 id="_3-创建没有密码用户" tabindex="-1">3.创建没有密码用户 <a class="header-anchor" href="#_3-创建没有密码用户" aria-label="Permalink to &quot;3.创建没有密码用户&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">user_name</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">NOT</span><span style="color:#E1E4E8;"> IDENTIFIED</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">user_name</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">NOT</span><span style="color:#24292E;"> IDENTIFIED</span></span></code></pre></div><h3 id="_4-创建指定ip用户" tabindex="-1">4.创建指定ip用户 <a class="header-anchor" href="#_4-创建指定ip用户" aria-label="Permalink to &quot;4.创建指定ip用户&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">HOST IP </span><span style="color:#9ECBFF;">&#39;ip_address_or_subnetwork&#39;</span><span style="color:#E1E4E8;"> # 用户只能从指定的 IP 地址或子网连接到 ClickHouse 服务器。例子：。对于在生产中使用，请仅指定元素（IP 地址及其掩码），因为使用 和可能会导致额外的延迟。HOST IP </span><span style="color:#9ECBFF;">&#39;192.168.0.0/16&#39;</span><span style="color:#E1E4E8;">HOST IP </span><span style="color:#9ECBFF;">&#39;2001:DB8::/32&#39;</span><span style="color:#E1E4E8;">HOST IPhosthost_regexp</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">HOST ANY # 用户可以从任何位置进行连接。这是默认选项。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">HOST </span><span style="color:#F97583;">LOCAL</span><span style="color:#E1E4E8;"> # 用户只能在本地连接。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">HOST </span><span style="color:#F97583;">NAME</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;fqdn&#39;</span><span style="color:#E1E4E8;"> # 可以将用户主机指定为 FQDN。例如。HOST </span><span style="color:#F97583;">NAME</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;mysite.com&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">HOST REGEXP </span><span style="color:#9ECBFF;">&#39;regexp&#39;</span><span style="color:#E1E4E8;"> # 您可以在指定用户主机时使用 pcre 正则表达式。例如。HOST REGEXP </span><span style="color:#9ECBFF;">&#39;.*\\.mysite\\.com&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">HOST </span><span style="color:#F97583;">LIKE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;template&#39;</span><span style="color:#E1E4E8;"> # 允许您使用 </span><span style="color:#F97583;">LIKE</span><span style="color:#E1E4E8;"> 运算符过滤用户主机。例如， 等效于 ，筛选域中的所有主机。HOST </span><span style="color:#F97583;">LIKE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;%&#39;</span><span style="color:#E1E4E8;">HOST ANYHOST </span><span style="color:#F97583;">LIKE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;%.mysite.com&#39;</span><span style="color:#79B8FF;">mysite</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">com</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">mira</span><span style="color:#E1E4E8;"> HOST IP </span><span style="color:#9ECBFF;">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> sha256_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;qwerty&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">HOST IP </span><span style="color:#032F62;">&#39;ip_address_or_subnetwork&#39;</span><span style="color:#24292E;"> # 用户只能从指定的 IP 地址或子网连接到 ClickHouse 服务器。例子：。对于在生产中使用，请仅指定元素（IP 地址及其掩码），因为使用 和可能会导致额外的延迟。HOST IP </span><span style="color:#032F62;">&#39;192.168.0.0/16&#39;</span><span style="color:#24292E;">HOST IP </span><span style="color:#032F62;">&#39;2001:DB8::/32&#39;</span><span style="color:#24292E;">HOST IPhosthost_regexp</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">HOST ANY # 用户可以从任何位置进行连接。这是默认选项。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">HOST </span><span style="color:#D73A49;">LOCAL</span><span style="color:#24292E;"> # 用户只能在本地连接。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">HOST </span><span style="color:#D73A49;">NAME</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;fqdn&#39;</span><span style="color:#24292E;"> # 可以将用户主机指定为 FQDN。例如。HOST </span><span style="color:#D73A49;">NAME</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;mysite.com&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">HOST REGEXP </span><span style="color:#032F62;">&#39;regexp&#39;</span><span style="color:#24292E;"> # 您可以在指定用户主机时使用 pcre 正则表达式。例如。HOST REGEXP </span><span style="color:#032F62;">&#39;.*\\.mysite\\.com&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">HOST </span><span style="color:#D73A49;">LIKE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;template&#39;</span><span style="color:#24292E;"> # 允许您使用 </span><span style="color:#D73A49;">LIKE</span><span style="color:#24292E;"> 运算符过滤用户主机。例如， 等效于 ，筛选域中的所有主机。HOST </span><span style="color:#D73A49;">LIKE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;%&#39;</span><span style="color:#24292E;">HOST ANYHOST </span><span style="color:#D73A49;">LIKE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;%.mysite.com&#39;</span><span style="color:#005CC5;">mysite</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">com</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">mira</span><span style="color:#24292E;"> HOST IP </span><span style="color:#032F62;">&#39;127.0.0.1&#39;</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> sha256_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;qwerty&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">mira</span><span style="color:#E1E4E8;">@</span><span style="color:#9ECBFF;">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8;"> — Equivalent </span><span style="color:#F97583;">to</span><span style="color:#E1E4E8;"> the HOST IP syntax.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">mira</span><span style="color:#E1E4E8;">@</span><span style="color:#9ECBFF;">&#39;localhost&#39;</span><span style="color:#E1E4E8;"> — Equivalent </span><span style="color:#F97583;">to</span><span style="color:#E1E4E8;"> the HOST </span><span style="color:#F97583;">LOCAL</span><span style="color:#E1E4E8;"> syntax.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">mira</span><span style="color:#E1E4E8;">@</span><span style="color:#9ECBFF;">&#39;192.168.%.%&#39;</span><span style="color:#E1E4E8;"> — Equivalent </span><span style="color:#F97583;">to</span><span style="color:#E1E4E8;"> the HOST </span><span style="color:#F97583;">LIKE</span><span style="color:#E1E4E8;"> syntax.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">mira</span><span style="color:#24292E;">@</span><span style="color:#032F62;">&#39;127.0.0.1&#39;</span><span style="color:#24292E;"> — Equivalent </span><span style="color:#D73A49;">to</span><span style="color:#24292E;"> the HOST IP syntax.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">mira</span><span style="color:#24292E;">@</span><span style="color:#032F62;">&#39;localhost&#39;</span><span style="color:#24292E;"> — Equivalent </span><span style="color:#D73A49;">to</span><span style="color:#24292E;"> the HOST </span><span style="color:#D73A49;">LOCAL</span><span style="color:#24292E;"> syntax.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">mira</span><span style="color:#24292E;">@</span><span style="color:#032F62;">&#39;192.168.%.%&#39;</span><span style="color:#24292E;"> — Equivalent </span><span style="color:#D73A49;">to</span><span style="color:#24292E;"> the HOST </span><span style="color:#D73A49;">LIKE</span><span style="color:#24292E;"> syntax.</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">PASSWORD=</span><span style="color:#E1E4E8;">$(</span><span style="color:#F97583;">base64</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">dev</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">urandom | head </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">c8); echo </span><span style="color:#9ECBFF;">&quot;$PASSWORD&quot;</span><span style="color:#E1E4E8;">; echo </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">n </span><span style="color:#9ECBFF;">&quot;$PASSWORD&quot;</span><span style="color:#E1E4E8;"> | sha256sum | tr </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">d </span><span style="color:#9ECBFF;">&#39;-&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">mira</span><span style="color:#E1E4E8;"> HOST IP </span><span style="color:#9ECBFF;">&#39;127.0.0.1&#39;</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> sha256_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;qwerty&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">PASSWORD=</span><span style="color:#24292E;">$(</span><span style="color:#D73A49;">base64</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/</span><span style="color:#24292E;">dev</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">urandom | head </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">c8); echo </span><span style="color:#032F62;">&quot;$PASSWORD&quot;</span><span style="color:#24292E;">; echo </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">n </span><span style="color:#032F62;">&quot;$PASSWORD&quot;</span><span style="color:#24292E;"> | sha256sum | tr </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">d </span><span style="color:#032F62;">&#39;-&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">mira</span><span style="color:#24292E;"> HOST IP </span><span style="color:#032F62;">&#39;127.0.0.1&#39;</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> sha256_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;qwerty&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><h2 id="_1-5-删除用户" tabindex="-1">1.5 删除用户 <a class="header-anchor" href="#_1-5-删除用户" aria-label="Permalink to &quot;1.5 删除用户&quot;">​</a></h2><p><a href="https://clickhouse.com/docs/en/sql-reference/statements/drop#drop-user" target="_blank" rel="noreferrer">官当</a></p><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">DROP</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> [IF EXISTS] </span><span style="color:#F97583;">name</span><span style="color:#E1E4E8;"> [,...] [ON CLUSTER cluster_name] [FROM access_storage_type]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">DROP</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> [IF EXISTS] </span><span style="color:#D73A49;">name</span><span style="color:#24292E;"> [,...] [ON CLUSTER cluster_name] [FROM access_storage_type]</span></span></code></pre></div><h2 id="_1-6-查看用户权限" tabindex="-1">1.6 查看用户权限 <a class="header-anchor" href="#_1-6-查看用户权限" aria-label="Permalink to &quot;1.6 查看用户权限&quot;">​</a></h2><ul><li>查看用户</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">system</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">users</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">system</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">users</span><span style="color:#24292E;">;</span></span></code></pre></div><ul><li>查看某用户权限</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">ch_accesslog :) show grants </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> user_name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">SHOW GRANTS </span><span style="color:#F97583;">FOR</span><span style="color:#E1E4E8;"> super_admin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">Query id: 5ffca0b8</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">b194</span><span style="color:#F97583;">-</span><span style="color:#79B8FF;">4542</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">9fcb</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">5a80878e7a3f</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">┌─GRANTS </span><span style="color:#F97583;">FOR</span><span style="color:#E1E4E8;"> super_admin────────────────────────────┐</span></span>
<span class="line"><span style="color:#E1E4E8;">│ </span><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> ALL </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> super_admin </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">OPTION</span><span style="color:#E1E4E8;"> │</span></span>
<span class="line"><span style="color:#E1E4E8;">└───────────────────────────────────────────────────┘</span></span>
<span class="line"></span>
<span class="line"><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">row</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">set</span><span style="color:#E1E4E8;">. Elapsed: </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">018</span><span style="color:#E1E4E8;"> sec.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">ch_accesslog :) show grants </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> user_name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">SHOW GRANTS </span><span style="color:#D73A49;">FOR</span><span style="color:#24292E;"> super_admin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">Query id: 5ffca0b8</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">b194</span><span style="color:#D73A49;">-</span><span style="color:#005CC5;">4542</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">9fcb</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">5a80878e7a3f</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">┌─GRANTS </span><span style="color:#D73A49;">FOR</span><span style="color:#24292E;"> super_admin────────────────────────────┐</span></span>
<span class="line"><span style="color:#24292E;">│ </span><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> ALL </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> super_admin </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">OPTION</span><span style="color:#24292E;"> │</span></span>
<span class="line"><span style="color:#24292E;">└───────────────────────────────────────────────────┘</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">row</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">set</span><span style="color:#24292E;">. Elapsed: </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">018</span><span style="color:#24292E;"> sec.</span></span></code></pre></div><h2 id="_1-7-修改用户权限" tabindex="-1">1.7 修改用户权限 <a class="header-anchor" href="#_1-7-修改用户权限" aria-label="Permalink to &quot;1.7 修改用户权限&quot;">​</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">#修改密码并配置远程访问</span></span>
<span class="line"><span style="color:#F97583;">alter</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">user</span><span style="color:#E1E4E8;"> user_name@</span><span style="color:#9ECBFF;">&#39;192.168.%.%&#39;</span><span style="color:#E1E4E8;"> rename </span><span style="color:#F97583;">to</span><span style="color:#E1E4E8;"> username@</span><span style="color:#9ECBFF;">&#39;%&#39;</span><span style="color:#E1E4E8;"> identified </span><span style="color:#F97583;">with</span><span style="color:#E1E4E8;"> sha256_password </span><span style="color:#F97583;">by</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;password&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">#只修改密码</span></span>
<span class="line"><span style="color:#E1E4E8;">#生成sha256的密码</span></span>
<span class="line"><span style="color:#E1E4E8;">echo </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">n </span><span style="color:#9ECBFF;">&quot;password&quot;</span><span style="color:#E1E4E8;"> | sha256sum | tr </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">d </span><span style="color:#9ECBFF;">&#39;-&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> abce IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> sha256_hash </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">#修改密码并配置远程访问</span></span>
<span class="line"><span style="color:#D73A49;">alter</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">user</span><span style="color:#24292E;"> user_name@</span><span style="color:#032F62;">&#39;192.168.%.%&#39;</span><span style="color:#24292E;"> rename </span><span style="color:#D73A49;">to</span><span style="color:#24292E;"> username@</span><span style="color:#032F62;">&#39;%&#39;</span><span style="color:#24292E;"> identified </span><span style="color:#D73A49;">with</span><span style="color:#24292E;"> sha256_password </span><span style="color:#D73A49;">by</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;password&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">#只修改密码</span></span>
<span class="line"><span style="color:#24292E;">#生成sha256的密码</span></span>
<span class="line"><span style="color:#24292E;">echo </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">n </span><span style="color:#032F62;">&quot;password&quot;</span><span style="color:#24292E;"> | sha256sum | tr </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">d </span><span style="color:#032F62;">&#39;-&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> abce IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> sha256_hash </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><h2 id="_1-8-权限授权" tabindex="-1">1.8 权限授权 <a class="header-anchor" href="#_1-8-权限授权" aria-label="Permalink to &quot;1.8 权限授权&quot;">​</a></h2><p><a href="https://clickhouse.com/docs/en/sql-reference/statements/alter/role" target="_blank" rel="noreferrer">官当</a></p><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ROLE</span><span style="color:#E1E4E8;"> [IF EXISTS] name1 [RENAME TO new_name |, name2 [,...]] </span></span>
<span class="line"><span style="color:#E1E4E8;">    [ON CLUSTER cluster_name]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [CONST|READONLY|WRITABLE|CHANGEABLE_IN_READONLY] | </span><span style="color:#F97583;">PROFILE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;profile_name&#39;</span><span style="color:#E1E4E8;">] [,...]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ROLE</span><span style="color:#24292E;"> [IF EXISTS] name1 [RENAME TO new_name |, name2 [,...]] </span></span>
<span class="line"><span style="color:#24292E;">    [ON CLUSTER cluster_name]</span></span>
<span class="line"><span style="color:#24292E;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [CONST|READONLY|WRITABLE|CHANGEABLE_IN_READONLY] | </span><span style="color:#D73A49;">PROFILE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;profile_name&#39;</span><span style="color:#24292E;">] [,...]</span></span></code></pre></div><h3 id="_1-根据普通用户" tabindex="-1">1.根据普通用户 <a class="header-anchor" href="#_1-根据普通用户" aria-label="Permalink to &quot;1.根据普通用户&quot;">​</a></h3><ul><li>创建数据库</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DATABASE</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">IF</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">NOT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">EXISTS</span><span style="color:#E1E4E8;"> your_database_name;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DATABASE</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">IF</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">NOT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">EXISTS</span><span style="color:#24292E;"> your_database_name;</span></span></code></pre></div><ul><li>创建用户</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">your_username</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> plaintext_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;your_password&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">your_username</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> plaintext_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;your_password&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><ul><li>赋予读写</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">INSERT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> your_database_name.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> your_username;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">INSERT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> your_database_name.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> your_username;</span></span></code></pre></div><ul><li>赋予所有</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> ALL </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> your_database_name.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> your_username;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> ALL </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> your_database_name.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> your_username;</span></span></code></pre></div><h3 id="_2-根据角色-推荐" tabindex="-1">2.根据角色，推荐 <a class="header-anchor" href="#_2-根据角色-推荐" aria-label="Permalink to &quot;2.根据角色，推荐&quot;">​</a></h3><div class="danger custom-block"><p class="custom-block-title">❌ 注意</p><p>查看当前所有的权限,SHOW ACCESS</p></div><ul><li><a href="https://clickhouse.com/docs/zh/sql-reference/statements/create#create-role-statement" target="_blank" rel="noreferrer">CREATE ROLE</a></li><li><a href="https://clickhouse.com/docs/zh/sql-reference/statements/alter#alter-role-statement" target="_blank" rel="noreferrer">ALTER ROLE</a></li><li><a href="https://clickhouse.com/docs/zh/sql-reference/statements/misc#drop-role-statement" target="_blank" rel="noreferrer">DROP ROLE</a></li><li><a href="https://clickhouse.com/docs/zh/sql-reference/statements/misc#set-role-statement" target="_blank" rel="noreferrer">SET ROLE</a></li><li><a href="https://clickhouse.com/docs/zh/sql-reference/statements/misc#set-default-role-statement" target="_blank" rel="noreferrer">SET DEFAULT ROLE</a></li><li><a href="https://clickhouse.com/docs/zh/sql-reference/statements/show#show-create-role-statement" target="_blank" rel="noreferrer">SHOW CREATE ROLE</a></li></ul><p>使用<a href="https://clickhouse.com/docs/zh/sql-reference/statements/grant" target="_blank" rel="noreferrer">GRANT</a> 查询可以把特权授予给角色。用<a href="https://clickhouse.com/docs/zh/sql-reference/statements/revoke" target="_blank" rel="noreferrer">REVOKE</a>来撤回特权。</p><h4 id="_1-创建role" tabindex="-1">1.创建role <a class="header-anchor" href="#_1-创建role" aria-label="Permalink to &quot;1.创建role&quot;">​</a></h4><p><a href="https://clickhouse.ac.cn/docs/en/sql-reference/statements/create/role" target="_blank" rel="noreferrer">官当</a></p><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ROLE</span><span style="color:#E1E4E8;"> [IF NOT EXISTS | OR REPLACE] </span><span style="color:#F97583;">name</span></span>
<span class="line"><span style="color:#E1E4E8;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [READONLY|WRITABLE] | </span><span style="color:#F97583;">PROFILE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;profile_name&#39;</span><span style="color:#E1E4E8;">] [,...]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ROLE</span><span style="color:#24292E;"> [IF NOT EXISTS | OR REPLACE] </span><span style="color:#D73A49;">name</span></span>
<span class="line"><span style="color:#24292E;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [READONLY|WRITABLE] | </span><span style="color:#D73A49;">PROFILE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;profile_name&#39;</span><span style="color:#24292E;">] [,...]</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">#创建</span></span>
<span class="line"><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">role</span><span style="color:#E1E4E8;"> dba_role;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">#查看</span></span>
<span class="line"><span style="color:#E1E4E8;">show roles;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">#创建</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">role</span><span style="color:#24292E;"> dba_role;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">#查看</span></span>
<span class="line"><span style="color:#24292E;">show roles;</span></span></code></pre></div><h4 id="_2-给角色授权" tabindex="-1">2.给角色授权 <a class="header-anchor" href="#_2-给角色授权" aria-label="Permalink to &quot;2.给角色授权&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> you_db_name.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> dba_role;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> you_db_name.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> dba_role;</span></span></code></pre></div><h4 id="_3-给用户授权" tabindex="-1">3.给用户授权 <a class="header-anchor" href="#_3-给用户授权" aria-label="Permalink to &quot;3.给用户授权&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> dba_role </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> user_name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;"># 激活当前用户角色，这样用户便拥有权限了</span></span>
<span class="line"><span style="color:#F97583;">SET</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ROLE</span><span style="color:#E1E4E8;"> dba_role;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> dba_role </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> user_name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;"># 激活当前用户角色，这样用户便拥有权限了</span></span>
<span class="line"><span style="color:#D73A49;">SET</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ROLE</span><span style="color:#24292E;"> dba_role;</span></span></code></pre></div><h4 id="_4-创建帐户" tabindex="-1">4.创建帐户 <a class="header-anchor" href="#_4-创建帐户" aria-label="Permalink to &quot;4.创建帐户&quot;">​</a></h4><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> USER [IF NOT EXISTS | OR REPLACE] </span><span style="color:#F97583;">name</span><span style="color:#E1E4E8;"> [ON CLUSTER cluster_name]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [IDENTIFIED [WITH {NO_PASSWORD|PLAINTEXT_PASSWORD|SHA256_PASSWORD|SHA256_HASH|DOUBLE_SHA1_PASSWORD|DOUBLE_SHA1_HASH}] </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> {</span><span style="color:#9ECBFF;">&#39;password&#39;</span><span style="color:#E1E4E8;">|</span><span style="color:#9ECBFF;">&#39;hash&#39;</span><span style="color:#E1E4E8;">}]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [HOST {LOCAL | NAME &#39;name&#39; | REGEXP &#39;name_regexp&#39; | IP &#39;address&#39; | LIKE &#39;pattern&#39;} [,...] | ANY | </span><span style="color:#F97583;">NONE</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [DEFAULT ROLE role [,...]]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [READONLY|WRITABLE] | </span><span style="color:#F97583;">PROFILE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;profile_name&#39;</span><span style="color:#E1E4E8;">] [,...]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> USER [IF NOT EXISTS | OR REPLACE] </span><span style="color:#D73A49;">name</span><span style="color:#24292E;"> [ON CLUSTER cluster_name]</span></span>
<span class="line"><span style="color:#24292E;">    [IDENTIFIED [WITH {NO_PASSWORD|PLAINTEXT_PASSWORD|SHA256_PASSWORD|SHA256_HASH|DOUBLE_SHA1_PASSWORD|DOUBLE_SHA1_HASH}] </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> {</span><span style="color:#032F62;">&#39;password&#39;</span><span style="color:#24292E;">|</span><span style="color:#032F62;">&#39;hash&#39;</span><span style="color:#24292E;">}]</span></span>
<span class="line"><span style="color:#24292E;">    [HOST {LOCAL | NAME &#39;name&#39; | REGEXP &#39;name_regexp&#39; | IP &#39;address&#39; | LIKE &#39;pattern&#39;} [,...] | ANY | </span><span style="color:#D73A49;">NONE</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">    [DEFAULT ROLE role [,...]]</span></span>
<span class="line"><span style="color:#24292E;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [READONLY|WRITABLE] | </span><span style="color:#D73A49;">PROFILE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;profile_name&#39;</span><span style="color:#24292E;">] [,...]</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"># </span><span style="color:#F97583;">PASSWORD=</span><span style="color:#E1E4E8;">$(</span><span style="color:#F97583;">base64</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">dev</span><span style="color:#F97583;">/</span><span style="color:#E1E4E8;">urandom | head </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">c8); echo </span><span style="color:#9ECBFF;">&quot;$PASSWORD&quot;</span><span style="color:#E1E4E8;">; echo </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">n </span><span style="color:#9ECBFF;">&quot;$PASSWORD&quot;</span><span style="color:#E1E4E8;"> | sha256sum | tr </span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">d </span><span style="color:#9ECBFF;">&#39;-&#39;</span></span>
<span class="line"><span style="color:#E1E4E8;">Jt9Us0rG   ## 明文密码</span></span>
<span class="line"><span style="color:#E1E4E8;">de5a7f4866fd2205876184dce54bc89921052a9057a9fc4e4346f4e073a2123d   ## 加密后的密码</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">#</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">USER</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">dba_u</span><span style="color:#E1E4E8;">@</span><span style="color:#9ECBFF;">&#39;192.168.%&#39;</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> sha256_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;123456&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">#或者</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> USER </span><span style="color:#9ECBFF;">\`dba_u@192.168.%\`</span><span style="color:#E1E4E8;"> IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> sha256_hash </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;8D969EEF6ECAD3C29A3A629280E686CF0C3F5D5A86AFF3CA12020C923ADC6C92&#39;</span><span style="color:#E1E4E8;"> HOST </span><span style="color:#F97583;">LIKE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;192.168.%&#39;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"># </span><span style="color:#D73A49;">PASSWORD=</span><span style="color:#24292E;">$(</span><span style="color:#D73A49;">base64</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">/</span><span style="color:#24292E;">dev</span><span style="color:#D73A49;">/</span><span style="color:#24292E;">urandom | head </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">c8); echo </span><span style="color:#032F62;">&quot;$PASSWORD&quot;</span><span style="color:#24292E;">; echo </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">n </span><span style="color:#032F62;">&quot;$PASSWORD&quot;</span><span style="color:#24292E;"> | sha256sum | tr </span><span style="color:#D73A49;">-</span><span style="color:#24292E;">d </span><span style="color:#032F62;">&#39;-&#39;</span></span>
<span class="line"><span style="color:#24292E;">Jt9Us0rG   ## 明文密码</span></span>
<span class="line"><span style="color:#24292E;">de5a7f4866fd2205876184dce54bc89921052a9057a9fc4e4346f4e073a2123d   ## 加密后的密码</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">#</span></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">USER</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">dba_u</span><span style="color:#24292E;">@</span><span style="color:#032F62;">&#39;192.168.%&#39;</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> sha256_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;123456&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">#或者</span></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> USER </span><span style="color:#032F62;">\`dba_u@192.168.%\`</span><span style="color:#24292E;"> IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> sha256_hash </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;8D969EEF6ECAD3C29A3A629280E686CF0C3F5D5A86AFF3CA12020C923ADC6C92&#39;</span><span style="color:#24292E;"> HOST </span><span style="color:#D73A49;">LIKE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;192.168.%&#39;</span></span></code></pre></div><h4 id="_5-查看" tabindex="-1">5.查看 <a class="header-anchor" href="#_5-查看" aria-label="Permalink to &quot;5.查看&quot;">​</a></h4><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">#查看授权</span></span>
<span class="line"><span style="color:#E1E4E8;">SHOW GRANTS;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">#</span></span>
<span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">system</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">roles</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">ch_accesslog :) </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">system</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">roles</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">┌─</span><span style="color:#F97583;">name</span><span style="color:#E1E4E8;">─┬─id───────────────────────────────────┬─storage─────────┐</span></span>
<span class="line"><span style="color:#E1E4E8;">│ dba  │ e8493f7d</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">5c7b</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">3ebd</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">d79f</span><span style="color:#F97583;">-</span><span style="color:#E1E4E8;">67e500d22c8b │ local_directory │</span></span>
<span class="line"><span style="color:#E1E4E8;">└──────┴──────────────────────────────────────┴─────────────────┘</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">#查看用户</span></span>
<span class="line"><span style="color:#E1E4E8;">show users;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">#查看授权</span></span>
<span class="line"><span style="color:#24292E;">SHOW GRANTS;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">#</span></span>
<span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">system</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">roles</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">ch_accesslog :) </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">system</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">roles</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">┌─</span><span style="color:#D73A49;">name</span><span style="color:#24292E;">─┬─id───────────────────────────────────┬─storage─────────┐</span></span>
<span class="line"><span style="color:#24292E;">│ dba  │ e8493f7d</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">5c7b</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">3ebd</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">d79f</span><span style="color:#D73A49;">-</span><span style="color:#24292E;">67e500d22c8b │ local_directory │</span></span>
<span class="line"><span style="color:#24292E;">└──────┴──────────────────────────────────────┴─────────────────┘</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">#查看用户</span></span>
<span class="line"><span style="color:#24292E;">show users;</span></span></code></pre></div><h4 id="_6-删除角色" tabindex="-1">6.删除角色 <a class="header-anchor" href="#_6-删除角色" aria-label="Permalink to &quot;6.删除角色&quot;">​</a></h4><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">DROP</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ROLE</span><span style="color:#E1E4E8;"> [IF EXISTS] </span><span style="color:#F97583;">name</span><span style="color:#E1E4E8;"> [,...] [ON CLUSTER cluster_name]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">DROP</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ROLE</span><span style="color:#24292E;"> [IF EXISTS] </span><span style="color:#D73A49;">name</span><span style="color:#24292E;"> [,...] [ON CLUSTER cluster_name]</span></span></code></pre></div><h4 id="_7-修改角色" tabindex="-1">7.修改角色 <a class="header-anchor" href="#_7-修改角色" aria-label="Permalink to &quot;7.修改角色&quot;">​</a></h4><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ROLE</span><span style="color:#E1E4E8;"> [IF EXISTS] name1 [ON CLUSTER cluster_name1] [RENAME TO new_name1]</span></span>
<span class="line"><span style="color:#E1E4E8;">        [, name2 [ON CLUSTER cluster_name2] [RENAME TO new_name2] ...]</span></span>
<span class="line"><span style="color:#E1E4E8;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [CONST|READONLY|WRITABLE|CHANGEABLE_IN_READONLY] | </span><span style="color:#F97583;">PROFILE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;profile_name&#39;</span><span style="color:#E1E4E8;">] [,...]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ROLE</span><span style="color:#24292E;"> [IF EXISTS] name1 [ON CLUSTER cluster_name1] [RENAME TO new_name1]</span></span>
<span class="line"><span style="color:#24292E;">        [, name2 [ON CLUSTER cluster_name2] [RENAME TO new_name2] ...]</span></span>
<span class="line"><span style="color:#24292E;">    [SETTINGS variable [= value] [MIN [=] min_value] [MAX [=] max_value] [CONST|READONLY|WRITABLE|CHANGEABLE_IN_READONLY] | </span><span style="color:#D73A49;">PROFILE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;profile_name&#39;</span><span style="color:#24292E;">] [,...]</span></span></code></pre></div><h3 id="_3-集群角色" tabindex="-1">3.集群角色 <a class="header-anchor" href="#_3-集群角色" aria-label="Permalink to &quot;3.集群角色&quot;">​</a></h3><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">-- 创建用户 guaoran、明文明码：123456</span></span>
<span class="line"><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">user</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">exists</span><span style="color:#E1E4E8;"> guaoran </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster </span></span>
<span class="line"><span style="color:#E1E4E8;">IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> plaintext_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;123456&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 创建角色 guaoran_role</span></span>
<span class="line"><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">role</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">exists</span><span style="color:#E1E4E8;"> guaoran_role </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权 test_db 库查询权限给 角色 guaoran_role</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> test_db.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> guaoran_role </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 分配角色给用户 guraoran</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> guaoran_role </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> guaoran </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- 创建用户 guaoran、明文明码：123456</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">user</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">exists</span><span style="color:#24292E;"> guaoran </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster </span></span>
<span class="line"><span style="color:#24292E;">IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> plaintext_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;123456&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 创建角色 guaoran_role</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">role</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">exists</span><span style="color:#24292E;"> guaoran_role </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权 test_db 库查询权限给 角色 guaoran_role</span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> test_db.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> guaoran_role </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 分配角色给用户 guraoran</span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> guaoran_role </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> guaoran </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span></code></pre></div><ul><li>读</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">-- 创建用户 reader、明文明码：123456</span></span>
<span class="line"><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">user</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">exists</span><span style="color:#E1E4E8;"> reader </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster </span></span>
<span class="line"><span style="color:#E1E4E8;">IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> plaintext_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;123456&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 创建角色 reader_role</span></span>
<span class="line"><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">role</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">exists</span><span style="color:#E1E4E8;"> reader_role </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权角色 reader_role 可以读test_db/system 数据库</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> test_db.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> reader_role </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">system</span><span style="color:#E1E4E8;">.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> reader_role </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权 reader_role  角色给 reader 用户</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> reader_role </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> reader </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster  ;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">-- 创建用户 reader、明文明码：123456</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">user</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">exists</span><span style="color:#24292E;"> reader </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster </span></span>
<span class="line"><span style="color:#24292E;">IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> plaintext_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;123456&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 创建角色 reader_role</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">role</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">exists</span><span style="color:#24292E;"> reader_role </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权角色 reader_role 可以读test_db/system 数据库</span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> test_db.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> reader_role </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">system</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> reader_role </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权 reader_role  角色给 reader 用户</span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> reader_role </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> reader </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster  ;</span></span></code></pre></div><ul><li>写</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 创建用户 writer、明文明码：123456</span></span>
<span class="line"><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">user</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">exists</span><span style="color:#E1E4E8;"> writer </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster </span></span>
<span class="line"><span style="color:#E1E4E8;">IDENTIFIED </span><span style="color:#F97583;">WITH</span><span style="color:#E1E4E8;"> plaintext_password </span><span style="color:#F97583;">BY</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;123456&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">-- 创建角色 wirter_role</span></span>
<span class="line"><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">role</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">exists</span><span style="color:#E1E4E8;"> wirter_role </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"><span style="color:#6A737D;">-- 授权角色 wirter_role  可以读写所有数据库</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> SHOW, </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">INSERT</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">DROP</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">TRUNCATE</span><span style="color:#E1E4E8;">, OPTIMIZE, </span><span style="color:#F97583;">KILL</span><span style="color:#E1E4E8;"> QUERY, </span><span style="color:#F97583;">MOVE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">PARTITION</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">BETWEEN</span><span style="color:#E1E4E8;"> SHARDS, </span><span style="color:#F97583;">SYSTEM</span><span style="color:#E1E4E8;">, dictGet, INTROSPECTION, SOURCES </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> wirter_role </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权 wirter_role  角色给 guaoran 用户</span></span>
<span class="line"><span style="color:#F97583;">GRANT</span><span style="color:#E1E4E8;"> wirter_role </span><span style="color:#F97583;">TO</span><span style="color:#E1E4E8;"> guaoran </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 收回 guaoran 用户 wirter_role  角色</span></span>
<span class="line"><span style="color:#F97583;">REVOKE</span><span style="color:#E1E4E8;"> wirter_role </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> guaoran </span><span style="color:#F97583;">on</span><span style="color:#E1E4E8;"> cluster my_cluster ;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 创建用户 writer、明文明码：123456</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">user</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">exists</span><span style="color:#24292E;"> writer </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster </span></span>
<span class="line"><span style="color:#24292E;">IDENTIFIED </span><span style="color:#D73A49;">WITH</span><span style="color:#24292E;"> plaintext_password </span><span style="color:#D73A49;">BY</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;123456&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6A737D;">-- 创建角色 wirter_role</span></span>
<span class="line"><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">role</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">not</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">exists</span><span style="color:#24292E;"> wirter_role </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"><span style="color:#6A737D;">-- 授权角色 wirter_role  可以读写所有数据库</span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> SHOW, </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">INSERT</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">DROP</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">TRUNCATE</span><span style="color:#24292E;">, OPTIMIZE, </span><span style="color:#D73A49;">KILL</span><span style="color:#24292E;"> QUERY, </span><span style="color:#D73A49;">MOVE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">PARTITION</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">BETWEEN</span><span style="color:#24292E;"> SHARDS, </span><span style="color:#D73A49;">SYSTEM</span><span style="color:#24292E;">, dictGet, INTROSPECTION, SOURCES </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> wirter_role </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 授权 wirter_role  角色给 guaoran 用户</span></span>
<span class="line"><span style="color:#D73A49;">GRANT</span><span style="color:#24292E;"> wirter_role </span><span style="color:#D73A49;">TO</span><span style="color:#24292E;"> guaoran </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">-- 收回 guaoran 用户 wirter_role  角色</span></span>
<span class="line"><span style="color:#D73A49;">REVOKE</span><span style="color:#24292E;"> wirter_role </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> guaoran </span><span style="color:#D73A49;">on</span><span style="color:#24292E;"> cluster my_cluster ;</span></span></code></pre></div><ul><li>查看</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">SHOW ACCESS</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">SHOW ACCESS</span></span></code></pre></div><h2 id="_1-9-回收权限" tabindex="-1">1.9 回收权限 <a class="header-anchor" href="#_1-9-回收权限" aria-label="Permalink to &quot;1.9 回收权限&quot;">​</a></h2><p><a href="https://clickhouse.com/docs/en/sql-reference/statements/revoke" target="_blank" rel="noreferrer">官当</a></p><p>语法：</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">REVOKE</span><span style="color:#E1E4E8;"> [ON CLUSTER cluster_name] privilege[(column_name [,...])] [,...] </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> {</span><span style="color:#79B8FF;">db</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">table</span><span style="color:#E1E4E8;">|db.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">|</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">|</span><span style="color:#F97583;">table</span><span style="color:#E1E4E8;">|</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">} </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> {user | CURRENT_USER} [,...] | ALL | ALL </span><span style="color:#F97583;">EXCEPT</span><span style="color:#E1E4E8;"> {user | CURRENT_USER} [,...]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">REVOKE</span><span style="color:#24292E;"> [ON CLUSTER cluster_name] privilege[(column_name [,...])] [,...] </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> {</span><span style="color:#005CC5;">db</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">table</span><span style="color:#24292E;">|db.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">|</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">|</span><span style="color:#D73A49;">table</span><span style="color:#24292E;">|</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">} </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> {user | CURRENT_USER} [,...] | ALL | ALL </span><span style="color:#D73A49;">EXCEPT</span><span style="color:#24292E;"> {user | CURRENT_USER} [,...]</span></span></code></pre></div><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">REVOKE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> test_auth_db.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> test_user;</span></span>
<span class="line"><span style="color:#F97583;">REVOKE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">DROP</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ON</span><span style="color:#E1E4E8;"> test_auth_db.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> test_user;</span></span>
<span class="line"><span style="color:#F97583;">REVOKE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ALTER</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> test_auth_db.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> test_user;</span></span>
<span class="line"><span style="color:#F97583;">REVOKE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">ON</span><span style="color:#E1E4E8;"> test_auth_db.</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> test_user;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">REVOKE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> test_auth_db.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> test_user;</span></span>
<span class="line"><span style="color:#D73A49;">REVOKE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">DROP</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ON</span><span style="color:#24292E;"> test_auth_db.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> test_user;</span></span>
<span class="line"><span style="color:#D73A49;">REVOKE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ALTER</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> test_auth_db.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> test_user;</span></span>
<span class="line"><span style="color:#D73A49;">REVOKE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">ON</span><span style="color:#24292E;"> test_auth_db.</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> test_user;</span></span></code></pre></div><p><a href="https://blog.csdn.net/weixin_38070561/article/details/131421734" target="_blank" rel="noreferrer">https://blog.csdn.net/weixin_38070561/article/details/131421734</a></p><p><a href="https://www.cnblogs.com/MrYang-11-GetKnow/p/15896355.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/MrYang-11-GetKnow/p/15896355.html</a></p><p><a href="http://www.mllib.cn/?id=9" target="_blank" rel="noreferrer">http://www.mllib.cn/?id=9</a></p><p><a href="https://www.cnblogs.com/MrYang-11-GetKnow/p/15896355.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/MrYang-11-GetKnow/p/15896355.html</a></p>`,103),e=[o];function t(c,r,E,y,i,d){return a(),n("div",null,e)}const u=s(p,[["render",t]]);export{A as __pageData,u as default};
