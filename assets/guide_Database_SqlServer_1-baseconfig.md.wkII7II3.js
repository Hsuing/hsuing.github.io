import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const g=JSON.parse('{"title":"1. Sql Server基础配置","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Database/SqlServer/1-baseconfig.md","filePath":"guide/Database/SqlServer/1-baseconfig.md","lastUpdated":1741098603000}'),e={name:"guide/Database/SqlServer/1-baseconfig.md"},p=l(`<h1 id="_1-sql-server基础配置" tabindex="-1">1. Sql Server基础配置 <a class="header-anchor" href="#_1-sql-server基础配置" aria-label="Permalink to &quot;1. Sql Server基础配置&quot;">​</a></h1><h2 id="_1-1-服务器配置" tabindex="-1">1.1 服务器配置 <a class="header-anchor" href="#_1-1-服务器配置" aria-label="Permalink to &quot;1.1 服务器配置&quot;">​</a></h2><h3 id="_1-服务器内存" tabindex="-1">1.服务器内存 <a class="header-anchor" href="#_1-服务器内存" aria-label="Permalink to &quot;1.服务器内存&quot;">​</a></h3><p>这些选项的默认设置和允许的最小值为：</p><table><thead><tr><th style="text-align:left;">选项</th><th style="text-align:left;">默认</th><th style="text-align:left;">允许的最小值</th><th style="text-align:left;">建议</th></tr></thead><tbody><tr><td style="text-align:left;"><strong>最小服务器内存 (MB)</strong></td><td style="text-align:left;">0</td><td style="text-align:left;">0</td><td style="text-align:left;">0</td></tr><tr><td style="text-align:left;"><strong>最大服务器内存 (MB)</strong></td><td style="text-align:left;">2,147,483,647 兆字节 (MB)</td><td style="text-align:left;">128 MB</td><td style="text-align:left;">75% 的可用系统内存未被其他进程（包括<a href="https://learn.microsoft.com/zh-cn/sql/database-engine/configure-windows/server-memory-server-configuration-options?view=sql-server-ver16#multiple-instances-of-" target="_blank" rel="noreferrer">其他实例</a>）占用。 有关更详细的建议，请参阅<a href="https://learn.microsoft.com/zh-cn/sql/database-engine/configure-windows/server-memory-server-configuration-options?view=sql-server-ver16#max-server-memory" target="_blank" rel="noreferrer">最大服务器内存</a>。</td></tr></tbody></table><p>在SSMS中设置步骤如下：</p><p>1.在对象资源管理器中，右键单击服务器并选择“属性”。</p><p>2.选择“服务器属性“窗口的“内存“页。这会显示最小服务器内存和最大服务器内存的当前值</p><p>3.在“服务器内存“选项中，输入最小服务器内存和最大服务器内存所需的数字</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502202152794.png" alt="image-20250220215136779"></p><blockquote><p>注意，<code>内存的修改，不用重启服务</code></p></blockquote><ul><li>使用sql修改，单位MB，12288 MB (12 GB)</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">sp_configure </span><span style="color:#9ECBFF;">&#39;show advanced options&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"><span style="color:#F97583;">RECONFIGURE</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"><span style="color:#E1E4E8;">sp_configure </span><span style="color:#9ECBFF;">&#39;max server memory&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">12288</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"><span style="color:#F97583;">RECONFIGURE</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">sp_configure </span><span style="color:#032F62;">&#39;show advanced options&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"><span style="color:#D73A49;">RECONFIGURE</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"><span style="color:#24292E;">sp_configure </span><span style="color:#032F62;">&#39;max server memory&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">12288</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"><span style="color:#D73A49;">RECONFIGURE</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span></code></pre></div><ul><li>查看修改之后的值</li></ul><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">SELECT</span><span style="color:#E1E4E8;"> [name], [value], [value_in_use]</span></span>
<span class="line"><span style="color:#F97583;">FROM</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">sys</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">configurations</span></span>
<span class="line"><span style="color:#F97583;">WHERE</span><span style="color:#E1E4E8;"> [name] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;max server memory (MB)&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">OR</span><span style="color:#E1E4E8;"> [name] </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;min server memory (MB)&#39;</span><span style="color:#E1E4E8;">;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">SELECT</span><span style="color:#24292E;"> [name], [value], [value_in_use]</span></span>
<span class="line"><span style="color:#D73A49;">FROM</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">sys</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">configurations</span></span>
<span class="line"><span style="color:#D73A49;">WHERE</span><span style="color:#24292E;"> [name] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;max server memory (MB)&#39;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">OR</span><span style="color:#24292E;"> [name] </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;min server memory (MB)&#39;</span><span style="color:#24292E;">;</span></span></code></pre></div><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502202200176.png" alt="image-20250220220052935"></p><h3 id="_2-配置每次查询分配的最小内存" tabindex="-1">2.配置每次查询分配的最小<a href="https://learn.microsoft.com/zh-cn/sql/database-engine/configure-windows/configure-the-min-memory-per-query-server-configuration-option?view=sql-server-2017" target="_blank" rel="noreferrer">内存</a> <a class="header-anchor" href="#_2-配置每次查询分配的最小内存" aria-label="Permalink to &quot;2.配置每次查询分配的最小[内存](https://learn.microsoft.com/zh-cn/sql/database-engine/configure-windows/configure-the-min-memory-per-query-server-configuration-option?view=sql-server-2017)&quot;">​</a></h3><p>“每次查询占用的最小内存”选项指定将分配给查询执行时所需要的最小内存量（KB）。</p><p>在SSMS中设置步骤如下：</p><p>1.在对象资源管理器中，右键单击服务器并选择“属性”。</p><p>2.单击“内存”节点。</p><p>3.在“每次查询占用的最小内存框中，输入将分配给查询执行时所需要的最小内存量（KB）。</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202502202207584.png" alt="image-20250220220707633"></p><ul><li>sql语句</li></ul><p>使用 <a href="https://learn.microsoft.com/zh-cn/sql/relational-databases/system-stored-procedures/sp-configure-transact-sql?view=sql-server-2017" target="_blank" rel="noreferrer">sp_configure</a> 将 <code>min memory per query</code> 选项的值设置为 <code>1024</code> KB</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">USE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">master</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">EXECUTE</span><span style="color:#E1E4E8;"> sp_configure </span><span style="color:#9ECBFF;">&#39;show advanced options&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">RECONFIGURE</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">EXECUTE</span><span style="color:#E1E4E8;"> sp_configure </span><span style="color:#9ECBFF;">&#39;min memory per query&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">1024</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">RECONFIGURE</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">EXECUTE</span><span style="color:#E1E4E8;"> sp_configure </span><span style="color:#9ECBFF;">&#39;show advanced options&#39;</span><span style="color:#E1E4E8;">, </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">RECONFIGURE</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#F97583;">GO</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">USE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">master</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">EXECUTE</span><span style="color:#24292E;"> sp_configure </span><span style="color:#032F62;">&#39;show advanced options&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">RECONFIGURE</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">EXECUTE</span><span style="color:#24292E;"> sp_configure </span><span style="color:#032F62;">&#39;min memory per query&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">1024</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">RECONFIGURE</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">EXECUTE</span><span style="color:#24292E;"> sp_configure </span><span style="color:#032F62;">&#39;show advanced options&#39;</span><span style="color:#24292E;">, </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">RECONFIGURE</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#D73A49;">GO</span></span></code></pre></div><h3 id="_3-配置最大并行度" tabindex="-1">3.配置最大并行度 <a class="header-anchor" href="#_3-配置最大并行度" aria-label="Permalink to &quot;3.配置最大并行度&quot;">​</a></h3><p>对于每个并行计划的执行，并行度设置了运行单个语句时所使用的处理器数量</p><table><thead><tr><th>服务器配置</th><th>处理数目</th><th>说明</th></tr></thead><tbody><tr><td>具有单个NUMA节点的服务器</td><td>小于或等于8个逻辑处理器</td><td>将MAXDOP保持为小于或等于逻辑处理器的数量</td></tr><tr><td>具有单个NUMA节点的服务器</td><td>大于8个逻辑处理器</td><td>将MAXDOP保持为8个</td></tr><tr><td>具有多个NUMA节点的服务器</td><td>每个NUMA节点拥有小于或等于16个逻辑处理器</td><td>将MAXDOP保持为小于或等于每个NUMA节点的逻辑处理器的数量</td></tr><tr><td>具有多个NUMA节点的服务器</td><td>每个NUMA节点大于16个逻辑处理器</td><td>将MAXDOP保持为每个NUMA节点逻辑处理器数量的一半，最大值为16</td></tr></tbody></table><h3 id="_4-配置最大工作线程数" tabindex="-1">4.配置最大工作线程数 <a class="header-anchor" href="#_4-配置最大工作线程数" aria-label="Permalink to &quot;4.配置最大工作线程数&quot;">​</a></h3><h2 id="_1-2-管理数据库引擎服务" tabindex="-1">1.2 管理数据库引擎服务 <a class="header-anchor" href="#_1-2-管理数据库引擎服务" aria-label="Permalink to &quot;1.2 管理数据库引擎服务&quot;">​</a></h2><h2 id="_1-3-服务器网络配置" tabindex="-1">1.3 服务器网络配置 <a class="header-anchor" href="#_1-3-服务器网络配置" aria-label="Permalink to &quot;1.3 服务器网络配置&quot;">​</a></h2>`,32),o=[p];function t(r,c,i,y,E,d){return a(),n("div",null,o)}const m=s(e,[["render",t]]);export{g as __pageData,m as default};
