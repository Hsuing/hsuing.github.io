import{_ as s,o as a,c as l,R as n}from"./chunks/framework.zUbWieqp.js";const u=JSON.parse('{"title":"1. ck配置文件","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Linux/Logs/Clickhouse/1-config.md","filePath":"guide/Linux/Logs/Clickhouse/1-config.md","lastUpdated":1730975389000}'),o={name:"guide/Linux/Logs/Clickhouse/1-config.md"},p=n(`<h1 id="_1-ck配置文件" tabindex="-1">1. ck配置文件 <a class="header-anchor" href="#_1-ck配置文件" aria-label="Permalink to &quot;1. ck配置文件&quot;">​</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/clickhouse-server/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/clickhouse-server/</span></span></code></pre></div><h2 id="_1-1-config-xml" tabindex="-1">1.1 config.xml <a class="header-anchor" href="#_1-1-config-xml" aria-label="Permalink to &quot;1.1 config.xml&quot;">​</a></h2><div class="language-xml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">timezone</span><span style="color:#E1E4E8;">&gt;Asia/Shanghai&lt;/</span><span style="color:#85E89D;">timezone</span><span style="color:#E1E4E8;">&gt; #修改时区</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">listen_host</span><span style="color:#E1E4E8;">&gt;::&lt;/</span><span style="color:#85E89D;">listen_host</span><span style="color:#E1E4E8;">&gt; #开启外部访问</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">&gt;/data/server/clickhouse/&lt;/</span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">&gt; #修改数据存放路径，默认是&lt;</span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">&gt;/var/lib/clickhouse&lt;/</span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">level</span><span style="color:#E1E4E8;">&gt;none&lt;/</span><span style="color:#85E89D;">level</span><span style="color:#E1E4E8;">&gt; #不记录日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">&lt;!-- &lt;log&gt;/data/server/clickhouse/log/clickhouse-server.log&lt;/log&gt; --&gt;</span><span style="color:#E1E4E8;"> #不记录日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">&lt;!-- &lt;errorlog&gt;/data/server/clickhouse/log/clickhouse-server.err.log&lt;/errorlog&gt; --&gt;</span><span style="color:#E1E4E8;"> #不记录日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">max_open_files</span><span style="color:#E1E4E8;">&gt;1048576&lt;/</span><span style="color:#85E89D;">max_open_files</span><span style="color:#E1E4E8;">&gt; #文件句柄数量的配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">http_port</span><span style="color:#E1E4E8;">&gt;8123&lt;/</span><span style="color:#85E89D;">http_port</span><span style="color:#E1E4E8;">&gt; #http默认端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">tcp_port</span><span style="color:#E1E4E8;">&gt;9000&lt;/</span><span style="color:#85E89D;">tcp_port</span><span style="color:#E1E4E8;">&gt; #tcp默认端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">max_concurrent_queries</span><span style="color:#E1E4E8;">&gt;4096&lt;/</span><span style="color:#85E89D;">max_concurrent_queries</span><span style="color:#E1E4E8;">&gt;  #限制的是活跃查询的数量，是对正在执行或排队等待执行的查询进行限制</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">&lt;</span><span style="color:#85E89D;">max_connections</span><span style="color:#E1E4E8;">&gt;4096&lt;/</span><span style="color:#85E89D;">max_connections</span><span style="color:#E1E4E8;">&gt; #限制的是客户端连接的数量，是对同时与 ClickHouse 建立的连接进行限制</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">timezone</span><span style="color:#24292E;">&gt;Asia/Shanghai&lt;/</span><span style="color:#22863A;">timezone</span><span style="color:#24292E;">&gt; #修改时区</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">listen_host</span><span style="color:#24292E;">&gt;::&lt;/</span><span style="color:#22863A;">listen_host</span><span style="color:#24292E;">&gt; #开启外部访问</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">path</span><span style="color:#24292E;">&gt;/data/server/clickhouse/&lt;/</span><span style="color:#22863A;">path</span><span style="color:#24292E;">&gt; #修改数据存放路径，默认是&lt;</span><span style="color:#22863A;">path</span><span style="color:#24292E;">&gt;/var/lib/clickhouse&lt;/</span><span style="color:#22863A;">path</span><span style="color:#24292E;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">level</span><span style="color:#24292E;">&gt;none&lt;/</span><span style="color:#22863A;">level</span><span style="color:#24292E;">&gt; #不记录日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">&lt;!-- &lt;log&gt;/data/server/clickhouse/log/clickhouse-server.log&lt;/log&gt; --&gt;</span><span style="color:#24292E;"> #不记录日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">&lt;!-- &lt;errorlog&gt;/data/server/clickhouse/log/clickhouse-server.err.log&lt;/errorlog&gt; --&gt;</span><span style="color:#24292E;"> #不记录日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">max_open_files</span><span style="color:#24292E;">&gt;1048576&lt;/</span><span style="color:#22863A;">max_open_files</span><span style="color:#24292E;">&gt; #文件句柄数量的配置</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">http_port</span><span style="color:#24292E;">&gt;8123&lt;/</span><span style="color:#22863A;">http_port</span><span style="color:#24292E;">&gt; #http默认端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">tcp_port</span><span style="color:#24292E;">&gt;9000&lt;/</span><span style="color:#22863A;">tcp_port</span><span style="color:#24292E;">&gt; #tcp默认端口</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">max_concurrent_queries</span><span style="color:#24292E;">&gt;4096&lt;/</span><span style="color:#22863A;">max_concurrent_queries</span><span style="color:#24292E;">&gt;  #限制的是活跃查询的数量，是对正在执行或排队等待执行的查询进行限制</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">&lt;</span><span style="color:#22863A;">max_connections</span><span style="color:#24292E;">&gt;4096&lt;/</span><span style="color:#22863A;">max_connections</span><span style="color:#24292E;">&gt; #限制的是客户端连接的数量，是对同时与 ClickHouse 建立的连接进行限制</span></span></code></pre></div><h2 id="_1-2-users-xml" tabindex="-1">1.2 users.xml <a class="header-anchor" href="#_1-2-users-xml" aria-label="Permalink to &quot;1.2 users.xml&quot;">​</a></h2><h2 id="_1-3-启动端口" tabindex="-1">1.3 启动端口 <a class="header-anchor" href="#_1-3-启动端口" aria-label="Permalink to &quot;1.3 启动端口&quot;">​</a></h2><table><thead><tr><th>端口</th><th>说明</th></tr></thead><tbody><tr><td>8123</td><td>ClickHouse 的 HTTP 端口，用于提供基于 HTTP 的查询接口。</td></tr><tr><td>9000</td><td>ClickHouse 的默认服务器端口，用于客户端与 ClickHouse 服务器进行通信</td></tr><tr><td>9004</td><td>ClickHouse 的分布式表引擎（Distributed Table Engine）使用的端口</td></tr><tr><td>9005</td><td>ClickHouse 的分布式表引擎（Distributed Table Engine）使用的备份（Replica）端口</td></tr><tr><td>9009</td><td>ClickHouse 的远程服务器管理（Remote Server Management）端口。通过该端口，可以使用 ClickHouse 客户端工具（如 clickhouse-client）远程管理 ClickHouse 服务器，包括执行管理命令、配置修改等操作</td></tr></tbody></table><h2 id="_1-4-包介绍" tabindex="-1">1.4 包介绍 <a class="header-anchor" href="#_1-4-包介绍" aria-label="Permalink to &quot;1.4 包介绍&quot;">​</a></h2><table><thead><tr><th>包名字</th><th>说明</th></tr></thead><tbody><tr><td>clickhouse-common-static-23.12.6.19</td><td>ClickHouse编译的二进制文件（23年份）</td></tr><tr><td>clickhouse-common-static-dbg-23.12.6.19</td><td>带有调试信息的ClickHouse二进制文件</td></tr><tr><td>clickhouse-server-23.12.6.19</td><td>软连接，并安装默认配置服务</td></tr><tr><td>clickhouse-client-23.12.6.19</td><td>客户端工具软连接，并安装客户端配置文件</td></tr></tbody></table><h2 id="_1-5-目录说明" tabindex="-1">1.5 目录说明 <a class="header-anchor" href="#_1-5-目录说明" aria-label="Permalink to &quot;1.5 目录说明&quot;">​</a></h2><table><thead><tr><th>目录名字</th><th>说明</th></tr></thead><tbody><tr><td>/etc/clickhouse-server</td><td>服务端的配置文件目录，包括全局配置config.xml和用户配置users.xml</td></tr><tr><td>/etc/clickhouse-client</td><td>客户端配置，里面只有一个config.xml并且默认为空</td></tr><tr><td>/etc/clickhouse-keeper</td><td>集群配置相关</td></tr><tr><td>/var/lib/clickhouse</td><td>数据目录</td></tr><tr><td>/var/log/clickhouse-server</td><td>日志目录</td></tr><tr><td>/etc/security/limits.d/clickhouse.conf</td><td>修改limit配置</td></tr><tr><td>/usr/bin{.}</td><td></td></tr></tbody></table><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">clickhouse                      clickhouse-diagnostics          clickhouse-keeper               clickhouse-obfuscator</span></span>
<span class="line"><span style="color:#e1e4e8;">clickhouse-benchmark            clickhouse-disks                clickhouse-keeper-client        clickhouse-odbc-bridge</span></span>
<span class="line"><span style="color:#e1e4e8;">clickhouse-client               clickhouse-extract-from-config  clickhouse-keeper-converter     clickhouse-server</span></span>
<span class="line"><span style="color:#e1e4e8;">clickhouse-compressor           clickhouse-format               clickhouse-library-bridge</span></span>
<span class="line"><span style="color:#e1e4e8;">clickhouse-copier               clickhouse-git-import           clickhouse-local</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">clickhouse                      clickhouse-diagnostics          clickhouse-keeper               clickhouse-obfuscator</span></span>
<span class="line"><span style="color:#24292e;">clickhouse-benchmark            clickhouse-disks                clickhouse-keeper-client        clickhouse-odbc-bridge</span></span>
<span class="line"><span style="color:#24292e;">clickhouse-client               clickhouse-extract-from-config  clickhouse-keeper-converter     clickhouse-server</span></span>
<span class="line"><span style="color:#24292e;">clickhouse-compressor           clickhouse-format               clickhouse-library-bridge</span></span>
<span class="line"><span style="color:#24292e;">clickhouse-copier               clickhouse-git-import           clickhouse-local</span></span></code></pre></div><h1 id="_2-ck修改数据目录" tabindex="-1">2. ck修改数据目录 <a class="header-anchor" href="#_2-ck修改数据目录" aria-label="Permalink to &quot;2. ck修改数据目录&quot;">​</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/clickhouse</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#数据存储目录</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/clickhouse/log</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#日志存放目录</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#修改目录权限</span></span>
<span class="line"><span style="color:#B392F0;">chown</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clickhouse:clickhouse</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/clickhouse</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span></span>
<span class="line"><span style="color:#B392F0;">chmod</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">755</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/clickhouse</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">vim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/clickhouse-server/config.xml</span></span>
<span class="line"><span style="color:#6A737D;">#修改此处</span></span>
<span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">/var/lib/clickhouse/</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">/path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#数据目录</span></span>
<span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">tmp_path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">/var/lib/clickhouse/tmp</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">/tmp_path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#用于处理大型查询的临时数据的路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">user_files_path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">/data/clickhouse/user_files/</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">/user_files_path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#包含用户文件的目录，在表函数file()中使用。</span></span>
<span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">format_schema_path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">/data/clickhouse/format_schemas/</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">/format_schema_path</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">#包含输入格式文件</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/clickhouse</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#数据存储目录</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/clickhouse/log</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#日志存放目录</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#修改目录权限</span></span>
<span class="line"><span style="color:#6F42C1;">chown</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clickhouse:clickhouse</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/clickhouse</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span></span>
<span class="line"><span style="color:#6F42C1;">chmod</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">755</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/clickhouse</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/clickhouse-server/config.xml</span></span>
<span class="line"><span style="color:#6A737D;">#修改此处</span></span>
<span class="line"><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">/var/lib/clickhouse/</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">/path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#数据目录</span></span>
<span class="line"><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">tmp_path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">/var/lib/clickhouse/tmp</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">/tmp_path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#用于处理大型查询的临时数据的路径</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">user_files_path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">/data/clickhouse/user_files/</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">/user_files_path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#包含用户文件的目录，在表函数file()中使用。</span></span>
<span class="line"><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">format_schema_path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">/data/clickhouse/format_schemas/</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">/format_schema_path</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">#包含输入格式文件</span></span></code></pre></div><blockquote><p>重启服务</p></blockquote><h1 id="_3-ck修改timezone" tabindex="-1">3. ck修改timezone <a class="header-anchor" href="#_3-ck修改timezone" aria-label="Permalink to &quot;3. ck修改timezone&quot;">​</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">vim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/clickhouse-server/config.xml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">timezone</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">Asia/Shanghai</span><span style="color:#F97583;">&lt;</span><span style="color:#E1E4E8;">/timezone</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#修改时区</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">vim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/clickhouse-server/config.xml</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">timezone</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">Asia/Shanghai</span><span style="color:#D73A49;">&lt;</span><span style="color:#24292E;">/timezone</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#修改时区</span></span></code></pre></div>`,17),e=[p];function t(c,r,i,y,E,h){return a(),l("div",null,e)}const g=s(o,[["render",t]]);export{u as __pageData,g as default};
