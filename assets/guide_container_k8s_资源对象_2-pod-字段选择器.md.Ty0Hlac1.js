import{_ as s,o as e,c as a,R as t}from"./chunks/framework.zUbWieqp.js";const E=JSON.parse('{"title":"1. 概述","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/资源对象/2-pod-字段选择器.md","filePath":"guide/container/k8s/资源对象/2-pod-字段选择器.md","lastUpdated":1721891189000}'),l={name:"guide/container/k8s/资源对象/2-pod-字段选择器.md"},o=t(`<h1 id="_1-概述" tabindex="-1">1. 概述 <a class="header-anchor" href="#_1-概述" aria-label="Permalink to &quot;1. 概述&quot;">​</a></h1><p>在Kubernetes中，字段选择器（Field Selectors）和标签选择器（Label Selectors）是两种不同的查询机制，用于过滤和选择特定的资源。字段选择器允许用户根据资源的内部字段来过滤资源，这些字段可以是资源的状态、元数据等。通过字段选择器，用户可以精确地选择出满足特定条件的资源，进而对这些资源执行进一步的操作，如查看、删除等。</p><h1 id="_2-基本语法" tabindex="-1">2. 基本语法 <a class="header-anchor" href="#_2-基本语法" aria-label="Permalink to &quot;2. 基本语法&quot;">​</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--field-selector</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">ke</span><span style="color:#E1E4E8;">y</span><span style="color:#9ECBFF;">&gt;([</span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">operator</span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">][</span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">value</span><span style="color:#F97583;">&gt;</span><span style="color:#9ECBFF;">])</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--field-selector</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">ke</span><span style="color:#24292E;">y</span><span style="color:#032F62;">&gt;([</span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">operator</span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">][</span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">value</span><span style="color:#D73A49;">&gt;</span><span style="color:#032F62;">])</span></span></code></pre></div><ul><li>使用 kubectl get 命令加上 --field-selector 选项来指定字段选择器。</li><li>字段选择器的格式为 =，其中 是资源的字段名， 是要匹配的值。</li><li>可以使用多个字段选择器，用逗号分隔。</li></ul><h1 id="_3-支持的字段" tabindex="-1">3. 支持的字段 <a class="header-anchor" href="#_3-支持的字段" aria-label="Permalink to &quot;3. 支持的字段&quot;">​</a></h1><blockquote><p>不同的 Kubernetes 资源类型支持不同的字段选择器。 所有资源类型都支持 <code>metadata.name</code> 和 <code>metadata.namespace</code> 字段。 使用不被支持的字段选择器会产生错误。</p></blockquote><h2 id="_3-1-支持的字段列表" tabindex="-1">3.1 支持的字段列表 <a class="header-anchor" href="#_3-1-支持的字段列表" aria-label="Permalink to &quot;3.1 支持的字段列表&quot;">​</a></h2><table><thead><tr><th style="text-align:left;">类别</th><th style="text-align:left;">字段</th></tr></thead><tbody><tr><td style="text-align:left;">Pod</td><td style="text-align:left;"><code>spec.nodeName</code> <code>spec.restartPolicy</code> <code>spec.schedulerName</code> <code>spec.serviceAccountName</code> <code>spec.hostNetwork</code> <code>status.phase</code> <code>status.podIP</code> <code>status.nominatedNodeName</code></td></tr><tr><td style="text-align:left;">Event</td><td style="text-align:left;"><code>involvedObject.kind</code> <code>involvedObject.namespace</code> <code>involvedObject.name</code> <code>involvedObject.uid</code> <code>involvedObject.apiVersion</code> <code>involvedObject.resourceVersion</code> <code>involvedObject.fieldPath</code> <code>reason</code> <code>reportingComponent</code> <code>source</code> <code>type</code></td></tr><tr><td style="text-align:left;">Secret</td><td style="text-align:left;"><code>type</code></td></tr><tr><td style="text-align:left;">Namespace</td><td style="text-align:left;"><code>status.phase</code></td></tr><tr><td style="text-align:left;">ReplicaSet</td><td style="text-align:left;"><code>status.replicas</code></td></tr><tr><td style="text-align:left;">ReplicationController</td><td style="text-align:left;"><code>status.replicas</code></td></tr><tr><td style="text-align:left;">Job</td><td style="text-align:left;"><code>status.successful</code></td></tr><tr><td style="text-align:left;">Node</td><td style="text-align:left;"><code>spec.unschedulable</code></td></tr><tr><td style="text-align:left;">CertificateSigningRequest</td><td style="text-align:left;"><code>spec.signerName</code></td></tr></tbody></table><h1 id="_4-支持的操作符" tabindex="-1">4. 支持的操作符 <a class="header-anchor" href="#_4-支持的操作符" aria-label="Permalink to &quot;4. 支持的操作符&quot;">​</a></h1><ul><li>等于（= 或 ==）：选择字段值等于指定值的资源。</li><li>不等于（!=）：选择字段值不等于指定值的资源。</li><li><a href="https://kubernetes.io/zh-cn/docs/concepts/overview/working-with-objects/labels/#set-based-requirement" target="_blank" rel="noreferrer">基于集合的操作符</a> （in、notin、exists）不支持字段选择算符。</li></ul><p>案例</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#查询集群中所有非运行状态的Pods</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pods</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-A</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--field-selector=status.phase!=Running</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#查询集群中所有非运行状态的Pods</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pods</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-A</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--field-selector=status.phase!=Running</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#查询集群中所有处于运行状态（Running）并且重启策略设置为Always的Pods</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pods</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-A</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--field-selector=status.phase=Running,spec.restartPolicy=Always</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#查询集群中所有处于运行状态（Running）并且重启策略设置为Always的Pods</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pods</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-A</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--field-selector=status.phase=Running,spec.restartPolicy=Always</span></span></code></pre></div><blockquote><p>多个字段选择器可以通过使用逗号分隔的列表组成一个选择链</p></blockquote><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#跨资源</span></span>
<span class="line"><span style="color:#6A737D;">#查询集群中除default命名空间之外的所有命名空间内的StatefulSets和Services资源</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">statefulsets,services</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--all-namespaces</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--field-selector</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">metadata.namespace!=default</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#跨资源</span></span>
<span class="line"><span style="color:#6A737D;">#查询集群中除default命名空间之外的所有命名空间内的StatefulSets和Services资源</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">statefulsets,services</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--all-namespaces</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--field-selector</span><span style="color:#24292E;"> </span><span style="color:#032F62;">metadata.namespace!=default</span></span></code></pre></div>`,16),n=[o];function p(c,r,d,i,y,u){return e(),a("div",null,n)}const g=s(l,[["render",p]]);export{E as __pageData,g as default};
