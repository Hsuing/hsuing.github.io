import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const d=JSON.parse('{"title":"1. BSC FULL节点部署","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Blockchain/BSC/2-deploy_fullnode.md","filePath":"guide/Blockchain/BSC/2-deploy_fullnode.md","lastUpdated":1745674312000}'),p={name:"guide/Blockchain/BSC/2-deploy_fullnode.md"},o=l(`<h1 id="_1-bsc-full节点部署" tabindex="-1">1. BSC FULL节点部署 <a class="header-anchor" href="#_1-bsc-full节点部署" aria-label="Permalink to &quot;1. BSC FULL节点部署&quot;">​</a></h1><p>目前只有三个客户端支持BSC链</p><ul><li>Geth: <a href="https://github.com/bnb-chain/bsc" target="_blank" rel="noreferrer">https://github.com/bnb-chain/bsc</a></li><li>Reth: <a href="https://github.com/bnb-chain/reth" target="_blank" rel="noreferrer">https://github.com/bnb-chain/reth</a></li><li>Erigon: <a href="https://github.com/node-real/bsc-erigon" target="_blank" rel="noreferrer">https://github.com/node-real/bsc-erigon</a> 因为 Erigon 主要支持存档模式，请使用 <a href="https://docs.bnbchain.org/bnb-smart-chain/developers/node_operators/archive_node/" target="_blank" rel="noreferrer">archive_node.md</a></li></ul><p>本次以Geth安装,支持在 <strong>Mac OS X</strong>、<strong>Linux</strong> 和 <strong>Windows</strong> 上运行全节点</p><h2 id="_1-0-服务器环境" tabindex="-1">1.0 服务器环境 <a class="header-anchor" href="#_1-0-服务器环境" aria-label="Permalink to &quot;1.0 服务器环境&quot;">​</a></h2><p>基于centos7.x</p><p>geth_bsc_v1.4.16</p><p>aws_c5.4xlarge(16x32g)</p><h2 id="_1-1-full节点作用" tabindex="-1">1.1 full节点作用 <a class="header-anchor" href="#_1-1-full节点作用" aria-label="Permalink to &quot;1.1 full节点作用&quot;">​</a></h2><p>Full Node 将完整的世界状态存储在磁盘上，并且能够：</p><ul><li>处理新交易并产生新区块，可以作为验证节点使用。</li><li>执行并验证新收到的区块。</li><li>验证每个账户的状态，因为它具有完整的世界状态。</li></ul><h2 id="_1-2-两种方式设置bsc全节点" tabindex="-1">1.2 两种方式设置BSC全节点 <a class="header-anchor" href="#_1-2-两种方式设置bsc全节点" aria-label="Permalink to &quot;1.2 两种方式设置BSC全节点&quot;">​</a></h2><p><a href="https://docs.bnbchain.org/bnb-smart-chain/developers/node_operators/full_node/#2run-bsc-full-node-geth" target="_blank" rel="noreferrer">https://docs.bnbchain.org/bnb-smart-chain/developers/node_operators/full_node/#2run-bsc-full-node-geth</a></p><p><a href="https://github.com/bnb-chain/bsc" target="_blank" rel="noreferrer">https://github.com/bnb-chain/bsc</a></p><h3 id="_1-snapshot-推荐" tabindex="-1">1.Snapshot-推荐 <a class="header-anchor" href="#_1-snapshot-推荐" aria-label="Permalink to &quot;1.Snapshot-推荐&quot;">​</a></h3><p>下载最新的快照，并根据快照进行同步</p><h3 id="_2-genesis" tabindex="-1">2.Genesis <a class="header-anchor" href="#_2-genesis" aria-label="Permalink to &quot;2.Genesis&quot;">​</a></h3><p>从创世区块同步整个 BSC 链</p><blockquote><p>截至 2024 年 11 月，BSC 主网的最新区块高度超过 40M，需要更强大的硬件，并且需要很长时间才能从创世同步，因此建议基于快照设置 BSC 全节点。</p></blockquote><h2 id="_1-3-下载" tabindex="-1">1.3 下载 <a class="header-anchor" href="#_1-3-下载" aria-label="Permalink to &quot;1.3 下载&quot;">​</a></h2><p><a href="https://github.com/bnb-chain/bsc/releases/latest" target="_blank" rel="noreferrer">release page</a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># Linux</span></span>
<span class="line"><span style="color:#B392F0;">wget</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">$(</span><span style="color:#B392F0;">curl</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-s</span><span style="color:#9ECBFF;"> https://api.github.com/repos/bnb-chain/bsc/releases/latest </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#9ECBFF;"> browser_ </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#9ECBFF;"> geth_linux </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">cut</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-d\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-f4</span><span style="color:#9ECBFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#指定版本进行下载</span></span>
<span class="line"><span style="color:#B392F0;">wget</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/bnb-chain/bsc/releases/download/v1.4.16/geth_linux</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># Linux</span></span>
<span class="line"><span style="color:#6F42C1;">wget</span><span style="color:#24292E;">   </span><span style="color:#032F62;">$(</span><span style="color:#6F42C1;">curl</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-s</span><span style="color:#032F62;"> https://api.github.com/repos/bnb-chain/bsc/releases/latest </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#032F62;"> browser_ </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#032F62;"> geth_linux </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">cut</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-d\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-f4</span><span style="color:#032F62;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#指定版本进行下载</span></span>
<span class="line"><span style="color:#6F42C1;">wget</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/bnb-chain/bsc/releases/download/v1.4.16/geth_linux</span></span></code></pre></div><ul><li>下载配置文件</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">#下载配置</span></span>
<span class="line"><span style="color:#6A737D;"># mainnet</span></span>
<span class="line"><span style="color:#B392F0;">wget</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">$(</span><span style="color:#B392F0;">curl</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-s</span><span style="color:#9ECBFF;"> https://api.github.com/repos/bnb-chain/bsc/releases/latest </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#9ECBFF;"> browser_ </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#9ECBFF;"> mainnet </span><span style="color:#F97583;">|</span><span style="color:#B392F0;">cut</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-d\\&quot;</span><span style="color:#9ECBFF;"> </span><span style="color:#79B8FF;">-f4</span><span style="color:#9ECBFF;">)</span></span>
<span class="line"><span style="color:#B392F0;">unzip</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">mainnet.zip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#指定版本进行下载</span></span>
<span class="line"><span style="color:#B392F0;">wget</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">https://github.com/bnb-chain/bsc/releases/download/v1.4.16/mainnet.zip</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">#下载配置</span></span>
<span class="line"><span style="color:#6A737D;"># mainnet</span></span>
<span class="line"><span style="color:#6F42C1;">wget</span><span style="color:#24292E;">   </span><span style="color:#032F62;">$(</span><span style="color:#6F42C1;">curl</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-s</span><span style="color:#032F62;"> https://api.github.com/repos/bnb-chain/bsc/releases/latest </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#032F62;"> browser_ </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#032F62;"> mainnet </span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">cut</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-d\\&quot;</span><span style="color:#032F62;"> </span><span style="color:#005CC5;">-f4</span><span style="color:#032F62;">)</span></span>
<span class="line"><span style="color:#6F42C1;">unzip</span><span style="color:#24292E;"> </span><span style="color:#032F62;">mainnet.zip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">#指定版本进行下载</span></span>
<span class="line"><span style="color:#6F42C1;">wget</span><span style="color:#24292E;"> </span><span style="color:#032F62;">https://github.com/bnb-chain/bsc/releases/download/v1.4.16/mainnet.zip</span></span></code></pre></div><ul><li>下载快照文件</li></ul><p><a href="https://github.com/bnb-chain/bsc-snapshots" target="_blank" rel="noreferrer">here</a></p><p>这个需要双倍磁盘空间（解压）</p><h2 id="_1-4-部署" tabindex="-1">1.4 部署 <a class="header-anchor" href="#_1-4-部署" aria-label="Permalink to &quot;1.4 部署&quot;">​</a></h2><ul><li>创建目录</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/apps/bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/bsc</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/apps/bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/bsc</span></span></code></pre></div><ul><li>移动geth</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mv</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">geth_linux</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/apps/bsc/geth</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">chmod</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-v</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">u+x</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">geth</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mv</span><span style="color:#24292E;"> </span><span style="color:#032F62;">geth_linux</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/apps/bsc/geth</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">chmod</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-v</span><span style="color:#24292E;"> </span><span style="color:#032F62;">u+x</span><span style="color:#24292E;"> </span><span style="color:#032F62;">geth</span></span></code></pre></div><ul><li>创建用户</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">useradd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-rs</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/bin/</span><span style="color:#79B8FF;">false</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">chown</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bsc.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/apps/bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">chown</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bsc.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/bsc</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">useradd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-rs</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/bin/</span><span style="color:#005CC5;">false</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">chown</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bsc.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/apps/bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">chown</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bsc.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/bsc</span></span></code></pre></div><ul><li>创建启动脚本</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark has-diff vp-code-dark"><code><span class="line"><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/apps/bsc/bsc_bsc_validator.sh</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#9ECBFF;">cd /data/apps/bsc/</span></span>
<span class="line"><span style="color:#9ECBFF;">/data/apps/bsc/geth --config /data/apps/bsc/config.toml --syncmode snap --datadir /data/bsc  --cache 2000 -rpc.allow-unprotected-txs --txlookuplimit 0 --txpool.reannouncetime 5m --history.transactions 0 --db.engine=pebble --pruneancient=true --diffsync</span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span></code></pre><pre class="shiki github-light has-diff vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/apps/bsc/bsc_bsc_validator.sh</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#032F62;">cd /data/apps/bsc/</span></span>
<span class="line"><span style="color:#032F62;">/data/apps/bsc/geth --config /data/apps/bsc/config.toml --syncmode snap --datadir /data/bsc  --cache 2000 -rpc.allow-unprotected-txs --txlookuplimit 0 --txpool.reannouncetime 5m --history.transactions 0 --db.engine=pebble --pruneancient=true --diffsync</span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span></code></pre></div><p>参数解释：</p><p>--config：指定BSC节点配置文件</p><p>--datadir：指定BSC节点数据库和密钥存储库的数据目录(默认:&quot;/root/.ethereum&quot;)</p><p>--cache：设置最大分配给内部缓存的内存，默认:1024（建议3分之1，设置越大，每次同步的数据越多，消耗的内存也越大）</p><p>--rpc.allow-unprotected-txs：允许通过RPC提交不受保护的（非 EIP155 签名）交易</p><p>--txlookuplimit 0 : 禁用删除事务索引</p><p>--diffsync：启用差异同步协议来帮助节点更快地同步</p><p>--db.engine ：使用数据库实现（pebble or leveldb）</p><p>--pruneancient=true ：只保留90000万最新数据</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">chown</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bsc.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/apps/bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">chmod</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-v</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">u+x</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/apps/bsc/bsc_bsc_validator.sh</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">chown</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bsc.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/apps/bsc</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">chmod</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-v</span><span style="color:#24292E;"> </span><span style="color:#032F62;">u+x</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/apps/bsc/bsc_bsc_validator.sh</span></span></code></pre></div><ul><li>创建systemd</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">cat</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/systemd/system/bsc.service</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">EOF</span></span>
<span class="line"><span style="color:#9ECBFF;">[Unit]</span></span>
<span class="line"><span style="color:#9ECBFF;">Description=BSC Validator</span></span>
<span class="line"><span style="color:#9ECBFF;">Documentation=https://docs.bnbchain.org/bnb-smart-chain/</span></span>
<span class="line"><span style="color:#9ECBFF;">After=network.target</span></span>
<span class="line"><span style="color:#9ECBFF;">Wants=bsc-sys-tuner.service</span></span>
<span class="line"><span style="color:#9ECBFF;">StartLimitIntervalSec=0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9ECBFF;">[Service]</span></span>
<span class="line"><span style="color:#9ECBFF;">Type=simple</span></span>
<span class="line"><span style="color:#9ECBFF;">Restart=always</span></span>
<span class="line"><span style="color:#9ECBFF;">RestartSec=1</span></span>
<span class="line"><span style="color:#9ECBFF;">User=bsc</span></span>
<span class="line"><span style="color:#9ECBFF;">LimitNOFILE=1000000</span></span>
<span class="line"><span style="color:#9ECBFF;">LogRateLimitIntervalSec=0</span></span>
<span class="line"><span style="color:#9ECBFF;">Environment=&quot;PATH=/data/apps/bsc:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span></span>
<span class="line"><span style="color:#9ECBFF;">ExecStart=/data/apps/bsc/bsc_validator.sh</span></span>
<span class="line"><span style="color:#9ECBFF;">ExecStop=/bin/kill -HUP </span><span style="color:#E1E4E8;">$MAINPID</span></span>
<span class="line"><span style="color:#9ECBFF;">KillMode=process</span></span>
<span class="line"><span style="color:#9ECBFF;">[Install]</span></span>
<span class="line"><span style="color:#9ECBFF;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="color:#9ECBFF;">EOF</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">cat</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/systemd/system/bsc.service</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">EOF</span></span>
<span class="line"><span style="color:#032F62;">[Unit]</span></span>
<span class="line"><span style="color:#032F62;">Description=BSC Validator</span></span>
<span class="line"><span style="color:#032F62;">Documentation=https://docs.bnbchain.org/bnb-smart-chain/</span></span>
<span class="line"><span style="color:#032F62;">After=network.target</span></span>
<span class="line"><span style="color:#032F62;">Wants=bsc-sys-tuner.service</span></span>
<span class="line"><span style="color:#032F62;">StartLimitIntervalSec=0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#032F62;">[Service]</span></span>
<span class="line"><span style="color:#032F62;">Type=simple</span></span>
<span class="line"><span style="color:#032F62;">Restart=always</span></span>
<span class="line"><span style="color:#032F62;">RestartSec=1</span></span>
<span class="line"><span style="color:#032F62;">User=bsc</span></span>
<span class="line"><span style="color:#032F62;">LimitNOFILE=1000000</span></span>
<span class="line"><span style="color:#032F62;">LogRateLimitIntervalSec=0</span></span>
<span class="line"><span style="color:#032F62;">Environment=&quot;PATH=/data/apps/bsc:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span></span>
<span class="line"><span style="color:#032F62;">ExecStart=/data/apps/bsc/bsc_validator.sh</span></span>
<span class="line"><span style="color:#032F62;">ExecStop=/bin/kill -HUP </span><span style="color:#24292E;">$MAINPID</span></span>
<span class="line"><span style="color:#032F62;">KillMode=process</span></span>
<span class="line"><span style="color:#032F62;">[Install]</span></span>
<span class="line"><span style="color:#032F62;">WantedBy=multi-user.target</span></span>
<span class="line"><span style="color:#032F62;">EOF</span></span></code></pre></div><ul><li>修改启动配置文件</li></ul><p>HTTPHost: HTTP-RPC服务连接白名单，此参数的值默认为 &quot;localhost&quot;，仅允许本地可访问，可设置为：&quot;0.0.0.0&quot;</p><p>HTTPVirtualHosts：HTTP-RPC服务监听接口,此参数的值默认为 [&quot;localhost&quot;],可设置为：HTTPVirtualHosts = [&quot;*&quot;]</p><p>HTTPPort：http协议rpc端口</p><p>WSPort：websocket协议rpc端口</p><p>WSHost：websocket服务连接白名单，此参数的值默认为 &quot;localhost&quot;，仅允许本地可访问，如果需要外网访问节点可设置为：&quot;0.0.0.0&quot;</p><p>WSOrigins：websocket服务监听接口,可设置为：WSOrigins = [&quot;*&quot;]</p><h2 id="_1-5-启动" tabindex="-1">1.5 启动 <a class="header-anchor" href="#_1-5-启动" aria-label="Permalink to &quot;1.5 启动&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">daemon-reload</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enable</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--now</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bsc</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## 测试</span></span>
<span class="line"><span style="color:#B392F0;">./geth</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--config</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">./config.toml</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--datadir</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">datadi</span><span style="color:#E1E4E8;">r</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;">  </span><span style="color:#79B8FF;">--cache</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">8000</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">daemon-reload</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enable</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--now</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bsc</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## 测试</span></span>
<span class="line"><span style="color:#6F42C1;">./geth</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--config</span><span style="color:#24292E;"> </span><span style="color:#032F62;">./config.toml</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--datadir</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">datadi</span><span style="color:#24292E;">r</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;">  </span><span style="color:#005CC5;">--cache</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">8000</span></span></code></pre></div><ul><li>查看同步状态</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">tail</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/data/bsc/bsc.log</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">tail</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/data/bsc/bsc.log</span></span></code></pre></div><ul><li>关闭服务</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#79B8FF;">kill</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-HUP</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">$(</span><span style="color:#B392F0;">pgrep</span><span style="color:#9ECBFF;"> geth)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#005CC5;">kill</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-HUP</span><span style="color:#24292E;"> </span><span style="color:#032F62;">$(</span><span style="color:#6F42C1;">pgrep</span><span style="color:#032F62;"> geth)</span></span></code></pre></div><h1 id="_2-bsc-同步模式" tabindex="-1">2. BSC 同步模式 <a class="header-anchor" href="#_2-bsc-同步模式" aria-label="Permalink to &quot;2. BSC 同步模式&quot;">​</a></h1><p>通过标志 <strong>--syncmode</strong> 指定</p><h2 id="_2-1-snap-推荐" tabindex="-1">2.1 snap-推荐 <a class="header-anchor" href="#_2-1-snap-推荐" aria-label="Permalink to &quot;2.1 snap-推荐&quot;">​</a></h2><p>该模式为<strong>默认</strong>，模式用于初始同步，它将下载最新的状态，而不是执行创世中的区块。初始同步完成后，它将自动切换到完全同步。</p><h2 id="_2-2-full" tabindex="-1">2.2 full <a class="header-anchor" href="#_2-2-full" aria-label="Permalink to &quot;2.2 full&quot;">​</a></h2><p>模式也可用于进行初始同步，这将执行自创世以来的所有 block。但<strong>不建议</strong>这样做，因为历史数据量太大。相反，你可以从<a href="https://github.com/bnb-chain/bsc-snapshots" target="_blank" rel="noreferrer">官方存储库</a>下载快照，然后从快照开始完全同步。</p><h1 id="_3-bsc常用命令" tabindex="-1">3. BSC常用命令 <a class="header-anchor" href="#_3-bsc常用命令" aria-label="Permalink to &quot;3. BSC常用命令&quot;">​</a></h1><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;"># 查看当前最新区块</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-H</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Content-Type: application/json&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-X</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POST</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--data</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_blockNumber&quot;,&quot;params&quot;:[],&quot;id&quot;:1}&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">http://127.0.0.1:8545</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#B392F0;">&quot;jsonrpc&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#B392F0;">&quot;2.0&quot;</span><span style="color:#B392F0;">,</span><span style="color:#B392F0;">&quot;id&quot;</span><span style="color:#B392F0;">:1,</span><span style="color:#B392F0;">&quot;result&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#B392F0;">&quot;0x8f8e68&quot;</span><span style="color:#B392F0;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看当前同步状态</span></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-H</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Content-Type: application/json&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-X</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POST</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--data</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_syncing&quot;,&quot;params&quot;:[],&quot;id&quot;:1}&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">http://127.0.0.1:8545</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">{</span><span style="color:#B392F0;">&quot;jsonrpc&quot;</span><span style="color:#79B8FF;">:</span><span style="color:#B392F0;">&quot;2.0&quot;</span><span style="color:#B392F0;">,</span><span style="color:#B392F0;">&quot;id&quot;</span><span style="color:#B392F0;">:1,</span><span style="color:#B392F0;">&quot;result&quot;</span><span style="color:#B392F0;">:false}</span></span>
<span class="line"><span style="color:#6A737D;"># 注：结果为false为同步完成</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">curl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-H</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Content-Type: application/json&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-X</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">POST</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--data</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;net_version&quot;,&quot;params&quot;:[],&quot;id&quot;:1}&#39;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">http://127.0.0.1:8545</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;"># 查看当前最新区块</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">curl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-H</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Content-Type: application/json&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-X</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POST</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--data</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_blockNumber&quot;,&quot;params&quot;:[],&quot;id&quot;:1}&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:8545</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">{</span><span style="color:#6F42C1;">&quot;jsonrpc&quot;</span><span style="color:#005CC5;">:</span><span style="color:#6F42C1;">&quot;2.0&quot;</span><span style="color:#6F42C1;">,</span><span style="color:#6F42C1;">&quot;id&quot;</span><span style="color:#6F42C1;">:1,</span><span style="color:#6F42C1;">&quot;result&quot;</span><span style="color:#005CC5;">:</span><span style="color:#6F42C1;">&quot;0x8f8e68&quot;</span><span style="color:#6F42C1;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 查看当前同步状态</span></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">curl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-H</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Content-Type: application/json&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-X</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POST</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--data</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;eth_syncing&quot;,&quot;params&quot;:[],&quot;id&quot;:1}&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:8545</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">{</span><span style="color:#6F42C1;">&quot;jsonrpc&quot;</span><span style="color:#005CC5;">:</span><span style="color:#6F42C1;">&quot;2.0&quot;</span><span style="color:#6F42C1;">,</span><span style="color:#6F42C1;">&quot;id&quot;</span><span style="color:#6F42C1;">:1,</span><span style="color:#6F42C1;">&quot;result&quot;</span><span style="color:#6F42C1;">:false}</span></span>
<span class="line"><span style="color:#6A737D;"># 注：结果为false为同步完成</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">curl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-H</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Content-Type: application/json&quot;</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-X</span><span style="color:#24292E;"> </span><span style="color:#032F62;">POST</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--data</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&#39;{&quot;jsonrpc&quot;:&quot;2.0&quot;,&quot;method&quot;:&quot;net_version&quot;,&quot;params&quot;:[],&quot;id&quot;:1}&#39;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">http://127.0.0.1:8545</span></span></code></pre></div>`,69),e=[o];function t(c,r,i,y,F,E){return a(),n("div",null,e)}const h=s(p,[["render",t]]);export{d as __pageData,h as default};
