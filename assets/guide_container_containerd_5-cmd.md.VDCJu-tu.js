import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const C=JSON.parse('{"title":"1. docker、crictl和ctr命令对比","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/containerd/5-cmd.md","filePath":"guide/container/containerd/5-cmd.md","lastUpdated":1732547108000}'),p={name:"guide/container/containerd/5-cmd.md"},o=l(`<h1 id="_1-docker、crictl和ctr命令对比" tabindex="-1">1. docker、crictl和ctr命令对比 <a class="header-anchor" href="#_1-docker、crictl和ctr命令对比" aria-label="Permalink to &quot;1. docker、crictl和ctr命令对比&quot;">​</a></h1><table><thead><tr><th><strong>命令</strong></th><th><strong>docker</strong></th><th><strong>crictl（k8s）</strong></th><th><strong>ctr（containerd）</strong></th><th><strong>nerdctl（containerd）</strong></th></tr></thead><tbody><tr><td>查看运行的容器</td><td>docker ps</td><td>crictl ps</td><td>ctr task ls/ctr container ls</td><td>nerdctl ps</td></tr><tr><td>查看镜像</td><td>docker images</td><td>crictl images</td><td>ctr image ls</td><td>nerdctl images</td></tr><tr><td>查看容器日志</td><td>docker logs</td><td>crictl logs</td><td>无</td><td>nerdctl logs</td></tr><tr><td>查看容器信息</td><td>docker inspect</td><td>crictl inspect</td><td>ctr container info</td><td>nerdctl inspect</td></tr><tr><td>查看容器资源使用</td><td>docker stats</td><td>crictl stats</td><td>无</td><td>nerdctl stats</td></tr><tr><td>启动/关闭已有的容器</td><td>docker start/stop</td><td>crictl start/stop</td><td>ctr task start/kill</td><td>nerdctl start/stop</td></tr><tr><td>运行一个新的容器</td><td>docker run</td><td>比较麻烦，因为它的最小单元为 Pod</td><td>ctr run</td><td>nerdctl run</td></tr><tr><td>创建一个新的容器</td><td>docker create</td><td>比较麻烦，因为它的最小单元为 Pod</td><td>ctr container create</td><td>nerdctl create</td></tr><tr><td>在容器内部执行命令</td><td>docker exec</td><td>crictl exec</td><td>无</td><td>nerdctl exec</td></tr><tr><td>删除容器</td><td>docker rm</td><td>crictl rm</td><td>ctr container rm</td><td>nerdctl rm</td></tr><tr><td>删除镜像</td><td>docker rmi</td><td>crictl rmi</td><td>ctr image rm</td><td>nerdctl rmi</td></tr><tr><td>导入镜像</td><td>docker load</td><td>无</td><td>ctr image import</td><td>nerdctl load</td></tr><tr><td>导出镜像</td><td>docker save</td><td>无</td><td>ctr image export</td><td>nerdctl save</td></tr><tr><td>拉取镜像</td><td>docker pull</td><td>ctictl pull</td><td>ctr image pull</td><td>nerdctl pull</td></tr><tr><td>给镜像打标签</td><td>docker tag</td><td>无</td><td>ctr image tag</td><td>nerdctl tag</td></tr><tr><td>推送镜像</td><td>docker push</td><td>无</td><td>ctr image push</td><td>nerdctl push</td></tr><tr><td>构建镜像</td><td>docker build</td><td>无</td><td>无</td><td>nerdctl build（需要额外安装buildkit服务）</td></tr></tbody></table><div class="danger custom-block"><p class="custom-block-title">❌ 注意</p><p>ctr和nerdctl命令需要指定名字空间，管理k8s创建的容器，需要使用k8s.io名字空间，即ctr/nerdctl -n k8s.io</p></div><h1 id="_2-内置命令" tabindex="-1">2. 内置命令 <a class="header-anchor" href="#_2-内置命令" aria-label="Permalink to &quot;2. 内置命令&quot;">​</a></h1><h2 id="_2-1-ctr" tabindex="-1">2.1 ctr <a class="header-anchor" href="#_2-1-ctr" aria-label="Permalink to &quot;2.1 ctr&quot;">​</a></h2><p>ctr是containerd提供的客户端工具,内置在containerd中. <code>不好的一点,下载镜像的指定具体路径</code></p><div class="danger custom-block"><p class="custom-block-title">❌ 注意</p><p>containerd支持oci标准的镜像，所以可以直接使用docker官方或dockerfile构建Q的镜像需要注意的是，与docker不同，拉取镜像时要加上docker.io/liarary</p></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 containers]# ctr --help</span></span>
<span class="line"><span style="color:#B392F0;">NAME:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">-</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">__</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#B392F0;">_____/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/______</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">___/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">__/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">___/</span></span>
<span class="line"><span style="color:#B392F0;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/__/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/_/</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/</span></span>
<span class="line"><span style="color:#B392F0;">\\___/\\__/_/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">containerd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CLI</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">USAGE:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> [global </span><span style="color:#9ECBFF;">options]</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">command</span><span style="color:#E1E4E8;"> [command </span><span style="color:#9ECBFF;">options]</span><span style="color:#E1E4E8;"> [arguments...]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">VERSION:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">v1.7.22</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">DESCRIPTION:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">an</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">unsupported</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">debug</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">administrative</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">client</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">interacting</span></span>
<span class="line"><span style="color:#B392F0;">with</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containerd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">daemon.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Because</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">it</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">unsupported,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">commands,</span></span>
<span class="line"><span style="color:#B392F0;">options,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">operations</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">are</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">not</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">guaranteed</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">be</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">backward</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">compatible</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">or</span></span>
<span class="line"><span style="color:#B392F0;">stable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">release</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">release</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">of</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containerd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">project.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">COMMANDS:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">plugins,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">plugin</span><span style="color:#E1E4E8;">            </span><span style="color:#9ECBFF;">Provides</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">information</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">about</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containerd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">plugins</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">version</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Print</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">client</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">versions</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">containers,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">c,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">container</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containers</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">content</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">content</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">events,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">event</span><span style="color:#E1E4E8;">              </span><span style="color:#9ECBFF;">Display</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containerd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">events</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">images,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">i</span><span style="color:#E1E4E8;">           </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">leases</span><span style="color:#E1E4E8;">                     </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">leases</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">namespaces,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">namespace,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ns</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">namespaces</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">pprof</span><span style="color:#E1E4E8;">                      </span><span style="color:#9ECBFF;">Provide</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">golang</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pprof</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">outputs</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containerd</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">run</span><span style="color:#E1E4E8;">                        </span><span style="color:#9ECBFF;">Run</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">container</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">snapshots,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">snapshot</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">snapshots</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">tasks,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">t,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">task</span><span style="color:#E1E4E8;">             </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tasks</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">install</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">package</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">oci</span><span style="color:#E1E4E8;">                        </span><span style="color:#9ECBFF;">OCI</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tools</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">sandboxes,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sandbox,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sb,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">s</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sandboxes</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">info</span><span style="color:#E1E4E8;">                       </span><span style="color:#9ECBFF;">Print</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">info</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">deprecations</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">shim</span><span style="color:#E1E4E8;">                       </span><span style="color:#9ECBFF;">Interact</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">with</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">shim</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">directly</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">help,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">h</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Shows</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">list</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">of</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">commands</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">or</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">help</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">one</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">command</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">GLOBAL</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">OPTIONS:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">--debug</span><span style="color:#E1E4E8;">                      </span><span style="color:#9ECBFF;">Enable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">debug</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">output</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">--address</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">value,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">value</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">Address</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containerd&#39;s GRPC server (default: &quot;/run/containerd/containerd.sock&quot;) [$CONTAINERD_ADDRESS]</span></span>
<span class="line"><span style="color:#9ECBFF;">   --timeout value              Total timeout for ctr commands (default: 0s)</span></span>
<span class="line"><span style="color:#9ECBFF;">   --connect-timeout value      Timeout for connecting to containerd (default: 0s)</span></span>
<span class="line"><span style="color:#9ECBFF;">   --namespace value, -n value  Namespace to use with commands (default: &quot;default&quot;) [$CONTAINERD_NAMESPACE]</span></span>
<span class="line"><span style="color:#9ECBFF;">   --help, -h                   show help</span></span>
<span class="line"><span style="color:#9ECBFF;">   --version, -v                print the version</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master-01 containers]# ctr --help</span></span>
<span class="line"><span style="color:#6F42C1;">NAME:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">__</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#6F42C1;">_____/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/______</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#6F42C1;">/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">___/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">__/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">___/</span></span>
<span class="line"><span style="color:#6F42C1;">/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/__/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/_/</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/</span></span>
<span class="line"><span style="color:#6F42C1;">\\___/\\__/_/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">containerd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CLI</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">USAGE:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> [global </span><span style="color:#032F62;">options]</span><span style="color:#24292E;"> </span><span style="color:#032F62;">command</span><span style="color:#24292E;"> [command </span><span style="color:#032F62;">options]</span><span style="color:#24292E;"> [arguments...]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">VERSION:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">v1.7.22</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">DESCRIPTION:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#032F62;">an</span><span style="color:#24292E;"> </span><span style="color:#032F62;">unsupported</span><span style="color:#24292E;"> </span><span style="color:#032F62;">debug</span><span style="color:#24292E;"> </span><span style="color:#032F62;">and</span><span style="color:#24292E;"> </span><span style="color:#032F62;">administrative</span><span style="color:#24292E;"> </span><span style="color:#032F62;">client</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">interacting</span></span>
<span class="line"><span style="color:#6F42C1;">with</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containerd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">daemon.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Because</span><span style="color:#24292E;"> </span><span style="color:#032F62;">it</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#032F62;">unsupported,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">commands,</span></span>
<span class="line"><span style="color:#6F42C1;">options,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">and</span><span style="color:#24292E;"> </span><span style="color:#032F62;">operations</span><span style="color:#24292E;"> </span><span style="color:#032F62;">are</span><span style="color:#24292E;"> </span><span style="color:#032F62;">not</span><span style="color:#24292E;"> </span><span style="color:#032F62;">guaranteed</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">be</span><span style="color:#24292E;"> </span><span style="color:#032F62;">backward</span><span style="color:#24292E;"> </span><span style="color:#032F62;">compatible</span><span style="color:#24292E;"> </span><span style="color:#032F62;">or</span></span>
<span class="line"><span style="color:#6F42C1;">stable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">release</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">release</span><span style="color:#24292E;"> </span><span style="color:#032F62;">of</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containerd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">project.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">COMMANDS:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">plugins,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">plugin</span><span style="color:#24292E;">            </span><span style="color:#032F62;">Provides</span><span style="color:#24292E;"> </span><span style="color:#032F62;">information</span><span style="color:#24292E;"> </span><span style="color:#032F62;">about</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containerd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">plugins</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">version</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Print</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">client</span><span style="color:#24292E;"> </span><span style="color:#032F62;">and</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server</span><span style="color:#24292E;"> </span><span style="color:#032F62;">versions</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">containers,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">c,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">container</span><span style="color:#24292E;">   </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containers</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">content</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">content</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">events,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">event</span><span style="color:#24292E;">              </span><span style="color:#032F62;">Display</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containerd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">events</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">images,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">i</span><span style="color:#24292E;">           </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">leases</span><span style="color:#24292E;">                     </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">leases</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">namespaces,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">namespace,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ns</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">namespaces</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">pprof</span><span style="color:#24292E;">                      </span><span style="color:#032F62;">Provide</span><span style="color:#24292E;"> </span><span style="color:#032F62;">golang</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pprof</span><span style="color:#24292E;"> </span><span style="color:#032F62;">outputs</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containerd</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">run</span><span style="color:#24292E;">                        </span><span style="color:#032F62;">Run</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">container</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">snapshots,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">snapshot</span><span style="color:#24292E;">        </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">snapshots</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">tasks,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">t,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">task</span><span style="color:#24292E;">             </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tasks</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">install</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">new</span><span style="color:#24292E;"> </span><span style="color:#032F62;">package</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">oci</span><span style="color:#24292E;">                        </span><span style="color:#032F62;">OCI</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tools</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">sandboxes,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sandbox,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sb,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">s</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sandboxes</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">info</span><span style="color:#24292E;">                       </span><span style="color:#032F62;">Print</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server</span><span style="color:#24292E;"> </span><span style="color:#032F62;">info</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">deprecations</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">shim</span><span style="color:#24292E;">                       </span><span style="color:#032F62;">Interact</span><span style="color:#24292E;"> </span><span style="color:#032F62;">with</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">shim</span><span style="color:#24292E;"> </span><span style="color:#032F62;">directly</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">help,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">h</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Shows</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">list</span><span style="color:#24292E;"> </span><span style="color:#032F62;">of</span><span style="color:#24292E;"> </span><span style="color:#032F62;">commands</span><span style="color:#24292E;"> </span><span style="color:#032F62;">or</span><span style="color:#24292E;"> </span><span style="color:#032F62;">help</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">one</span><span style="color:#24292E;"> </span><span style="color:#032F62;">command</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">GLOBAL</span><span style="color:#24292E;"> </span><span style="color:#032F62;">OPTIONS:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">--debug</span><span style="color:#24292E;">                      </span><span style="color:#032F62;">Enable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">debug</span><span style="color:#24292E;"> </span><span style="color:#032F62;">output</span><span style="color:#24292E;"> </span><span style="color:#032F62;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">--address</span><span style="color:#24292E;"> </span><span style="color:#032F62;">value,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">value</span><span style="color:#24292E;">    </span><span style="color:#032F62;">Address</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containerd&#39;s GRPC server (default: &quot;/run/containerd/containerd.sock&quot;) [$CONTAINERD_ADDRESS]</span></span>
<span class="line"><span style="color:#032F62;">   --timeout value              Total timeout for ctr commands (default: 0s)</span></span>
<span class="line"><span style="color:#032F62;">   --connect-timeout value      Timeout for connecting to containerd (default: 0s)</span></span>
<span class="line"><span style="color:#032F62;">   --namespace value, -n value  Namespace to use with commands (default: &quot;default&quot;) [$CONTAINERD_NAMESPACE]</span></span>
<span class="line"><span style="color:#032F62;">   --help, -h                   show help</span></span>
<span class="line"><span style="color:#032F62;">   --version, -v                print the version</span></span></code></pre></div><h2 id="_2-2-命名空间操作" tabindex="-1">2.2 命名空间操作 <a class="header-anchor" href="#_2-2-命名空间操作" aria-label="Permalink to &quot;2.2 命名空间操作&quot;">​</a></h2><p>namespace</p><h2 id="_2-3-镜像操作" tabindex="-1">2.3 镜像操作 <a class="header-anchor" href="#_2-3-镜像操作" aria-label="Permalink to &quot;2.3 镜像操作&quot;">​</a></h2><h3 id="下载镜像" tabindex="-1">下载镜像 <a class="header-anchor" href="#下载镜像" aria-label="Permalink to &quot;下载镜像&quot;">​</a></h3><ul><li>语法</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 containerd]# ctr images</span></span>
<span class="line"><span style="color:#B392F0;">NAME:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">-</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Manage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">USAGE:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">command</span><span style="color:#E1E4E8;"> [command </span><span style="color:#9ECBFF;">options]</span><span style="color:#E1E4E8;"> [arguments...]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">COMMANDS:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">check</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Check</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">existing</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ensure</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">all</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">content</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">available</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">locally</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#F97583;">export</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">Export</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">import</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">Import</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">list,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ls</span><span style="color:#E1E4E8;">                 </span><span style="color:#9ECBFF;">List</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">known</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">containerd</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">mount</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Mount</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">an</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">target</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">path</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">unmount</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">Unmount</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">target</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">pull</span><span style="color:#E1E4E8;">                     </span><span style="color:#9ECBFF;">Pull</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">an</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">from</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">remote</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">push</span><span style="color:#E1E4E8;">                     </span><span style="color:#9ECBFF;">Push</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">an</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">remote</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">prune</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Remove</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">unused</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">delete,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">del,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">remove,</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rm</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">Remove</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">one</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">or</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">more</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">by</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">reference</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">tag</span><span style="color:#E1E4E8;">                      </span><span style="color:#9ECBFF;">Tag</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">an</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">label</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Set</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">and</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clear</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">labels</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">an</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">convert</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">Convert</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">an</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">usage</span><span style="color:#E1E4E8;">                    </span><span style="color:#9ECBFF;">Display</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">usage</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">of</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">snapshots</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">for</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">given</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ref</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">OPTIONS:</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">--help,</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-h</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">show</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">help</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master-01 containerd]# ctr images</span></span>
<span class="line"><span style="color:#6F42C1;">NAME:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Manage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">USAGE:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">command</span><span style="color:#24292E;"> [command </span><span style="color:#032F62;">options]</span><span style="color:#24292E;"> [arguments...]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">COMMANDS:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">check</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Check</span><span style="color:#24292E;"> </span><span style="color:#032F62;">existing</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ensure</span><span style="color:#24292E;"> </span><span style="color:#032F62;">all</span><span style="color:#24292E;"> </span><span style="color:#032F62;">content</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#032F62;">available</span><span style="color:#24292E;"> </span><span style="color:#032F62;">locally</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#D73A49;">export</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">Export</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">import</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">Import</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">list,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ls</span><span style="color:#24292E;">                 </span><span style="color:#032F62;">List</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">known</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">containerd</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">mount</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Mount</span><span style="color:#24292E;"> </span><span style="color:#032F62;">an</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">target</span><span style="color:#24292E;"> </span><span style="color:#032F62;">path</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">unmount</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">Unmount</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">target</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">pull</span><span style="color:#24292E;">                     </span><span style="color:#032F62;">Pull</span><span style="color:#24292E;"> </span><span style="color:#032F62;">an</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">from</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">remote</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">push</span><span style="color:#24292E;">                     </span><span style="color:#032F62;">Push</span><span style="color:#24292E;"> </span><span style="color:#032F62;">an</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">remote</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">prune</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Remove</span><span style="color:#24292E;"> </span><span style="color:#032F62;">unused</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">delete,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">del,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">remove,</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rm</span><span style="color:#24292E;">  </span><span style="color:#032F62;">Remove</span><span style="color:#24292E;"> </span><span style="color:#032F62;">one</span><span style="color:#24292E;"> </span><span style="color:#032F62;">or</span><span style="color:#24292E;"> </span><span style="color:#032F62;">more</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">by</span><span style="color:#24292E;"> </span><span style="color:#032F62;">reference</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">tag</span><span style="color:#24292E;">                      </span><span style="color:#032F62;">Tag</span><span style="color:#24292E;"> </span><span style="color:#032F62;">an</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">label</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Set</span><span style="color:#24292E;"> </span><span style="color:#032F62;">and</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clear</span><span style="color:#24292E;"> </span><span style="color:#032F62;">labels</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">an</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">convert</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">Convert</span><span style="color:#24292E;"> </span><span style="color:#032F62;">an</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">usage</span><span style="color:#24292E;">                    </span><span style="color:#032F62;">Display</span><span style="color:#24292E;"> </span><span style="color:#032F62;">usage</span><span style="color:#24292E;"> </span><span style="color:#032F62;">of</span><span style="color:#24292E;"> </span><span style="color:#032F62;">snapshots</span><span style="color:#24292E;"> </span><span style="color:#032F62;">for</span><span style="color:#24292E;"> </span><span style="color:#032F62;">a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">given</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ref</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">OPTIONS:</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">--help,</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-h</span><span style="color:#24292E;">  </span><span style="color:#032F62;">show</span><span style="color:#24292E;"> </span><span style="color:#032F62;">help</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pull</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker.io/library/nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#或者</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 containerd]# ctr images ls -q</span></span>
<span class="line"><span style="color:#B392F0;">docker.io/library/nginx:latest</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pull</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker.io/library/nginx:latest</span></span>
<span class="line"><span style="color:#24292E;"> </span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#6A737D;">#或者</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master-01 containerd]# ctr images ls -q</span></span>
<span class="line"><span style="color:#6F42C1;">docker.io/library/nginx:latest</span></span></code></pre></div><h4 id="指定平台下载" tabindex="-1">指定平台下载 <a class="header-anchor" href="#指定平台下载" aria-label="Permalink to &quot;指定平台下载&quot;">​</a></h4><p><code>默认下载所有</code></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pull</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--all-platforms</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker.io/library/nginx:alpine</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pull</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--platform</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">linux/amd64</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker.io/library/nginx:alpine</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pull</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--all-platforms</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker.io/library/nginx:alpine</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pull</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--platform</span><span style="color:#24292E;"> </span><span style="color:#032F62;">linux/amd64</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker.io/library/nginx:alpine</span></span></code></pre></div><h3 id="查看镜像" tabindex="-1">查看镜像 <a class="header-anchor" href="#查看镜像" aria-label="Permalink to &quot;查看镜像&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr image ls</span></span>
<span class="line"><span style="color:#B392F0;">REF</span><span style="color:#E1E4E8;">                            </span><span style="color:#9ECBFF;">TYPE</span><span style="color:#E1E4E8;">                                    </span><span style="color:#9ECBFF;">DIGEST</span><span style="color:#E1E4E8;">                                                                  </span><span style="color:#9ECBFF;">SIZE</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">PLATFORMS</span><span style="color:#E1E4E8;">                                                                                    </span><span style="color:#9ECBFF;">LABELS</span></span>
<span class="line"><span style="color:#B392F0;">docker.io/library/nginx:latest</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">application/vnd.oci.image.index.v1+json</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">sha256:04ba374043ccd2fc5c593885c0eacddebabd5ca375f9323666f28dfd5a9710e3</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">67.7</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">MiB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">linux/386,linux/amd64,linux/arm/v5,linux/arm/v7,linux/arm64/v8,linux/mips64le,linux/ppc64le,linux/s390x</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">-</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr image ls</span></span>
<span class="line"><span style="color:#6F42C1;">REF</span><span style="color:#24292E;">                            </span><span style="color:#032F62;">TYPE</span><span style="color:#24292E;">                                    </span><span style="color:#032F62;">DIGEST</span><span style="color:#24292E;">                                                                  </span><span style="color:#032F62;">SIZE</span><span style="color:#24292E;">     </span><span style="color:#032F62;">PLATFORMS</span><span style="color:#24292E;">                                                                                    </span><span style="color:#032F62;">LABELS</span></span>
<span class="line"><span style="color:#6F42C1;">docker.io/library/nginx:latest</span><span style="color:#24292E;"> </span><span style="color:#032F62;">application/vnd.oci.image.index.v1+json</span><span style="color:#24292E;"> </span><span style="color:#032F62;">sha256:04ba374043ccd2fc5c593885c0eacddebabd5ca375f9323666f28dfd5a9710e3</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">67.7</span><span style="color:#24292E;"> </span><span style="color:#032F62;">MiB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">linux/386,linux/amd64,linux/arm/v5,linux/arm/v7,linux/arm64/v8,linux/mips64le,linux/ppc64le,linux/s390x</span><span style="color:#24292E;"> </span><span style="color:#032F62;">-</span></span></code></pre></div><h3 id="删除镜像" tabindex="-1">删除镜像 <a class="header-anchor" href="#删除镜像" aria-label="Permalink to &quot;删除镜像&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">del</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker.io/library/nginx:latest</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">del</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker.io/library/nginx:latest</span></span></code></pre></div><h3 id="导出镜像" tabindex="-1">导出镜像 <a class="header-anchor" href="#导出镜像" aria-label="Permalink to &quot;导出镜像&quot;">​</a></h3><ul><li>语法</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">output-filenam</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">image-nam</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">export</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">output-filenam</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">image-nam</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre></div><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">image</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">export</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx.tar.gz</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker.io/library/nginx:alpine</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;"> </span><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">image</span><span style="color:#24292E;"> </span><span style="color:#032F62;">export</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx.tar.gz</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker.io/library/nginx:alpine</span></span></code></pre></div><h3 id="导入镜像" tabindex="-1">导入镜像 <a class="header-anchor" href="#导入镜像" aria-label="Permalink to &quot;导入镜像&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">ctr images import nginx.tar.gz</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">ctr images import nginx.tar.gz</span></span></code></pre></div><h3 id="修改tag" tabindex="-1">修改tag <a class="header-anchor" href="#修改tag" aria-label="Permalink to &quot;修改tag&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"></span>
<span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tag</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker.io/library/nginx:alpine</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx:alpine</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 建议修改tag的名称为：镜像仓库地址/目录/镜像名</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"></span>
<span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tag</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker.io/library/nginx:alpine</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx:alpine</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;"># 建议修改tag的名称为：镜像仓库地址/目录/镜像名</span></span></code></pre></div><h2 id="_2-4-容器操作" tabindex="-1">2.4 容器操作 <a class="header-anchor" href="#_2-4-容器操作" aria-label="Permalink to &quot;2.4 容器操作&quot;">​</a></h2><p>单从containerd的角度来看启动一个容器的过程大致是下图所示的流程:</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202409142116114.png" alt="containerd-run-container-1.png"></p><p>containerd 创建容器流程如下：</p><ol><li>接收到 api 请求，通过调用 containerd-shim-runc-v2 调用 runc 创建容器，主要是做解压文件和准备环境的工作。</li><li>接收到 api 请求，创建一个 task，task 是一个容器的抽象，包含了容器的所有信息，比如容器的 id、容器的状态、容器的配置等等。</li><li>containerd 启动一个 containerd-shim-runc-v2 进程。</li><li>containerd-shim-runc-v2 进程 在启动一个 containerd-shim-runc-v2 进程，然后第一个 containerd-shim-runc-v2 进程退出。</li><li>containerd 通过 IPC 通信，让第二个 containerd-shim-runc-v2 启动容器。</li><li>containerd-shim-runc-v2 进程通过调用 runc start 启动容器。</li><li>runc 会调用 runc init 启动容器的 init 进程。</li><li>runc init 进程会调用 <code>unix.Exec</code> 的方式，替换自己的进程，启动容器的第一个进程。这个进程既是容器的启动命令，也是容器的 pid 1 进程。完成之后，runc create 进程退出。</li></ol><h3 id="容器启动" tabindex="-1">容器启动 <a class="header-anchor" href="#容器启动" aria-label="Permalink to &quot;容器启动&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-t</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-d</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">docker.io/library/nginx:alpine</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">run</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-t</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">docker.io/library/nginx:alpine</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span></span></code></pre></div><h3 id="容器查看" tabindex="-1">容器查看 <a class="header-anchor" href="#容器查看" aria-label="Permalink to &quot;容器查看&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr container ls</span></span>
<span class="line"><span style="color:#B392F0;">CONTAINER</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">IMAGE</span><span style="color:#E1E4E8;">                             </span><span style="color:#9ECBFF;">RUNTIME</span></span>
<span class="line"><span style="color:#B392F0;">nginx</span><span style="color:#E1E4E8;">        </span><span style="color:#9ECBFF;">docker.io/library/nginx:alpine</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">io.containerd.runc.v2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr task ls</span></span>
<span class="line"><span style="color:#B392F0;">TASK</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">PID</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">STATUS</span></span>
<span class="line"><span style="color:#B392F0;">nginx</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">2057</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RUNNING</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr container ls</span></span>
<span class="line"><span style="color:#6F42C1;">CONTAINER</span><span style="color:#24292E;">    </span><span style="color:#032F62;">IMAGE</span><span style="color:#24292E;">                             </span><span style="color:#032F62;">RUNTIME</span></span>
<span class="line"><span style="color:#6F42C1;">nginx</span><span style="color:#24292E;">        </span><span style="color:#032F62;">docker.io/library/nginx:alpine</span><span style="color:#24292E;">    </span><span style="color:#032F62;">io.containerd.runc.v2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr task ls</span></span>
<span class="line"><span style="color:#6F42C1;">TASK</span><span style="color:#24292E;">     </span><span style="color:#032F62;">PID</span><span style="color:#24292E;">     </span><span style="color:#032F62;">STATUS</span></span>
<span class="line"><span style="color:#6F42C1;">nginx</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">2057</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RUNNING</span></span></code></pre></div><div class="danger custom-block"><p class="custom-block-title">❌ 注意</p><p>在containerd中，container和task是分离的，container描述的是容器分配和附加资源的元数据对象，是静态内容，task是任务是系统上一个活动的、正在运行的进程。 task应该在每次运行后删除，而container可以被多次使用、更新和查询。这点和docker中container定义是不一样的。</p></div><h4 id="查看容器详细配置" tabindex="-1">查看容器详细配置 <a class="header-anchor" href="#查看容器详细配置" aria-label="Permalink to &quot;查看容器详细配置&quot;">​</a></h4><p><code>container</code>表示静态容器，可用<code>c</code>缩写代表container</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">c</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">info</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">container_name</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">c</span><span style="color:#24292E;"> </span><span style="color:#032F62;">info</span><span style="color:#24292E;"> </span><span style="color:#032F62;">container_name</span></span></code></pre></div><h4 id="查看容器使用的指标" tabindex="-1">查看容器使用的指标 <a class="header-anchor" href="#查看容器使用的指标" aria-label="Permalink to &quot;查看容器使用的指标&quot;">​</a></h4><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr t metrics container_name</span></span>
<span class="line"><span style="color:#B392F0;">ID</span><span style="color:#E1E4E8;">       </span><span style="color:#9ECBFF;">TIMESTAMP</span></span>
<span class="line"><span style="color:#B392F0;">nginx</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">seconds:1726319142</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">nanos:539959947</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">METRIC</span><span style="color:#E1E4E8;">                </span><span style="color:#9ECBFF;">VALUE</span></span>
<span class="line"><span style="color:#B392F0;">pids.current</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">3</span></span>
<span class="line"><span style="color:#B392F0;">pids.limit</span><span style="color:#E1E4E8;">            </span><span style="color:#79B8FF;">18446744073709551615</span></span>
<span class="line"><span style="color:#B392F0;">cpu.usage_usec</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">38526</span></span>
<span class="line"><span style="color:#B392F0;">cpu.user_usec</span><span style="color:#E1E4E8;">         </span><span style="color:#79B8FF;">2854</span></span>
<span class="line"><span style="color:#B392F0;">cpu.system_usec</span><span style="color:#E1E4E8;">       </span><span style="color:#79B8FF;">35672</span></span>
<span class="line"><span style="color:#B392F0;">cpu.nr_periods</span><span style="color:#E1E4E8;">        </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">cpu.nr_throttled</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">cpu.throttled_usec</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">memory.usage</span><span style="color:#E1E4E8;">          </span><span style="color:#79B8FF;">3690496</span></span>
<span class="line"><span style="color:#B392F0;">memory.usage_limit</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">18446744073709551615</span></span>
<span class="line"><span style="color:#B392F0;">memory.swap_usage</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">0</span></span>
<span class="line"><span style="color:#B392F0;">memory.swap_limit</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">18446744073709551615</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr t metrics container_name</span></span>
<span class="line"><span style="color:#6F42C1;">ID</span><span style="color:#24292E;">       </span><span style="color:#032F62;">TIMESTAMP</span></span>
<span class="line"><span style="color:#6F42C1;">nginx</span><span style="color:#24292E;">    </span><span style="color:#032F62;">seconds:1726319142</span><span style="color:#24292E;">  </span><span style="color:#032F62;">nanos:539959947</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">METRIC</span><span style="color:#24292E;">                </span><span style="color:#032F62;">VALUE</span></span>
<span class="line"><span style="color:#6F42C1;">pids.current</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">3</span></span>
<span class="line"><span style="color:#6F42C1;">pids.limit</span><span style="color:#24292E;">            </span><span style="color:#005CC5;">18446744073709551615</span></span>
<span class="line"><span style="color:#6F42C1;">cpu.usage_usec</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">38526</span></span>
<span class="line"><span style="color:#6F42C1;">cpu.user_usec</span><span style="color:#24292E;">         </span><span style="color:#005CC5;">2854</span></span>
<span class="line"><span style="color:#6F42C1;">cpu.system_usec</span><span style="color:#24292E;">       </span><span style="color:#005CC5;">35672</span></span>
<span class="line"><span style="color:#6F42C1;">cpu.nr_periods</span><span style="color:#24292E;">        </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">cpu.nr_throttled</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">cpu.throttled_usec</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">memory.usage</span><span style="color:#24292E;">          </span><span style="color:#005CC5;">3690496</span></span>
<span class="line"><span style="color:#6F42C1;">memory.usage_limit</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">18446744073709551615</span></span>
<span class="line"><span style="color:#6F42C1;">memory.swap_usage</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">0</span></span>
<span class="line"><span style="color:#6F42C1;">memory.swap_limit</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">18446744073709551615</span></span></code></pre></div><h3 id="进入容器" tabindex="-1">进入容器 <a class="header-anchor" href="#进入容器" aria-label="Permalink to &quot;进入容器&quot;">​</a></h3><p>ctr task exec -t --exec-id exec-id container_name</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr task exec -t --exec-id nginx-sh nginx sh</span></span>
<span class="line"><span style="color:#B392F0;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># ls</span></span>
<span class="line"><span style="color:#B392F0;">bin</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">docker-entrypoint.sh</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">lib</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">opt</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">run</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">sys</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">var</span></span>
<span class="line"><span style="color:#B392F0;">dev</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">etc</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">media</span><span style="color:#E1E4E8;">                 </span><span style="color:#9ECBFF;">proc</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">sbin</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">tmp</span></span>
<span class="line"><span style="color:#B392F0;">docker-entrypoint.d</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">home</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">mnt</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;">                  </span><span style="color:#9ECBFF;">srv</span><span style="color:#E1E4E8;">                   </span><span style="color:#9ECBFF;">usr</span></span>
<span class="line"><span style="color:#B392F0;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># ps uax|grep nginx</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">:00</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">master</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">process</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-g</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">daemon</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">off</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">30</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">:00</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">worker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">process</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">31</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span><span style="color:#E1E4E8;">     </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">:00</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx:</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">worker</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">process</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">40</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">root</span><span style="color:#E1E4E8;">      </span><span style="color:#79B8FF;">0</span><span style="color:#9ECBFF;">:00</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx</span></span>
<span class="line"><span style="color:#B392F0;">/</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># exit</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr task exec -t --exec-id nginx-sh nginx sh</span></span>
<span class="line"><span style="color:#6F42C1;">/</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># ls</span></span>
<span class="line"><span style="color:#6F42C1;">bin</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">docker-entrypoint.sh</span><span style="color:#24292E;">  </span><span style="color:#032F62;">lib</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">opt</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">run</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">sys</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">var</span></span>
<span class="line"><span style="color:#6F42C1;">dev</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">etc</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">media</span><span style="color:#24292E;">                 </span><span style="color:#032F62;">proc</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">sbin</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">tmp</span></span>
<span class="line"><span style="color:#6F42C1;">docker-entrypoint.d</span><span style="color:#24292E;">   </span><span style="color:#032F62;">home</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">mnt</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">root</span><span style="color:#24292E;">                  </span><span style="color:#032F62;">srv</span><span style="color:#24292E;">                   </span><span style="color:#032F62;">usr</span></span>
<span class="line"><span style="color:#6F42C1;">/</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># ps uax|grep nginx</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">1</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">:00</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">master</span><span style="color:#24292E;"> </span><span style="color:#032F62;">process</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-g</span><span style="color:#24292E;"> </span><span style="color:#032F62;">daemon</span><span style="color:#24292E;"> </span><span style="color:#032F62;">off</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">30</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">:00</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">worker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">process</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">31</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span><span style="color:#24292E;">     </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">:00</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx:</span><span style="color:#24292E;"> </span><span style="color:#032F62;">worker</span><span style="color:#24292E;"> </span><span style="color:#032F62;">process</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">40</span><span style="color:#24292E;"> </span><span style="color:#032F62;">root</span><span style="color:#24292E;">      </span><span style="color:#005CC5;">0</span><span style="color:#032F62;">:00</span><span style="color:#24292E;"> </span><span style="color:#032F62;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx</span></span>
<span class="line"><span style="color:#6F42C1;">/</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># exit</span></span></code></pre></div><h3 id="停止容器" tabindex="-1">停止容器 <a class="header-anchor" href="#停止容器" aria-label="Permalink to &quot;停止容器&quot;">​</a></h3><p>跟docker不同,先停止task ,再删除容器</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr task ls</span></span>
<span class="line"><span style="color:#B392F0;">TASK</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">PID</span><span style="color:#E1E4E8;">     </span><span style="color:#9ECBFF;">STATUS</span></span>
<span class="line"><span style="color:#B392F0;">nginx</span><span style="color:#E1E4E8;">    </span><span style="color:#79B8FF;">2057</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RUNNING</span></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr task kill nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr container rm nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">[root@kube-master-01 </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">]# ctr container ls</span></span>
<span class="line"><span style="color:#B392F0;">CONTAINER</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">IMAGE</span><span style="color:#E1E4E8;">    </span><span style="color:#9ECBFF;">RUNTIME</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr task ls</span></span>
<span class="line"><span style="color:#6F42C1;">TASK</span><span style="color:#24292E;">     </span><span style="color:#032F62;">PID</span><span style="color:#24292E;">     </span><span style="color:#032F62;">STATUS</span></span>
<span class="line"><span style="color:#6F42C1;">nginx</span><span style="color:#24292E;">    </span><span style="color:#005CC5;">2057</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RUNNING</span></span>
<span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr task kill nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr container rm nginx</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">[root@kube-master-01 </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">]# ctr container ls</span></span>
<span class="line"><span style="color:#6F42C1;">CONTAINER</span><span style="color:#24292E;">    </span><span style="color:#032F62;">IMAGE</span><span style="color:#24292E;">    </span><span style="color:#032F62;">RUNTIME</span></span></code></pre></div><h3 id="删除容器" tabindex="-1">删除容器 <a class="header-anchor" href="#删除容器" aria-label="Permalink to &quot;删除容器&quot;">​</a></h3><p>必须先删除task，再删除容器</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@kube-master-01 ~]# ctr task ls</span></span>
<span class="line"><span style="color:#e1e4e8;">TASK     PID     STATUS</span></span>
<span class="line"><span style="color:#e1e4e8;">nginx    2057    RUNNING</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#删除task</span></span>
<span class="line"><span style="color:#e1e4e8;">ctr tasks delete nginx2</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#删除</span></span>
<span class="line"><span style="color:#e1e4e8;">ctr container delete nginx</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@kube-master-01 ~]# ctr task ls</span></span>
<span class="line"><span style="color:#24292e;">TASK     PID     STATUS</span></span>
<span class="line"><span style="color:#24292e;">nginx    2057    RUNNING</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#删除task</span></span>
<span class="line"><span style="color:#24292e;">ctr tasks delete nginx2</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#删除</span></span>
<span class="line"><span style="color:#24292e;">ctr container delete nginx</span></span></code></pre></div><h3 id="上传容器" tabindex="-1">上传容器 <a class="header-anchor" href="#上传容器" aria-label="Permalink to &quot;上传容器&quot;">​</a></h3><p>以habor为例</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">push</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--platform</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">linux/amd64</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--plain-http</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-u</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">admin:密码</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">harbor.xx.com/library/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">注解：</span></span>
<span class="line"><span style="color:#B392F0;">因为我们harbor是http协议，不是https协议，所以需要加上</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--plain-http</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">--user</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">admin:Harbor12345</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">指定harbor的用户名与密码</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">push</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--platform</span><span style="color:#24292E;"> </span><span style="color:#032F62;">linux/amd64</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--plain-http</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-u</span><span style="color:#24292E;"> </span><span style="color:#032F62;">admin:密码</span><span style="color:#24292E;"> </span><span style="color:#032F62;">harbor.xx.com/library/nginx:latest</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">注解：</span></span>
<span class="line"><span style="color:#6F42C1;">因为我们harbor是http协议，不是https协议，所以需要加上</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--plain-http</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#6F42C1;">--user</span><span style="color:#24292E;"> </span><span style="color:#032F62;">admin:Harbor12345</span><span style="color:#24292E;"> </span><span style="color:#032F62;">指定harbor的用户名与密码</span></span></code></pre></div><ul><li>下载</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">$</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ctr</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">images</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pull</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--plain-http</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">harbor.xx.com/library/nginx:latest</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">$</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ctr</span><span style="color:#24292E;"> </span><span style="color:#032F62;">images</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pull</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--plain-http</span><span style="color:#24292E;"> </span><span style="color:#032F62;">harbor.xx.com/library/nginx:latest</span></span></code></pre></div><h2 id="官当" tabindex="-1">官当 <a class="header-anchor" href="#官当" aria-label="Permalink to &quot;官当&quot;">​</a></h2><ul><li><a href="https://containerd.io/" target="_blank" rel="noreferrer">containerd</a></li><li><a href="https://github.com/kubernetes-sigs/cri-tools/blob/master/docs/crictl.md" target="_blank" rel="noreferrer">Container Runtime Interface (CRI) CLI</a></li><li><a href="https://github.com/containerd/containerd/blob/master/docs/PLUGINS.md" target="_blank" rel="noreferrer">containerd Plugins</a></li><li><a href="https://github.com/containerd/containerd/blob/master/docs/cri/registry.md" target="_blank" rel="noreferrer">Configure Image Registry</a></li></ul>`,61),e=[o];function t(c,r,E,y,F,i){return a(),n("div",null,e)}const B=s(p,[["render",t]]);export{C as __pageData,B as default};
