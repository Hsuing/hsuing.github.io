import{_ as s,o as a,c as n,R as l}from"./chunks/framework.zUbWieqp.js";const u=JSON.parse('{"title":"1. å­˜å‚¨å·åŸºç¡€","description":"","frontmatter":{},"headers":[],"relativePath":"guide/container/k8s/å­˜å‚¨/Volume/1-volume.md","filePath":"guide/container/k8s/å­˜å‚¨/Volume/1-volume.md","lastUpdated":1733304370000}'),p={name:"guide/container/k8s/å­˜å‚¨/Volume/1-volume.md"},o=l(`<h1 id="_1-å­˜å‚¨å·åŸºç¡€" tabindex="-1">1. å­˜å‚¨å·åŸºç¡€ <a class="header-anchor" href="#_1-å­˜å‚¨å·åŸºç¡€" aria-label="Permalink to &quot;1. å­˜å‚¨å·åŸºç¡€&quot;">â€‹</a></h1><h2 id="_1-1-ä¸ºä½•éœ€è¦volumes" tabindex="-1">1.1 ä¸ºä½•éœ€è¦Volumes <a class="header-anchor" href="#_1-1-ä¸ºä½•éœ€è¦volumes" aria-label="Permalink to &quot;1.1 ä¸ºä½•éœ€è¦Volumes&quot;">â€‹</a></h2><p><code>Container</code>ä¸­çš„â½‚ä»¶åœ¨ç£ç›˜ä¸Šæ˜¯ä¸´æ—¶å­˜æ”¾çš„ï¼Œè¿™ç»™<code>Container</code>ä¸­è¿â¾çš„è¾ƒé‡è¦çš„åº”â½¤ç¨‹åºå¸¦æ¥â¼€äº›é—®é¢˜ã€‚</p><p>1ã€å½“å®¹å™¨å´©æºƒæ—¶ï¼Œ<code>kubelet</code>å°†é‡æ–°å¯åŠ¨â¼€ä¸ª&quot;å…¨æ–°çš„å®¹å™¨&quot;ï¼Œâ½½å®¹å™¨ä¸­çš„æ­¤å‰ä¿å­˜çš„æ•°æ®åˆ™ä¼šä¸¢å¤±ã€‚</p><p>2ã€å½“åŒâ¼€Podè¿â¾å¤šä¸ªå®¹å™¨æ—¶ï¼Œé€šå¸¸éœ€è¦åœ¨è¿™äº›å®¹å™¨ä¹‹é—´å…±äº«â½‚ä»¶ã€‚</p><p><code>Volume</code> æ˜¯ Kubernetes æŠ½è±¡å‡ºæ¥çš„å¯¹è±¡ï¼Œä¸»è¦â½¤äºè§£å†³Podè¿â¾æ—¶â½‚ä»¶å­˜æ”¾çš„é—®é¢˜ï¼Œä»¥åŠpodä¸­å¤šå®¹å™¨æ•°æ®å…±äº«é—®é¢˜ã€‚</p><h2 id="_1-2-ä»€ä¹ˆæ˜¯volume" tabindex="-1">1.2 ä»€ä¹ˆæ˜¯Volume <a class="header-anchor" href="#_1-2-ä»€ä¹ˆæ˜¯volume" aria-label="Permalink to &quot;1.2 ä»€ä¹ˆæ˜¯Volume&quot;">â€‹</a></h2><p>Volumeçš„æ ¸å¿ƒæ˜¯ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­å¯èƒ½å­˜æœ‰æ•°æ®ï¼ŒPodä¸­çš„å®¹å™¨å¯ä»¥è®¿é—®è¯¥ç›®å½•ä¸­çš„æ•°æ®ã€‚ä½¿ç”¨ä¸åŒçš„Volumeç±»å‹å°†å†³å®šè¯¥ç›®å½•å¦‚ä½•å½¢æˆï¼Œä»¥åŠä½¿ç”¨ä½•ç§ä»‹è´¨ï¼ˆDiskã€Memoryï¼‰æ¥å­˜å‚¨æ•°æ®ã€‚å½“ç„¶ä¸åŒçš„å·ç±»å‹æœ‰ç€ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸ;</p><p><code>ä¸´æ—¶å·</code>ï¼šä¸´æ—¶å·ç±»å‹çš„ç”Ÿå‘½å‘¨æœŸä¸Pod ç›¸åŒï¼Œå½“Pod ä¸å†å­˜åœ¨æ—¶ï¼ŒKubernetes ä¼šé”€æ¯ä¸´æ—¶å·ï¼› (ä¸€èˆ¬ç”¨ä½œç¼“å­˜åœºæ™¯)</p><p><code>æŒä¹…å·</code>ï¼šæŒä¹…å·å¯ä»¥æ¯” Pod çš„å­˜æ´»æœŸé•¿ï¼Œå› ä¸ºKubernetesä¸ä¼šé”€æ¯æŒä¹…å·ã€‚</p><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>ä»»ä½•ç±»å‹çš„å·ï¼Œåœ¨å®¹å™¨é‡å¯æœŸé—´æ•°æ®éƒ½ä¸ä¼šä¸¢å¤±</p></div><h2 id="_1-3-volumeçš„åŠŸèƒ½" tabindex="-1">1.3 Volumeçš„åŠŸèƒ½ <a class="header-anchor" href="#_1-3-volumeçš„åŠŸèƒ½" aria-label="Permalink to &quot;1.3 Volumeçš„åŠŸèƒ½&quot;">â€‹</a></h2><p>1.Volumeæ˜¯Podä¸­èƒ½å¤Ÿè¢«å¤šä¸ªå®¹å™¨è®¿é—®çš„å…±äº«ç›®å½•ï¼Œå¯ä»¥è®©å®¹å™¨çš„æ•°æ®å†™åˆ°å®¿ä¸»æœºä¸Šæˆ–è€…å†™æ–‡ä»¶åˆ°ç½‘ç»œå­˜å‚¨ä¸­</p><p>2.å¯ä»¥å®ç°å®¹å™¨é…ç½®æ–‡ä»¶é›†ä¸­åŒ–å®šä¹‰ä¸ç®¡ç†ï¼Œé€šè¿‡ConfigMapèµ„æºå¯¹è±¡æ¥å®ç°.</p><h2 id="_1-4-volumeçš„ç‰¹ç‚¹" tabindex="-1">1.4 Volumeçš„ç‰¹ç‚¹ <a class="header-anchor" href="#_1-4-volumeçš„ç‰¹ç‚¹" aria-label="Permalink to &quot;1.4 Volumeçš„ç‰¹ç‚¹&quot;">â€‹</a></h2><p>k8sä¸­çš„Volumeä¸Dockerçš„Volumeç›¸ä¼¼ï¼Œä½†ä¸å®Œå…¨ç›¸åŒã€‚</p><ol><li>k8sä¸ŠVolumeå®šä¹‰åœ¨Podä¸Šï¼Œç„¶åè¢«ä¸€ä¸ªPodä¸­çš„å¤šä¸ªå®¹å™¨æŒ‚è½½åˆ°å…·ä½“çš„æ–‡ä»¶ç›®å½•ä¸‹ã€‚</li><li>k8sçš„Volumeä¸Podç”Ÿå‘½å‘¨æœŸç›¸å…³è€Œä¸æ˜¯å®¹å™¨æ˜¯ç”Ÿå‘½å‘¨æœŸï¼Œå³å®¹å™¨æŒ‚æ‰ï¼Œæ•°æ®ä¸ä¼šä¸¢å¤±ä½†æ˜¯PodæŒ‚æ‰ï¼Œæ•°æ®åˆ™ä¼šä¸¢å¤±ã€‚</li><li>k8sä¸­çš„Volumeæ”¯æŒå¤šç§ç±»å‹çš„Volumeï¼šCephã€GlusterFSç­‰åˆ†å¸ƒå¼ç³»ç»Ÿ</li></ol><h2 id="_1-5-podé…ç½®volume" tabindex="-1">1.5 Podé…ç½®Volume <a class="header-anchor" href="#_1-5-podé…ç½®volume" aria-label="Permalink to &quot;1.5 Podé…ç½®Volume&quot;">â€‹</a></h2><p>Podä½¿â½¤å·æ–¹å¼ï¼š</p><p>1ã€ç¬¬â¼€æ­¥ï¼šåœ¨<code>pod.spec.volumes</code> å­—æ®µä¸­ç”³æ˜ï¼Œç”³æ˜è¯¥å·æä¾›çš„å·ç±»å‹ä»¥åŠå·åå­—</p><p>2ã€ç¬¬äºŒæ­¥ï¼šåœ¨<code>.spec.containers[*].voLumeMounts</code>å­—æ®µä¸­å£°æ˜ï¼Œå°†å·æŒ‚è½½åˆ°å®¹å™¨çš„å“ªä¸ªä½ç½®ã€‚</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202405311025604.png" alt="image-20240531102533666"></p><h1 id="_2-volumeç±»å‹" tabindex="-1">2. Volumeç±»å‹ <a class="header-anchor" href="#_2-volumeç±»å‹" aria-label="Permalink to &quot;2. Volumeç±»å‹&quot;">â€‹</a></h1><p>å…ˆåœ¨Podä¸Šå£°æ˜ä¸€ä¸ªVolumeï¼Œç„¶åå®¹å™¨å¼•ç”¨è¯¥Volumeå¹¶Mountåˆ°å®¹å™¨çš„æŸä¸ªç›®å½•</p><h2 id="_2-1-ä¸´æ—¶å­˜å‚¨" tabindex="-1">2.1 ä¸´æ—¶å­˜å‚¨ <a class="header-anchor" href="#_2-1-ä¸´æ—¶å­˜å‚¨" aria-label="Permalink to &quot;2.1 ä¸´æ—¶å­˜å‚¨&quot;">â€‹</a></h2><p>å®˜æ–¹æ–‡æ¡£,<a href="https://kubernetes.io/docs/concepts/storage/volumes/#emptydir" target="_blank" rel="noreferrer">https://kubernetes.io/docs/concepts/storage/volumes/#emptydir</a></p><h3 id="emptydirå®šä¹‰" tabindex="-1">emptyDirå®šä¹‰ <a class="header-anchor" href="#emptydirå®šä¹‰" aria-label="Permalink to &quot;emptyDirå®šä¹‰&quot;">â€‹</a></h3><p>emptyDiræ˜¯ä¸€ä¸ªä¸´æ—¶å­˜å‚¨å·ï¼Œä¸Podçš„ç”Ÿå‘½å‘¨æœŸç»‘å®šåˆ°ä¸€èµ·ï¼Œå¦‚æœPodè¢«åˆ é™¤äº†ï¼Œè¿™æ„å‘³ç€æ•°æ®ä¹Ÿè¢«éšä¹‹åˆ é™¤.</p><p>emptyDirä¸»è¦æœ‰å¦‚ä¸‹ä¸¤ä¸ªå­—æ®µ</p><ul><li>mediumï¼šå­˜å‚¨ä»‹è´¨çš„ç±»å‹ï¼Œæœ‰defautã€Memory, <ul><li>defaultï¼šè¡¨ç¤ºä½¿ç”¨èŠ‚ç‚¹çš„ç£ç›˜å­˜å‚¨ä»‹è´¨ã€‚ (é»˜è®¤)</li><li>Memoryï¼šè¡¨ç¤ºä½¿ç”¨åŸºäºå†…å­˜ä¸´æ—¶æ–‡ä»¶ç³»ç»Ÿï¼Œæ€§èƒ½é«˜ã€ä½†æ•´ä½“å¯ç”¨ç©ºé—´å—é™äºå†…å­˜ï¼Œä¸€èˆ¬ç”¨äºç¼“å­˜åœºæ™¯ã€‚</li></ul></li><li>sizeLimitï¼šå­˜å‚¨å·çš„ç©ºé—´é™é¢ï¼Œé»˜è®¤nilè¡¨ç¤ºä¸é™åˆ¶ï¼Œå¦‚æœmediumä¸ºMemoryæ—¶ï¼Œå»ºè®®é…ç½®æ­¤å€¼ã€‚</li></ul><h4 id="emptydirä½œç”¨" tabindex="-1">emptyDirä½œç”¨ <a class="header-anchor" href="#emptydirä½œç”¨" aria-label="Permalink to &quot;emptyDirä½œç”¨&quot;">â€‹</a></h4><p>(1)å¯ä»¥å®ç°æŒä¹…åŒ–;</p><p>(2)åŒä¸€ä¸ªPodçš„å¤šä¸ªå®¹å™¨å¯ä»¥å®ç°æ•°æ®å…±äº«ï¼Œå¤šä¸ªä¸åŒçš„Podä¹‹é—´ä¸èƒ½è¿›è¡Œæ•°æ®é€šä¿¡;</p><p>(3)éšç€Podçš„ç”Ÿå‘½å‘¨æœŸè€Œå­˜åœ¨ï¼Œå½“æˆ‘ä»¬åˆ é™¤Podæ—¶ï¼Œå…¶æ•°æ®ä¹Ÿä¼šè¢«éšä¹‹åˆ é™¤;</p><h4 id="emptydirä¼˜ç¼ºç‚¹" tabindex="-1">emptyDirä¼˜ç¼ºç‚¹ <a class="header-anchor" href="#emptydirä¼˜ç¼ºç‚¹" aria-label="Permalink to &quot;emptyDirä¼˜ç¼ºç‚¹&quot;">â€‹</a></h4><p>ä¼˜ç‚¹ï¼š</p><p>(1)å¯ä»¥å®ç°åŒä¸€ä¸ªPodå†…å¤šä¸ªå®¹å™¨ä¹‹é—´æ•°æ®å…±äº«;</p><p>(2)å½“Podå†…çš„æŸä¸ªå®¹å™¨è¢«å¼ºåˆ¶åˆ é™¤æ—¶ï¼Œæ•°æ®å¹¶ä¸ä¼šä¸¢å¤±ï¼Œå› ä¸ºPodæ²¡æœ‰åˆ é™¤;</p><p>ç¼ºç‚¹:</p><p>(1)å½“Podè¢«åˆ é™¤æ—¶ï¼Œæ•°æ®ä¹Ÿä¼šè¢«éšä¹‹åˆ é™¤;</p><p>(2)ä¸åŒçš„Podä¹‹é—´æ— æ³•å®ç°æ•°æ®å…±äº«;</p><div class="danger custom-block"><p class="custom-block-title">âŒ æ³¨æ„</p><p>å¯åŠ¨podsåï¼Œä½¿ç”¨emptyDirå…¶æ•°æ®å­˜å‚¨åœ¨&quot;/var/lib/kubelet/pods&quot;è·¯å¾„ä¸‹å¯¹åº”çš„POD_IDç›®å½•</p><p>å¦‚,/var/lib/kubelet/pods/\${POD_ID}/volumes/kubernetes.io~empty-dir/</p></div><h3 id="emptydiråœºæ™¯1" tabindex="-1">emptyDiråœºæ™¯1 <a class="header-anchor" href="#emptydiråœºæ™¯1" aria-label="Permalink to &quot;emptyDiråœºæ™¯1&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master volumes</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 1.nginx-emptydir.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume-pod</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">emptyDir</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">medium</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Memory</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">sizeLimit</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">&quot;1Gi&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">volume-container</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/usr/share/nginx/html</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">initContainers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">init-container</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">busybox</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">command</span><span style="color:#E1E4E8;">: [</span><span style="color:#9ECBFF;">&quot;sh&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;-c&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;echo &#39;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Welcome to my website&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#39; &gt; /data/index.html&quot;</span><span style="color:#E1E4E8;">]</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">my-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/data</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master volumes</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 1.nginx-emptydir.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume-pod</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-volume</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">emptyDir</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">medium</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Memory</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">sizeLimit</span><span style="color:#24292E;">: </span><span style="color:#032F62;">&quot;1Gi&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">volume-container</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-volume</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/usr/share/nginx/html</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">initContainers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">init-container</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">busybox</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">command</span><span style="color:#24292E;">: [</span><span style="color:#032F62;">&quot;sh&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;-c&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;echo &#39;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Welcome to my website&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;&#39; &gt; /data/index.html&quot;</span><span style="color:#24292E;">]</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">my-volume</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/data</span></span></code></pre></div><h3 id="emptydiråœºæ™¯2" tabindex="-1">emptyDiråœºæ™¯2 <a class="header-anchor" href="#emptydiråœºæ™¯2" aria-label="Permalink to &quot;emptyDiråœºæ™¯2&quot;">â€‹</a></h3><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">test-pd</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">k8s.gcr.io/test-webserver</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">test-container</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/cache</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">cache-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">cache-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">emptyDir</span><span style="color:#E1E4E8;">: {}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">test-pd</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">k8s.gcr.io/test-webserver</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">test-container</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/cache</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">cache-volume</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">cache-volume</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">emptyDir</span><span style="color:#24292E;">: {}</span></span></code></pre></div><h2 id="_2-2-æœ¬åœ°å­˜å‚¨" tabindex="-1">2.2 æœ¬åœ°å­˜å‚¨ <a class="header-anchor" href="#_2-2-æœ¬åœ°å­˜å‚¨" aria-label="Permalink to &quot;2.2 æœ¬åœ°å­˜å‚¨&quot;">â€‹</a></h2><p>å®˜æ–¹æ–‡æ¡£,<a href="https://kubernetes.io/docs/concepts/storage/volumes/#hostpath" target="_blank" rel="noreferrer">https://kubernetes.io/docs/concepts/storage/volumes/#hostpath</a></p><h3 id="hostpath" tabindex="-1">hostPath <a class="header-anchor" href="#hostpath" aria-label="Permalink to &quot;hostPath&quot;">â€‹</a></h3><p>ä¼šå°†Podéƒ¨ç½²æ‰€åœ¨<code>å®¿ä¸»æœº</code>çš„ç›®å½•æˆ–æ–‡ä»¶æŒ‚è½½åˆ°Podä¸­å»</p><p><strong>ä½œç”¨</strong>ï¼š</p><ol><li>å®¹å™¨åº”ç”¨æ—¥å¿—éœ€è¦æŒä¹…åŒ–æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å®¿ä¸»æœºçš„é«˜é€Ÿæ–‡ä»¶ç³»ç»Ÿè¿›è¡Œå­˜å‚¨</li><li>éœ€è¦è®¿é—®å®¿ä¸»æœºä¸ŠDockerå¼•æ“å†…éƒ¨æ•°æ®ç»“æ„çš„å®¹å™¨åº”ç”¨æ—¶ï¼Œå¯ä»¥é€šè¿‡å®šä¹‰hostPathä¸ºå®¿ä¸»æœº/var/lib/dockerç›®å½•ï¼Œä½¿å®¹å™¨å†…éƒ¨åº”ç”¨å¯ä»¥ç›´æ¥è®¿é—®Dockerçš„æ–‡ä»¶ç³»ç»Ÿ</li><li>æŒ‚è½½æ—¶åŒº</li></ol><blockquote><p>1.åœ¨ä¸åŒçš„Nodeä¸Šå…·æœ‰ç›¸åŒé…ç½®çš„Podå¯èƒ½ä¼šå› ä¸ºå®¿ä¸»æœºä¸Šçš„ç›®å½•æˆ–æ–‡ä»¶ä¸åŒå¯¼è‡´å¯¹Volumeä¸Šç›®å½•æˆ–æ–‡ä»¶çš„è®¿é—®ç»“æœä¸ä¸€è‡´ã€‚</p><p>2.å¦‚æœä½¿ç”¨äº†èµ„æºé…é¢ç®¡ç†ï¼Œåˆ™kubernetesæ— æ³•å°†hostPathåœ¨å®¿ä¸»æœºä¸Šä½¿ç”¨çš„èµ„æºçº³å…¥ç®¡ç†</p></blockquote><p>type<a href="https://kubernetes.io/zh-cn/docs/concepts/storage/volumes/#emptydir" target="_blank" rel="noreferrer">ç±»å‹</a>ï¼š</p><table><thead><tr><th>typeç±»å‹</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>DirectoryOrCreate</td><td>å·æ˜ å°„å¯¹è±¡æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå¦‚æœä¸å­˜åœ¨å°±åˆ›å»ºå®ƒ</td></tr><tr><td>Directory</td><td>å·æ˜ å°„å¯¹è±¡æ˜¯ä¸€ä¸ªç›®å½•ï¼Œä¸”å¿…é¡»å­˜åœ¨</td></tr><tr><td>FileOrCreate</td><td>å·æ˜ å°„å¯¹è±¡æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œå¦‚æœä¸å­˜åœ¨åˆ›å»ºå®ƒ</td></tr><tr><td>File</td><td>å·æ˜ å°„å¯¹è±¡æ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œä¸”å¿…é¡»å­˜åœ¨</td></tr><tr><td>Socket</td><td>å·æ˜ å°„å¯¹è±¡æ˜¯ä¸€ä¸ªSocketå¥—æ¥å­—ï¼Œä¸”å¿…é¡»å­˜åœ¨</td></tr><tr><td>CharDevice</td><td>å·æ˜ å°„å¯¹è±¡æ˜¯ä¸€ä¸ªå­—ç¬¦è®¾å¤‡ï¼Œä¸”å¿…é¡»å­˜åœ¨ï¼ˆä»… Linux èŠ‚ç‚¹ï¼‰</td></tr><tr><td>BlockDevice</td><td>å·æ˜ å°„å¯¹è±¡æ˜¯ä¸€ä¸ªå—è®¾å¤‡ï¼Œä¸”å¿…é¡»å­˜åœ¨ï¼ˆä»… Linux èŠ‚ç‚¹ï¼‰</td></tr></tbody></table><p>æ¡ˆä¾‹</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[</span><span style="color:#9ECBFF;">root@kube-master volumes</span><span style="color:#E1E4E8;">]# </span><span style="color:#9ECBFF;">cat 2.hostpath.yaml</span></span>
<span class="line"><span style="color:#85E89D;">apiVersion</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">v1</span></span>
<span class="line"><span style="color:#85E89D;">kind</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Pod</span></span>
<span class="line"><span style="color:#85E89D;">metadata</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">pod-hostpath</span></span>
<span class="line"><span style="color:#85E89D;">spec</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">volumes</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">hostpath-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">hostPath</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">path</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/data/hostpathdir/</span><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;"># å®¿ä¸»ä¸Šâ½¬å½•ä½ç½®</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">type</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">Directory</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#85E89D;">containers</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">  - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">container-hostpath</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">image</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">nginx:latest</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#85E89D;">volumeMounts</span><span style="color:#E1E4E8;">:</span></span>
<span class="line"><span style="color:#E1E4E8;">    - </span><span style="color:#85E89D;">name</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">hostpath-volume</span></span>
<span class="line"><span style="color:#E1E4E8;">      </span><span style="color:#85E89D;">mountPath</span><span style="color:#E1E4E8;">: </span><span style="color:#9ECBFF;">/usr/share/nginx/html/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[</span><span style="color:#032F62;">root@kube-master volumes</span><span style="color:#24292E;">]# </span><span style="color:#032F62;">cat 2.hostpath.yaml</span></span>
<span class="line"><span style="color:#22863A;">apiVersion</span><span style="color:#24292E;">: </span><span style="color:#032F62;">v1</span></span>
<span class="line"><span style="color:#22863A;">kind</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Pod</span></span>
<span class="line"><span style="color:#22863A;">metadata</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">pod-hostpath</span></span>
<span class="line"><span style="color:#22863A;">spec</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">volumes</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">hostpath-volume</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">hostPath</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">path</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/data/hostpathdir/</span><span style="color:#24292E;">    </span><span style="color:#6A737D;"># å®¿ä¸»ä¸Šâ½¬å½•ä½ç½®</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">type</span><span style="color:#24292E;">: </span><span style="color:#032F62;">Directory</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#22863A;">containers</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">  - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">container-hostpath</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">image</span><span style="color:#24292E;">: </span><span style="color:#032F62;">nginx:latest</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#22863A;">volumeMounts</span><span style="color:#24292E;">:</span></span>
<span class="line"><span style="color:#24292E;">    - </span><span style="color:#22863A;">name</span><span style="color:#24292E;">: </span><span style="color:#032F62;">hostpath-volume</span></span>
<span class="line"><span style="color:#24292E;">      </span><span style="color:#22863A;">mountPath</span><span style="color:#24292E;">: </span><span style="color:#032F62;">/usr/share/nginx/html/</span></span></code></pre></div>`,57),e=[o];function t(c,r,E,y,i,m){return a(),n("div",null,e)}const h=s(p,[["render",t]]);export{u as __pageData,h as default};
