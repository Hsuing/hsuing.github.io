import{_ as s,o as a,c as n,R as p}from"./chunks/framework.zUbWieqp.js";const g=JSON.parse('{"title":"pgæ•°æ®åº“dataç›®å½•","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Database/pgSql/base/3-dir.md","filePath":"guide/Database/pgSql/base/3-dir.md","lastUpdated":1711952995000}'),l={name:"guide/Database/pgSql/base/3-dir.md"},e=p(`<h1 id="pgæ•°æ®åº“dataç›®å½•" tabindex="-1">pgæ•°æ®åº“dataç›®å½• <a class="header-anchor" href="#pgæ•°æ®åº“dataç›®å½•" aria-label="Permalink to &quot;pgæ•°æ®åº“dataç›®å½•&quot;">â€‹</a></h1><p>pgæ•°æ®åº“å’Œmysqlæ•°æ®åº“çš„å®‰è£…ç›®å½•ç»“æ„å¾ˆç±»ä¼¼ï¼Œç¨‹åºå’Œæ•°æ®æ˜¯åˆ†å¼€çš„ï¼Œåœ¨å¯åŠ¨æ—¶å€™å¯ä»¥è‡ªè¡ŒæŒ‡å®šä¸åŒçš„æ•°æ®ç›®å½•æ¥åšåˆ°å¯åŠ¨ä¸åŒçš„æ•°æ®åº“</p><p>é‡Špgæ•°æ®ç›®å½•ä¸‹ï¼Œæ¯ä¸ªæ–‡ä»¶å¤¹ä»¥åŠæ–‡ä»¶åçš„ä½œç”¨</p><table><thead><tr><th>ç›®å½•å</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>base</td><td>è¯¥ç›®å½•åŒ…å«äº†æ•°æ®åº“ä¸­å„ä¸ªæ•°æ®åº“ï¼Œæ¯ä¸ªæ•°æ®åº“éƒ½æ˜¯ç”±ä¸€ä¸ªæ–‡ä»¶å¤¹ç»„æˆï¼Œæ–‡ä»¶åæ˜¯è¯¥æ•°æ®åº“çš„oidï¼Œè¿™ä¸ªå¯ä»¥é€šè¿‡æ•°æ®å­—å…¸pg_databaseæ¥æŸ¥çœ‹å¯¹åº”çš„æ•°æ®åº“å(select oid,datname from pg_database)ã€‚</td></tr><tr><td>pg_xlog/pg_wal</td><td>è¯¥ç›®å½•åŒ…å«wal(é¢„å†™)æ—¥å¿—ã€‚æ³¨æ„åœ¨10ç‰ˆæœ¬åï¼Œè¯¥ç›®å½•é‡å‘½åä¸º&quot;pg_wal&quot;ã€‚</td></tr><tr><td>global</td><td>è¯¥ç›®å½•åŒ…å«é›†ç¾¤èŒƒå›´çš„å„ä¸ªè¡¨å’Œç›¸å…³è§†å›¾ã€‚ ï¼ˆ pg_databaseã€ pg_tablespace ï¼‰</td></tr><tr><td>pg_clog</td><td>è¯¥ç›®å½•åŒ…å«äº‹åŠ¡æäº¤çŠ¶æ€æ•°æ®ã€‚</td></tr><tr><td>pg_multixact</td><td>è¯¥ç›®å½•åŒ…å«å¤šäº‹åŠ¡çŠ¶æ€æ•°æ®ï¼ˆç­‰å¾…é”å®šçš„å¹¶å‘äº‹åŠ¡ï¼‰</td></tr><tr><td>pg_notify</td><td>è¯¥ç›®å½•åŒ…å«LISTEN/NOTIFYçŠ¶æ€æ•°æ®ã€‚å­˜å‚¨é€šçŸ¥ä¿¡æ¯ï¼Œç”¨äºåœ¨äº‹åŠ¡æäº¤æ—¶å‘é€é€šçŸ¥</td></tr><tr><td>pg_serial</td><td>è¯¥ç›®å½•åŒ…å«äº†å·²ç»æäº¤çš„åºåˆ—åŒ–äº‹åŠ¡çš„æœ‰å…³ä¿¡æ¯ã€‚</td></tr><tr><td>pg_snapshots</td><td>è¯¥ç›®å½•åŒ…å«å¯¼å‡ºçš„å¿«ç…§,å­˜å‚¨å¿«ç…§æ–‡ä»¶ï¼Œç”¨äºé€»è¾‘å¤åˆ¶çš„åˆå§‹åŒæ­¥</td></tr><tr><td>pg_stat_tmp</td><td>è¯¥ç›®å½•åŒ…å«ç»Ÿè®¡å­ç³»ç»Ÿçš„ä¸´æ—¶æ–‡ä»¶ã€‚</td></tr><tr><td>pg_subtrans</td><td>è¯¥ç›®å½•åŒ…å«å­äº‹åŠ¡çŠ¶æ€æ•°æ®ã€‚</td></tr><tr><td>pg_tblspc</td><td>è¯¥ç›®å½•åŒ…å«è¡¨ç©ºé—´çš„ç¬¦å·é“¾æ¥ã€‚</td></tr><tr><td>pg_twophase</td><td>è¯¥ç›®å½•åŒ…å«é¢„å¤‡äº‹åŠ¡çš„çŠ¶æ€æ–‡ä»¶ã€‚</td></tr><tr><td>pg_commit_ts</td><td>è¯¥ç›®å½•åŒ…å«å·²æäº¤äº‹åŠ¡çš„æ—¶é—´ã€‚</td></tr><tr><td>pg_dynshmem</td><td>è¯¥ç›®å½•åŠ¨æ€å…±äº«å†…å­˜ç›®å½•ï¼Œç”¨äºå­˜å‚¨åŠ¨æ€åˆ†é…çš„å…±äº«å†…å­˜å—</td></tr><tr><td>pg_logical</td><td>è¯¥ç›®å½•åŒ…å«é€»è¾‘è§£ç çš„çŠ¶æ€æ•°æ®ã€‚</td></tr><tr><td>pg_replslot</td><td>è¯¥ç›®å½•åŒ…å«å¤åˆ¶æ§½æ•°æ®ï¼Œç”¨äºç‰©ç†å¤åˆ¶å’Œé€»è¾‘å¤åˆ¶</td></tr><tr><td>pg_stat</td><td>è¯¥ç›®å½•åŒ…å«ç»Ÿè®¡å­ç³»ç»Ÿçš„æ°¸ä¹…æ–‡ä»¶,å­˜å‚¨ç»Ÿè®¡ä¿¡æ¯ï¼Œç”¨äºæ•°æ®åº“çš„æ€§èƒ½ç›‘æ§</td></tr></tbody></table><hr><table><thead><tr><th>æ–‡ä»¶å</th><th>ä½œç”¨</th></tr></thead><tbody><tr><td>pg_hba.conf</td><td>æ•°æ®åº“è®¿é—®æ§åˆ¶æ–‡ä»¶ï¼Œä¸€èˆ¬æ–°å®‰è£…çš„æ•°æ®åº“éƒ½éœ€è¦è¿›è¡Œé…ç½®ï¼Œåœ¨æµå¤åˆ¶ä¸­ä¹Ÿéœ€è¦é…ç½®ã€‚</td></tr><tr><td>pg_ident.conf</td><td>å°†æ•°æ®åº“ç”¨æˆ·æ˜ å°„åˆ°æœ¬åœ°ç”¨æˆ·çš„ä¸€ç§è®¤è¯æ–¹å¼ï¼Œä½¿ç”¨æ¯”è¾ƒå°‘ï¼Œåœ¨ç‰¹æ®Šåœºæ™¯ä¸‹éœ€è¦é…ç½®ï¼ˆæ§åˆ¶å“ªä¸€ä¸ªæœ¬åœ°ç”¨æˆ·å¯ä»¥è¿æ¥åˆ°å“ªä¸€ä¸ªæ•°æ®åº“ï¼‰ã€‚</td></tr><tr><td>postgresql.conf/postgresql.auto.conf</td><td>ä¸»è¦é…ç½®æ–‡ä»¶ï¼Œåœ¨æ•°æ®åº“å®‰è£…å®Œåï¼Œéœ€è¦æ‰‹åŠ¨æ›´æ”¹é‡Œé¢çš„ç›‘å¬åœ°å€ï¼Œå¦åˆ™é»˜è®¤åªèƒ½æœ¬åœ°è¿æ¥ã€‚</td></tr><tr><td>PG_VERSION</td><td>åŒ…å«ç‰ˆæœ¬ä¿¡æ¯ã€‚</td></tr><tr><td>postmaster.pid</td><td>å¯åŠ¨åpgä¸»è¿›ç¨‹ID</td></tr></tbody></table><h2 id="_1-global" tabindex="-1">1.global <a class="header-anchor" href="#_1-global" aria-label="Permalink to &quot;1.global&quot;">â€‹</a></h2><p>globalï¼Œå­˜æ”¾çš„æ–‡ä»¶ç”¨äºå­˜å‚¨å…¨å±€çš„ç³»ç»Ÿè¡¨ä¿¡æ¯å’Œå…¨å±€æ§åˆ¶ä¿¡æ¯ã€‚</p><p>globalä¸‹æœ‰å››ç§æ–‡ä»¶ï¼š</p><ol><li>pg_control ç”¨äºå­˜å‚¨å…¨å±€æ§åˆ¶ä¿¡æ¯</li><li>pg_filenode.map ç”¨äºå°†å½“å‰ç›®å½•ä¸‹ç³»ç»Ÿè¡¨çš„OIDä¸å…·ä½“æ–‡ä»¶åè¿›è¡Œç¡¬ç¼–ç æ˜ å°„ï¼ˆæ¯ä¸ªç”¨æˆ·åˆ›å»ºçš„æ•°æ®åº“ç›®å½•ä¸‹ä¹Ÿæœ‰åŒåæ–‡ä»¶ï¼‰ã€‚</li><li>pg_internal.init ç”¨äºç¼“å­˜ç³»ç»Ÿè¡¨ï¼ŒåŠ å¿«ç³»ç»Ÿè¡¨è¯»å–é€Ÿåº¦ï¼ˆæ¯ä¸ªç”¨æˆ·åˆ›å»ºçš„æ•°æ®åº“ç›®å½•ä¸‹ä¹Ÿæœ‰åŒåæ–‡ä»¶ï¼‰ã€‚</li><li>å…¨å±€ç³»ç»Ÿè¡¨æ–‡ä»¶ æ•°å­—å‘½åçš„æ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨ç³»ç»Ÿè¡¨çš„å†…å®¹ã€‚å®ƒä»¬åœ¨pg_classé‡Œçš„relfilenodeéƒ½ä¸º0ï¼Œæ˜¯é pg_filenode.mapå°†OIDä¸æ–‡ä»¶ç¡¬ç¼–ç æ˜ å°„ã€‚ï¼ˆæ³¨ï¼šä¸æ˜¯æ‰€æœ‰çš„ç³»ç»Ÿè¡¨çš„relfilenodeéƒ½ä¸º0ï¼‰</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">data</span></span>
<span class="line"><span style="color:#e1e4e8;">â”œâ”€â”€ global                # under global, all the filenode is hard-code(select oid,relname,relfilenode from pg_class where relfilenode=0 order by oid;)</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1136              # pg_pltemplate</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1137              # pg_pltemplate_name_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1213              # pg_tablespace</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1214              # pg_shdepend</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1232              # pg_shdepend_depender_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1233              # pg_shdepend_reference_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1260              # pg_authid</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1261              # pg_auth_members</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1262              # pg_database</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2396              # pg_shdescription</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2397              # pg_shdescription_o_c_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2671              # pg_database_datname_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2672              # pg_database_oid_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2676              # pg_authid_rolname_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2677              # pg_authid_oid_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2694              # pg_auth_members_role_member_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2695              # pg_auth_members_member_role_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2697              # pg_tablespace_oid_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2698              # pg_tablespace_spcname_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2846              # pg_toast_2396</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2847              # pg_toast_2396_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2964              # pg_db_role_setting</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2965              # pg_db_role_setting_databaseid_rol_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2966              # pg_toast_2964</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 2967              # pg_toast_2964_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 3592              # pg_shseclabel</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 3593              # pg_shseclabel_object_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 4060              # pg_toast_3592x</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 4061              # pg_toast_3592_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 6000              # pg_replication_origin</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 6001              # pg_replication_origin_roiident_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 6002              # pg_replication_origin_roname_index</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ pg_control        # global control file, use pgcheck -pc to see it.</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ pg_filenode.map   # system table (oid -&gt; filenode) mapping file, use pgcheck -pm to see it.</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â””â”€â”€ pg_internal.init  # system table cache file, use pgcheck -pr to see it.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">data</span></span>
<span class="line"><span style="color:#24292e;">â”œâ”€â”€ global                # under global, all the filenode is hard-code(select oid,relname,relfilenode from pg_class where relfilenode=0 order by oid;)</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1136              # pg_pltemplate</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1137              # pg_pltemplate_name_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1213              # pg_tablespace</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1214              # pg_shdepend</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1232              # pg_shdepend_depender_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1233              # pg_shdepend_reference_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1260              # pg_authid</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1261              # pg_auth_members</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1262              # pg_database</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2396              # pg_shdescription</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2397              # pg_shdescription_o_c_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2671              # pg_database_datname_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2672              # pg_database_oid_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2676              # pg_authid_rolname_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2677              # pg_authid_oid_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2694              # pg_auth_members_role_member_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2695              # pg_auth_members_member_role_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2697              # pg_tablespace_oid_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2698              # pg_tablespace_spcname_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2846              # pg_toast_2396</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2847              # pg_toast_2396_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2964              # pg_db_role_setting</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2965              # pg_db_role_setting_databaseid_rol_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2966              # pg_toast_2964</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 2967              # pg_toast_2964_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 3592              # pg_shseclabel</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 3593              # pg_shseclabel_object_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 4060              # pg_toast_3592x</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 4061              # pg_toast_3592_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 6000              # pg_replication_origin</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 6001              # pg_replication_origin_roiident_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 6002              # pg_replication_origin_roname_index</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ pg_control        # global control file, use pgcheck -pc to see it.</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ pg_filenode.map   # system table (oid -&gt; filenode) mapping file, use pgcheck -pm to see it.</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â””â”€â”€ pg_internal.init  # system table cache file, use pgcheck -pr to see it.</span></span></code></pre></div><h2 id="_2-base" tabindex="-1">2.base <a class="header-anchor" href="#_2-base" aria-label="Permalink to &quot;2.base&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">data</span></span>
<span class="line"><span style="color:#e1e4e8;">â”œâ”€â”€ base                  # use to store database file(SELECT oid, datname FROM pg_database;)</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 1                 # template database</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 12406             # template0 database</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”œâ”€â”€ 12407             # postgres database</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â””â”€â”€ 16384             # testdb, first user database</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”‚   â”œâ”€â”€ 3600</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”‚   â”œâ”€â”€ 3600_fsm</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”‚   â”œâ”€â”€ 3600_vm</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”‚   â”œâ”€â”€ 16385</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”‚   â”œâ”€â”€ pg_filenode.map</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”‚   â”œâ”€â”€ pg_internal.init</span></span>
<span class="line"><span style="color:#e1e4e8;">â”‚   â”‚   â””â”€â”€ PG_VERSION</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">data</span></span>
<span class="line"><span style="color:#24292e;">â”œâ”€â”€ base                  # use to store database file(SELECT oid, datname FROM pg_database;)</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 1                 # template database</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 12406             # template0 database</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”œâ”€â”€ 12407             # postgres database</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â””â”€â”€ 16384             # testdb, first user database</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”‚   â”œâ”€â”€ 3600</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”‚   â”œâ”€â”€ 3600_fsm</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”‚   â”œâ”€â”€ 3600_vm</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”‚   â”œâ”€â”€ 16385</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”‚   â”œâ”€â”€ pg_filenode.map</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”‚   â”œâ”€â”€ pg_internal.init</span></span>
<span class="line"><span style="color:#24292e;">â”‚   â”‚   â””â”€â”€ PG_VERSION</span></span></code></pre></div><ol><li>pg_filenode.map æ˜¯pg_classé‡Œrelfilenodeä¸º0çš„ç³»ç»Ÿè¡¨ï¼ŒOIDä¸æ–‡ä»¶çš„ç¡¬ç¼–ç æ˜ å°„ã€‚</li><li>pg_internal.init æ˜¯ç³»ç»Ÿè¡¨çš„cacheæ–‡ä»¶ï¼Œç”¨äºåŠ å¿«è¯»å–ã€‚é»˜è®¤ä¸å­˜åœ¨ï¼ŒæŸ¥è¯¢ç³»ç»Ÿè¡¨åè‡ªåŠ¨äº§ç”Ÿã€‚</li><li>PG_VERSION æ˜¯å½“å‰æ•°æ®åº“æ•°æ®æ ¼å¼å¯¹åº”çš„ç‰ˆæœ¬å·</li><li>å…¶å®ƒæ–‡ä»¶æ˜¯éœ€è¦åˆ°pg_classé‡Œæ ¹æ®OIDæŸ¥åˆ°å¯¹åº”çš„relfilenodeæ¥ä¸æ–‡ä»¶ååŒ¹é…çš„ã€‚ ä¾‹å¦‚ï¼štab1çš„relfilenodeæ˜¯16385ï¼Œé‚£ä¹ˆ16385è¿™ä¸ªæ–‡ä»¶å°±æ˜¯tab1çš„æ•°æ®æ–‡ä»¶</li></ol><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">han</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"># </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;">,relfilenode,relname </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> pg_class </span><span style="color:#F97583;">where</span><span style="color:#E1E4E8;"> relname</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;test&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;">  | relfilenode | relname </span></span>
<span class="line"><span style="color:#6A737D;">-------+-------------+---------</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">16393</span><span style="color:#E1E4E8;"> |       </span><span style="color:#79B8FF;">16393</span><span style="color:#E1E4E8;"> | test</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">row</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">han</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"># </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;">,relfilenode,relname </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> pg_class </span><span style="color:#D73A49;">where</span><span style="color:#24292E;"> relname</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;test&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;">  | relfilenode | relname </span></span>
<span class="line"><span style="color:#6A737D;">-------+-------------+---------</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#005CC5;">16393</span><span style="color:#24292E;"> |       </span><span style="color:#005CC5;">16393</span><span style="color:#24292E;"> | test</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">row</span><span style="color:#24292E;">)</span></span></code></pre></div><p>5.ç©ºé—²ç©ºé—´æ˜ å°„è¡¨ åå­—ä»¥_fsmç»“å°¾çš„æ–‡ä»¶æ˜¯æ•°æ®æ–‡ä»¶å¯¹åº”çš„FSM(free space map)æ–‡ä»¶ï¼Œç”¨mapæ–¹å¼æ¥æ ‡è¯†å“ªäº›blockæ˜¯ç©ºé—²çš„ã€‚ç”¨ä¸€ä¸ªByteè€Œä¸æ˜¯bitæ¥æ ‡è¯†ä¸€ä¸ªblockã€‚å¯¹äºä¸€ä¸ªæœ‰Nä¸ªå­—èŠ‚çš„blockï¼Œå®ƒåœ¨_fsmæ–‡ä»¶ä¸­ç¬¬blknumä¸ªå­—èŠ‚ä¸­è®°å½•çš„å€¼æ˜¯(31+N)/32ã€‚é€šè¿‡è¿™ç§æ–¹å¼æ ‡è¯†ä¸€ä¸ªblockç©ºé—²å­—èŠ‚æ•°ã€‚FSMä¸­ä¸æ˜¯ç®€å•çš„æ•°ç»„ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸‰å±‚çš„æ ‘å½¢ç»“æ„ã€‚FSMæ–‡ä»¶æ˜¯åœ¨éœ€è¦ç”¨åˆ°å®ƒæ—¶æ‰è‡ªåŠ¨äº§ç”Ÿçš„ã€‚</p><p>6.å¯è§æ€§æ˜ å°„è¡¨æ–‡ä»¶ åå­—ä»¥_vmç»“å°¾çš„æ–‡ä»¶æ˜¯æ•°æ®æ–‡ä»¶å¯¹åº”çš„VM(visibility map)ã€‚PostgreSQLä¸­åœ¨åšå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶æ—¶æ˜¯é€šè¿‡åœ¨å…ƒç»„å¤´ä¸Šæ ‡è¯†â€œå·²æ— æ•ˆâ€æ¥å®ç°åˆ é™¤æˆ–æ›´æ–°çš„ï¼Œæœ€åé€šè¿‡VACUUMåŠŸèƒ½æ¥æ¸…ç†æ— æ•ˆæ•°æ®å›æ”¶ç©ºé—²ç©ºé—´ã€‚åœ¨åšVACUUMæ—¶å°±ä½¿ç”¨VMå¼€å¿«é€ŸæŸ¥æ‰¾åŒ…å«æ— æ•ˆå…ƒç»„çš„blockã€‚VMä»…æ˜¯ä¸ªç®€å•çš„bitmap,ä¸€ä¸ªbitå¯¹åº”ä¸€ä¸ªblockã€‚</p><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>ç³»ç»Ÿè¡¨åˆ†ä¸ºå…¨å±€ç³»ç»Ÿè¡¨å’Œåº“çº§ç³»ç»Ÿè¡¨ã€‚</p><p>å…¨å±€ç³»ç»Ÿè¡¨ä½äºglobalä¸‹ï¼Œä¾‹å¦‚ï¼špg_database,pg_tablespace,pg_auth_membersè¿™ç§å­˜å‚¨ç³»ç»Ÿçº§å¯¹è±¡çš„è¡¨ã€‚</p><p>åº“çº§ç³»ç»Ÿè¡¨ä½äºæ•°æ®åº“ç›®å½•ä¸‹ï¼Œä¾‹å¦‚ï¼špg_type,pg_proc,pg_attributeè¿™ç§å­˜å‚¨åº“çº§å¯¹è±¡çš„è¡¨ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯pg_classä½äºåº“çº§ç›®å½•çš„é‡Œï¼Œä½†ä¹ŸåŒ…å«å…¨å±€ç³»ç»Ÿè¡¨ä¿¡æ¯ï¼Œå› æ­¤ç ”å‘æˆ–è¿ç»´äººå‘˜åœ¨æ”¹åŠ¨å…¨å±€ç³»ç»Ÿè¡¨ä¿¡æ¯æ—¶éœ€è¦æ³¨æ„</p></div><h2 id="_3-è¡¨ç©ºé—´" tabindex="-1">3.è¡¨ç©ºé—´ <a class="header-anchor" href="#_3-è¡¨ç©ºé—´" aria-label="Permalink to &quot;3.è¡¨ç©ºé—´&quot;">â€‹</a></h2><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">han</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"># </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;">,</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> pg_tablespace;</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;">  | </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;">  |  spcname   | spcowner | spcacl | spcoptions </span></span>
<span class="line"><span style="color:#6A737D;">------+------+------------+----------+--------+------------</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1663</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">1663</span><span style="color:#E1E4E8;"> | pg_default |       </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;"> |        | </span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">1664</span><span style="color:#E1E4E8;"> | </span><span style="color:#79B8FF;">1664</span><span style="color:#E1E4E8;"> | pg_global  |       </span><span style="color:#79B8FF;">10</span><span style="color:#E1E4E8;"> |        | </span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">rows</span><span style="color:#E1E4E8;">)</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">han</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"># </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;">,</span><span style="color:#D73A49;">*</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> pg_tablespace;</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;">  | </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;">  |  spcname   | spcowner | spcacl | spcoptions </span></span>
<span class="line"><span style="color:#6A737D;">------+------+------------+----------+--------+------------</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#005CC5;">1663</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">1663</span><span style="color:#24292E;"> | pg_default |       </span><span style="color:#005CC5;">10</span><span style="color:#24292E;"> |        | </span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#005CC5;">1664</span><span style="color:#24292E;"> | </span><span style="color:#005CC5;">1664</span><span style="color:#24292E;"> | pg_global  |       </span><span style="color:#005CC5;">10</span><span style="color:#24292E;"> |        | </span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#005CC5;">2</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">rows</span><span style="color:#24292E;">)</span></span></code></pre></div><p>æ¯ä¸€ä¸ªOidéƒ½åœ¨data/pg_tblspcä¸‹å¯¹åº”ä¸€ä¸ªåä¸ºOidçš„è½¯é“¾æ¥æ–‡ä»¶ï¼ŒæŒ‡å‘çœŸæ­£çš„spaceç›®å½•</p><div class="language-sql vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">han</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"># </span><span style="color:#F97583;">create</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">table</span><span style="color:#E1E4E8;"> test1(a </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;">) tablespace dbspace;</span></span>
<span class="line"><span style="color:#F97583;">CREATE</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">TABLE</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">han</span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"># </span><span style="color:#F97583;">select</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;">,relname,relfilenode </span><span style="color:#F97583;">from</span><span style="color:#E1E4E8;"> pg_class </span><span style="color:#F97583;">where</span><span style="color:#E1E4E8;"> relname</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">&#39;test1&#39;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">  </span><span style="color:#F97583;">oid</span><span style="color:#E1E4E8;">  | relname | relfilenode</span></span>
<span class="line"><span style="color:#6A737D;">-------+---------+-------------</span></span>
<span class="line"><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">57351</span><span style="color:#E1E4E8;"> | tab3    |       </span><span style="color:#79B8FF;">57351</span></span>
<span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">row</span><span style="color:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#E1E4E8;"> tree ..</span><span style="color:#F97583;">/data/</span><span style="color:#E1E4E8;">pg_tblspc</span><span style="color:#F97583;">/</span><span style="color:#79B8FF;">49162</span></span>
<span class="line"><span style="color:#E1E4E8;">..</span><span style="color:#F97583;">/data/</span><span style="color:#E1E4E8;">pg_tblspc</span><span style="color:#F97583;">/</span><span style="color:#79B8FF;">49162</span></span>
<span class="line"><span style="color:#E1E4E8;">â””â”€â”€ </span><span style="color:#79B8FF;">PG_9</span><span style="color:#E1E4E8;">.</span><span style="color:#79B8FF;">6_201608131</span></span>
<span class="line"><span style="color:#E1E4E8;">    â””â”€â”€ </span><span style="color:#79B8FF;">16384</span></span>
<span class="line"><span style="color:#E1E4E8;">        â””â”€â”€ </span><span style="color:#79B8FF;">57351</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">han</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"># </span><span style="color:#D73A49;">create</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">table</span><span style="color:#24292E;"> test1(a </span><span style="color:#D73A49;">int</span><span style="color:#24292E;">) tablespace dbspace;</span></span>
<span class="line"><span style="color:#D73A49;">CREATE</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">TABLE</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">han</span><span style="color:#D73A49;">=</span><span style="color:#24292E;"># </span><span style="color:#D73A49;">select</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;">,relname,relfilenode </span><span style="color:#D73A49;">from</span><span style="color:#24292E;"> pg_class </span><span style="color:#D73A49;">where</span><span style="color:#24292E;"> relname</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">&#39;test1&#39;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">  </span><span style="color:#D73A49;">oid</span><span style="color:#24292E;">  | relname | relfilenode</span></span>
<span class="line"><span style="color:#6A737D;">-------+---------+-------------</span></span>
<span class="line"><span style="color:#24292E;"> </span><span style="color:#005CC5;">57351</span><span style="color:#24292E;"> | tab3    |       </span><span style="color:#005CC5;">57351</span></span>
<span class="line"><span style="color:#24292E;">(</span><span style="color:#005CC5;">1</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">row</span><span style="color:#24292E;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">#æŸ¥çœ‹</span></span>
<span class="line"><span style="color:#24292E;"> tree ..</span><span style="color:#D73A49;">/data/</span><span style="color:#24292E;">pg_tblspc</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">49162</span></span>
<span class="line"><span style="color:#24292E;">..</span><span style="color:#D73A49;">/data/</span><span style="color:#24292E;">pg_tblspc</span><span style="color:#D73A49;">/</span><span style="color:#005CC5;">49162</span></span>
<span class="line"><span style="color:#24292E;">â””â”€â”€ </span><span style="color:#005CC5;">PG_9</span><span style="color:#24292E;">.</span><span style="color:#005CC5;">6_201608131</span></span>
<span class="line"><span style="color:#24292E;">    â””â”€â”€ </span><span style="color:#005CC5;">16384</span></span>
<span class="line"><span style="color:#24292E;">        â””â”€â”€ </span><span style="color:#005CC5;">57351</span></span></code></pre></div>`,22),o=[e];function t(c,r,i,d,y,_){return a(),n("div",null,o)}const b=s(l,[["render",t]]);export{g as __pageData,b as default};
