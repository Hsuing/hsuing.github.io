import{_ as a,o as s,c as e,R as n}from"./chunks/framework.zUbWieqp.js";const h=JSON.parse('{"title":"1.å¤‡ä»½å…ƒæ•°æ®","description":"","frontmatter":{},"headers":[],"relativePath":"guide/Database/rabbitmq/3-backup.md","filePath":"guide/Database/rabbitmq/3-backup.md","lastUpdated":1716287268000}'),t={name:"guide/Database/rabbitmq/3-backup.md"},l=n(`<h1 id="_1-å¤‡ä»½å…ƒæ•°æ®" tabindex="-1">1.å¤‡ä»½å…ƒæ•°æ® <a class="header-anchor" href="#_1-å¤‡ä»½å…ƒæ•°æ®" aria-label="Permalink to &quot;1.å¤‡ä»½å…ƒæ•°æ®&quot;">â€‹</a></h1><p>åœ¨æœåŠ¡Bä¸Šæ­å»ºrabbitmqæœåŠ¡ï¼Œæ³¨æ„ï¼Œä¸»æœºåæœ€å¥½å’ŒAä¸Šçš„MQä¿æŒä¸€è‡´ã€‚é¿å…åé¢çš„æ•°æ®å­˜å‚¨èŠ‚ç‚¹åä¸ä¸€è‡´ï¼Œå¯¼è‡´å¯åŠ¨å¤±è´¥</p><ul><li>é€šè¿‡å›¾å½¢å¤‡ä»½å…ƒæ•°æ®</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202405181306506.jpg" alt=""></p><ul><li>å¯¼å…¥æ–°æœºå™¨ä¸Šé¢</li></ul><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202405181306454.jpg" alt=""></p><ul><li><h3 id="éªŒè¯æ•°æ®" tabindex="-1">éªŒè¯æ•°æ® <a class="header-anchor" href="#éªŒè¯æ•°æ®" aria-label="Permalink to &quot;éªŒè¯æ•°æ®&quot;">â€‹</a></h3></li></ul><p>åˆ·æ–°é¡µé¢ï¼ŒæŸ¥çœ‹ç”¨æˆ·ã€é˜Ÿåˆ—ã€vhost ç­‰ä¿¡æ¯æ˜¯å¦å­˜åœ¨</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202405181306250.jpg" alt=""></p><div class="warning custom-block"><p class="custom-block-title">ğŸ’¡ è¯´æ˜</p><p>å†…éƒ¨èŠ‚ç‚¹æ•°æ®åº“åœ¨æŸäº›è®°å½•ä¸­å­˜å‚¨èŠ‚ç‚¹çš„åç§°ï¼Œå¦‚æœèŠ‚ç‚¹åç§°å‘ç”Ÿæ›´æ”¹ï¼Œåˆ™å¿…é¡»é¦–å…ˆä½¿ç”¨ä»¥ä¸‹rabbitmqctlå‘½ä»¤æ›´æ–°æ•°æ®åº“ä»¥ä¾¿æ›´æ”¹ï¼š</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">rabbitmqctl rename_cluster_node &lt;oldnode&gt; &lt;newnode&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">rabbitmqctl rename_cluster_node &lt;oldnode&gt; &lt;newnode&gt;</span></span></code></pre></div><p>å½“æ–°èŠ‚ç‚¹ä»¥å¤‡ä»½ç›®å½•å’ŒåŒ¹é…çš„èŠ‚ç‚¹åç§°å¯åŠ¨æ—¶ï¼Œå®ƒä¼šæ ¹æ®éœ€è¦æ‰§è¡Œå‡çº§æ­¥éª¤å¹¶ç»§ç»­å¼•å¯¼</p></div><h1 id="_2-å¤‡ä»½æ¶ˆæ¯æ•°æ®" tabindex="-1">2.å¤‡ä»½æ¶ˆæ¯æ•°æ® <a class="header-anchor" href="#_2-å¤‡ä»½æ¶ˆæ¯æ•°æ®" aria-label="Permalink to &quot;2.å¤‡ä»½æ¶ˆæ¯æ•°æ®&quot;">â€‹</a></h1><h2 id="_1-å¤‡ä»½-rabbitmq-é…ç½®" tabindex="-1">1.å¤‡ä»½ rabbitmq é…ç½® <a class="header-anchor" href="#_1-å¤‡ä»½-rabbitmq-é…ç½®" aria-label="Permalink to &quot;1.å¤‡ä»½ rabbitmq é…ç½®&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@beta ~]# rabbitmqadmin export rabbitmq_back.json</span></span>
<span class="line"><span style="color:#e1e4e8;">Exported definitions for localhost to &quot;rabbitmq_back.json&quot;</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">#æœ‰å¯†ç æ–¹å¼</span></span>
<span class="line"><span style="color:#e1e4e8;">/sbin/rabbitmqadmin -H \${mq_server_ip} -P \${mqadmin_port} -u \${mqadmin_user} -p \${mqadmin_pw} export \${mq_config_backup_file} &gt; /dev/null 2&gt;&amp;1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@beta ~]# rabbitmqadmin export rabbitmq_back.json</span></span>
<span class="line"><span style="color:#24292e;">Exported definitions for localhost to &quot;rabbitmq_back.json&quot;</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">#æœ‰å¯†ç æ–¹å¼</span></span>
<span class="line"><span style="color:#24292e;">/sbin/rabbitmqadmin -H \${mq_server_ip} -P \${mqadmin_port} -u \${mqadmin_user} -p \${mqadmin_pw} export \${mq_config_backup_file} &gt; /dev/null 2&gt;&amp;1</span></span></code></pre></div><h2 id="_2-æ¢å¤é…ç½®" tabindex="-1">2.æ¢å¤é…ç½® <a class="header-anchor" href="#_2-æ¢å¤é…ç½®" aria-label="Permalink to &quot;2.æ¢å¤é…ç½®&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@beta ~]# rabbitmqadmin import   rabbitmq_back.json  Imported definitions for localhost from &quot;rabbitmq_back.json&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@beta ~]# rabbitmqadmin import   rabbitmq_back.json  Imported definitions for localhost from &quot;rabbitmq_back.json&quot;</span></span></code></pre></div><h2 id="_3-è·å–-rabbitmq-æ•°æ®ç›®å½•" tabindex="-1">3.è·å– rabbitmq æ•°æ®ç›®å½• <a class="header-anchor" href="#_3-è·å–-rabbitmq-æ•°æ®ç›®å½•" aria-label="Permalink to &quot;3.è·å– rabbitmq æ•°æ®ç›®å½•&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#è·å–æ•°æ®ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</span></span>
<span class="line"><span style="color:#e1e4e8;">[root@beta ~]# rabbitmqctl eval &#39;rabbit_mnesia:dir().&#39;</span></span>
<span class="line"><span style="color:#e1e4e8;">&quot;/data/ajime/ajime_data/rabbitmq_data/mnesia/rabbit&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#è·å–æ•°æ®ç›®å½•æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤</span></span>
<span class="line"><span style="color:#24292e;">[root@beta ~]# rabbitmqctl eval &#39;rabbit_mnesia:dir().&#39;</span></span>
<span class="line"><span style="color:#24292e;">&quot;/data/ajime/ajime_data/rabbitmq_data/mnesia/rabbit&quot;</span></span></code></pre></div><h2 id="_4-å¤‡ä»½" tabindex="-1">4.å¤‡ä»½ <a class="header-anchor" href="#_4-å¤‡ä»½" aria-label="Permalink to &quot;4.å¤‡ä»½&quot;">â€‹</a></h2><p>ä¸ºä¿è¯æ•°æ®ä¸€è‡´ï¼Œå¯ä»¥å…ˆåœæ­¢ rabbitmq</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">[root@beta mnesia]# pwd</span></span>
<span class="line"><span style="color:#e1e4e8;">/data/ajime/ajime_data/rabbitmq_data/mnesia</span></span>
<span class="line"><span style="color:#e1e4e8;"></span></span>
<span class="line"><span style="color:#e1e4e8;">tar -zcf rabbitmq_backup.tar.gz rabbit</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">[root@beta mnesia]# pwd</span></span>
<span class="line"><span style="color:#24292e;">/data/ajime/ajime_data/rabbitmq_data/mnesia</span></span>
<span class="line"><span style="color:#24292e;"></span></span>
<span class="line"><span style="color:#24292e;">tar -zcf rabbitmq_backup.tar.gz rabbit</span></span></code></pre></div><h2 id="_5-æ•°æ®æ¢å¤" tabindex="-1">5.æ•°æ®æ¢å¤ <a class="header-anchor" href="#_5-æ•°æ®æ¢å¤" aria-label="Permalink to &quot;5.æ•°æ®æ¢å¤&quot;">â€‹</a></h2><p>æ¢å¤æ•°æ®æ¯”è¾ƒç®€å•ï¼ŒæŠŠå‹ç¼©æ¡£è§£å‹è‡³æ•°æ®ç›®å½•ä¸­å³å¯ã€‚æ¢å¤åˆ°å¦ä¸€èŠ‚ç‚¹åˆ™ä¸é€‚ç”¨ï¼Œå¤‡ä»½åŒä¸€å°æœºå™¨ï¼Œç„¶åé‡å¯åŒä¸€å°æœºå™¨</p><p>å‚è€ƒåœ°å€</p><ul><li><a href="https://www.rabbitmq.com/backup.html" target="_blank" rel="noreferrer">https://www.rabbitmq.com/backup.html</a></li><li><a href="https://www.rabbitmq.com/upgrade.html" target="_blank" rel="noreferrer">https://www.rabbitmq.com/upgrade.html</a></li><li><a href="https://www.rabbitmq.com/blue-green-upgrade.html" target="_blank" rel="noreferrer">https://www.rabbitmq.com/blue-green-upgrade.html</a></li></ul><h1 id="_3-åˆ é™¤æ•°æ®" tabindex="-1">3.åˆ é™¤æ•°æ® <a class="header-anchor" href="#_3-åˆ é™¤æ•°æ®" aria-label="Permalink to &quot;3.åˆ é™¤æ•°æ®&quot;">â€‹</a></h1><h2 id="_1-æ¸…ç©ºæŒ‡å®šqueueé˜Ÿåˆ—çš„æ•°æ®" tabindex="-1">1. æ¸…ç©ºæŒ‡å®šqueueé˜Ÿåˆ—çš„æ•°æ® <a class="header-anchor" href="#_1-æ¸…ç©ºæŒ‡å®šqueueé˜Ÿåˆ—çš„æ•°æ®" aria-label="Permalink to &quot;1. æ¸…ç©ºæŒ‡å®šqueueé˜Ÿåˆ—çš„æ•°æ®&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#æŸ¥çœ‹é˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#e1e4e8;">rabbitmqctl list_queues</span></span>
<span class="line"><span style="color:#e1e4e8;">#æ¸…ç©ºæŒ‡å®šé˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#e1e4e8;">rabbitmqctl -q purge_queue queue_name</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#æŸ¥çœ‹é˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#24292e;">rabbitmqctl list_queues</span></span>
<span class="line"><span style="color:#24292e;">#æ¸…ç©ºæŒ‡å®šé˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#24292e;">rabbitmqctl -q purge_queue queue_name</span></span></code></pre></div><h2 id="_2-rabbitmqadminæ¸…ç©ºé˜Ÿåˆ—" tabindex="-1">2. rabbitmqadminæ¸…ç©ºé˜Ÿåˆ— <a class="header-anchor" href="#_2-rabbitmqadminæ¸…ç©ºé˜Ÿåˆ—" aria-label="Permalink to &quot;2. rabbitmqadminæ¸…ç©ºé˜Ÿåˆ—&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">#æŸ¥çœ‹é˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#e1e4e8;">rabbitmqadmin list queues</span></span>
<span class="line"><span style="color:#e1e4e8;">#æ¸…ç©ºæŒ‡å®šé˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#e1e4e8;">rabbitmqadmin delete queue name=queue_name</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">#æŸ¥çœ‹é˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#24292e;">rabbitmqadmin list queues</span></span>
<span class="line"><span style="color:#24292e;">#æ¸…ç©ºæŒ‡å®šé˜Ÿåˆ—</span></span>
<span class="line"><span style="color:#24292e;">rabbitmqadmin delete queue name=queue_name</span></span></code></pre></div><h2 id="_3-æ¸…ç©ºå…¨éƒ¨é˜Ÿåˆ—" tabindex="-1">3. æ¸…ç©ºå…¨éƒ¨é˜Ÿåˆ— <a class="header-anchor" href="#_3-æ¸…ç©ºå…¨éƒ¨é˜Ÿåˆ—" aria-label="Permalink to &quot;3. æ¸…ç©ºå…¨éƒ¨é˜Ÿåˆ—&quot;">â€‹</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#e1e4e8;">rabbitmqctl stop_app</span></span>
<span class="line"><span style="color:#e1e4e8;">rabbitmqctl reset    </span></span>
<span class="line"><span style="color:#e1e4e8;">rabbitmqctl start_app</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292e;">rabbitmqctl stop_app</span></span>
<span class="line"><span style="color:#24292e;">rabbitmqctl reset    </span></span>
<span class="line"><span style="color:#24292e;">rabbitmqctl start_app</span></span></code></pre></div><h2 id="_4-ç®¡ç†ç«¯æ“ä½œ" tabindex="-1">4. ç®¡ç†ç«¯æ“ä½œ <a class="header-anchor" href="#_4-ç®¡ç†ç«¯æ“ä½œ" aria-label="Permalink to &quot;4. ç®¡ç†ç«¯æ“ä½œ&quot;">â€‹</a></h2><p>åœ¨webç®¡ç†ç«¯å¯ä»¥è¿›è¡Œæ“ä½œ,é€‰æ‹©åˆ°è¦æ“ä½œçš„é˜Ÿåˆ—,ä¸‹æ‹‰é‡Œé¢æœ‰ä¸€ä¸ªPurge(ä¸è¦é€‰åˆ°delete)</p><p><img src="https://nnaigos.oss-cn-hangzhou.aliyuncs.com/imgs/202405181306288.png" alt=""></p>`,34),p=[l];function i(o,r,c,b,d,m){return s(),e("div",null,p)}const q=a(t,[["render",i]]);export{h as __pageData,q as default};
